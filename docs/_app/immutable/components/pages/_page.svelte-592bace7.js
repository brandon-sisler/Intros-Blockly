var tx=Object.defineProperty;var ix=(r,e,i)=>e in r?tx(r,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[e]=i;var _i=(r,e,i)=>(ix(r,typeof e!="symbol"?e+"":e,i),i);import{S as Ii,i as ki,s as Ai,k as Ft,q as Et,l as Ut,m as Vt,r as $t,h as ue,b as Ee,H as vi,u as Li,C as Wi,I as ns,x as st,y as nt,z as ot,f as ee,t as ae,A as lt,p as R0,J as A2,n as Ki,K as rx,e as dt,L as sx,g as mt,d as gt,M as di,a as xi,c as Di,N as nx,o as ub,O as ox,v as cb,P as lx,Q as ax}from"../../chunks/index-5264acbb.js";import{w as ux}from"../../chunks/index-0b8245a6.js";const hb={xml:!1,decodeEntities:!0},C2={_useHtmlParser2:!0,xmlMode:!0};function K1(r){return r!=null&&r.xml?typeof r.xml=="boolean"?C2:{...C2,...r.xml}:r??void 0}var Pt;(function(r){r.Root="root",r.Text="text",r.Directive="directive",r.Comment="comment",r.Script="script",r.Style="style",r.Tag="tag",r.CDATA="cdata",r.Doctype="doctype"})(Pt||(Pt={}));function cx(r){return r.type===Pt.Tag||r.type===Pt.Script||r.type===Pt.Style}const hx=Pt.Root,dx=Pt.Text,fx=Pt.Directive,px=Pt.Comment,mx=Pt.Script,gx=Pt.Style,_x=Pt.Tag,bx=Pt.CDATA,Tx=Pt.Doctype;let rA=class{constructor(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}get parentNode(){return this.parent}set parentNode(e){this.parent=e}get previousSibling(){return this.prev}set previousSibling(e){this.prev=e}get nextSibling(){return this.next}set nextSibling(e){this.next=e}cloneNode(e=!1){return N0(this,e)}};class db extends rA{constructor(e){super(),this.data=e}get nodeValue(){return this.data}set nodeValue(e){this.data=e}}let Vc=class extends db{constructor(){super(...arguments),this.type=Pt.Text}get nodeType(){return 3}};class fb extends db{constructor(){super(...arguments),this.type=Pt.Comment}get nodeType(){return 8}}class pb extends db{constructor(e,i){super(i),this.name=e,this.type=Pt.Directive}get nodeType(){return 1}}class mb extends rA{constructor(e){super(),this.children=e}get firstChild(){var e;return(e=this.children[0])!==null&&e!==void 0?e:null}get lastChild(){return this.children.length>0?this.children[this.children.length-1]:null}get childNodes(){return this.children}set childNodes(e){this.children=e}}class sA extends mb{constructor(){super(...arguments),this.type=Pt.CDATA}get nodeType(){return 4}}class Fl extends mb{constructor(){super(...arguments),this.type=Pt.Root}get nodeType(){return 9}}let gb=class extends mb{constructor(e,i,s=[],n=e==="script"?Pt.Script:e==="style"?Pt.Style:Pt.Tag){super(s),this.name=e,this.attribs=i,this.type=n}get nodeType(){return 1}get tagName(){return this.name}set tagName(e){this.name=e}get attributes(){return Object.keys(this.attribs).map(e=>{var i,s;return{name:e,value:this.attribs[e],namespace:(i=this["x-attribsNamespace"])===null||i===void 0?void 0:i[e],prefix:(s=this["x-attribsPrefix"])===null||s===void 0?void 0:s[e]}})}};function et(r){return cx(r)}function Df(r){return r.type===Pt.CDATA}function Sn(r){return r.type===Pt.Text}function Lf(r){return r.type===Pt.Comment}function q1(r){return r.type===Pt.Directive}function Wl(r){return r.type===Pt.Root}function qi(r){return Object.prototype.hasOwnProperty.call(r,"children")}function N0(r,e=!1){let i;if(Sn(r))i=new Vc(r.data);else if(Lf(r))i=new fb(r.data);else if(et(r)){const s=e?Kg(r.children):[],n=new gb(r.name,{...r.attribs},s);s.forEach(l=>l.parent=n),r.namespace!=null&&(n.namespace=r.namespace),r["x-attribsNamespace"]&&(n["x-attribsNamespace"]={...r["x-attribsNamespace"]}),r["x-attribsPrefix"]&&(n["x-attribsPrefix"]={...r["x-attribsPrefix"]}),i=n}else if(Df(r)){const s=e?Kg(r.children):[],n=new sA(s);s.forEach(l=>l.parent=n),i=n}else if(Wl(r)){const s=e?Kg(r.children):[],n=new Fl(s);s.forEach(l=>l.parent=n),r["x-mode"]&&(n["x-mode"]=r["x-mode"]),i=n}else if(q1(r)){const s=new pb(r.name,r.data);r["x-name"]!=null&&(s["x-name"]=r["x-name"],s["x-publicId"]=r["x-publicId"],s["x-systemId"]=r["x-systemId"]),i=s}else throw new Error(`Not implemented yet: ${r.type}`);return i.startIndex=r.startIndex,i.endIndex=r.endIndex,r.sourceCodeLocation!=null&&(i.sourceCodeLocation=r.sourceCodeLocation),i}function Kg(r){const e=r.map(i=>N0(i,!0));for(let i=1;i<e.length;i++)e[i].prev=e[i-1],e[i-1].next=e[i];return e}const O2={withStartIndices:!1,withEndIndices:!1,xmlMode:!1};class Ex{constructor(e,i,s){this.dom=[],this.root=new Fl(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof i=="function"&&(s=i,i=O2),typeof e=="object"&&(i=e,e=void 0),this.callback=e??null,this.options=i??O2,this.elementCB=s??null}onparserinit(e){this.parser=e}onreset(){this.dom=[],this.root=new Fl(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null}onend(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))}onerror(e){this.handleCallback(e)}onclosetag(){this.lastNode=null;const e=this.tagStack.pop();this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(e)}onopentag(e,i){const s=this.options.xmlMode?Pt.Tag:void 0,n=new gb(e,i,void 0,s);this.addNode(n),this.tagStack.push(n)}ontext(e){const{lastNode:i}=this;if(i&&i.type===Pt.Text)i.data+=e,this.options.withEndIndices&&(i.endIndex=this.parser.endIndex);else{const s=new Vc(e);this.addNode(s),this.lastNode=s}}oncomment(e){if(this.lastNode&&this.lastNode.type===Pt.Comment){this.lastNode.data+=e;return}const i=new fb(e);this.addNode(i),this.lastNode=i}oncommentend(){this.lastNode=null}oncdatastart(){const e=new Vc(""),i=new sA([e]);this.addNode(i),e.parent=i,this.lastNode=e}oncdataend(){this.lastNode=null}onprocessinginstruction(e,i){const s=new pb(e,i);this.addNode(s)}handleCallback(e){if(typeof this.callback=="function")this.callback(e,this.dom);else if(e)throw e}addNode(e){const i=this.tagStack[this.tagStack.length-1],s=i.children[i.children.length-1];this.options.withStartIndices&&(e.startIndex=this.parser.startIndex),this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),i.children.push(e),s&&(e.prev=s,s.next=e),e.parent=i,this.lastNode=null}}const Oo=new Uint16Array('ᵁ<Õıʊҝջאٵ۞ޢߖࠏ੊ઑඡ๭༉༦჊ረዡᐕᒝᓃᓟᔥ\0\0\0\0\0\0ᕫᛍᦍᰒᷝ὾⁠↰⊍⏀⏻⑂⠤⤒ⴈ⹈⿎〖㊺㘹㞬㣾㨨㩱㫠㬮ࠀEMabcfglmnoprstu\\bfms¦³¹ÈÏlig耻Æ䃆P耻&䀦cute耻Á䃁reve;䄂Āiyx}rc耻Â䃂;䐐r;쀀𝔄rave耻À䃀pha;䎑acr;䄀d;橓Āgp¡on;䄄f;쀀𝔸plyFunction;恡ing耻Å䃅Ācs¾Ãr;쀀𝒜ign;扔ilde耻Ã䃃ml耻Ä䃄ЀaceforsuåûþėĜĢħĪĀcrêòkslash;或Ŷöø;櫧ed;挆y;䐑ƀcrtąċĔause;戵noullis;愬a;䎒r;쀀𝔅pf;쀀𝔹eve;䋘còēmpeq;扎܀HOacdefhilorsuōőŖƀƞƢƵƷƺǜȕɳɸɾcy;䐧PY耻©䂩ƀcpyŝŢźute;䄆Ā;iŧŨ拒talDifferentialD;慅leys;愭ȀaeioƉƎƔƘron;䄌dil耻Ç䃇rc;䄈nint;戰ot;䄊ĀdnƧƭilla;䂸terDot;䂷òſi;䎧rcleȀDMPTǇǋǑǖot;抙inus;抖lus;投imes;抗oĀcsǢǸkwiseContourIntegral;戲eCurlyĀDQȃȏoubleQuote;思uote;怙ȀlnpuȞȨɇɕonĀ;eȥȦ户;橴ƀgitȯȶȺruent;扡nt;戯ourIntegral;戮ĀfrɌɎ;愂oduct;成nterClockwiseContourIntegral;戳oss;樯cr;쀀𝒞pĀ;Cʄʅ拓ap;才րDJSZacefiosʠʬʰʴʸˋ˗ˡ˦̳ҍĀ;oŹʥtrahd;椑cy;䐂cy;䐅cy;䐏ƀgrsʿ˄ˇger;怡r;憡hv;櫤Āayː˕ron;䄎;䐔lĀ;t˝˞戇a;䎔r;쀀𝔇Āaf˫̧Ācm˰̢riticalȀADGT̖̜̀̆cute;䂴oŴ̋̍;䋙bleAcute;䋝rave;䁠ilde;䋜ond;拄ferentialD;慆Ѱ̽\0\0\0͔͂\0Ѕf;쀀𝔻ƀ;DE͈͉͍䂨ot;惜qual;扐blèCDLRUVͣͲ΂ϏϢϸontourIntegraìȹoɴ͹\0\0ͻ»͉nArrow;懓Āeo·ΤftƀARTΐΖΡrrow;懐ightArrow;懔eåˊngĀLRΫτeftĀARγιrrow;柸ightArrow;柺ightArrow;柹ightĀATϘϞrrow;懒ee;抨pɁϩ\0\0ϯrrow;懑ownArrow;懕erticalBar;戥ǹABLRTaВЪаўѿͼrrowƀ;BUНОТ憓ar;椓pArrow;懵reve;䌑eft˒к\0ц\0ѐightVector;楐eeVector;楞ectorĀ;Bљњ憽ar;楖ightǔѧ\0ѱeeVector;楟ectorĀ;BѺѻ懁ar;楗eeĀ;A҆҇护rrow;憧ĀctҒҗr;쀀𝒟rok;䄐ࠀNTacdfglmopqstuxҽӀӄӋӞӢӧӮӵԡԯԶՒ՝ՠեG;䅊H耻Ð䃐cute耻É䃉ƀaiyӒӗӜron;䄚rc耻Ê䃊;䐭ot;䄖r;쀀𝔈rave耻È䃈ement;戈ĀapӺӾcr;䄒tyɓԆ\0\0ԒmallSquare;旻erySmallSquare;斫ĀgpԦԪon;䄘f;쀀𝔼silon;䎕uĀaiԼՉlĀ;TՂՃ橵ilde;扂librium;懌Āci՗՚r;愰m;橳a;䎗ml耻Ë䃋Āipժկsts;戃onentialE;慇ʀcfiosօֈ֍ֲ׌y;䐤r;쀀𝔉lledɓ֗\0\0֣mallSquare;旼erySmallSquare;斪Ͱֺ\0ֿ\0\0ׄf;쀀𝔽All;戀riertrf;愱cò׋؀JTabcdfgorstר׬ׯ׺؀ؒؖ؛؝أ٬ٲcy;䐃耻>䀾mmaĀ;d׷׸䎓;䏜reve;䄞ƀeiy؇،ؐdil;䄢rc;䄜;䐓ot;䄠r;쀀𝔊;拙pf;쀀𝔾eater̀EFGLSTصلَٖٛ٦qualĀ;Lؾؿ扥ess;招ullEqual;执reater;檢ess;扷lantEqual;橾ilde;扳cr;쀀𝒢;扫ЀAacfiosuڅڋږڛڞڪھۊRDcy;䐪Āctڐڔek;䋇;䁞irc;䄤r;愌lbertSpace;愋ǰگ\0ڲf;愍izontalLine;攀Āctۃۅòکrok;䄦mpńېۘownHumðįqual;扏܀EJOacdfgmnostuۺ۾܃܇܎ܚܞܡܨ݄ݸދޏޕcy;䐕lig;䄲cy;䐁cute耻Í䃍Āiyܓܘrc耻Î䃎;䐘ot;䄰r;愑rave耻Ì䃌ƀ;apܠܯܿĀcgܴܷr;䄪inaryI;慈lieóϝǴ݉\0ݢĀ;eݍݎ戬Āgrݓݘral;戫section;拂isibleĀCTݬݲomma;恣imes;恢ƀgptݿރވon;䄮f;쀀𝕀a;䎙cr;愐ilde;䄨ǫޚ\0ޞcy;䐆l耻Ï䃏ʀcfosuެ޷޼߂ߐĀiyޱ޵rc;䄴;䐙r;쀀𝔍pf;쀀𝕁ǣ߇\0ߌr;쀀𝒥rcy;䐈kcy;䐄΀HJacfosߤߨ߽߬߱ࠂࠈcy;䐥cy;䐌ppa;䎚Āey߶߻dil;䄶;䐚r;쀀𝔎pf;쀀𝕂cr;쀀𝒦րJTaceflmostࠥࠩࠬࡐࡣ঳সে্਷ੇcy;䐉耻<䀼ʀcmnpr࠷࠼ࡁࡄࡍute;䄹bda;䎛g;柪lacetrf;愒r;憞ƀaeyࡗ࡜ࡡron;䄽dil;䄻;䐛Āfsࡨ॰tԀACDFRTUVarࡾࢩࢱࣦ࣠ࣼयज़ΐ४Ānrࢃ࢏gleBracket;柨rowƀ;BR࢙࢚࢞憐ar;懤ightArrow;懆eiling;挈oǵࢷ\0ࣃbleBracket;柦nǔࣈ\0࣒eeVector;楡ectorĀ;Bࣛࣜ懃ar;楙loor;挊ightĀAV࣯ࣵrrow;憔ector;楎Āerँगeƀ;AVउऊऐ抣rrow;憤ector;楚iangleƀ;BEतथऩ抲ar;槏qual;抴pƀDTVषूौownVector;楑eeVector;楠ectorĀ;Bॖॗ憿ar;楘ectorĀ;B॥०憼ar;楒ightáΜs̀EFGLSTॾঋকঝঢভqualGreater;拚ullEqual;扦reater;扶ess;檡lantEqual;橽ilde;扲r;쀀𝔏Ā;eঽা拘ftarrow;懚idot;䄿ƀnpw৔ਖਛgȀLRlr৞৷ਂਐeftĀAR০৬rrow;柵ightArrow;柷ightArrow;柶eftĀarγਊightáοightáϊf;쀀𝕃erĀLRਢਬeftArrow;憙ightArrow;憘ƀchtਾੀੂòࡌ;憰rok;䅁;扪Ѐacefiosuਗ਼੝੠੷੼અઋ઎p;椅y;䐜Ādl੥੯iumSpace;恟lintrf;愳r;쀀𝔐nusPlus;戓pf;쀀𝕄cò੶;䎜ҀJacefostuણધભીଔଙඑ඗ඞcy;䐊cute;䅃ƀaey઴હાron;䅇dil;䅅;䐝ƀgswે૰଎ativeƀMTV૓૟૨ediumSpace;怋hiĀcn૦૘ë૙eryThiî૙tedĀGL૸ଆreaterGreateòٳessLesóੈLine;䀊r;쀀𝔑ȀBnptଢନଷ଺reak;恠BreakingSpace;䂠f;愕ڀ;CDEGHLNPRSTV୕ୖ୪୼஡௫ఄ౞಄ದ೘ൡඅ櫬Āou୛୤ngruent;扢pCap;扭oubleVerticalBar;戦ƀlqxஃஊ஛ement;戉ualĀ;Tஒஓ扠ilde;쀀≂̸ists;戄reater΀;EFGLSTஶஷ஽௉௓௘௥扯qual;扱ullEqual;쀀≧̸reater;쀀≫̸ess;批lantEqual;쀀⩾̸ilde;扵umpń௲௽ownHump;쀀≎̸qual;쀀≏̸eĀfsఊధtTriangleƀ;BEచఛడ拪ar;쀀⧏̸qual;括s̀;EGLSTవశ఼ౄోౘ扮qual;扰reater;扸ess;쀀≪̸lantEqual;쀀⩽̸ilde;扴estedĀGL౨౹reaterGreater;쀀⪢̸essLess;쀀⪡̸recedesƀ;ESಒಓಛ技qual;쀀⪯̸lantEqual;拠ĀeiಫಹverseElement;戌ghtTriangleƀ;BEೋೌ೒拫ar;쀀⧐̸qual;拭ĀquೝഌuareSuĀbp೨೹setĀ;E೰ೳ쀀⊏̸qual;拢ersetĀ;Eഃആ쀀⊐̸qual;拣ƀbcpഓതൎsetĀ;Eഛഞ쀀⊂⃒qual;抈ceedsȀ;ESTലള഻െ抁qual;쀀⪰̸lantEqual;拡ilde;쀀≿̸ersetĀ;E൘൛쀀⊃⃒qual;抉ildeȀ;EFT൮൯൵ൿ扁qual;扄ullEqual;扇ilde;扉erticalBar;戤cr;쀀𝒩ilde耻Ñ䃑;䎝܀Eacdfgmoprstuvලෂ෉෕ෛ෠෧෼ขภยา฿ไlig;䅒cute耻Ó䃓Āiy෎ීrc耻Ô䃔;䐞blac;䅐r;쀀𝔒rave耻Ò䃒ƀaei෮ෲ෶cr;䅌ga;䎩cron;䎟pf;쀀𝕆enCurlyĀDQฎบoubleQuote;怜uote;怘;橔Āclวฬr;쀀𝒪ash耻Ø䃘iŬื฼de耻Õ䃕es;樷ml耻Ö䃖erĀBP๋๠Āar๐๓r;怾acĀek๚๜;揞et;掴arenthesis;揜Ҁacfhilors๿ງຊຏຒດຝະ໼rtialD;戂y;䐟r;쀀𝔓i;䎦;䎠usMinus;䂱Āipຢອncareplanåڝf;愙Ȁ;eio຺ູ໠໤檻cedesȀ;EST່້໏໚扺qual;檯lantEqual;扼ilde;找me;怳Ādp໩໮uct;戏ortionĀ;aȥ໹l;戝Āci༁༆r;쀀𝒫;䎨ȀUfos༑༖༛༟OT耻"䀢r;쀀𝔔pf;愚cr;쀀𝒬؀BEacefhiorsu༾གྷཇའཱིྦྷྪྭ႖ႩႴႾarr;椐G耻®䂮ƀcnrཎནབute;䅔g;柫rĀ;tཛྷཝ憠l;椖ƀaeyཧཬཱron;䅘dil;䅖;䐠Ā;vླྀཹ愜erseĀEUྂྙĀlq྇ྎement;戋uilibrium;懋pEquilibrium;楯r»ཹo;䎡ghtЀACDFTUVa࿁࿫࿳ဢဨၛႇϘĀnr࿆࿒gleBracket;柩rowƀ;BL࿜࿝࿡憒ar;懥eftArrow;懄eiling;按oǵ࿹\0စbleBracket;柧nǔည\0နeeVector;楝ectorĀ;Bဝသ懂ar;楕loor;挋Āerိ၃eƀ;AVဵံြ抢rrow;憦ector;楛iangleƀ;BEၐၑၕ抳ar;槐qual;抵pƀDTVၣၮၸownVector;楏eeVector;楜ectorĀ;Bႂႃ憾ar;楔ectorĀ;B႑႒懀ar;楓Āpuႛ႞f;愝ndImplies;楰ightarrow;懛ĀchႹႼr;愛;憱leDelayed;槴ڀHOacfhimoqstuფჱჷჽᄙᄞᅑᅖᅡᅧᆵᆻᆿĀCcჩხHcy;䐩y;䐨FTcy;䐬cute;䅚ʀ;aeiyᄈᄉᄎᄓᄗ檼ron;䅠dil;䅞rc;䅜;䐡r;쀀𝔖ortȀDLRUᄪᄴᄾᅉownArrow»ОeftArrow»࢚ightArrow»࿝pArrow;憑gma;䎣allCircle;战pf;쀀𝕊ɲᅭ\0\0ᅰt;戚areȀ;ISUᅻᅼᆉᆯ斡ntersection;抓uĀbpᆏᆞsetĀ;Eᆗᆘ抏qual;抑ersetĀ;Eᆨᆩ抐qual;抒nion;抔cr;쀀𝒮ar;拆ȀbcmpᇈᇛሉላĀ;sᇍᇎ拐etĀ;Eᇍᇕqual;抆ĀchᇠህeedsȀ;ESTᇭᇮᇴᇿ扻qual;檰lantEqual;扽ilde;承Tháྌ;我ƀ;esሒሓሣ拑rsetĀ;Eሜም抃qual;抇et»ሓրHRSacfhiorsሾቄ቉ቕ቞ቱቶኟዂወዑORN耻Þ䃞ADE;愢ĀHc቎ቒcy;䐋y;䐦Ābuቚቜ;䀉;䎤ƀaeyብቪቯron;䅤dil;䅢;䐢r;쀀𝔗Āeiቻ኉ǲኀ\0ኇefore;戴a;䎘Ācn኎ኘkSpace;쀀  Space;怉ldeȀ;EFTካኬኲኼ戼qual;扃ullEqual;扅ilde;扈pf;쀀𝕋ipleDot;惛Āctዖዛr;쀀𝒯rok;䅦ૡዷጎጚጦ\0ጬጱ\0\0\0\0\0ጸጽ፷ᎅ\0᏿ᐄᐊᐐĀcrዻጁute耻Ú䃚rĀ;oጇገ憟cir;楉rǣጓ\0጖y;䐎ve;䅬Āiyጞጣrc耻Û䃛;䐣blac;䅰r;쀀𝔘rave耻Ù䃙acr;䅪Ādiፁ፩erĀBPፈ፝Āarፍፐr;䁟acĀekፗፙ;揟et;掵arenthesis;揝onĀ;P፰፱拃lus;抎Āgp፻፿on;䅲f;쀀𝕌ЀADETadps᎕ᎮᎸᏄϨᏒᏗᏳrrowƀ;BDᅐᎠᎤar;椒ownArrow;懅ownArrow;憕quilibrium;楮eeĀ;AᏋᏌ报rrow;憥ownáϳerĀLRᏞᏨeftArrow;憖ightArrow;憗iĀ;lᏹᏺ䏒on;䎥ing;䅮cr;쀀𝒰ilde;䅨ml耻Ü䃜ҀDbcdefosvᐧᐬᐰᐳᐾᒅᒊᒐᒖash;披ar;櫫y;䐒ashĀ;lᐻᐼ抩;櫦Āerᑃᑅ;拁ƀbtyᑌᑐᑺar;怖Ā;iᑏᑕcalȀBLSTᑡᑥᑪᑴar;戣ine;䁼eparator;杘ilde;所ThinSpace;怊r;쀀𝔙pf;쀀𝕍cr;쀀𝒱dash;抪ʀcefosᒧᒬᒱᒶᒼirc;䅴dge;拀r;쀀𝔚pf;쀀𝕎cr;쀀𝒲Ȁfiosᓋᓐᓒᓘr;쀀𝔛;䎞pf;쀀𝕏cr;쀀𝒳ҀAIUacfosuᓱᓵᓹᓽᔄᔏᔔᔚᔠcy;䐯cy;䐇cy;䐮cute耻Ý䃝Āiyᔉᔍrc;䅶;䐫r;쀀𝔜pf;쀀𝕐cr;쀀𝒴ml;䅸ЀHacdefosᔵᔹᔿᕋᕏᕝᕠᕤcy;䐖cute;䅹Āayᕄᕉron;䅽;䐗ot;䅻ǲᕔ\0ᕛoWidtè૙a;䎖r;愨pf;愤cr;쀀𝒵௡ᖃᖊᖐ\0ᖰᖶᖿ\0\0\0\0ᗆᗛᗫᙟ᙭\0ᚕ᚛ᚲᚹ\0ᚾcute耻á䃡reve;䄃̀;Ediuyᖜᖝᖡᖣᖨᖭ戾;쀀∾̳;房rc耻â䃢te肻´̆;䐰lig耻æ䃦Ā;r²ᖺ;쀀𝔞rave耻à䃠ĀepᗊᗖĀfpᗏᗔsym;愵èᗓha;䎱ĀapᗟcĀclᗤᗧr;䄁g;樿ɤᗰ\0\0ᘊʀ;adsvᗺᗻᗿᘁᘇ戧nd;橕;橜lope;橘;橚΀;elmrszᘘᘙᘛᘞᘿᙏᙙ戠;榤e»ᘙsdĀ;aᘥᘦ戡ѡᘰᘲᘴᘶᘸᘺᘼᘾ;榨;榩;榪;榫;榬;榭;榮;榯tĀ;vᙅᙆ戟bĀ;dᙌᙍ抾;榝Āptᙔᙗh;戢»¹arr;捼Āgpᙣᙧon;䄅f;쀀𝕒΀;Eaeiop዁ᙻᙽᚂᚄᚇᚊ;橰cir;橯;扊d;手s;䀧roxĀ;e዁ᚒñᚃing耻å䃥ƀctyᚡᚦᚨr;쀀𝒶;䀪mpĀ;e዁ᚯñʈilde耻ã䃣ml耻ä䃤Āciᛂᛈoninôɲnt;樑ࠀNabcdefiklnoprsu᛭ᛱᜰ᜼ᝃᝈ᝸᝽០៦ᠹᡐᜍ᤽᥈ᥰot;櫭Ācrᛶ᜞kȀcepsᜀᜅᜍᜓong;扌psilon;䏶rime;怵imĀ;e᜚᜛戽q;拍Ŷᜢᜦee;抽edĀ;gᜬᜭ挅e»ᜭrkĀ;t፜᜷brk;掶Āoyᜁᝁ;䐱quo;怞ʀcmprtᝓ᝛ᝡᝤᝨausĀ;eĊĉptyv;榰séᜌnoõēƀahwᝯ᝱ᝳ;䎲;愶een;扬r;쀀𝔟g΀costuvwឍឝឳេ៕៛៞ƀaiuបពរðݠrc;旯p»፱ƀdptឤឨឭot;樀lus;樁imes;樂ɱឹ\0\0ើcup;樆ar;昅riangleĀdu៍្own;施p;斳plus;樄eåᑄåᒭarow;植ƀako៭ᠦᠵĀcn៲ᠣkƀlst៺֫᠂ozenge;槫riangleȀ;dlr᠒᠓᠘᠝斴own;斾eft;旂ight;斸k;搣Ʊᠫ\0ᠳƲᠯ\0ᠱ;斒;斑4;斓ck;斈ĀeoᠾᡍĀ;qᡃᡆ쀀=⃥uiv;쀀≡⃥t;挐Ȁptwxᡙᡞᡧᡬf;쀀𝕓Ā;tᏋᡣom»Ꮜtie;拈؀DHUVbdhmptuvᢅᢖᢪᢻᣗᣛᣬ᣿ᤅᤊᤐᤡȀLRlrᢎᢐᢒᢔ;敗;敔;敖;敓ʀ;DUduᢡᢢᢤᢦᢨ敐;敦;敩;敤;敧ȀLRlrᢳᢵᢷᢹ;敝;敚;敜;教΀;HLRhlrᣊᣋᣍᣏᣑᣓᣕ救;敬;散;敠;敫;敢;敟ox;槉ȀLRlrᣤᣦᣨᣪ;敕;敒;攐;攌ʀ;DUduڽ᣷᣹᣻᣽;敥;敨;攬;攴inus;抟lus;択imes;抠ȀLRlrᤙᤛᤝ᤟;敛;敘;攘;攔΀;HLRhlrᤰᤱᤳᤵᤷ᤻᤹攂;敪;敡;敞;攼;攤;攜Āevģ᥂bar耻¦䂦Ȁceioᥑᥖᥚᥠr;쀀𝒷mi;恏mĀ;e᜚᜜lƀ;bhᥨᥩᥫ䁜;槅sub;柈Ŭᥴ᥾lĀ;e᥹᥺怢t»᥺pƀ;Eeįᦅᦇ;檮Ā;qۜۛೡᦧ\0᧨ᨑᨕᨲ\0ᨷᩐ\0\0᪴\0\0᫁\0\0ᬡᬮ᭍᭒\0᯽\0ᰌƀcpr᦭ᦲ᧝ute;䄇̀;abcdsᦿᧀᧄ᧊᧕᧙戩nd;橄rcup;橉Āau᧏᧒p;橋p;橇ot;橀;쀀∩︀Āeo᧢᧥t;恁îړȀaeiu᧰᧻ᨁᨅǰ᧵\0᧸s;橍on;䄍dil耻ç䃧rc;䄉psĀ;sᨌᨍ橌m;橐ot;䄋ƀdmnᨛᨠᨦil肻¸ƭptyv;榲t脀¢;eᨭᨮ䂢räƲr;쀀𝔠ƀceiᨽᩀᩍy;䑇ckĀ;mᩇᩈ朓ark»ᩈ;䏇r΀;Ecefms᩟᩠ᩢᩫ᪤᪪᪮旋;槃ƀ;elᩩᩪᩭ䋆q;扗eɡᩴ\0\0᪈rrowĀlr᩼᪁eft;憺ight;憻ʀRSacd᪒᪔᪖᪚᪟»ཇ;擈st;抛irc;抚ash;抝nint;樐id;櫯cir;槂ubsĀ;u᪻᪼晣it»᪼ˬ᫇᫔᫺\0ᬊonĀ;eᫍᫎ䀺Ā;qÇÆɭ᫙\0\0᫢aĀ;t᫞᫟䀬;䁀ƀ;fl᫨᫩᫫戁îᅠeĀmx᫱᫶ent»᫩eóɍǧ᫾\0ᬇĀ;dኻᬂot;橭nôɆƀfryᬐᬔᬗ;쀀𝕔oäɔ脀©;sŕᬝr;愗Āaoᬥᬩrr;憵ss;朗Ācuᬲᬷr;쀀𝒸Ābpᬼ᭄Ā;eᭁᭂ櫏;櫑Ā;eᭉᭊ櫐;櫒dot;拯΀delprvw᭠᭬᭷ᮂᮬᯔ᯹arrĀlr᭨᭪;椸;椵ɰ᭲\0\0᭵r;拞c;拟arrĀ;p᭿ᮀ憶;椽̀;bcdosᮏᮐᮖᮡᮥᮨ截rcap;橈Āauᮛᮞp;橆p;橊ot;抍r;橅;쀀∪︀Ȁalrv᮵ᮿᯞᯣrrĀ;mᮼᮽ憷;椼yƀevwᯇᯔᯘqɰᯎ\0\0ᯒreã᭳uã᭵ee;拎edge;拏en耻¤䂤earrowĀlrᯮ᯳eft»ᮀight»ᮽeäᯝĀciᰁᰇoninôǷnt;戱lcty;挭ঀAHabcdefhijlorstuwz᰸᰻᰿ᱝᱩᱵᲊᲞᲬᲷ᳻᳿ᴍᵻᶑᶫᶻ᷆᷍rò΁ar;楥Ȁglrs᱈ᱍ᱒᱔ger;怠eth;愸òᄳhĀ;vᱚᱛ怐»ऊūᱡᱧarow;椏aã̕Āayᱮᱳron;䄏;䐴ƀ;ao̲ᱼᲄĀgrʿᲁr;懊tseq;橷ƀglmᲑᲔᲘ耻°䂰ta;䎴ptyv;榱ĀirᲣᲨsht;楿;쀀𝔡arĀlrᲳᲵ»ࣜ»သʀaegsv᳂͸᳖᳜᳠mƀ;oș᳊᳔ndĀ;ș᳑uit;晦amma;䏝in;拲ƀ;io᳧᳨᳸䃷de脀÷;o᳧ᳰntimes;拇nø᳷cy;䑒cɯᴆ\0\0ᴊrn;挞op;挍ʀlptuwᴘᴝᴢᵉᵕlar;䀤f;쀀𝕕ʀ;emps̋ᴭᴷᴽᵂqĀ;d͒ᴳot;扑inus;戸lus;戔quare;抡blebarwedgåúnƀadhᄮᵝᵧownarrowóᲃarpoonĀlrᵲᵶefôᲴighôᲶŢᵿᶅkaro÷གɯᶊ\0\0ᶎrn;挟op;挌ƀcotᶘᶣᶦĀryᶝᶡ;쀀𝒹;䑕l;槶rok;䄑Ādrᶰᶴot;拱iĀ;fᶺ᠖斿Āah᷀᷃ròЩaòྦangle;榦Āci᷒ᷕy;䑟grarr;柿ऀDacdefglmnopqrstuxḁḉḙḸոḼṉṡṾấắẽỡἪἷὄ὎὚ĀDoḆᴴoôᲉĀcsḎḔute耻é䃩ter;橮ȀaioyḢḧḱḶron;䄛rĀ;cḭḮ扖耻ê䃪lon;払;䑍ot;䄗ĀDrṁṅot;扒;쀀𝔢ƀ;rsṐṑṗ檚ave耻è䃨Ā;dṜṝ檖ot;檘Ȁ;ilsṪṫṲṴ檙nters;揧;愓Ā;dṹṺ檕ot;檗ƀapsẅẉẗcr;䄓tyƀ;svẒẓẕ戅et»ẓpĀ1;ẝẤĳạả;怄;怅怃ĀgsẪẬ;䅋p;怂ĀgpẴẸon;䄙f;쀀𝕖ƀalsỄỎỒrĀ;sỊị拕l;槣us;橱iƀ;lvỚớở䎵on»ớ;䏵ȀcsuvỪỳἋἣĀioữḱrc»Ḯɩỹ\0\0ỻíՈantĀglἂἆtr»ṝess»Ṻƀaeiἒ἖Ἒls;䀽st;扟vĀ;DȵἠD;橸parsl;槥ĀDaἯἳot;打rr;楱ƀcdiἾὁỸr;愯oô͒ĀahὉὋ;䎷耻ð䃰Āmrὓὗl耻ë䃫o;悬ƀcipὡὤὧl;䀡sôծĀeoὬὴctatioîՙnentialåչৡᾒ\0ᾞ\0ᾡᾧ\0\0ῆῌ\0ΐ\0ῦῪ \0 ⁚llingdotseñṄy;䑄male;晀ƀilrᾭᾳ῁lig;耀ﬃɩᾹ\0\0᾽g;耀ﬀig;耀ﬄ;쀀𝔣lig;耀ﬁlig;쀀fjƀaltῙ῜ῡt;晭ig;耀ﬂns;斱of;䆒ǰ΅\0ῳf;쀀𝕗ĀakֿῷĀ;vῼ´拔;櫙artint;樍Āao‌⁕Ācs‑⁒α‚‰‸⁅⁈\0⁐β•‥‧‪‬\0‮耻½䂽;慓耻¼䂼;慕;慙;慛Ƴ‴\0‶;慔;慖ʴ‾⁁\0\0⁃耻¾䂾;慗;慜5;慘ƶ⁌\0⁎;慚;慝8;慞l;恄wn;挢cr;쀀𝒻ࢀEabcdefgijlnorstv₂₉₟₥₰₴⃰⃵⃺⃿℃ℒℸ̗ℾ⅒↞Ā;lٍ₇;檌ƀcmpₐₕ₝ute;䇵maĀ;dₜ᳚䎳;檆reve;䄟Āiy₪₮rc;䄝;䐳ot;䄡Ȁ;lqsؾق₽⃉ƀ;qsؾٌ⃄lanô٥Ȁ;cdl٥⃒⃥⃕c;檩otĀ;o⃜⃝檀Ā;l⃢⃣檂;檄Ā;e⃪⃭쀀⋛︀s;檔r;쀀𝔤Ā;gٳ؛mel;愷cy;䑓Ȁ;Eajٚℌℎℐ;檒;檥;檤ȀEaesℛℝ℩ℴ;扩pĀ;p℣ℤ檊rox»ℤĀ;q℮ℯ檈Ā;q℮ℛim;拧pf;쀀𝕘Āci⅃ⅆr;愊mƀ;el٫ⅎ⅐;檎;檐茀>;cdlqr׮ⅠⅪⅮⅳⅹĀciⅥⅧ;檧r;橺ot;拗Par;榕uest;橼ʀadelsↄⅪ←ٖ↛ǰ↉\0↎proø₞r;楸qĀlqؿ↖lesó₈ií٫Āen↣↭rtneqq;쀀≩︀Å↪ԀAabcefkosy⇄⇇⇱⇵⇺∘∝∯≨≽ròΠȀilmr⇐⇔⇗⇛rsðᒄf»․ilôکĀdr⇠⇤cy;䑊ƀ;cwࣴ⇫⇯ir;楈;憭ar;意irc;䄥ƀalr∁∎∓rtsĀ;u∉∊晥it»∊lip;怦con;抹r;쀀𝔥sĀew∣∩arow;椥arow;椦ʀamopr∺∾≃≞≣rr;懿tht;戻kĀlr≉≓eftarrow;憩ightarrow;憪f;쀀𝕙bar;怕ƀclt≯≴≸r;쀀𝒽asè⇴rok;䄧Ābp⊂⊇ull;恃hen»ᱛૡ⊣\0⊪\0⊸⋅⋎\0⋕⋳\0\0⋸⌢⍧⍢⍿\0⎆⎪⎴cute耻í䃭ƀ;iyݱ⊰⊵rc耻î䃮;䐸Ācx⊼⊿y;䐵cl耻¡䂡ĀfrΟ⋉;쀀𝔦rave耻ì䃬Ȁ;inoܾ⋝⋩⋮Āin⋢⋦nt;樌t;戭fin;槜ta;愩lig;䄳ƀaop⋾⌚⌝ƀcgt⌅⌈⌗r;䄫ƀelpܟ⌏⌓inåގarôܠh;䄱f;抷ed;䆵ʀ;cfotӴ⌬⌱⌽⍁are;愅inĀ;t⌸⌹戞ie;槝doô⌙ʀ;celpݗ⍌⍐⍛⍡al;抺Āgr⍕⍙eróᕣã⍍arhk;樗rod;樼Ȁcgpt⍯⍲⍶⍻y;䑑on;䄯f;쀀𝕚a;䎹uest耻¿䂿Āci⎊⎏r;쀀𝒾nʀ;EdsvӴ⎛⎝⎡ӳ;拹ot;拵Ā;v⎦⎧拴;拳Ā;iݷ⎮lde;䄩ǫ⎸\0⎼cy;䑖l耻ï䃯̀cfmosu⏌⏗⏜⏡⏧⏵Āiy⏑⏕rc;䄵;䐹r;쀀𝔧ath;䈷pf;쀀𝕛ǣ⏬\0⏱r;쀀𝒿rcy;䑘kcy;䑔Ѐacfghjos␋␖␢␧␭␱␵␻ppaĀ;v␓␔䎺;䏰Āey␛␠dil;䄷;䐺r;쀀𝔨reen;䄸cy;䑅cy;䑜pf;쀀𝕜cr;쀀𝓀஀ABEHabcdefghjlmnoprstuv⑰⒁⒆⒍⒑┎┽╚▀♎♞♥♹♽⚚⚲⛘❝❨➋⟀⠁⠒ƀart⑷⑺⑼rò৆òΕail;椛arr;椎Ā;gঔ⒋;檋ar;楢ॣ⒥\0⒪\0⒱\0\0\0\0\0⒵Ⓔ\0ⓆⓈⓍ\0⓹ute;䄺mptyv;榴raîࡌbda;䎻gƀ;dlࢎⓁⓃ;榑åࢎ;檅uo耻«䂫rЀ;bfhlpst࢙ⓞⓦⓩ⓫⓮⓱⓵Ā;f࢝ⓣs;椟s;椝ë≒p;憫l;椹im;楳l;憢ƀ;ae⓿─┄檫il;椙Ā;s┉┊檭;쀀⪭︀ƀabr┕┙┝rr;椌rk;杲Āak┢┬cĀek┨┪;䁻;䁛Āes┱┳;榋lĀdu┹┻;榏;榍Ȁaeuy╆╋╖╘ron;䄾Ādi═╔il;䄼ìࢰâ┩;䐻Ȁcqrs╣╦╭╽a;椶uoĀ;rนᝆĀdu╲╷har;楧shar;楋h;憲ʀ;fgqs▋▌উ◳◿扤tʀahlrt▘▤▷◂◨rrowĀ;t࢙□aé⓶arpoonĀdu▯▴own»њp»०eftarrows;懇ightƀahs◍◖◞rrowĀ;sࣴࢧarpoonó྘quigarro÷⇰hreetimes;拋ƀ;qs▋ও◺lanôবʀ;cdgsব☊☍☝☨c;檨otĀ;o☔☕橿Ā;r☚☛檁;檃Ā;e☢☥쀀⋚︀s;檓ʀadegs☳☹☽♉♋pproøⓆot;拖qĀgq♃♅ôউgtò⒌ôছiíলƀilr♕࣡♚sht;楼;쀀𝔩Ā;Eজ♣;檑š♩♶rĀdu▲♮Ā;l॥♳;楪lk;斄cy;䑙ʀ;achtੈ⚈⚋⚑⚖rò◁orneòᴈard;楫ri;旺Āio⚟⚤dot;䅀ustĀ;a⚬⚭掰che»⚭ȀEaes⚻⚽⛉⛔;扨pĀ;p⛃⛄檉rox»⛄Ā;q⛎⛏檇Ā;q⛎⚻im;拦Ѐabnoptwz⛩⛴⛷✚✯❁❇❐Ānr⛮⛱g;柬r;懽rëࣁgƀlmr⛿✍✔eftĀar০✇ightá৲apsto;柼ightá৽parrowĀlr✥✩efô⓭ight;憬ƀafl✶✹✽r;榅;쀀𝕝us;樭imes;樴š❋❏st;戗áፎƀ;ef❗❘᠀旊nge»❘arĀ;l❤❥䀨t;榓ʀachmt❳❶❼➅➇ròࢨorneòᶌarĀ;d྘➃;業;怎ri;抿̀achiqt➘➝ੀ➢➮➻quo;怹r;쀀𝓁mƀ;egল➪➬;檍;檏Ābu┪➳oĀ;rฟ➹;怚rok;䅂萀<;cdhilqrࠫ⟒☹⟜⟠⟥⟪⟰Āci⟗⟙;檦r;橹reå◲mes;拉arr;楶uest;橻ĀPi⟵⟹ar;榖ƀ;ef⠀भ᠛旃rĀdu⠇⠍shar;楊har;楦Āen⠗⠡rtneqq;쀀≨︀Å⠞܀Dacdefhilnopsu⡀⡅⢂⢎⢓⢠⢥⢨⣚⣢⣤ઃ⣳⤂Dot;戺Ȁclpr⡎⡒⡣⡽r耻¯䂯Āet⡗⡙;時Ā;e⡞⡟朠se»⡟Ā;sျ⡨toȀ;dluျ⡳⡷⡻owîҌefôएðᏑker;斮Āoy⢇⢌mma;権;䐼ash;怔asuredangle»ᘦr;쀀𝔪o;愧ƀcdn⢯⢴⣉ro耻µ䂵Ȁ;acdᑤ⢽⣀⣄sôᚧir;櫰ot肻·Ƶusƀ;bd⣒ᤃ⣓戒Ā;uᴼ⣘;横ţ⣞⣡p;櫛ò−ðઁĀdp⣩⣮els;抧f;쀀𝕞Āct⣸⣽r;쀀𝓂pos»ᖝƀ;lm⤉⤊⤍䎼timap;抸ఀGLRVabcdefghijlmoprstuvw⥂⥓⥾⦉⦘⧚⧩⨕⨚⩘⩝⪃⪕⪤⪨⬄⬇⭄⭿⮮ⰴⱧⱼ⳩Āgt⥇⥋;쀀⋙̸Ā;v⥐௏쀀≫⃒ƀelt⥚⥲⥶ftĀar⥡⥧rrow;懍ightarrow;懎;쀀⋘̸Ā;v⥻ే쀀≪⃒ightarrow;懏ĀDd⦎⦓ash;抯ash;抮ʀbcnpt⦣⦧⦬⦱⧌la»˞ute;䅄g;쀀∠⃒ʀ;Eiop඄⦼⧀⧅⧈;쀀⩰̸d;쀀≋̸s;䅉roø඄urĀ;a⧓⧔普lĀ;s⧓ସǳ⧟\0⧣p肻 ଷmpĀ;e௹ఀʀaeouy⧴⧾⨃⨐⨓ǰ⧹\0⧻;橃on;䅈dil;䅆ngĀ;dൾ⨊ot;쀀⩭̸p;橂;䐽ash;怓΀;Aadqsxஒ⨩⨭⨻⩁⩅⩐rr;懗rĀhr⨳⨶k;椤Ā;oᏲᏰot;쀀≐̸uiöୣĀei⩊⩎ar;椨í஘istĀ;s஠டr;쀀𝔫ȀEest௅⩦⩹⩼ƀ;qs஼⩭௡ƀ;qs஼௅⩴lanô௢ií௪Ā;rஶ⪁»ஷƀAap⪊⪍⪑rò⥱rr;憮ar;櫲ƀ;svྍ⪜ྌĀ;d⪡⪢拼;拺cy;䑚΀AEadest⪷⪺⪾⫂⫅⫶⫹rò⥦;쀀≦̸rr;憚r;急Ȁ;fqs఻⫎⫣⫯tĀar⫔⫙rro÷⫁ightarro÷⪐ƀ;qs఻⪺⫪lanôౕĀ;sౕ⫴»శiíౝĀ;rవ⫾iĀ;eచథiäඐĀpt⬌⬑f;쀀𝕟膀¬;in⬙⬚⬶䂬nȀ;Edvஉ⬤⬨⬮;쀀⋹̸ot;쀀⋵̸ǡஉ⬳⬵;拷;拶iĀ;vಸ⬼ǡಸ⭁⭃;拾;拽ƀaor⭋⭣⭩rȀ;ast୻⭕⭚⭟lleì୻l;쀀⫽⃥;쀀∂̸lint;樔ƀ;ceಒ⭰⭳uåಥĀ;cಘ⭸Ā;eಒ⭽ñಘȀAait⮈⮋⮝⮧rò⦈rrƀ;cw⮔⮕⮙憛;쀀⤳̸;쀀↝̸ghtarrow»⮕riĀ;eೋೖ΀chimpqu⮽⯍⯙⬄୸⯤⯯Ȁ;cerല⯆ഷ⯉uå൅;쀀𝓃ortɭ⬅\0\0⯖ará⭖mĀ;e൮⯟Ā;q൴൳suĀbp⯫⯭å೸åഋƀbcp⯶ⰑⰙȀ;Ees⯿ⰀഢⰄ抄;쀀⫅̸etĀ;eഛⰋqĀ;qണⰀcĀ;eലⰗñസȀ;EesⰢⰣൟⰧ抅;쀀⫆̸etĀ;e൘ⰮqĀ;qൠⰣȀgilrⰽⰿⱅⱇìௗlde耻ñ䃱çృiangleĀlrⱒⱜeftĀ;eచⱚñదightĀ;eೋⱥñ೗Ā;mⱬⱭ䎽ƀ;esⱴⱵⱹ䀣ro;愖p;怇ҀDHadgilrsⲏⲔⲙⲞⲣⲰⲶⳓⳣash;抭arr;椄p;쀀≍⃒ash;抬ĀetⲨⲬ;쀀≥⃒;쀀>⃒nfin;槞ƀAetⲽⳁⳅrr;椂;쀀≤⃒Ā;rⳊⳍ쀀<⃒ie;쀀⊴⃒ĀAtⳘⳜrr;椃rie;쀀⊵⃒im;쀀∼⃒ƀAan⳰⳴ⴂrr;懖rĀhr⳺⳽k;椣Ā;oᏧᏥear;椧ቓ᪕\0\0\0\0\0\0\0\0\0\0\0\0\0ⴭ\0ⴸⵈⵠⵥ⵲ⶄᬇ\0\0ⶍⶫ\0ⷈⷎ\0ⷜ⸙⸫⸾⹃Ācsⴱ᪗ute耻ó䃳ĀiyⴼⵅrĀ;c᪞ⵂ耻ô䃴;䐾ʀabios᪠ⵒⵗǈⵚlac;䅑v;樸old;榼lig;䅓Ācr⵩⵭ir;榿;쀀𝔬ͯ⵹\0\0⵼\0ⶂn;䋛ave耻ò䃲;槁Ābmⶈ෴ar;榵Ȁacitⶕ⶘ⶥⶨrò᪀Āir⶝ⶠr;榾oss;榻nå๒;槀ƀaeiⶱⶵⶹcr;䅍ga;䏉ƀcdnⷀⷅǍron;䎿;榶pf;쀀𝕠ƀaelⷔ⷗ǒr;榷rp;榹΀;adiosvⷪⷫⷮ⸈⸍⸐⸖戨rò᪆Ȁ;efmⷷⷸ⸂⸅橝rĀ;oⷾⷿ愴f»ⷿ耻ª䂪耻º䂺gof;抶r;橖lope;橗;橛ƀclo⸟⸡⸧ò⸁ash耻ø䃸l;折iŬⸯ⸴de耻õ䃵esĀ;aǛ⸺s;樶ml耻ö䃶bar;挽ૡ⹞\0⹽\0⺀⺝\0⺢⺹\0\0⻋ຜ\0⼓\0\0⼫⾼\0⿈rȀ;astЃ⹧⹲຅脀¶;l⹭⹮䂶leìЃɩ⹸\0\0⹻m;櫳;櫽y;䐿rʀcimpt⺋⺏⺓ᡥ⺗nt;䀥od;䀮il;怰enk;怱r;쀀𝔭ƀimo⺨⺰⺴Ā;v⺭⺮䏆;䏕maô੶ne;明ƀ;tv⺿⻀⻈䏀chfork»´;䏖Āau⻏⻟nĀck⻕⻝kĀ;h⇴⻛;愎ö⇴sҀ;abcdemst⻳⻴ᤈ⻹⻽⼄⼆⼊⼎䀫cir;樣ir;樢Āouᵀ⼂;樥;橲n肻±ຝim;樦wo;樧ƀipu⼙⼠⼥ntint;樕f;쀀𝕡nd耻£䂣Ԁ;Eaceinosu່⼿⽁⽄⽇⾁⾉⾒⽾⾶;檳p;檷uå໙Ā;c໎⽌̀;acens່⽙⽟⽦⽨⽾pproø⽃urlyeñ໙ñ໎ƀaes⽯⽶⽺pprox;檹qq;檵im;拨iíໟmeĀ;s⾈ຮ怲ƀEas⽸⾐⽺ð⽵ƀdfp໬⾙⾯ƀals⾠⾥⾪lar;挮ine;挒urf;挓Ā;t໻⾴ï໻rel;抰Āci⿀⿅r;쀀𝓅;䏈ncsp;怈̀fiopsu⿚⋢⿟⿥⿫⿱r;쀀𝔮pf;쀀𝕢rime;恗cr;쀀𝓆ƀaeo⿸〉〓tĀei⿾々rnionóڰnt;樖stĀ;e【】䀿ñἙô༔઀ABHabcdefhilmnoprstux぀けさすムㄎㄫㅇㅢㅲㆎ㈆㈕㈤㈩㉘㉮㉲㊐㊰㊷ƀartぇおがròႳòϝail;検aròᱥar;楤΀cdenqrtとふへみわゔヌĀeuねぱ;쀀∽̱te;䅕iãᅮmptyv;榳gȀ;del࿑らるろ;榒;榥å࿑uo耻»䂻rր;abcfhlpstw࿜ガクシスゼゾダッデナp;極Ā;f࿠ゴs;椠;椳s;椞ë≝ð✮l;楅im;楴l;憣;憝Āaiパフil;椚oĀ;nホボ戶aló༞ƀabrョリヮrò៥rk;杳ĀakンヽcĀekヹ・;䁽;䁝Āes㄂㄄;榌lĀduㄊㄌ;榎;榐Ȁaeuyㄗㄜㄧㄩron;䅙Ādiㄡㄥil;䅗ì࿲âヺ;䑀Ȁclqsㄴㄷㄽㅄa;椷dhar;楩uoĀ;rȎȍh;憳ƀacgㅎㅟངlȀ;ipsླྀㅘㅛႜnåႻarôྩt;断ƀilrㅩဣㅮsht;楽;쀀𝔯ĀaoㅷㆆrĀduㅽㅿ»ѻĀ;l႑ㆄ;楬Ā;vㆋㆌ䏁;䏱ƀgns㆕ㇹㇼht̀ahlrstㆤㆰ㇂㇘㇤㇮rrowĀ;t࿜ㆭaéトarpoonĀduㆻㆿowîㅾp»႒eftĀah㇊㇐rrowó࿪arpoonóՑightarrows;應quigarro÷ニhreetimes;拌g;䋚ingdotseñἲƀahm㈍㈐㈓rò࿪aòՑ;怏oustĀ;a㈞㈟掱che»㈟mid;櫮Ȁabpt㈲㈽㉀㉒Ānr㈷㈺g;柭r;懾rëဃƀafl㉇㉊㉎r;榆;쀀𝕣us;樮imes;樵Āap㉝㉧rĀ;g㉣㉤䀩t;榔olint;樒arò㇣Ȁachq㉻㊀Ⴜ㊅quo;怺r;쀀𝓇Ābu・㊊oĀ;rȔȓƀhir㊗㊛㊠reåㇸmes;拊iȀ;efl㊪ၙᠡ㊫方tri;槎luhar;楨;愞ൡ㋕㋛㋟㌬㌸㍱\0㍺㎤\0\0㏬㏰\0㐨㑈㑚㒭㒱㓊㓱\0㘖\0\0㘳cute;䅛quï➺Ԁ;Eaceinpsyᇭ㋳㋵㋿㌂㌋㌏㌟㌦㌩;檴ǰ㋺\0㋼;檸on;䅡uåᇾĀ;dᇳ㌇il;䅟rc;䅝ƀEas㌖㌘㌛;檶p;檺im;择olint;樓iíሄ;䑁otƀ;be㌴ᵇ㌵担;橦΀Aacmstx㍆㍊㍗㍛㍞㍣㍭rr;懘rĀhr㍐㍒ë∨Ā;oਸ਼਴t耻§䂧i;䀻war;椩mĀin㍩ðnuóñt;朶rĀ;o㍶⁕쀀𝔰Ȁacoy㎂㎆㎑㎠rp;景Āhy㎋㎏cy;䑉;䑈rtɭ㎙\0\0㎜iäᑤaraì⹯耻­䂭Āgm㎨㎴maƀ;fv㎱㎲㎲䏃;䏂Ѐ;deglnprካ㏅㏉㏎㏖㏞㏡㏦ot;橪Ā;q኱ኰĀ;E㏓㏔檞;檠Ā;E㏛㏜檝;檟e;扆lus;樤arr;楲aròᄽȀaeit㏸㐈㐏㐗Āls㏽㐄lsetmé㍪hp;樳parsl;槤Ādlᑣ㐔e;挣Ā;e㐜㐝檪Ā;s㐢㐣檬;쀀⪬︀ƀflp㐮㐳㑂tcy;䑌Ā;b㐸㐹䀯Ā;a㐾㐿槄r;挿f;쀀𝕤aĀdr㑍ЂesĀ;u㑔㑕晠it»㑕ƀcsu㑠㑹㒟Āau㑥㑯pĀ;sᆈ㑫;쀀⊓︀pĀ;sᆴ㑵;쀀⊔︀uĀbp㑿㒏ƀ;esᆗᆜ㒆etĀ;eᆗ㒍ñᆝƀ;esᆨᆭ㒖etĀ;eᆨ㒝ñᆮƀ;afᅻ㒦ְrť㒫ֱ»ᅼaròᅈȀcemt㒹㒾㓂㓅r;쀀𝓈tmîñiì㐕aræᆾĀar㓎㓕rĀ;f㓔ឿ昆Āan㓚㓭ightĀep㓣㓪psiloîỠhé⺯s»⡒ʀbcmnp㓻㕞ሉ㖋㖎Ҁ;Edemnprs㔎㔏㔑㔕㔞㔣㔬㔱㔶抂;櫅ot;檽Ā;dᇚ㔚ot;櫃ult;櫁ĀEe㔨㔪;櫋;把lus;檿arr;楹ƀeiu㔽㕒㕕tƀ;en㔎㕅㕋qĀ;qᇚ㔏eqĀ;q㔫㔨m;櫇Ābp㕚㕜;櫕;櫓c̀;acensᇭ㕬㕲㕹㕻㌦pproø㋺urlyeñᇾñᇳƀaes㖂㖈㌛pproø㌚qñ㌗g;晪ڀ123;Edehlmnps㖩㖬㖯ሜ㖲㖴㗀㗉㗕㗚㗟㗨㗭耻¹䂹耻²䂲耻³䂳;櫆Āos㖹㖼t;檾ub;櫘Ā;dሢ㗅ot;櫄sĀou㗏㗒l;柉b;櫗arr;楻ult;櫂ĀEe㗤㗦;櫌;抋lus;櫀ƀeiu㗴㘉㘌tƀ;enሜ㗼㘂qĀ;qሢ㖲eqĀ;q㗧㗤m;櫈Ābp㘑㘓;櫔;櫖ƀAan㘜㘠㘭rr;懙rĀhr㘦㘨ë∮Ā;oਫ਩war;椪lig耻ß䃟௡㙑㙝㙠ዎ㙳㙹\0㙾㛂\0\0\0\0\0㛛㜃\0㜉㝬\0\0\0㞇ɲ㙖\0\0㙛get;挖;䏄rë๟ƀaey㙦㙫㙰ron;䅥dil;䅣;䑂lrec;挕r;쀀𝔱Ȁeiko㚆㚝㚵㚼ǲ㚋\0㚑eĀ4fኄኁaƀ;sv㚘㚙㚛䎸ym;䏑Ācn㚢㚲kĀas㚨㚮pproø዁im»ኬsðኞĀas㚺㚮ð዁rn耻þ䃾Ǭ̟㛆⋧es膀×;bd㛏㛐㛘䃗Ā;aᤏ㛕r;樱;樰ƀeps㛡㛣㜀á⩍Ȁ;bcf҆㛬㛰㛴ot;挶ir;櫱Ā;o㛹㛼쀀𝕥rk;櫚á㍢rime;怴ƀaip㜏㜒㝤dåቈ΀adempst㜡㝍㝀㝑㝗㝜㝟ngleʀ;dlqr㜰㜱㜶㝀㝂斵own»ᶻeftĀ;e⠀㜾ñम;扜ightĀ;e㊪㝋ñၚot;旬inus;樺lus;樹b;槍ime;樻ezium;揢ƀcht㝲㝽㞁Āry㝷㝻;쀀𝓉;䑆cy;䑛rok;䅧Āio㞋㞎xô᝷headĀlr㞗㞠eftarro÷ࡏightarrow»ཝऀAHabcdfghlmoprstuw㟐㟓㟗㟤㟰㟼㠎㠜㠣㠴㡑㡝㡫㢩㣌㣒㣪㣶ròϭar;楣Ācr㟜㟢ute耻ú䃺òᅐrǣ㟪\0㟭y;䑞ve;䅭Āiy㟵㟺rc耻û䃻;䑃ƀabh㠃㠆㠋ròᎭlac;䅱aòᏃĀir㠓㠘sht;楾;쀀𝔲rave耻ù䃹š㠧㠱rĀlr㠬㠮»ॗ»ႃlk;斀Āct㠹㡍ɯ㠿\0\0㡊rnĀ;e㡅㡆挜r»㡆op;挏ri;旸Āal㡖㡚cr;䅫肻¨͉Āgp㡢㡦on;䅳f;쀀𝕦̀adhlsuᅋ㡸㡽፲㢑㢠ownáᎳarpoonĀlr㢈㢌efô㠭ighô㠯iƀ;hl㢙㢚㢜䏅»ᏺon»㢚parrows;懈ƀcit㢰㣄㣈ɯ㢶\0\0㣁rnĀ;e㢼㢽挝r»㢽op;挎ng;䅯ri;旹cr;쀀𝓊ƀdir㣙㣝㣢ot;拰lde;䅩iĀ;f㜰㣨»᠓Āam㣯㣲rò㢨l耻ü䃼angle;榧ހABDacdeflnoprsz㤜㤟㤩㤭㦵㦸㦽㧟㧤㧨㧳㧹㧽㨁㨠ròϷarĀ;v㤦㤧櫨;櫩asèϡĀnr㤲㤷grt;榜΀eknprst㓣㥆㥋㥒㥝㥤㦖appá␕othinçẖƀhir㓫⻈㥙opô⾵Ā;hᎷ㥢ïㆍĀiu㥩㥭gmá㎳Ābp㥲㦄setneqĀ;q㥽㦀쀀⊊︀;쀀⫋︀setneqĀ;q㦏㦒쀀⊋︀;쀀⫌︀Āhr㦛㦟etá㚜iangleĀlr㦪㦯eft»थight»ၑy;䐲ash»ံƀelr㧄㧒㧗ƀ;beⷪ㧋㧏ar;抻q;扚lip;拮Ābt㧜ᑨaòᑩr;쀀𝔳tré㦮suĀbp㧯㧱»ജ»൙pf;쀀𝕧roð໻tré㦴Ācu㨆㨋r;쀀𝓋Ābp㨐㨘nĀEe㦀㨖»㥾nĀEe㦒㨞»㦐igzag;榚΀cefoprs㨶㨻㩖㩛㩔㩡㩪irc;䅵Ādi㩀㩑Ābg㩅㩉ar;機eĀ;qᗺ㩏;扙erp;愘r;쀀𝔴pf;쀀𝕨Ā;eᑹ㩦atèᑹcr;쀀𝓌ૣណ㪇\0㪋\0㪐㪛\0\0㪝㪨㪫㪯\0\0㫃㫎\0㫘ៜ៟tré៑r;쀀𝔵ĀAa㪔㪗ròσrò৶;䎾ĀAa㪡㪤ròθrò৫að✓is;拻ƀdptឤ㪵㪾Āfl㪺ឩ;쀀𝕩imåឲĀAa㫇㫊ròώròਁĀcq㫒ីr;쀀𝓍Āpt៖㫜ré។Ѐacefiosu㫰㫽㬈㬌㬑㬕㬛㬡cĀuy㫶㫻te耻ý䃽;䑏Āiy㬂㬆rc;䅷;䑋n耻¥䂥r;쀀𝔶cy;䑗pf;쀀𝕪cr;쀀𝓎Ācm㬦㬩y;䑎l耻ÿ䃿Ԁacdefhiosw㭂㭈㭔㭘㭤㭩㭭㭴㭺㮀cute;䅺Āay㭍㭒ron;䅾;䐷ot;䅼Āet㭝㭡træᕟa;䎶r;쀀𝔷cy;䐶grarr;懝pf;쀀𝕫cr;쀀𝓏Ājn㮅㮇;怍j;怌'.split("").map(r=>r.charCodeAt(0))),$x=new Uint16Array("Ȁaglq	\x1Bɭ\0\0p;䀦os;䀧t;䀾t;䀼uot;䀢".split("").map(r=>r.charCodeAt(0)));var qg;const vx=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),w2=(qg=String.fromCodePoint)!==null&&qg!==void 0?qg:function(r){let e="";return r>65535&&(r-=65536,e+=String.fromCharCode(r>>>10&1023|55296),r=56320|r&1023),e+=String.fromCharCode(r),e};function yx(r){var e;return r>=55296&&r<=57343||r>1114111?65533:(e=vx.get(r))!==null&&e!==void 0?e:r}var R2;(function(r){r[r.NUM=35]="NUM",r[r.SEMI=59]="SEMI",r[r.ZERO=48]="ZERO",r[r.NINE=57]="NINE",r[r.LOWER_A=97]="LOWER_A",r[r.LOWER_F=102]="LOWER_F",r[r.LOWER_X=120]="LOWER_X",r[r.To_LOWER_BIT=32]="To_LOWER_BIT"})(R2||(R2={}));var to;(function(r){r[r.VALUE_LENGTH=49152]="VALUE_LENGTH",r[r.BRANCH_LENGTH=16256]="BRANCH_LENGTH",r[r.JUMP_TABLE=127]="JUMP_TABLE"})(to||(to={}));function nA(r,e,i,s){const n=(e&to.BRANCH_LENGTH)>>7,l=e&to.JUMP_TABLE;if(n===0)return l!==0&&s===l?i:-1;if(l){const h=s-l;return h<0||h>=n?-1:r[i+h]-1}let u=i,c=u+n-1;for(;u<=c;){const h=u+c>>>1,f=r[h];if(f<s)u=h+1;else if(f>s)c=h-1;else return r[h+n]}return-1}const N2=/["&'<>$\x80-\uFFFF]/g,Sx=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),Ix=String.prototype.codePointAt!=null?(r,e)=>r.codePointAt(e):(r,e)=>(r.charCodeAt(e)&64512)===55296?(r.charCodeAt(e)-55296)*1024+r.charCodeAt(e+1)-56320+65536:r.charCodeAt(e);function oA(r){let e="",i=0,s;for(;(s=N2.exec(r))!==null;){const n=s.index,l=r.charCodeAt(n),u=Sx.get(l);u!==void 0?(e+=r.substring(i,n)+u,i=n+1):(e+=`${r.substring(i,n)}&#x${Ix(r,n).toString(16)};`,i=N2.lastIndex+=Number((l&64512)===55296))}return e+r.substr(i)}function lA(r,e){return function(s){let n,l=0,u="";for(;n=r.exec(s);)l!==n.index&&(u+=s.substring(l,n.index)),u+=e.get(n[0].charCodeAt(0)),l=n.index+1;return u+s.substring(l)}}const aA=lA(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),uA=lA(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),kx=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(r=>[r.toLowerCase(),r])),Ax=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(r=>[r.toLowerCase(),r])),Cx=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function Ox(r){return r.replace(/"/g,"&quot;")}function wx(r,e){var i;if(!r)return;const s=((i=e.encodeEntities)!==null&&i!==void 0?i:e.decodeEntities)===!1?Ox:e.xmlMode||e.encodeEntities!=="utf8"?oA:aA;return Object.keys(r).map(n=>{var l,u;const c=(l=r[n])!==null&&l!==void 0?l:"";return e.xmlMode==="foreign"&&(n=(u=Ax.get(n))!==null&&u!==void 0?u:n),!e.emptyAttrs&&!e.xmlMode&&c===""?n:`${n}="${s(c)}"`}).join(" ")}const x2=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function Mf(r,e={}){const i="length"in r?r:[r];let s="";for(let n=0;n<i.length;n++)s+=Rx(i[n],e);return s}function Rx(r,e){switch(r.type){case hx:return Mf(r.children,e);case Tx:case fx:return Lx(r);case px:return Px(r);case bx:return Bx(r);case mx:case gx:case _x:return Dx(r,e);case dx:return Mx(r,e)}}const Nx=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),xx=new Set(["svg","math"]);function Dx(r,e){var i;e.xmlMode==="foreign"&&(r.name=(i=kx.get(r.name))!==null&&i!==void 0?i:r.name,r.parent&&Nx.has(r.parent.name)&&(e={...e,xmlMode:!1})),!e.xmlMode&&xx.has(r.name)&&(e={...e,xmlMode:"foreign"});let s=`<${r.name}`;const n=wx(r.attribs,e);return n&&(s+=` ${n}`),r.children.length===0&&(e.xmlMode?e.selfClosingTags!==!1:e.selfClosingTags&&x2.has(r.name))?(e.xmlMode||(s+=" "),s+="/>"):(s+=">",r.children.length>0&&(s+=Mf(r.children,e)),(e.xmlMode||!x2.has(r.name))&&(s+=`</${r.name}>`)),s}function Lx(r){return`<${r.data}>`}function Mx(r,e){var i;let s=r.data||"";return((i=e.encodeEntities)!==null&&i!==void 0?i:e.decodeEntities)!==!1&&!(!e.xmlMode&&r.parent&&Cx.has(r.parent.name))&&(s=e.xmlMode||e.encodeEntities!=="utf8"?oA(s):uA(s)),s}function Bx(r){return`<![CDATA[${r.children[0].data}]]>`}function Px(r){return`<!--${r.data}-->`}function cA(r,e){return Mf(r,e)}function Fx(r,e){return qi(r)?r.children.map(i=>cA(i,e)).join(""):""}function _0(r){return Array.isArray(r)?r.map(_0).join(""):et(r)?r.name==="br"?`
`:_0(r.children):Df(r)?_0(r.children):Sn(r)?r.data:""}function Qa(r){return Array.isArray(r)?r.map(Qa).join(""):qi(r)&&!Lf(r)?Qa(r.children):Sn(r)?r.data:""}function x0(r){return Array.isArray(r)?r.map(x0).join(""):qi(r)&&(r.type===Pt.Tag||Df(r))?x0(r.children):Sn(r)?r.data:""}function Bf(r){return qi(r)?r.children:[]}function hA(r){return r.parent||null}function dA(r){const e=hA(r);if(e!=null)return Bf(e);const i=[r];let{prev:s,next:n}=r;for(;s!=null;)i.unshift(s),{prev:s}=s;for(;n!=null;)i.push(n),{next:n}=n;return i}function Ux(r,e){var i;return(i=r.attribs)===null||i===void 0?void 0:i[e]}function Hx(r,e){return r.attribs!=null&&Object.prototype.hasOwnProperty.call(r.attribs,e)&&r.attribs[e]!=null}function Gx(r){return r.name}function _b(r){let{next:e}=r;for(;e!==null&&!et(e);)({next:e}=e);return e}function bb(r){let{prev:e}=r;for(;e!==null&&!et(e);)({prev:e}=e);return e}function zl(r){if(r.prev&&(r.prev.next=r.next),r.next&&(r.next.prev=r.prev),r.parent){const e=r.parent.children;e.splice(e.lastIndexOf(r),1)}}function Vx(r,e){const i=e.prev=r.prev;i&&(i.next=e);const s=e.next=r.next;s&&(s.prev=e);const n=e.parent=r.parent;if(n){const l=n.children;l[l.lastIndexOf(r)]=e,r.parent=null}}function Wx(r,e){if(zl(e),e.next=null,e.parent=r,r.children.push(e)>1){const i=r.children[r.children.length-2];i.next=e,e.prev=i}else e.prev=null}function zx(r,e){zl(e);const{parent:i}=r,s=r.next;if(e.next=s,e.prev=r,r.next=e,e.parent=i,s){if(s.prev=e,i){const n=i.children;n.splice(n.lastIndexOf(s),0,e)}}else i&&i.children.push(e)}function Yx(r,e){if(zl(e),e.parent=r,e.prev=null,r.children.unshift(e)!==1){const i=r.children[1];i.prev=e,e.next=i}else e.next=null}function Xx(r,e){zl(e);const{parent:i}=r;if(i){const s=i.children;s.splice(s.indexOf(r),0,e)}r.prev&&(r.prev.next=e),e.parent=i,e.prev=r.prev,e.next=r,r.prev=e}function Pf(r,e,i=!0,s=1/0){return Array.isArray(e)||(e=[e]),Ff(r,e,i,s)}function Ff(r,e,i,s){const n=[];for(const l of e){if(r(l)&&(n.push(l),--s<=0))break;if(i&&qi(l)&&l.children.length>0){const u=Ff(r,l.children,i,s);if(n.push(...u),s-=u.length,s<=0)break}}return n}function jx(r,e){return e.find(r)}function Tb(r,e,i=!0){let s=null;for(let n=0;n<e.length&&!s;n++){const l=e[n];if(et(l))r(l)?s=l:i&&l.children.length>0&&(s=Tb(r,l.children,!0));else continue}return s}function fA(r,e){return e.some(i=>et(i)&&(r(i)||i.children.length>0&&fA(r,i.children)))}function Kx(r,e){var i;const s=[],n=e.filter(et);let l;for(;l=n.shift();){const u=(i=l.children)===null||i===void 0?void 0:i.filter(et);u&&u.length>0&&n.unshift(...u),r(l)&&s.push(l)}return s}const D0={tag_name(r){return typeof r=="function"?e=>et(e)&&r(e.name):r==="*"?et:e=>et(e)&&e.name===r},tag_type(r){return typeof r=="function"?e=>r(e.type):e=>e.type===r},tag_contains(r){return typeof r=="function"?e=>Sn(e)&&r(e.data):e=>Sn(e)&&e.data===r}};function pA(r,e){return typeof e=="function"?i=>et(i)&&e(i.attribs[r]):i=>et(i)&&i.attribs[r]===e}function qx(r,e){return i=>r(i)||e(i)}function mA(r){const e=Object.keys(r).map(i=>{const s=r[i];return Object.prototype.hasOwnProperty.call(D0,i)?D0[i](s):pA(i,s)});return e.length===0?null:e.reduce(qx)}function Jx(r,e){const i=mA(r);return i?i(e):!0}function Qx(r,e,i,s=1/0){const n=mA(r);return n?Pf(n,e,i,s):[]}function Zx(r,e,i=!0){return Array.isArray(e)||(e=[e]),Tb(pA("id",r),e,i)}function uu(r,e,i=!0,s=1/0){return Pf(D0.tag_name(r),e,i,s)}function e5(r,e,i=!0,s=1/0){return Pf(D0.tag_type(r),e,i,s)}function t5(r){let e=r.length;for(;--e>=0;){const i=r[e];if(e>0&&r.lastIndexOf(i,e-1)>=0){r.splice(e,1);continue}for(let s=i.parent;s;s=s.parent)if(r.includes(s)){r.splice(e,1);break}}return r}var gs;(function(r){r[r.DISCONNECTED=1]="DISCONNECTED",r[r.PRECEDING=2]="PRECEDING",r[r.FOLLOWING=4]="FOLLOWING",r[r.CONTAINS=8]="CONTAINS",r[r.CONTAINED_BY=16]="CONTAINED_BY"})(gs||(gs={}));function gA(r,e){const i=[],s=[];if(r===e)return 0;let n=qi(r)?r:r.parent;for(;n;)i.unshift(n),n=n.parent;for(n=qi(e)?e:e.parent;n;)s.unshift(n),n=n.parent;const l=Math.min(i.length,s.length);let u=0;for(;u<l&&i[u]===s[u];)u++;if(u===0)return gs.DISCONNECTED;const c=i[u-1],h=c.children,f=i[u],p=s[u];return h.indexOf(f)>h.indexOf(p)?c===e?gs.FOLLOWING|gs.CONTAINED_BY:gs.FOLLOWING:c===r?gs.PRECEDING|gs.CONTAINS:gs.PRECEDING}function cu(r){return r=r.filter((e,i,s)=>!s.includes(e,i+1)),r.sort((e,i)=>{const s=gA(e,i);return s&gs.PRECEDING?-1:s&gs.FOLLOWING?1:0}),r}function i5(r){const e=L0(l5,r);return e?e.name==="feed"?r5(e):s5(e):null}function r5(r){var e;const i=r.children,s={type:"atom",items:uu("entry",i).map(u=>{var c;const{children:h}=u,f={media:_A(h)};Mr(f,"id","id",h),Mr(f,"title","title",h);const p=(c=L0("link",h))===null||c===void 0?void 0:c.attribs.href;p&&(f.link=p);const g=Dl("summary",h)||Dl("content",h);g&&(f.description=g);const T=Dl("updated",h);return T&&(f.pubDate=new Date(T)),f})};Mr(s,"id","id",i),Mr(s,"title","title",i);const n=(e=L0("link",i))===null||e===void 0?void 0:e.attribs.href;n&&(s.link=n),Mr(s,"description","subtitle",i);const l=Dl("updated",i);return l&&(s.updated=new Date(l)),Mr(s,"author","email",i,!0),s}function s5(r){var e,i;const s=(i=(e=L0("channel",r.children))===null||e===void 0?void 0:e.children)!==null&&i!==void 0?i:[],n={type:r.name.substr(0,3),id:"",items:uu("item",r.children).map(u=>{const{children:c}=u,h={media:_A(c)};Mr(h,"id","guid",c),Mr(h,"title","title",c),Mr(h,"link","link",c),Mr(h,"description","description",c);const f=Dl("pubDate",c);return f&&(h.pubDate=new Date(f)),h})};Mr(n,"title","title",s),Mr(n,"link","link",s),Mr(n,"description","description",s);const l=Dl("lastBuildDate",s);return l&&(n.updated=new Date(l)),Mr(n,"author","managingEditor",s,!0),n}const n5=["url","type","lang"],o5=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function _A(r){return uu("media:content",r).map(e=>{const{attribs:i}=e,s={medium:i.medium,isDefault:!!i.isDefault};for(const n of n5)i[n]&&(s[n]=i[n]);for(const n of o5)i[n]&&(s[n]=parseInt(i[n],10));return i.expression&&(s.expression=i.expression),s})}function L0(r,e){return uu(r,e,!0,1)[0]}function Dl(r,e,i=!1){return Qa(uu(r,e,i,1)).trim()}function Mr(r,e,i,s,n=!1){const l=Dl(i,s,n);l&&(r[e]=l)}function l5(r){return r==="rss"||r==="feed"||r==="rdf:RDF"}const Uf=Object.freeze(Object.defineProperty({__proto__:null,get DocumentPosition(){return gs},append:zx,appendChild:Wx,compareDocumentPosition:gA,existsOne:fA,filter:Pf,find:Ff,findAll:Kx,findOne:Tb,findOneChild:jx,getAttributeValue:Ux,getChildren:Bf,getElementById:Zx,getElements:Qx,getElementsByTagName:uu,getElementsByTagType:e5,getFeed:i5,getInnerHTML:Fx,getName:Gx,getOuterHTML:cA,getParent:hA,getSiblings:dA,getText:_0,hasAttrib:Hx,hasChildren:qi,innerText:x0,isCDATA:Df,isComment:Lf,isDocument:Wl,isTag:et,isText:Sn,nextElementSibling:_b,prepend:Xx,prependChild:Yx,prevElementSibling:bb,removeElement:zl,removeSubsets:t5,replaceElement:Vx,testElement:Jx,textContent:Qa,uniqueSort:cu},Symbol.toStringTag,{value:"Module"}));function bA(r,e,i){return r?r(e??r._root.children,null,void 0,i).toString():""}function a5(r,e){return!e&&typeof r=="object"&&r!=null&&!("length"in r)&&!("type"in r)}function u5(r,e){const i=a5(r)?(e=r,void 0):r,s={...hb,...this===null||this===void 0?void 0:this._options,...K1(e??{})};return bA(this,i,s)}function c5(r){const e={...this._options,xmlMode:!0};return bA(this,r,e)}function Wc(r){const e=r||(this?this.root():[]);let i="";for(let s=0;s<e.length;s++)i+=Qa(e[s]);return i}function h5(r,e,i=typeof e=="boolean"?e:!1){if(!r||typeof r!="string")return null;typeof e=="boolean"&&(i=e);const s=this.load(r,hb,!1);return i||s("script").remove(),s.root()[0].children.slice()}function d5(){return this(this._root)}function TA(r,e){if(e===r)return!1;let i=e;for(;i&&i!==i.parent;)if(i=i.parent,i===r)return!0;return!1}function f5(r,e){if(!D2(r)||!D2(e))return;let i=r.length;const s=+e.length;for(let n=0;n<s;n++)r[i++]=e[n];return r.length=i,r}function D2(r){if(Array.isArray(r))return!0;if(typeof r!="object"||!Object.prototype.hasOwnProperty.call(r,"length")||typeof r.length!="number"||r.length<0)return!1;for(let e=0;e<r.length;e++)if(!(e in r))return!1;return!0}const p5=Object.freeze(Object.defineProperty({__proto__:null,contains:TA,html:u5,merge:f5,parseHTML:h5,root:d5,text:Wc,xml:c5},Symbol.toStringTag,{value:"Module"}));function In(r){return r.cheerio!=null}function m5(r){return r.replace(/[_.-](\w|$)/g,(e,i)=>i.toUpperCase())}function g5(r){return r.replace(/[A-Z]/g,"-$&").toLowerCase()}function fi(r,e){const i=r.length;for(let s=0;s<i;s++)e(r[s],s);return r}function J1(r){const e="length"in r?Array.prototype.map.call(r,s=>N0(s,!0)):[N0(r,!0)],i=new Fl(e);return e.forEach(s=>{s.parent=i}),e}var wl;(function(r){r[r.LowerA=97]="LowerA",r[r.LowerZ=122]="LowerZ",r[r.UpperA=65]="UpperA",r[r.UpperZ=90]="UpperZ",r[r.Exclamation=33]="Exclamation"})(wl||(wl={}));function Q1(r){const e=r.indexOf("<");if(e<0||e>r.length-3)return!1;const i=r.charCodeAt(e+1);return(i>=wl.LowerA&&i<=wl.LowerZ||i>=wl.UpperA&&i<=wl.UpperZ||i===wl.Exclamation)&&r.includes(">",e+2)}const Va=Object.prototype.hasOwnProperty,zc=/\s+/,Jg="data-",L2={null:null,true:!0,false:!1},Eb=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,_5=/^{[^]*}$|^\[[^]*]$/;function M0(r,e,i){var s;if(!(!r||!et(r))){if((s=r.attribs)!==null&&s!==void 0||(r.attribs={}),!e)return r.attribs;if(Va.call(r.attribs,e))return!i&&Eb.test(e)?e:r.attribs[e];if(r.name==="option"&&e==="value")return Wc(r.children);if(r.name==="input"&&(r.attribs.type==="radio"||r.attribs.type==="checkbox")&&e==="value")return"on"}}function Wa(r,e,i){i===null?EA(r,e):r.attribs[e]=`${i}`}function b5(r,e){if(typeof r=="object"||e!==void 0){if(typeof e=="function"){if(typeof r!="string")throw new Error("Bad combination of arguments.");return fi(this,(i,s)=>{et(i)&&Wa(i,r,e.call(i,s,i.attribs[r]))})}return fi(this,i=>{et(i)&&(typeof r=="object"?Object.keys(r).forEach(s=>{const n=r[s];Wa(i,s,n)}):Wa(i,r,e))})}return arguments.length>1?this:M0(this[0],r,this.options.xmlMode)}function M2(r,e,i){return e in r?r[e]:!i&&Eb.test(e)?M0(r,e,!1)!==void 0:M0(r,e,i)}function Qg(r,e,i,s){e in r?r[e]=i:Wa(r,e,!s&&Eb.test(e)?i?"":null:`${i}`)}function T5(r,e){var i;if(typeof r=="string"&&e===void 0){const s=this[0];if(!s||!et(s))return;switch(r){case"style":{const n=this.css(),l=Object.keys(n);return l.forEach((u,c)=>{n[c]=u}),n.length=l.length,n}case"tagName":case"nodeName":return s.name.toUpperCase();case"href":case"src":{const n=(i=s.attribs)===null||i===void 0?void 0:i[r];return typeof URL<"u"&&(r==="href"&&(s.tagName==="a"||s.name==="link")||r==="src"&&(s.tagName==="img"||s.tagName==="iframe"||s.tagName==="audio"||s.tagName==="video"||s.tagName==="source"))&&n!==void 0&&this.options.baseURI?new URL(n,this.options.baseURI).href:n}case"innerText":return x0(s);case"textContent":return Qa(s);case"outerHTML":return this.clone().wrap("<container />").parent().html();case"innerHTML":return this.html();default:return M2(s,r,this.options.xmlMode)}}if(typeof r=="object"||e!==void 0){if(typeof e=="function"){if(typeof r=="object")throw new Error("Bad combination of arguments.");return fi(this,(s,n)=>{et(s)&&Qg(s,r,e.call(s,n,M2(s,r,this.options.xmlMode)),this.options.xmlMode)})}return fi(this,s=>{et(s)&&(typeof r=="object"?Object.keys(r).forEach(n=>{const l=r[n];Qg(s,n,l,this.options.xmlMode)}):Qg(s,r,e,this.options.xmlMode))})}}function B2(r,e,i){var s;const n=r;(s=n.data)!==null&&s!==void 0||(n.data={}),typeof e=="object"?Object.assign(n.data,e):typeof e=="string"&&i!==void 0&&(n.data[e]=i)}function P2(r,e){let i,s,n;e==null?(i=Object.keys(r.attribs).filter(l=>l.startsWith(Jg)),s=i.map(l=>m5(l.slice(Jg.length)))):(i=[Jg+g5(e)],s=[e]);for(let l=0;l<i.length;++l){const u=i[l],c=s[l];if(Va.call(r.attribs,u)&&!Va.call(r.data,c)){if(n=r.attribs[u],Va.call(L2,n))n=L2[n];else if(n===String(Number(n)))n=Number(n);else if(_5.test(n))try{n=JSON.parse(n)}catch{}r.data[c]=n}}return e==null?r.data:n}function E5(r,e){var i;const s=this[0];if(!s||!et(s))return;const n=s;return(i=n.data)!==null&&i!==void 0||(n.data={}),r?typeof r=="object"||e!==void 0?(fi(this,l=>{et(l)&&(typeof r=="object"?B2(l,r):B2(l,r,e))}),this):Va.call(n.data,r)?n.data[r]:P2(n,r):P2(n)}function $5(r){const e=arguments.length===0,i=this[0];if(!i||!et(i))return e?void 0:this;switch(i.name){case"textarea":return this.text(r);case"select":{const s=this.find("option:selected");if(!e){if(this.attr("multiple")==null&&typeof r=="object")return this;this.find("option").removeAttr("selected");const n=typeof r!="object"?[r]:r;for(let l=0;l<n.length;l++)this.find(`option[value="${n[l]}"]`).attr("selected","");return this}return this.attr("multiple")?s.toArray().map(n=>Wc(n.children)):s.attr("value")}case"input":case"option":return e?this.attr("value"):this.attr("value",r)}}function EA(r,e){!r.attribs||!Va.call(r.attribs,e)||delete r.attribs[e]}function B0(r){return r?r.trim().split(zc):[]}function v5(r){const e=B0(r);for(let i=0;i<e.length;i++)fi(this,s=>{et(s)&&EA(s,e[i])});return this}function y5(r){return this.toArray().some(e=>{const i=et(e)&&e.attribs.class;let s=-1;if(i&&r.length)for(;(s=i.indexOf(r,s+1))>-1;){const n=s+r.length;if((s===0||zc.test(i[s-1]))&&(n===i.length||zc.test(i[n])))return!0}return!1})}function $A(r){if(typeof r=="function")return fi(this,(s,n)=>{if(et(s)){const l=s.attribs.class||"";$A.call([s],r.call(s,n,l))}});if(!r||typeof r!="string")return this;const e=r.split(zc),i=this.length;for(let s=0;s<i;s++){const n=this[s];if(!et(n))continue;const l=M0(n,"class",!1);if(!l)Wa(n,"class",e.join(" ").trim());else{let u=` ${l} `;for(let c=0;c<e.length;c++){const h=`${e[c]} `;u.includes(` ${h}`)||(u+=h)}Wa(n,"class",u.trim())}}return this}function vA(r){if(typeof r=="function")return fi(this,(n,l)=>{et(n)&&vA.call([n],r.call(n,l,n.attribs.class||""))});const e=B0(r),i=e.length,s=arguments.length===0;return fi(this,n=>{if(et(n))if(s)n.attribs.class="";else{const l=B0(n.attribs.class);let u=!1;for(let c=0;c<i;c++){const h=l.indexOf(e[c]);h>=0&&(l.splice(h,1),u=!0,c--)}u&&(n.attribs.class=l.join(" "))}})}function yA(r,e){if(typeof r=="function")return fi(this,(u,c)=>{et(u)&&yA.call([u],r.call(u,c,u.attribs.class||"",e),e)});if(!r||typeof r!="string")return this;const i=r.split(zc),s=i.length,n=typeof e=="boolean"?e?1:-1:0,l=this.length;for(let u=0;u<l;u++){const c=this[u];if(!et(c))continue;const h=B0(c.attribs.class);for(let f=0;f<s;f++){const p=h.indexOf(i[f]);n>=0&&p<0?h.push(i[f]):n<=0&&p>=0&&h.splice(p,1)}c.attribs.class=h.join(" ")}return this}const S5=Object.freeze(Object.defineProperty({__proto__:null,addClass:$A,attr:b5,data:E5,hasClass:y5,prop:T5,removeAttr:v5,removeClass:vA,toggleClass:yA,val:$5},Symbol.toStringTag,{value:"Module"}));var ze;(function(r){r.Attribute="attribute",r.Pseudo="pseudo",r.PseudoElement="pseudo-element",r.Tag="tag",r.Universal="universal",r.Adjacent="adjacent",r.Child="child",r.Descendant="descendant",r.Parent="parent",r.Sibling="sibling",r.ColumnCombinator="column-combinator"})(ze||(ze={}));var Gi;(function(r){r.Any="any",r.Element="element",r.End="end",r.Equals="equals",r.Exists="exists",r.Hyphen="hyphen",r.Not="not",r.Start="start"})(Gi||(Gi={}));const F2=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,I5=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,k5=new Map([[126,Gi.Element],[94,Gi.Start],[36,Gi.End],[42,Gi.Any],[33,Gi.Not],[124,Gi.Hyphen]]),A5=new Set(["has","not","matches","is","where","host","host-context"]);function Oc(r){switch(r.type){case ze.Adjacent:case ze.Child:case ze.Descendant:case ze.Parent:case ze.Sibling:case ze.ColumnCombinator:return!0;default:return!1}}const C5=new Set(["contains","icontains"]);function O5(r,e,i){const s=parseInt(e,16)-65536;return s!==s||i?e:s<0?String.fromCharCode(s+65536):String.fromCharCode(s>>10|55296,s&1023|56320)}function mc(r){return r.replace(I5,O5)}function Zg(r){return r===39||r===34}function U2(r){return r===32||r===9||r===10||r===12||r===13}function Hf(r){const e=[],i=SA(e,`${r}`,0);if(i<r.length)throw new Error(`Unmatched selector: ${r.slice(i)}`);return e}function SA(r,e,i){let s=[];function n(T){const $=e.slice(i+T).match(F2);if(!$)throw new Error(`Expected name, found ${e.slice(i)}`);const[y]=$;return i+=T+y.length,mc(y)}function l(T){for(i+=T;i<e.length&&U2(e.charCodeAt(i));)i++}function u(){i+=1;const T=i;let $=1;for(;$>0&&i<e.length;i++)e.charCodeAt(i)===40&&!c(i)?$++:e.charCodeAt(i)===41&&!c(i)&&$--;if($)throw new Error("Parenthesis not matched");return mc(e.slice(T,i-1))}function c(T){let $=0;for(;e.charCodeAt(--T)===92;)$++;return($&1)===1}function h(){if(s.length>0&&Oc(s[s.length-1]))throw new Error("Did not expect successive traversals.")}function f(T){if(s.length>0&&s[s.length-1].type===ze.Descendant){s[s.length-1].type=T;return}h(),s.push({type:T})}function p(T,$){s.push({type:ze.Attribute,name:T,action:$,value:n(1),namespace:null,ignoreCase:"quirks"})}function g(){if(s.length&&s[s.length-1].type===ze.Descendant&&s.pop(),s.length===0)throw new Error("Empty sub-selector");r.push(s)}if(l(0),e.length===i)return i;e:for(;i<e.length;){const T=e.charCodeAt(i);switch(T){case 32:case 9:case 10:case 12:case 13:{(s.length===0||s[0].type!==ze.Descendant)&&(h(),s.push({type:ze.Descendant})),l(1);break}case 62:{f(ze.Child),l(1);break}case 60:{f(ze.Parent),l(1);break}case 126:{f(ze.Sibling),l(1);break}case 43:{f(ze.Adjacent),l(1);break}case 46:{p("class",Gi.Element);break}case 35:{p("id",Gi.Equals);break}case 91:{l(1);let $,y=null;e.charCodeAt(i)===124?$=n(1):e.startsWith("*|",i)?(y="*",$=n(2)):($=n(0),e.charCodeAt(i)===124&&e.charCodeAt(i+1)!==61&&(y=$,$=n(1))),l(0);let R=Gi.Exists;const C=k5.get(e.charCodeAt(i));if(C){if(R=C,e.charCodeAt(i+1)!==61)throw new Error("Expected `=`");l(2)}else e.charCodeAt(i)===61&&(R=Gi.Equals,l(1));let x="",j=null;if(R!=="exists"){if(Zg(e.charCodeAt(i))){const W=e.charCodeAt(i);let ne=i+1;for(;ne<e.length&&(e.charCodeAt(ne)!==W||c(ne));)ne+=1;if(e.charCodeAt(ne)!==W)throw new Error("Attribute value didn't end");x=mc(e.slice(i+1,ne)),i=ne+1}else{const W=i;for(;i<e.length&&(!U2(e.charCodeAt(i))&&e.charCodeAt(i)!==93||c(i));)i+=1;x=mc(e.slice(W,i))}l(0);const q=e.charCodeAt(i)|32;q===115?(j=!1,l(1)):q===105&&(j=!0,l(1))}if(e.charCodeAt(i)!==93)throw new Error("Attribute selector didn't terminate");i+=1;const F={type:ze.Attribute,name:$,action:R,value:x,namespace:y,ignoreCase:j};s.push(F);break}case 58:{if(e.charCodeAt(i+1)===58){s.push({type:ze.PseudoElement,name:n(2).toLowerCase(),data:e.charCodeAt(i)===40?u():null});continue}const $=n(1).toLowerCase();let y=null;if(e.charCodeAt(i)===40)if(A5.has($)){if(Zg(e.charCodeAt(i+1)))throw new Error(`Pseudo-selector ${$} cannot be quoted`);if(y=[],i=SA(y,e,i+1),e.charCodeAt(i)!==41)throw new Error(`Missing closing parenthesis in :${$} (${e})`);i+=1}else{if(y=u(),C5.has($)){const R=y.charCodeAt(0);R===y.charCodeAt(y.length-1)&&Zg(R)&&(y=y.slice(1,-1))}y=mc(y)}s.push({type:ze.Pseudo,name:$,data:y});break}case 44:{g(),s=[],l(1);break}default:{if(e.startsWith("/*",i)){const R=e.indexOf("*/",i+2);if(R<0)throw new Error("Comment was not terminated");i=R+2,s.length===0&&l(0);break}let $=null,y;if(T===42)i+=1,y="*";else if(T===124){if(y="",e.charCodeAt(i+1)===124){f(ze.ColumnCombinator),l(2);break}}else if(F2.test(e.slice(i)))y=n(0);else break e;e.charCodeAt(i)===124&&e.charCodeAt(i+1)!==124&&($=y,e.charCodeAt(i+1)===42?(y="*",i+=2):y=n(1)),s.push(y==="*"?{type:ze.Universal,namespace:$}:{type:ze.Tag,name:y,namespace:$})}}}return g(),i}var ys=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ut={trueFunc:function(){return!0},falseFunc:function(){return!1}};const IA=new Map([[ze.Universal,50],[ze.Tag,30],[ze.Attribute,1],[ze.Pseudo,0]]);function $b(r){return!IA.has(r.type)}const w5=new Map([[Gi.Exists,10],[Gi.Equals,8],[Gi.Not,7],[Gi.Start,6],[Gi.End,6],[Gi.Any,5]]);function R5(r){const e=r.map(kA);for(let i=1;i<r.length;i++){const s=e[i];if(!(s<0))for(let n=i-1;n>=0&&s<e[n];n--){const l=r[n+1];r[n+1]=r[n],r[n]=l,e[n+1]=e[n],e[n]=s}}}function kA(r){var e,i;let s=(e=IA.get(r.type))!==null&&e!==void 0?e:-1;return r.type===ze.Attribute?(s=(i=w5.get(r.action))!==null&&i!==void 0?i:4,r.action===Gi.Equals&&r.name==="id"&&(s=9),r.ignoreCase&&(s>>=1)):r.type===ze.Pseudo&&(r.data?r.name==="has"||r.name==="contains"?s=0:Array.isArray(r.data)?(s=Math.min(...r.data.map(n=>Math.min(...n.map(kA)))),s<0&&(s=0)):s=2:s=3),s}const N5=/[-[\]{}()*+?.,\\^$|#\s]/g;function H2(r){return r.replace(N5,"\\$&")}const x5=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function kl(r,e){return typeof r.ignoreCase=="boolean"?r.ignoreCase:r.ignoreCase==="quirks"?!!e.quirksMode:!e.xmlMode&&x5.has(r.name)}const D5={equals(r,e,i){const{adapter:s}=i,{name:n}=e;let{value:l}=e;return kl(e,i)?(l=l.toLowerCase(),u=>{const c=s.getAttributeValue(u,n);return c!=null&&c.length===l.length&&c.toLowerCase()===l&&r(u)}):u=>s.getAttributeValue(u,n)===l&&r(u)},hyphen(r,e,i){const{adapter:s}=i,{name:n}=e;let{value:l}=e;const u=l.length;return kl(e,i)?(l=l.toLowerCase(),function(h){const f=s.getAttributeValue(h,n);return f!=null&&(f.length===u||f.charAt(u)==="-")&&f.substr(0,u).toLowerCase()===l&&r(h)}):function(h){const f=s.getAttributeValue(h,n);return f!=null&&(f.length===u||f.charAt(u)==="-")&&f.substr(0,u)===l&&r(h)}},element(r,e,i){const{adapter:s}=i,{name:n,value:l}=e;if(/\s/.test(l))return ut.falseFunc;const u=new RegExp(`(?:^|\\s)${H2(l)}(?:$|\\s)`,kl(e,i)?"i":"");return function(h){const f=s.getAttributeValue(h,n);return f!=null&&f.length>=l.length&&u.test(f)&&r(h)}},exists(r,{name:e},{adapter:i}){return s=>i.hasAttrib(s,e)&&r(s)},start(r,e,i){const{adapter:s}=i,{name:n}=e;let{value:l}=e;const u=l.length;return u===0?ut.falseFunc:kl(e,i)?(l=l.toLowerCase(),c=>{const h=s.getAttributeValue(c,n);return h!=null&&h.length>=u&&h.substr(0,u).toLowerCase()===l&&r(c)}):c=>{var h;return!!(!((h=s.getAttributeValue(c,n))===null||h===void 0)&&h.startsWith(l))&&r(c)}},end(r,e,i){const{adapter:s}=i,{name:n}=e;let{value:l}=e;const u=-l.length;return u===0?ut.falseFunc:kl(e,i)?(l=l.toLowerCase(),c=>{var h;return((h=s.getAttributeValue(c,n))===null||h===void 0?void 0:h.substr(u).toLowerCase())===l&&r(c)}):c=>{var h;return!!(!((h=s.getAttributeValue(c,n))===null||h===void 0)&&h.endsWith(l))&&r(c)}},any(r,e,i){const{adapter:s}=i,{name:n,value:l}=e;if(l==="")return ut.falseFunc;if(kl(e,i)){const u=new RegExp(H2(l),"i");return function(h){const f=s.getAttributeValue(h,n);return f!=null&&f.length>=l.length&&u.test(f)&&r(h)}}return u=>{var c;return!!(!((c=s.getAttributeValue(u,n))===null||c===void 0)&&c.includes(l))&&r(u)}},not(r,e,i){const{adapter:s}=i,{name:n}=e;let{value:l}=e;return l===""?u=>!!s.getAttributeValue(u,n)&&r(u):kl(e,i)?(l=l.toLowerCase(),u=>{const c=s.getAttributeValue(u,n);return(c==null||c.length!==l.length||c.toLowerCase()!==l)&&r(u)}):u=>s.getAttributeValue(u,n)!==l&&r(u)}},L5=new Set([9,10,12,13,32]),G2="0".charCodeAt(0),M5="9".charCodeAt(0);function B5(r){if(r=r.trim().toLowerCase(),r==="even")return[2,0];if(r==="odd")return[2,1];let e=0,i=0,s=l(),n=u();if(e<r.length&&r.charAt(e)==="n"&&(e++,i=s*(n??1),c(),e<r.length?(s=l(),c(),n=u()):s=n=0),n===null||e<r.length)throw new Error(`n-th rule couldn't be parsed ('${r}')`);return[i,s*n];function l(){return r.charAt(e)==="-"?(e++,-1):(r.charAt(e)==="+"&&e++,1)}function u(){const h=e;let f=0;for(;e<r.length&&r.charCodeAt(e)>=G2&&r.charCodeAt(e)<=M5;)f=f*10+(r.charCodeAt(e)-G2),e++;return e===h?null:f}function c(){for(;e<r.length&&L5.has(r.charCodeAt(e));)e++}}function P5(r){const e=r[0],i=r[1]-1;if(i<0&&e<=0)return ut.falseFunc;if(e===-1)return l=>l<=i;if(e===0)return l=>l===i;if(e===1)return i<0?ut.trueFunc:l=>l>=i;const s=Math.abs(e),n=(i%s+s)%s;return e>1?l=>l>=i&&l%s===n:l=>l<=i&&l%s===n}function Md(r){return P5(B5(r))}function Bd(r,e){return i=>{const s=e.getParent(i);return s!=null&&e.isTag(s)&&r(i)}}const Z1={contains(r,e,{adapter:i}){return function(n){return r(n)&&i.getText(n).includes(e)}},icontains(r,e,{adapter:i}){const s=e.toLowerCase();return function(l){return r(l)&&i.getText(l).toLowerCase().includes(s)}},"nth-child"(r,e,{adapter:i,equals:s}){const n=Md(e);return n===ut.falseFunc?ut.falseFunc:n===ut.trueFunc?Bd(r,i):function(u){const c=i.getSiblings(u);let h=0;for(let f=0;f<c.length&&!s(u,c[f]);f++)i.isTag(c[f])&&h++;return n(h)&&r(u)}},"nth-last-child"(r,e,{adapter:i,equals:s}){const n=Md(e);return n===ut.falseFunc?ut.falseFunc:n===ut.trueFunc?Bd(r,i):function(u){const c=i.getSiblings(u);let h=0;for(let f=c.length-1;f>=0&&!s(u,c[f]);f--)i.isTag(c[f])&&h++;return n(h)&&r(u)}},"nth-of-type"(r,e,{adapter:i,equals:s}){const n=Md(e);return n===ut.falseFunc?ut.falseFunc:n===ut.trueFunc?Bd(r,i):function(u){const c=i.getSiblings(u);let h=0;for(let f=0;f<c.length;f++){const p=c[f];if(s(u,p))break;i.isTag(p)&&i.getName(p)===i.getName(u)&&h++}return n(h)&&r(u)}},"nth-last-of-type"(r,e,{adapter:i,equals:s}){const n=Md(e);return n===ut.falseFunc?ut.falseFunc:n===ut.trueFunc?Bd(r,i):function(u){const c=i.getSiblings(u);let h=0;for(let f=c.length-1;f>=0;f--){const p=c[f];if(s(u,p))break;i.isTag(p)&&i.getName(p)===i.getName(u)&&h++}return n(h)&&r(u)}},root(r,e,{adapter:i}){return s=>{const n=i.getParent(s);return(n==null||!i.isTag(n))&&r(s)}},scope(r,e,i,s){const{equals:n}=i;return!s||s.length===0?Z1.root(r,e,i):s.length===1?l=>n(s[0],l)&&r(l):l=>s.includes(l)&&r(l)},hover:e1("isHovered"),visited:e1("isVisited"),active:e1("isActive")};function e1(r){return function(i,s,{adapter:n}){const l=n[r];return typeof l!="function"?ut.falseFunc:function(c){return l(c)&&i(c)}}}const V2={empty(r,{adapter:e}){return!e.getChildren(r).some(i=>e.isTag(i)||e.getText(i)!=="")},"first-child"(r,{adapter:e,equals:i}){if(e.prevElementSibling)return e.prevElementSibling(r)==null;const s=e.getSiblings(r).find(n=>e.isTag(n));return s!=null&&i(r,s)},"last-child"(r,{adapter:e,equals:i}){const s=e.getSiblings(r);for(let n=s.length-1;n>=0;n--){if(i(r,s[n]))return!0;if(e.isTag(s[n]))break}return!1},"first-of-type"(r,{adapter:e,equals:i}){const s=e.getSiblings(r),n=e.getName(r);for(let l=0;l<s.length;l++){const u=s[l];if(i(r,u))return!0;if(e.isTag(u)&&e.getName(u)===n)break}return!1},"last-of-type"(r,{adapter:e,equals:i}){const s=e.getSiblings(r),n=e.getName(r);for(let l=s.length-1;l>=0;l--){const u=s[l];if(i(r,u))return!0;if(e.isTag(u)&&e.getName(u)===n)break}return!1},"only-of-type"(r,{adapter:e,equals:i}){const s=e.getName(r);return e.getSiblings(r).every(n=>i(r,n)||!e.isTag(n)||e.getName(n)!==s)},"only-child"(r,{adapter:e,equals:i}){return e.getSiblings(r).every(s=>i(r,s)||!e.isTag(s))}};function W2(r,e,i,s){if(i===null){if(r.length>s)throw new Error(`Pseudo-class :${e} requires an argument`)}else if(r.length===s)throw new Error(`Pseudo-class :${e} doesn't have any arguments`)}const F5={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:`:is(
        :is(button, input, select, textarea, optgroup, option)[disabled],
        optgroup[disabled] > option,
        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)
    )`,enabled:":not(:disabled)",checked:":is(:is(input[type=radio], input[type=checkbox])[checked], option:selected)",required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(> option[selected])) > :first-of-type)",checkbox:"[type=checkbox]",file:"[type=file]",password:"[type=password]",radio:"[type=radio]",reset:"[type=reset]",image:"[type=image]",submit:"[type=submit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type=button])",input:":is(input, textarea, select, button)",text:"input:is(:not([type!='']), [type=text])"},AA={};function U5(r,e){return r===ut.falseFunc?ut.falseFunc:i=>e.isTag(i)&&r(i)}function CA(r,e){const i=e.getSiblings(r);if(i.length<=1)return[];const s=i.indexOf(r);return s<0||s===i.length-1?[]:i.slice(s+1).filter(e.isTag)}function e_(r){return{xmlMode:!!r.xmlMode,lowerCaseAttributeNames:!!r.lowerCaseAttributeNames,lowerCaseTags:!!r.lowerCaseTags,quirksMode:!!r.quirksMode,cacheResults:!!r.cacheResults,pseudos:r.pseudos,adapter:r.adapter,equals:r.equals}}const t1=(r,e,i,s,n)=>{const l=n(e,e_(i),s);return l===ut.trueFunc?r:l===ut.falseFunc?ut.falseFunc:u=>l(u)&&r(u)},i1={is:t1,matches:t1,where:t1,not(r,e,i,s,n){const l=n(e,e_(i),s);return l===ut.falseFunc?r:l===ut.trueFunc?ut.falseFunc:u=>!l(u)&&r(u)},has(r,e,i,s,n){const{adapter:l}=i,u=e_(i);u.relativeSelector=!0;const c=e.some(p=>p.some($b))?[AA]:void 0,h=n(e,u,c);if(h===ut.falseFunc)return ut.falseFunc;const f=U5(h,l);if(c&&h!==ut.trueFunc){const{shouldTestNextSiblings:p=!1}=h;return g=>{if(!r(g))return!1;c[0]=g;const T=l.getChildren(g),$=p?[...T,...CA(g,l)]:T;return l.existsOne(f,$)}}return p=>r(p)&&l.existsOne(f,l.getChildren(p))}};function H5(r,e,i,s,n){var l;const{name:u,data:c}=e;if(Array.isArray(c)){if(!(u in i1))throw new Error(`Unknown pseudo-class :${u}(${c})`);return i1[u](r,c,i,s,n)}const h=(l=i.pseudos)===null||l===void 0?void 0:l[u],f=typeof h=="string"?h:F5[u];if(typeof f=="string"){if(c!=null)throw new Error(`Pseudo ${u} doesn't have any arguments`);const p=Hf(f);return i1.is(r,p,i,s,n)}if(typeof h=="function")return W2(h,u,c,1),p=>h(p,c)&&r(p);if(u in Z1)return Z1[u](r,c,i,s);if(u in V2){const p=V2[u];return W2(p,u,c,2),g=>p(g,i,c)&&r(g)}throw new Error(`Unknown pseudo-class :${u}`)}function r1(r,e){const i=e.getParent(r);return i&&e.isTag(i)?i:null}function G5(r,e,i,s,n){const{adapter:l,equals:u}=i;switch(e.type){case ze.PseudoElement:throw new Error("Pseudo-elements are not supported by css-select");case ze.ColumnCombinator:throw new Error("Column combinators are not yet supported by css-select");case ze.Attribute:{if(e.namespace!=null)throw new Error("Namespaced attributes are not yet supported by css-select");return(!i.xmlMode||i.lowerCaseAttributeNames)&&(e.name=e.name.toLowerCase()),D5[e.action](r,e,i)}case ze.Pseudo:return H5(r,e,i,s,n);case ze.Tag:{if(e.namespace!=null)throw new Error("Namespaced tag names are not yet supported by css-select");let{name:c}=e;return(!i.xmlMode||i.lowerCaseTags)&&(c=c.toLowerCase()),function(f){return l.getName(f)===c&&r(f)}}case ze.Descendant:{if(i.cacheResults===!1||typeof WeakSet>"u")return function(f){let p=f;for(;p=r1(p,l);)if(r(p))return!0;return!1};const c=new WeakSet;return function(f){let p=f;for(;p=r1(p,l);)if(!c.has(p)){if(l.isTag(p)&&r(p))return!0;c.add(p)}return!1}}case"_flexibleDescendant":return function(h){let f=h;do if(r(f))return!0;while(f=r1(f,l));return!1};case ze.Parent:return function(h){return l.getChildren(h).some(f=>l.isTag(f)&&r(f))};case ze.Child:return function(h){const f=l.getParent(h);return f!=null&&l.isTag(f)&&r(f)};case ze.Sibling:return function(h){const f=l.getSiblings(h);for(let p=0;p<f.length;p++){const g=f[p];if(u(h,g))break;if(l.isTag(g)&&r(g))return!0}return!1};case ze.Adjacent:return l.prevElementSibling?function(h){const f=l.prevElementSibling(h);return f!=null&&r(f)}:function(h){const f=l.getSiblings(h);let p;for(let g=0;g<f.length;g++){const T=f[g];if(u(h,T))break;l.isTag(T)&&(p=T)}return!!p&&r(p)};case ze.Universal:{if(e.namespace!=null&&e.namespace!=="*")throw new Error("Namespaced universal selectors are not yet supported by css-select");return r}}}function OA(r){return r.type===ze.Pseudo&&(r.name==="scope"||Array.isArray(r.data)&&r.data.some(e=>e.some(OA)))}const V5={type:ze.Descendant},W5={type:"_flexibleDescendant"},z5={type:ze.Pseudo,name:"scope",data:null};function Y5(r,{adapter:e},i){const s=!!(i!=null&&i.every(n=>{const l=e.isTag(n)&&e.getParent(n);return n===AA||l&&e.isTag(l)}));for(const n of r){if(!(n.length>0&&$b(n[0])&&n[0].type!==ze.Descendant))if(s&&!n.some(OA))n.unshift(V5);else continue;n.unshift(z5)}}function wA(r,e,i){var s;r.forEach(R5),i=(s=e.context)!==null&&s!==void 0?s:i;const n=Array.isArray(i),l=i&&(Array.isArray(i)?i:[i]);if(e.relativeSelector!==!1)Y5(r,e,l);else if(r.some(h=>h.length>0&&$b(h[0])))throw new Error("Relative selectors are not allowed when the `relativeSelector` option is disabled");let u=!1;const c=r.map(h=>{if(h.length>=2){const[f,p]=h;f.type!==ze.Pseudo||f.name!=="scope"||(n&&p.type===ze.Descendant?h[1]=W5:(p.type===ze.Adjacent||p.type===ze.Sibling)&&(u=!0))}return X5(h,e,l)}).reduce(j5,ut.falseFunc);return c.shouldTestNextSiblings=u,c}function X5(r,e,i){var s;return r.reduce((n,l)=>n===ut.falseFunc?ut.falseFunc:G5(n,l,e,i,wA),(s=e.rootFunc)!==null&&s!==void 0?s:ut.trueFunc)}function j5(r,e){return e===ut.falseFunc||r===ut.trueFunc?r:r===ut.falseFunc||e===ut.trueFunc?e:function(s){return r(s)||e(s)}}const RA=(r,e)=>r===e,K5={adapter:Uf,equals:RA};function q5(r){var e,i,s,n;const l=r??K5;return(e=l.adapter)!==null&&e!==void 0||(l.adapter=Uf),(i=l.equals)!==null&&i!==void 0||(l.equals=(n=(s=l.adapter)===null||s===void 0?void 0:s.equals)!==null&&n!==void 0?n:RA),l}function J5(r){return function(i,s,n){const l=q5(s);return r(i,l,n)}}const vb=J5(wA);function NA(r,e,i=!1){return i&&(r=Q5(r,e)),Array.isArray(r)?e.removeSubsets(r):e.getChildren(r)}function Q5(r,e){const i=Array.isArray(r)?r.slice(0):[r],s=i.length;for(let n=0;n<s;n++){const l=CA(i[n],e);i.push(...l)}return i}const Z5=new Set(["first","last","eq","gt","nth","lt","even","odd"]);function P0(r){return r.type!=="pseudo"?!1:Z5.has(r.name)?!0:r.name==="not"&&Array.isArray(r.data)?r.data.some(e=>e.some(P0)):!1}function eD(r,e,i){const s=e!=null?parseInt(e,10):NaN;switch(r){case"first":return 1;case"nth":case"eq":return isFinite(s)?s>=0?s+1:1/0:0;case"lt":return isFinite(s)?s>=0?Math.min(s,i):1/0:0;case"gt":return isFinite(s)?1/0:0;case"odd":return 2*i;case"even":return 2*i-1;case"last":case"not":return 1/0}}function tD(r){for(;r.parent;)r=r.parent;return r}function yb(r){const e=[],i=[];for(const s of r)s.some(P0)?e.push(s):i.push(s);return[i,e]}const iD={type:ze.Universal,namespace:null},rD={type:ze.Pseudo,name:"scope",data:null};function xA(r,e,i={}){return DA([r],e,i)}function DA(r,e,i={}){if(typeof e=="function")return r.some(e);const[s,n]=yb(Hf(e));return s.length>0&&r.some(vb(s,i))||n.some(l=>BA(l,r,i).length>0)}function sD(r,e,i,s){const n=typeof i=="string"?parseInt(i,10):NaN;switch(r){case"first":case"lt":return e;case"last":return e.length>0?[e[e.length-1]]:e;case"nth":case"eq":return isFinite(n)&&Math.abs(n)<e.length?[n<0?e[e.length+n]:e[n]]:[];case"gt":return isFinite(n)?e.slice(n+1):[];case"even":return e.filter((l,u)=>u%2===0);case"odd":return e.filter((l,u)=>u%2===1);case"not":{const l=new Set(MA(i,e,s));return e.filter(u=>!l.has(u))}}}function LA(r,e,i={}){return MA(Hf(r),e,i)}function MA(r,e,i){if(e.length===0)return[];const[s,n]=yb(r);let l;if(s.length){const u=i_(e,s,i);if(n.length===0)return u;u.length&&(l=new Set(u))}for(let u=0;u<n.length&&(l==null?void 0:l.size)!==e.length;u++){const c=n[u];if((l?e.filter(p=>et(p)&&!l.has(p)):e).length===0)break;const f=BA(c,e,i);if(f.length)if(l)f.forEach(p=>l.add(p));else{if(u===n.length-1)return f;l=new Set(f)}}return typeof l<"u"?l.size===e.length?e:e.filter(u=>l.has(u)):[]}function BA(r,e,i){var s;if(r.some(Oc)){const n=(s=i.root)!==null&&s!==void 0?s:tD(e[0]),l={...i,context:e,relativeSelector:!1};return r.push(rD),F0(n,r,l,!0,e.length)}return F0(e,r,i,!1,e.length)}function nD(r,e,i={},s=1/0){if(typeof r=="function")return PA(e,r);const[n,l]=yb(Hf(r)),u=l.map(c=>F0(e,c,i,!0,s));return n.length&&u.push(t_(e,n,i,s)),u.length===0?[]:u.length===1?u[0]:cu(u.reduce((c,h)=>[...c,...h]))}function F0(r,e,i,s,n){const l=e.findIndex(P0),u=e.slice(0,l),c=e[l],h=e.length-1===l?n:1/0,f=eD(c.name,c.data,h);if(f===0)return[];const g=(u.length===0&&!Array.isArray(r)?Bf(r).filter(et):u.length===0?(Array.isArray(r)?r:[r]).filter(et):s||u.some(Oc)?t_(r,[u],i,f):i_(r,[u],i)).slice(0,f);let T=sD(c.name,g,c.data,i);if(T.length===0||e.length===l+1)return T;const $=e.slice(l+1),y=$.some(Oc);if(y){if(Oc($[0])){const{type:R}=$[0];(R===ze.Sibling||R===ze.Adjacent)&&(T=NA(T,Uf,!0)),$.unshift(iD)}i={...i,relativeSelector:!1,rootFunc:R=>T.includes(R)}}else i.rootFunc&&i.rootFunc!==ut.trueFunc&&(i={...i,rootFunc:ut.trueFunc});return $.some(P0)?F0(T,$,i,!1,n):y?t_(T,[$],i,n):i_(T,[$],i)}function t_(r,e,i,s){const n=vb(e,i,r);return PA(r,n,s)}function PA(r,e,i=1/0){const s=NA(r,Uf,e.shouldTestNextSiblings);return Ff(n=>et(n)&&e(n),s,!0,i)}function i_(r,e,i){const s=(Array.isArray(r)?r:[r]).filter(et);if(s.length===0)return s;const n=vb(e,i);return n===ut.trueFunc?s:s.filter(n)}const oD=/^\s*[~+]/;function lD(r){var e;if(!r)return this._make([]);const i=this.toArray();if(typeof r!="string"){const l=In(r)?r.toArray():[r];return this._make(l.filter(u=>i.some(c=>TA(c,u))))}const s=oD.test(r)?i:this.children().toArray(),n={context:i,root:(e=this._root)===null||e===void 0?void 0:e[0],xmlMode:this.options.xmlMode,lowerCaseTags:this.options.lowerCaseTags,lowerCaseAttributeNames:this.options.lowerCaseAttributeNames,pseudos:this.options.pseudos,quirksMode:this.options.quirksMode};return this._make(nD(r,s,n))}function Sb(r){return function(e,...i){return function(s){var n;let l=r(e,this);return s&&(l=Ab(l,s,this.options.xmlMode,(n=this._root)===null||n===void 0?void 0:n[0])),this._make(this.length>1&&l.length>1?i.reduce((u,c)=>c(u),l):l)}}}const lh=Sb((r,e)=>{const i=[];for(let s=0;s<e.length;s++){const n=r(e[s]);i.push(n)}return new Array().concat(...i)}),Ib=Sb((r,e)=>{const i=[];for(let s=0;s<e.length;s++){const n=r(e[s]);n!==null&&i.push(n)}return i});function kb(r,...e){let i=null;const s=Sb((n,l)=>{const u=[];return fi(l,c=>{for(let h;(h=n(c))&&!(i!=null&&i(h,u.length));c=h)u.push(h)}),u})(r,...e);return function(n,l){i=typeof n=="string"?c=>xA(c,n,this.options):n?ah(n):null;const u=s.call(this,l);return i=null,u}}function hu(r){return Array.from(new Set(r))}const aD=Ib(({parent:r})=>r&&!Wl(r)?r:null,hu),uD=lh(r=>{const e=[];for(;r.parent&&!Wl(r.parent);)e.push(r.parent),r=r.parent;return e},cu,r=>r.reverse()),cD=kb(({parent:r})=>r&&!Wl(r)?r:null,cu,r=>r.reverse());function hD(r){var e;const i=[];if(!r)return this._make(i);const s={xmlMode:this.options.xmlMode,root:(e=this._root)===null||e===void 0?void 0:e[0]},n=typeof r=="string"?l=>xA(l,r,s):ah(r);return fi(this,l=>{for(;l&&et(l);){if(n(l,0)){i.includes(l)||i.push(l);break}l=l.parent}}),this._make(i)}const dD=Ib(r=>_b(r)),fD=lh(r=>{const e=[];for(;r.next;)r=r.next,et(r)&&e.push(r);return e},hu),pD=kb(r=>_b(r),hu),mD=Ib(r=>bb(r)),gD=lh(r=>{const e=[];for(;r.prev;)r=r.prev,et(r)&&e.push(r);return e},hu),_D=kb(r=>bb(r),hu),bD=lh(r=>dA(r).filter(e=>et(e)&&e!==r),cu),TD=lh(r=>Bf(r).filter(et),hu);function ED(){const r=this.toArray().reduce((e,i)=>qi(i)?e.concat(i.children):e,[]);return this._make(r)}function $D(r){let e=0;const i=this.length;for(;e<i&&r.call(this[e],e,this[e])!==!1;)++e;return this}function vD(r){let e=[];for(let i=0;i<this.length;i++){const s=this[i],n=r.call(s,i,s);n!=null&&(e=e.concat(n))}return this._make(e)}function ah(r){return typeof r=="function"?(e,i)=>r.call(e,i,e):In(r)?e=>Array.prototype.includes.call(r,e):function(e){return r===e}}function yD(r){var e;return this._make(Ab(this.toArray(),r,this.options.xmlMode,(e=this._root)===null||e===void 0?void 0:e[0]))}function Ab(r,e,i,s){return typeof e=="string"?LA(e,r,{xmlMode:i,root:s}):r.filter(ah(e))}function SD(r){const e=this.toArray();return typeof r=="string"?DA(e.filter(et),r,this.options):r?e.some(ah(r)):!1}function ID(r){let e=this.toArray();if(typeof r=="string"){const i=new Set(LA(r,e,this.options));e=e.filter(s=>!i.has(s))}else{const i=ah(r);e=e.filter((s,n)=>!i(s,n))}return this._make(e)}function kD(r){return this.filter(typeof r=="string"?`:has(${r})`:(e,i)=>this._make(i).find(r).length>0)}function AD(){return this.length>1?this._make(this[0]):this}function CD(){return this.length>0?this._make(this[this.length-1]):this}function OD(r){var e;return r=+r,r===0&&this.length<=1?this:(r<0&&(r=this.length+r),this._make((e=this[r])!==null&&e!==void 0?e:[]))}function wD(r){return r==null?this.toArray():this[r<0?this.length+r:r]}function RD(){return Array.prototype.slice.call(this)}function ND(r){let e,i;return r==null?(e=this.parent().children(),i=this[0]):typeof r=="string"?(e=this._make(r),i=this[0]):(e=this,i=In(r)?r[0]:r),Array.prototype.indexOf.call(e,i)}function xD(r,e){return this._make(Array.prototype.slice.call(this,r,e))}function DD(){var r;return(r=this.prevObject)!==null&&r!==void 0?r:this._make([])}function LD(r,e){const i=this._make(r,e),s=cu([...this.get(),...i.get()]);return this._make(s)}function MD(r){return this.prevObject?this.add(r?this.prevObject.filter(r):this.prevObject):this}const BD=Object.freeze(Object.defineProperty({__proto__:null,add:LD,addBack:MD,children:TD,closest:hD,contents:ED,each:$D,end:DD,eq:OD,filter:yD,filterArray:Ab,find:lD,first:AD,get:wD,has:kD,index:ND,is:SD,last:CD,map:vD,next:dD,nextAll:fD,nextUntil:pD,not:ID,parent:aD,parents:uD,parentsUntil:cD,prev:mD,prevAll:gD,prevUntil:_D,siblings:bD,slice:xD,toArray:RD},Symbol.toStringTag,{value:"Module"}));function PD(r){return function(i,s,n,l){if(typeof Buffer<"u"&&Buffer.isBuffer(i)&&(i=i.toString()),typeof i=="string")return r(i,s,n,l);const u=i;if(!Array.isArray(u)&&Wl(u))return u;const c=new Fl([]);return Ul(u,c),c}}function Ul(r,e){const i=Array.isArray(r)?r:[r];e?e.children=i:e=null;for(let s=0;s<i.length;s++){const n=i[s];n.parent&&n.parent.children!==i&&zl(n),e?(n.prev=i[s-1]||null,n.next=i[s+1]||null):n.prev=n.next=null,n.parent=e}return e}function FD(r,e){return r==null?[]:In(r)?e?J1(r.get()):r.get():Array.isArray(r)?r.reduce((i,s)=>i.concat(this._makeDomArray(s,e)),[]):typeof r=="string"?this._parse(r,this.options,!1,null).children:e?J1([r]):[r]}function FA(r){return function(...e){const i=this.length-1;return fi(this,(s,n)=>{if(!qi(s))return;const l=typeof e[0]=="function"?e[0].call(s,n,this._render(s.children)):e,u=this._makeDomArray(l,n<i);r(u,s.children,s)})}}function el(r,e,i,s,n){var l,u;const c=[e,i,...s],h=e===0?null:r[e-1],f=e+i>=r.length?null:r[e+i];for(let p=0;p<s.length;++p){const g=s[p],T=g.parent;if(T){const y=T.children.indexOf(g);y>-1&&(T.children.splice(y,1),n===T&&e>y&&c[0]--)}g.parent=n,g.prev&&(g.prev.next=(l=g.next)!==null&&l!==void 0?l:null),g.next&&(g.next.prev=(u=g.prev)!==null&&u!==void 0?u:null),g.prev=p===0?h:s[p-1],g.next=p===s.length-1?f:s[p+1]}return h&&(h.next=s[0]),f&&(f.prev=s[s.length-1]),r.splice(...c)}function UD(r){return(In(r)?r:this._make(r)).append(this),this}function HD(r){return(In(r)?r:this._make(r)).prepend(this),this}const GD=FA((r,e,i)=>{el(e,e.length,0,r,i)}),VD=FA((r,e,i)=>{el(e,0,0,r,i)});function UA(r){return function(e){const i=this.length-1,s=this.parents().last();for(let n=0;n<this.length;n++){const l=this[n],u=typeof e=="function"?e.call(l,n,l):typeof e=="string"&&!Q1(e)?s.find(e).clone():e,[c]=this._makeDomArray(u,n<i);if(!c||!qi(c))continue;let h=c,f=0;for(;f<h.children.length;){const p=h.children[f];et(p)?(h=p,f=0):f++}r(l,h,[c])}return this}}const WD=UA((r,e,i)=>{const{parent:s}=r;if(!s)return;const n=s.children,l=n.indexOf(r);Ul([r],e),el(n,l,0,i,s)}),zD=UA((r,e,i)=>{qi(r)&&(Ul(r.children,e),Ul(i,r))});function YD(r){return this.parent(r).not("body").each((e,i)=>{this._make(i).replaceWith(i.children)}),this}function XD(r){const e=this[0];if(e){const i=this._make(typeof r=="function"?r.call(e,0,e):r).insertBefore(e);let s;for(let l=0;l<i.length;l++)i[l].type==="tag"&&(s=i[l]);let n=0;for(;s&&n<s.children.length;){const l=s.children[n];l.type==="tag"?(s=l,n=0):n++}s&&this._make(s).append(this)}return this}function jD(...r){const e=this.length-1;return fi(this,(i,s)=>{const{parent:n}=i;if(!qi(i)||!n)return;const l=n.children,u=l.indexOf(i);if(u<0)return;const c=typeof r[0]=="function"?r[0].call(i,s,this._render(i.children)):r,h=this._makeDomArray(c,s<e);el(l,u+1,0,h,n)})}function KD(r){typeof r=="string"&&(r=this._make(r)),this.remove();const e=[];return this._makeDomArray(r).forEach(i=>{const s=this.clone().toArray(),{parent:n}=i;if(!n)return;const l=n.children,u=l.indexOf(i);u<0||(el(l,u+1,0,s,n),e.push(...s))}),this._make(e)}function qD(...r){const e=this.length-1;return fi(this,(i,s)=>{const{parent:n}=i;if(!qi(i)||!n)return;const l=n.children,u=l.indexOf(i);if(u<0)return;const c=typeof r[0]=="function"?r[0].call(i,s,this._render(i.children)):r,h=this._makeDomArray(c,s<e);el(l,u,0,h,n)})}function JD(r){const e=this._make(r);this.remove();const i=[];return fi(e,s=>{const n=this.clone().toArray(),{parent:l}=s;if(!l)return;const u=l.children,c=u.indexOf(s);c<0||(el(u,c,0,n,l),i.push(...n))}),this._make(i)}function QD(r){const e=r?this.filter(r):this;return fi(e,i=>{zl(i),i.prev=i.next=i.parent=null}),this}function ZD(r){return fi(this,(e,i)=>{const{parent:s}=e;if(!s)return;const n=s.children,l=typeof r=="function"?r.call(e,i,e):r,u=this._makeDomArray(l);Ul(u,null);const c=n.indexOf(e);el(n,c,1,u,s),u.includes(e)||(e.parent=e.prev=e.next=null)})}function eL(){return fi(this,r=>{qi(r)&&(r.children.forEach(e=>{e.next=e.prev=e.parent=null}),r.children.length=0)})}function tL(r){if(r===void 0){const e=this[0];return!e||!qi(e)?null:this._render(e.children)}return fi(this,e=>{if(!qi(e))return;e.children.forEach(s=>{s.next=s.prev=s.parent=null});const i=In(r)?r.toArray():this._parse(`${r}`,this.options,!1,e).children;Ul(i,e)})}function iL(){return this._render(this)}function rL(r){return r===void 0?Wc(this):typeof r=="function"?fi(this,(e,i)=>this._make(e).text(r.call(e,i,Wc([e])))):fi(this,e=>{if(!qi(e))return;e.children.forEach(s=>{s.next=s.prev=s.parent=null});const i=new Vc(`${r}`);Ul(i,e)})}function sL(){return this._make(J1(this.get()))}const nL=Object.freeze(Object.defineProperty({__proto__:null,_makeDomArray:FD,after:jD,append:GD,appendTo:UD,before:qD,clone:sL,empty:eL,html:tL,insertAfter:KD,insertBefore:JD,prepend:VD,prependTo:HD,remove:QD,replaceWith:ZD,text:rL,toString:iL,unwrap:YD,wrap:WD,wrapAll:XD,wrapInner:zD},Symbol.toStringTag,{value:"Module"}));function oL(r,e){if(r!=null&&e!=null||typeof r=="object"&&!Array.isArray(r))return fi(this,(i,s)=>{et(i)&&HA(i,r,e,s)});if(this.length!==0)return GA(this[0],r)}function HA(r,e,i,s){if(typeof e=="string"){const n=GA(r),l=typeof i=="function"?i.call(r,s,n[e]):i;l===""?delete n[e]:l!=null&&(n[e]=l),r.attribs.style=lL(n)}else typeof e=="object"&&Object.keys(e).forEach((n,l)=>{HA(r,n,e[n],l)})}function GA(r,e){if(!r||!et(r))return;const i=aL(r.attribs.style);if(typeof e=="string")return i[e];if(Array.isArray(e)){const s={};return e.forEach(n=>{i[n]!=null&&(s[n]=i[n])}),s}return i}function lL(r){return Object.keys(r).reduce((e,i)=>`${e}${e?" ":""}${i}: ${r[i]};`,"")}function aL(r){if(r=(r||"").trim(),!r)return{};const e={};let i;for(const s of r.split(";")){const n=s.indexOf(":");if(n<1||n===s.length-1){const l=s.trimEnd();l.length>0&&i!==void 0&&(e[i]+=`;${l}`)}else i=s.slice(0,n).trim(),e[i]=s.slice(n+1).trim()}return e}const uL=Object.freeze(Object.defineProperty({__proto__:null,css:oL},Symbol.toStringTag,{value:"Module"})),z2="input,select,textarea,keygen",cL=/%20/g,Y2=/\r?\n/g;function hL(){return this.serializeArray().map(i=>`${encodeURIComponent(i.name)}=${encodeURIComponent(i.value)}`).join("&").replace(cL,"+")}function dL(){return this.map((r,e)=>{const i=this._make(e);return et(e)&&e.name==="form"?i.find(z2).toArray():i.filter(z2).toArray()}).filter('[name!=""]:enabled:not(:submit, :button, :image, :reset, :file):matches([checked], :not(:checkbox, :radio))').map((r,e)=>{var i;const s=this._make(e),n=s.attr("name"),l=(i=s.val())!==null&&i!==void 0?i:"";return Array.isArray(l)?l.map(u=>({name:n,value:u.replace(Y2,`\r
`)})):{name:n,value:l.replace(Y2,`\r
`)}}).toArray()}const fL=Object.freeze(Object.defineProperty({__proto__:null,serialize:hL,serializeArray:dL},Symbol.toStringTag,{value:"Module"}));class uh{constructor(e,i,s){if(this.length=0,this.options=s,this._root=i,e){for(let n=0;n<e.length;n++)this[n]=e[n];this.length=e.length}}}uh.prototype.cheerio="[cheerio object]";uh.prototype.splice=Array.prototype.splice;uh.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];Object.assign(uh.prototype,S5,BD,nL,uL,fL);function pL(r,e){return function i(s,n,l=!0){if(s==null)throw new Error("cheerio.load() expects a string");const u={...hb,...K1(n)},c=r(s,u,l,null);class h extends uh{_make(g,T){const $=f(g,T);return $.prevObject=this,$}_parse(g,T,$,y){return r(g,T,$,y)}_render(g){return e(g,this.options)}}function f(p,g,T=c,$){if(p&&In(p))return p;const y={...u,...K1($)},R=typeof T=="string"?[r(T,y,!1,null)]:"length"in T?T:[T],C=In(R)?R:new h(R,null,y);if(C._root=C,!p)return new h(void 0,C,y);const x=typeof p=="string"&&Q1(p)?r(p,y,!1,null).children:mL(p)?[p]:Array.isArray(p)?p:void 0,j=new h(x,C,y);if(x)return j;if(typeof p!="string")throw new Error("Unexpected type of selector");let F=p;const q=g?typeof g=="string"?Q1(g)?new h([r(g,y,!1,null)],C,y):(F=`${g} ${F}`,C):In(g)?g:new h(Array.isArray(g)?g:[g],C,y):C;return q?q.find(F):j}return Object.assign(f,p5,{load:i,_root:c,_options:u,fn:h.prototype,prototype:h.prototype}),f}}function mL(r){return!!r.name||r.type==="root"||r.type==="text"||r.type==="comment"}const gL=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),ri="�";var O;(function(r){r[r.EOF=-1]="EOF",r[r.NULL=0]="NULL",r[r.TABULATION=9]="TABULATION",r[r.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",r[r.LINE_FEED=10]="LINE_FEED",r[r.FORM_FEED=12]="FORM_FEED",r[r.SPACE=32]="SPACE",r[r.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",r[r.QUOTATION_MARK=34]="QUOTATION_MARK",r[r.NUMBER_SIGN=35]="NUMBER_SIGN",r[r.AMPERSAND=38]="AMPERSAND",r[r.APOSTROPHE=39]="APOSTROPHE",r[r.HYPHEN_MINUS=45]="HYPHEN_MINUS",r[r.SOLIDUS=47]="SOLIDUS",r[r.DIGIT_0=48]="DIGIT_0",r[r.DIGIT_9=57]="DIGIT_9",r[r.SEMICOLON=59]="SEMICOLON",r[r.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",r[r.EQUALS_SIGN=61]="EQUALS_SIGN",r[r.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",r[r.QUESTION_MARK=63]="QUESTION_MARK",r[r.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",r[r.LATIN_CAPITAL_F=70]="LATIN_CAPITAL_F",r[r.LATIN_CAPITAL_X=88]="LATIN_CAPITAL_X",r[r.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",r[r.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",r[r.GRAVE_ACCENT=96]="GRAVE_ACCENT",r[r.LATIN_SMALL_A=97]="LATIN_SMALL_A",r[r.LATIN_SMALL_F=102]="LATIN_SMALL_F",r[r.LATIN_SMALL_X=120]="LATIN_SMALL_X",r[r.LATIN_SMALL_Z=122]="LATIN_SMALL_Z",r[r.REPLACEMENT_CHARACTER=65533]="REPLACEMENT_CHARACTER"})(O=O||(O={}));const Nr={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function VA(r){return r>=55296&&r<=57343}function _L(r){return r>=56320&&r<=57343}function bL(r,e){return(r-55296)*1024+9216+e}function WA(r){return r!==32&&r!==10&&r!==13&&r!==9&&r!==12&&r>=1&&r<=31||r>=127&&r<=159}function zA(r){return r>=64976&&r<=65007||gL.has(r)}var te;(function(r){r.controlCharacterInInputStream="control-character-in-input-stream",r.noncharacterInInputStream="noncharacter-in-input-stream",r.surrogateInInputStream="surrogate-in-input-stream",r.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",r.endTagWithAttributes="end-tag-with-attributes",r.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",r.unexpectedSolidusInTag="unexpected-solidus-in-tag",r.unexpectedNullCharacter="unexpected-null-character",r.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",r.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",r.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",r.missingEndTagName="missing-end-tag-name",r.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",r.unknownNamedCharacterReference="unknown-named-character-reference",r.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",r.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",r.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",r.eofBeforeTagName="eof-before-tag-name",r.eofInTag="eof-in-tag",r.missingAttributeValue="missing-attribute-value",r.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",r.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",r.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",r.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",r.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",r.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",r.missingDoctypePublicIdentifier="missing-doctype-public-identifier",r.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",r.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",r.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",r.cdataInHtmlContent="cdata-in-html-content",r.incorrectlyOpenedComment="incorrectly-opened-comment",r.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",r.eofInDoctype="eof-in-doctype",r.nestedComment="nested-comment",r.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",r.eofInComment="eof-in-comment",r.incorrectlyClosedComment="incorrectly-closed-comment",r.eofInCdata="eof-in-cdata",r.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",r.nullCharacterReference="null-character-reference",r.surrogateCharacterReference="surrogate-character-reference",r.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",r.controlCharacterReference="control-character-reference",r.noncharacterCharacterReference="noncharacter-character-reference",r.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",r.missingDoctypeName="missing-doctype-name",r.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",r.duplicateAttribute="duplicate-attribute",r.nonConformingDoctype="non-conforming-doctype",r.missingDoctype="missing-doctype",r.misplacedDoctype="misplaced-doctype",r.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",r.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",r.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",r.openElementsLeftAfterEof="open-elements-left-after-eof",r.abandonedHeadElementChild="abandoned-head-element-child",r.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",r.nestedNoscriptInHead="nested-noscript-in-head",r.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(te=te||(te={}));const TL=1<<16;class EL{constructor(e){this.handler=e,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=TL,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+Number(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(e){const{line:i,col:s,offset:n}=this;return{code:e,startLine:i,endLine:i,startCol:s,endCol:s,startOffset:n,endOffset:n}}_err(e){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(e)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(e){if(this.pos!==this.html.length-1){const i=this.html.charCodeAt(this.pos+1);if(_L(i))return this.pos++,this._addGap(),bL(e,i)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,O.EOF;return this._err(te.surrogateInInputStream),e}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(e,i){this.html.length>0?this.html+=e:this.html=e,this.endOfChunkHit=!1,this.lastChunkWritten=i}insertHtmlAtCurrentPos(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(e,i){if(this.pos+e.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(i)return this.html.startsWith(e,this.pos);for(let s=0;s<e.length;s++)if((this.html.charCodeAt(this.pos+s)|32)!==e.charCodeAt(s))return!1;return!0}peek(e){const i=this.pos+e;if(i>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,O.EOF;const s=this.html.charCodeAt(i);return s===O.CARRIAGE_RETURN?O.LINE_FEED:s}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,O.EOF;let e=this.html.charCodeAt(this.pos);return e===O.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,O.LINE_FEED):e===O.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,VA(e)&&(e=this._processSurrogate(e)),this.handler.onParseError===null||e>31&&e<127||e===O.LINE_FEED||e===O.CARRIAGE_RETURN||e>159&&e<64976||this._checkForProblematicCharacters(e),e)}_checkForProblematicCharacters(e){WA(e)?this._err(te.controlCharacterInInputStream):zA(e)&&this._err(te.noncharacterInInputStream)}retreat(e){for(this.pos-=e;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var Nt;(function(r){r[r.CHARACTER=0]="CHARACTER",r[r.NULL_CHARACTER=1]="NULL_CHARACTER",r[r.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",r[r.START_TAG=3]="START_TAG",r[r.END_TAG=4]="END_TAG",r[r.COMMENT=5]="COMMENT",r[r.DOCTYPE=6]="DOCTYPE",r[r.EOF=7]="EOF",r[r.HIBERNATION=8]="HIBERNATION"})(Nt=Nt||(Nt={}));function YA(r,e){for(let i=r.attrs.length-1;i>=0;i--)if(r.attrs[i].name===e)return r.attrs[i].value;return null}var se;(function(r){r.HTML="http://www.w3.org/1999/xhtml",r.MATHML="http://www.w3.org/1998/Math/MathML",r.SVG="http://www.w3.org/2000/svg",r.XLINK="http://www.w3.org/1999/xlink",r.XML="http://www.w3.org/XML/1998/namespace",r.XMLNS="http://www.w3.org/2000/xmlns/"})(se=se||(se={}));var Uo;(function(r){r.TYPE="type",r.ACTION="action",r.ENCODING="encoding",r.PROMPT="prompt",r.NAME="name",r.COLOR="color",r.FACE="face",r.SIZE="size"})(Uo=Uo||(Uo={}));var Br;(function(r){r.NO_QUIRKS="no-quirks",r.QUIRKS="quirks",r.LIMITED_QUIRKS="limited-quirks"})(Br=Br||(Br={}));var X;(function(r){r.A="a",r.ADDRESS="address",r.ANNOTATION_XML="annotation-xml",r.APPLET="applet",r.AREA="area",r.ARTICLE="article",r.ASIDE="aside",r.B="b",r.BASE="base",r.BASEFONT="basefont",r.BGSOUND="bgsound",r.BIG="big",r.BLOCKQUOTE="blockquote",r.BODY="body",r.BR="br",r.BUTTON="button",r.CAPTION="caption",r.CENTER="center",r.CODE="code",r.COL="col",r.COLGROUP="colgroup",r.DD="dd",r.DESC="desc",r.DETAILS="details",r.DIALOG="dialog",r.DIR="dir",r.DIV="div",r.DL="dl",r.DT="dt",r.EM="em",r.EMBED="embed",r.FIELDSET="fieldset",r.FIGCAPTION="figcaption",r.FIGURE="figure",r.FONT="font",r.FOOTER="footer",r.FOREIGN_OBJECT="foreignObject",r.FORM="form",r.FRAME="frame",r.FRAMESET="frameset",r.H1="h1",r.H2="h2",r.H3="h3",r.H4="h4",r.H5="h5",r.H6="h6",r.HEAD="head",r.HEADER="header",r.HGROUP="hgroup",r.HR="hr",r.HTML="html",r.I="i",r.IMG="img",r.IMAGE="image",r.INPUT="input",r.IFRAME="iframe",r.KEYGEN="keygen",r.LABEL="label",r.LI="li",r.LINK="link",r.LISTING="listing",r.MAIN="main",r.MALIGNMARK="malignmark",r.MARQUEE="marquee",r.MATH="math",r.MENU="menu",r.META="meta",r.MGLYPH="mglyph",r.MI="mi",r.MO="mo",r.MN="mn",r.MS="ms",r.MTEXT="mtext",r.NAV="nav",r.NOBR="nobr",r.NOFRAMES="noframes",r.NOEMBED="noembed",r.NOSCRIPT="noscript",r.OBJECT="object",r.OL="ol",r.OPTGROUP="optgroup",r.OPTION="option",r.P="p",r.PARAM="param",r.PLAINTEXT="plaintext",r.PRE="pre",r.RB="rb",r.RP="rp",r.RT="rt",r.RTC="rtc",r.RUBY="ruby",r.S="s",r.SCRIPT="script",r.SECTION="section",r.SELECT="select",r.SOURCE="source",r.SMALL="small",r.SPAN="span",r.STRIKE="strike",r.STRONG="strong",r.STYLE="style",r.SUB="sub",r.SUMMARY="summary",r.SUP="sup",r.TABLE="table",r.TBODY="tbody",r.TEMPLATE="template",r.TEXTAREA="textarea",r.TFOOT="tfoot",r.TD="td",r.TH="th",r.THEAD="thead",r.TITLE="title",r.TR="tr",r.TRACK="track",r.TT="tt",r.U="u",r.UL="ul",r.SVG="svg",r.VAR="var",r.WBR="wbr",r.XMP="xmp"})(X=X||(X={}));var _;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.A=1]="A",r[r.ADDRESS=2]="ADDRESS",r[r.ANNOTATION_XML=3]="ANNOTATION_XML",r[r.APPLET=4]="APPLET",r[r.AREA=5]="AREA",r[r.ARTICLE=6]="ARTICLE",r[r.ASIDE=7]="ASIDE",r[r.B=8]="B",r[r.BASE=9]="BASE",r[r.BASEFONT=10]="BASEFONT",r[r.BGSOUND=11]="BGSOUND",r[r.BIG=12]="BIG",r[r.BLOCKQUOTE=13]="BLOCKQUOTE",r[r.BODY=14]="BODY",r[r.BR=15]="BR",r[r.BUTTON=16]="BUTTON",r[r.CAPTION=17]="CAPTION",r[r.CENTER=18]="CENTER",r[r.CODE=19]="CODE",r[r.COL=20]="COL",r[r.COLGROUP=21]="COLGROUP",r[r.DD=22]="DD",r[r.DESC=23]="DESC",r[r.DETAILS=24]="DETAILS",r[r.DIALOG=25]="DIALOG",r[r.DIR=26]="DIR",r[r.DIV=27]="DIV",r[r.DL=28]="DL",r[r.DT=29]="DT",r[r.EM=30]="EM",r[r.EMBED=31]="EMBED",r[r.FIELDSET=32]="FIELDSET",r[r.FIGCAPTION=33]="FIGCAPTION",r[r.FIGURE=34]="FIGURE",r[r.FONT=35]="FONT",r[r.FOOTER=36]="FOOTER",r[r.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",r[r.FORM=38]="FORM",r[r.FRAME=39]="FRAME",r[r.FRAMESET=40]="FRAMESET",r[r.H1=41]="H1",r[r.H2=42]="H2",r[r.H3=43]="H3",r[r.H4=44]="H4",r[r.H5=45]="H5",r[r.H6=46]="H6",r[r.HEAD=47]="HEAD",r[r.HEADER=48]="HEADER",r[r.HGROUP=49]="HGROUP",r[r.HR=50]="HR",r[r.HTML=51]="HTML",r[r.I=52]="I",r[r.IMG=53]="IMG",r[r.IMAGE=54]="IMAGE",r[r.INPUT=55]="INPUT",r[r.IFRAME=56]="IFRAME",r[r.KEYGEN=57]="KEYGEN",r[r.LABEL=58]="LABEL",r[r.LI=59]="LI",r[r.LINK=60]="LINK",r[r.LISTING=61]="LISTING",r[r.MAIN=62]="MAIN",r[r.MALIGNMARK=63]="MALIGNMARK",r[r.MARQUEE=64]="MARQUEE",r[r.MATH=65]="MATH",r[r.MENU=66]="MENU",r[r.META=67]="META",r[r.MGLYPH=68]="MGLYPH",r[r.MI=69]="MI",r[r.MO=70]="MO",r[r.MN=71]="MN",r[r.MS=72]="MS",r[r.MTEXT=73]="MTEXT",r[r.NAV=74]="NAV",r[r.NOBR=75]="NOBR",r[r.NOFRAMES=76]="NOFRAMES",r[r.NOEMBED=77]="NOEMBED",r[r.NOSCRIPT=78]="NOSCRIPT",r[r.OBJECT=79]="OBJECT",r[r.OL=80]="OL",r[r.OPTGROUP=81]="OPTGROUP",r[r.OPTION=82]="OPTION",r[r.P=83]="P",r[r.PARAM=84]="PARAM",r[r.PLAINTEXT=85]="PLAINTEXT",r[r.PRE=86]="PRE",r[r.RB=87]="RB",r[r.RP=88]="RP",r[r.RT=89]="RT",r[r.RTC=90]="RTC",r[r.RUBY=91]="RUBY",r[r.S=92]="S",r[r.SCRIPT=93]="SCRIPT",r[r.SECTION=94]="SECTION",r[r.SELECT=95]="SELECT",r[r.SOURCE=96]="SOURCE",r[r.SMALL=97]="SMALL",r[r.SPAN=98]="SPAN",r[r.STRIKE=99]="STRIKE",r[r.STRONG=100]="STRONG",r[r.STYLE=101]="STYLE",r[r.SUB=102]="SUB",r[r.SUMMARY=103]="SUMMARY",r[r.SUP=104]="SUP",r[r.TABLE=105]="TABLE",r[r.TBODY=106]="TBODY",r[r.TEMPLATE=107]="TEMPLATE",r[r.TEXTAREA=108]="TEXTAREA",r[r.TFOOT=109]="TFOOT",r[r.TD=110]="TD",r[r.TH=111]="TH",r[r.THEAD=112]="THEAD",r[r.TITLE=113]="TITLE",r[r.TR=114]="TR",r[r.TRACK=115]="TRACK",r[r.TT=116]="TT",r[r.U=117]="U",r[r.UL=118]="UL",r[r.SVG=119]="SVG",r[r.VAR=120]="VAR",r[r.WBR=121]="WBR",r[r.XMP=122]="XMP"})(_=_||(_={}));const $L=new Map([[X.A,_.A],[X.ADDRESS,_.ADDRESS],[X.ANNOTATION_XML,_.ANNOTATION_XML],[X.APPLET,_.APPLET],[X.AREA,_.AREA],[X.ARTICLE,_.ARTICLE],[X.ASIDE,_.ASIDE],[X.B,_.B],[X.BASE,_.BASE],[X.BASEFONT,_.BASEFONT],[X.BGSOUND,_.BGSOUND],[X.BIG,_.BIG],[X.BLOCKQUOTE,_.BLOCKQUOTE],[X.BODY,_.BODY],[X.BR,_.BR],[X.BUTTON,_.BUTTON],[X.CAPTION,_.CAPTION],[X.CENTER,_.CENTER],[X.CODE,_.CODE],[X.COL,_.COL],[X.COLGROUP,_.COLGROUP],[X.DD,_.DD],[X.DESC,_.DESC],[X.DETAILS,_.DETAILS],[X.DIALOG,_.DIALOG],[X.DIR,_.DIR],[X.DIV,_.DIV],[X.DL,_.DL],[X.DT,_.DT],[X.EM,_.EM],[X.EMBED,_.EMBED],[X.FIELDSET,_.FIELDSET],[X.FIGCAPTION,_.FIGCAPTION],[X.FIGURE,_.FIGURE],[X.FONT,_.FONT],[X.FOOTER,_.FOOTER],[X.FOREIGN_OBJECT,_.FOREIGN_OBJECT],[X.FORM,_.FORM],[X.FRAME,_.FRAME],[X.FRAMESET,_.FRAMESET],[X.H1,_.H1],[X.H2,_.H2],[X.H3,_.H3],[X.H4,_.H4],[X.H5,_.H5],[X.H6,_.H6],[X.HEAD,_.HEAD],[X.HEADER,_.HEADER],[X.HGROUP,_.HGROUP],[X.HR,_.HR],[X.HTML,_.HTML],[X.I,_.I],[X.IMG,_.IMG],[X.IMAGE,_.IMAGE],[X.INPUT,_.INPUT],[X.IFRAME,_.IFRAME],[X.KEYGEN,_.KEYGEN],[X.LABEL,_.LABEL],[X.LI,_.LI],[X.LINK,_.LINK],[X.LISTING,_.LISTING],[X.MAIN,_.MAIN],[X.MALIGNMARK,_.MALIGNMARK],[X.MARQUEE,_.MARQUEE],[X.MATH,_.MATH],[X.MENU,_.MENU],[X.META,_.META],[X.MGLYPH,_.MGLYPH],[X.MI,_.MI],[X.MO,_.MO],[X.MN,_.MN],[X.MS,_.MS],[X.MTEXT,_.MTEXT],[X.NAV,_.NAV],[X.NOBR,_.NOBR],[X.NOFRAMES,_.NOFRAMES],[X.NOEMBED,_.NOEMBED],[X.NOSCRIPT,_.NOSCRIPT],[X.OBJECT,_.OBJECT],[X.OL,_.OL],[X.OPTGROUP,_.OPTGROUP],[X.OPTION,_.OPTION],[X.P,_.P],[X.PARAM,_.PARAM],[X.PLAINTEXT,_.PLAINTEXT],[X.PRE,_.PRE],[X.RB,_.RB],[X.RP,_.RP],[X.RT,_.RT],[X.RTC,_.RTC],[X.RUBY,_.RUBY],[X.S,_.S],[X.SCRIPT,_.SCRIPT],[X.SECTION,_.SECTION],[X.SELECT,_.SELECT],[X.SOURCE,_.SOURCE],[X.SMALL,_.SMALL],[X.SPAN,_.SPAN],[X.STRIKE,_.STRIKE],[X.STRONG,_.STRONG],[X.STYLE,_.STYLE],[X.SUB,_.SUB],[X.SUMMARY,_.SUMMARY],[X.SUP,_.SUP],[X.TABLE,_.TABLE],[X.TBODY,_.TBODY],[X.TEMPLATE,_.TEMPLATE],[X.TEXTAREA,_.TEXTAREA],[X.TFOOT,_.TFOOT],[X.TD,_.TD],[X.TH,_.TH],[X.THEAD,_.THEAD],[X.TITLE,_.TITLE],[X.TR,_.TR],[X.TRACK,_.TRACK],[X.TT,_.TT],[X.U,_.U],[X.UL,_.UL],[X.SVG,_.SVG],[X.VAR,_.VAR],[X.WBR,_.WBR],[X.XMP,_.XMP]]);function Gf(r){var e;return(e=$L.get(r))!==null&&e!==void 0?e:_.UNKNOWN}const pe=_,vL={[se.HTML]:new Set([pe.ADDRESS,pe.APPLET,pe.AREA,pe.ARTICLE,pe.ASIDE,pe.BASE,pe.BASEFONT,pe.BGSOUND,pe.BLOCKQUOTE,pe.BODY,pe.BR,pe.BUTTON,pe.CAPTION,pe.CENTER,pe.COL,pe.COLGROUP,pe.DD,pe.DETAILS,pe.DIR,pe.DIV,pe.DL,pe.DT,pe.EMBED,pe.FIELDSET,pe.FIGCAPTION,pe.FIGURE,pe.FOOTER,pe.FORM,pe.FRAME,pe.FRAMESET,pe.H1,pe.H2,pe.H3,pe.H4,pe.H5,pe.H6,pe.HEAD,pe.HEADER,pe.HGROUP,pe.HR,pe.HTML,pe.IFRAME,pe.IMG,pe.INPUT,pe.LI,pe.LINK,pe.LISTING,pe.MAIN,pe.MARQUEE,pe.MENU,pe.META,pe.NAV,pe.NOEMBED,pe.NOFRAMES,pe.NOSCRIPT,pe.OBJECT,pe.OL,pe.P,pe.PARAM,pe.PLAINTEXT,pe.PRE,pe.SCRIPT,pe.SECTION,pe.SELECT,pe.SOURCE,pe.STYLE,pe.SUMMARY,pe.TABLE,pe.TBODY,pe.TD,pe.TEMPLATE,pe.TEXTAREA,pe.TFOOT,pe.TH,pe.THEAD,pe.TITLE,pe.TR,pe.TRACK,pe.UL,pe.WBR,pe.XMP]),[se.MATHML]:new Set([pe.MI,pe.MO,pe.MN,pe.MS,pe.MTEXT,pe.ANNOTATION_XML]),[se.SVG]:new Set([pe.TITLE,pe.FOREIGN_OBJECT,pe.DESC]),[se.XLINK]:new Set,[se.XML]:new Set,[se.XMLNS]:new Set};function XA(r){return r===pe.H1||r===pe.H2||r===pe.H3||r===pe.H4||r===pe.H5||r===pe.H6}const yL=new Set([X.STYLE,X.SCRIPT,X.XMP,X.IFRAME,X.NOEMBED,X.NOFRAMES,X.PLAINTEXT]);function SL(r,e){return yL.has(r)||e&&r===X.NOSCRIPT}const IL=new Map([[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);var N;(function(r){r[r.DATA=0]="DATA",r[r.RCDATA=1]="RCDATA",r[r.RAWTEXT=2]="RAWTEXT",r[r.SCRIPT_DATA=3]="SCRIPT_DATA",r[r.PLAINTEXT=4]="PLAINTEXT",r[r.TAG_OPEN=5]="TAG_OPEN",r[r.END_TAG_OPEN=6]="END_TAG_OPEN",r[r.TAG_NAME=7]="TAG_NAME",r[r.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",r[r.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",r[r.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",r[r.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",r[r.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",r[r.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",r[r.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",r[r.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",r[r.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",r[r.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",r[r.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",r[r.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",r[r.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",r[r.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",r[r.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",r[r.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",r[r.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",r[r.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",r[r.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",r[r.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",r[r.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",r[r.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",r[r.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",r[r.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",r[r.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",r[r.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",r[r.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",r[r.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",r[r.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",r[r.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",r[r.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",r[r.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",r[r.BOGUS_COMMENT=40]="BOGUS_COMMENT",r[r.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",r[r.COMMENT_START=42]="COMMENT_START",r[r.COMMENT_START_DASH=43]="COMMENT_START_DASH",r[r.COMMENT=44]="COMMENT",r[r.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",r[r.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",r[r.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",r[r.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",r[r.COMMENT_END_DASH=49]="COMMENT_END_DASH",r[r.COMMENT_END=50]="COMMENT_END",r[r.COMMENT_END_BANG=51]="COMMENT_END_BANG",r[r.DOCTYPE=52]="DOCTYPE",r[r.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",r[r.DOCTYPE_NAME=54]="DOCTYPE_NAME",r[r.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",r[r.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",r[r.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",r[r.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",r[r.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",r[r.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",r[r.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",r[r.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",r[r.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",r[r.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",r[r.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",r[r.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",r[r.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",r[r.CDATA_SECTION=68]="CDATA_SECTION",r[r.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",r[r.CDATA_SECTION_END=70]="CDATA_SECTION_END",r[r.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",r[r.NAMED_CHARACTER_REFERENCE=72]="NAMED_CHARACTER_REFERENCE",r[r.AMBIGUOUS_AMPERSAND=73]="AMBIGUOUS_AMPERSAND",r[r.NUMERIC_CHARACTER_REFERENCE=74]="NUMERIC_CHARACTER_REFERENCE",r[r.HEXADEMICAL_CHARACTER_REFERENCE_START=75]="HEXADEMICAL_CHARACTER_REFERENCE_START",r[r.HEXADEMICAL_CHARACTER_REFERENCE=76]="HEXADEMICAL_CHARACTER_REFERENCE",r[r.DECIMAL_CHARACTER_REFERENCE=77]="DECIMAL_CHARACTER_REFERENCE",r[r.NUMERIC_CHARACTER_REFERENCE_END=78]="NUMERIC_CHARACTER_REFERENCE_END"})(N||(N={}));const Fr={DATA:N.DATA,RCDATA:N.RCDATA,RAWTEXT:N.RAWTEXT,SCRIPT_DATA:N.SCRIPT_DATA,PLAINTEXT:N.PLAINTEXT,CDATA_SECTION:N.CDATA_SECTION};function wc(r){return r>=O.DIGIT_0&&r<=O.DIGIT_9}function yc(r){return r>=O.LATIN_CAPITAL_A&&r<=O.LATIN_CAPITAL_Z}function kL(r){return r>=O.LATIN_SMALL_A&&r<=O.LATIN_SMALL_Z}function wo(r){return kL(r)||yc(r)}function r_(r){return wo(r)||wc(r)}function jA(r){return r>=O.LATIN_CAPITAL_A&&r<=O.LATIN_CAPITAL_F}function KA(r){return r>=O.LATIN_SMALL_A&&r<=O.LATIN_SMALL_F}function AL(r){return wc(r)||jA(r)||KA(r)}function Pd(r){return r+32}function qA(r){return r===O.SPACE||r===O.LINE_FEED||r===O.TABULATION||r===O.FORM_FEED}function CL(r){return r===O.EQUALS_SIGN||r_(r)}function X2(r){return qA(r)||r===O.SOLIDUS||r===O.GREATER_THAN_SIGN}let OL=class{constructor(e,i){this.options=e,this.handler=i,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=N.DATA,this.returnState=N.DATA,this.charRefCode=-1,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new EL(i),this.currentLocation=this.getCurrentLocation(-1)}_err(e){var i,s;(s=(i=this.handler).onParseError)===null||s===void 0||s.call(i,this.preprocessor.getError(e))}getCurrentLocation(e){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-e,startOffset:this.preprocessor.offset-e,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const e=this._consume();this._ensureHibernation()||this._callState(e)}this.inLoop=!1}}pause(){this.paused=!0}resume(e){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||e==null||e())}write(e,i,s){this.active=!0,this.preprocessor.write(e,i),this._runParsingLoop(),this.paused||s==null||s()}insertHtmlAtCurrentPos(e){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(e),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this._unconsume(this.consumedAfterSnapshot),this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_unconsume(e){this.consumedAfterSnapshot-=e,this.preprocessor.retreat(e)}_reconsumeInState(e,i){this.state=e,this._callState(i)}_advanceBy(e){this.consumedAfterSnapshot+=e;for(let i=0;i<e;i++)this.preprocessor.advance()}_consumeSequenceIfMatch(e,i){return this.preprocessor.startsWith(e,i)?(this._advanceBy(e.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:Nt.START_TAG,tagName:"",tagID:_.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:Nt.END_TAG,tagName:"",tagID:_.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(e){this.currentToken={type:Nt.COMMENT,data:"",location:this.getCurrentLocation(e)}}_createDoctypeToken(e){this.currentToken={type:Nt.DOCTYPE,name:e,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(e,i){this.currentCharacterToken={type:e,chars:i,location:this.currentLocation}}_createAttr(e){this.currentAttr={name:e,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var e,i;const s=this.currentToken;if(YA(s,this.currentAttr.name)===null){if(s.attrs.push(this.currentAttr),s.location&&this.currentLocation){const n=(e=(i=s.location).attrs)!==null&&e!==void 0?e:i.attrs=Object.create(null);n[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(te.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(e){this._emitCurrentCharacterToken(e.location),this.currentToken=null,e.location&&(e.location.endLine=this.preprocessor.line,e.location.endCol=this.preprocessor.col+1,e.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const e=this.currentToken;this.prepareToken(e),e.tagID=Gf(e.tagName),e.type===Nt.START_TAG?(this.lastStartTagName=e.tagName,this.handler.onStartTag(e)):(e.attrs.length>0&&this._err(te.endTagWithAttributes),e.selfClosing&&this._err(te.endTagWithTrailingSolidus),this.handler.onEndTag(e)),this.preprocessor.dropParsedChunk()}emitCurrentComment(e){this.prepareToken(e),this.handler.onComment(e),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(e){this.prepareToken(e),this.handler.onDoctype(e),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(e){if(this.currentCharacterToken){switch(e&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=e.startLine,this.currentCharacterToken.location.endCol=e.startCol,this.currentCharacterToken.location.endOffset=e.startOffset),this.currentCharacterToken.type){case Nt.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case Nt.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case Nt.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const e=this.getCurrentLocation(0);e&&(e.endLine=e.startLine,e.endCol=e.startCol,e.endOffset=e.startOffset),this._emitCurrentCharacterToken(e),this.handler.onEof({type:Nt.EOF,location:e}),this.active=!1}_appendCharToCurrentCharacterToken(e,i){if(this.currentCharacterToken)if(this.currentCharacterToken.type!==e)this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();else{this.currentCharacterToken.chars+=i;return}this._createCharacterToken(e,i)}_emitCodePoint(e){const i=qA(e)?Nt.WHITESPACE_CHARACTER:e===O.NULL?Nt.NULL_CHARACTER:Nt.CHARACTER;this._appendCharToCurrentCharacterToken(i,String.fromCodePoint(e))}_emitChars(e){this._appendCharToCurrentCharacterToken(Nt.CHARACTER,e)}_matchNamedCharacterReference(e){let i=null,s=0,n=!1;for(let l=0,u=Oo[0];l>=0&&(l=nA(Oo,u,l+1,e),!(l<0));e=this._consume()){s+=1,u=Oo[l];const c=u&to.VALUE_LENGTH;if(c){const h=(c>>14)-1;if(e!==O.SEMICOLON&&this._isCharacterReferenceInAttribute()&&CL(this.preprocessor.peek(1))?(i=[O.AMPERSAND],l+=h):(i=h===0?[Oo[l]&~to.VALUE_LENGTH]:h===1?[Oo[++l]]:[Oo[++l],Oo[++l]],s=0,n=e!==O.SEMICOLON),h===0){this._consume();break}}}return this._unconsume(s),n&&!this.preprocessor.endOfChunkHit&&this._err(te.missingSemicolonAfterCharacterReference),this._unconsume(1),i}_isCharacterReferenceInAttribute(){return this.returnState===N.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===N.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===N.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(e){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(e):this._emitCodePoint(e)}_callState(e){switch(this.state){case N.DATA:{this._stateData(e);break}case N.RCDATA:{this._stateRcdata(e);break}case N.RAWTEXT:{this._stateRawtext(e);break}case N.SCRIPT_DATA:{this._stateScriptData(e);break}case N.PLAINTEXT:{this._statePlaintext(e);break}case N.TAG_OPEN:{this._stateTagOpen(e);break}case N.END_TAG_OPEN:{this._stateEndTagOpen(e);break}case N.TAG_NAME:{this._stateTagName(e);break}case N.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(e);break}case N.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(e);break}case N.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(e);break}case N.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(e);break}case N.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(e);break}case N.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(e);break}case N.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(e);break}case N.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(e);break}case N.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(e);break}case N.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(e);break}case N.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(e);break}case N.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(e);break}case N.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(e);break}case N.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(e);break}case N.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(e);break}case N.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(e);break}case N.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(e);break}case N.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(e);break}case N.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(e);break}case N.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(e);break}case N.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(e);break}case N.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(e);break}case N.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(e);break}case N.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(e);break}case N.ATTRIBUTE_NAME:{this._stateAttributeName(e);break}case N.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(e);break}case N.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(e);break}case N.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(e);break}case N.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(e);break}case N.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(e);break}case N.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(e);break}case N.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(e);break}case N.BOGUS_COMMENT:{this._stateBogusComment(e);break}case N.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(e);break}case N.COMMENT_START:{this._stateCommentStart(e);break}case N.COMMENT_START_DASH:{this._stateCommentStartDash(e);break}case N.COMMENT:{this._stateComment(e);break}case N.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(e);break}case N.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(e);break}case N.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(e);break}case N.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(e);break}case N.COMMENT_END_DASH:{this._stateCommentEndDash(e);break}case N.COMMENT_END:{this._stateCommentEnd(e);break}case N.COMMENT_END_BANG:{this._stateCommentEndBang(e);break}case N.DOCTYPE:{this._stateDoctype(e);break}case N.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(e);break}case N.DOCTYPE_NAME:{this._stateDoctypeName(e);break}case N.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(e);break}case N.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(e);break}case N.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(e);break}case N.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(e);break}case N.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(e);break}case N.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(e);break}case N.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(e);break}case N.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(e);break}case N.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(e);break}case N.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(e);break}case N.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(e);break}case N.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(e);break}case N.BOGUS_DOCTYPE:{this._stateBogusDoctype(e);break}case N.CDATA_SECTION:{this._stateCdataSection(e);break}case N.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(e);break}case N.CDATA_SECTION_END:{this._stateCdataSectionEnd(e);break}case N.CHARACTER_REFERENCE:{this._stateCharacterReference(e);break}case N.NAMED_CHARACTER_REFERENCE:{this._stateNamedCharacterReference(e);break}case N.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(e);break}case N.NUMERIC_CHARACTER_REFERENCE:{this._stateNumericCharacterReference(e);break}case N.HEXADEMICAL_CHARACTER_REFERENCE_START:{this._stateHexademicalCharacterReferenceStart(e);break}case N.HEXADEMICAL_CHARACTER_REFERENCE:{this._stateHexademicalCharacterReference(e);break}case N.DECIMAL_CHARACTER_REFERENCE:{this._stateDecimalCharacterReference(e);break}case N.NUMERIC_CHARACTER_REFERENCE_END:{this._stateNumericCharacterReferenceEnd(e);break}default:throw new Error("Unknown state")}}_stateData(e){switch(e){case O.LESS_THAN_SIGN:{this.state=N.TAG_OPEN;break}case O.AMPERSAND:{this.returnState=N.DATA,this.state=N.CHARACTER_REFERENCE;break}case O.NULL:{this._err(te.unexpectedNullCharacter),this._emitCodePoint(e);break}case O.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRcdata(e){switch(e){case O.AMPERSAND:{this.returnState=N.RCDATA,this.state=N.CHARACTER_REFERENCE;break}case O.LESS_THAN_SIGN:{this.state=N.RCDATA_LESS_THAN_SIGN;break}case O.NULL:{this._err(te.unexpectedNullCharacter),this._emitChars(ri);break}case O.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRawtext(e){switch(e){case O.LESS_THAN_SIGN:{this.state=N.RAWTEXT_LESS_THAN_SIGN;break}case O.NULL:{this._err(te.unexpectedNullCharacter),this._emitChars(ri);break}case O.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptData(e){switch(e){case O.LESS_THAN_SIGN:{this.state=N.SCRIPT_DATA_LESS_THAN_SIGN;break}case O.NULL:{this._err(te.unexpectedNullCharacter),this._emitChars(ri);break}case O.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_statePlaintext(e){switch(e){case O.NULL:{this._err(te.unexpectedNullCharacter),this._emitChars(ri);break}case O.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateTagOpen(e){if(wo(e))this._createStartTagToken(),this.state=N.TAG_NAME,this._stateTagName(e);else switch(e){case O.EXCLAMATION_MARK:{this.state=N.MARKUP_DECLARATION_OPEN;break}case O.SOLIDUS:{this.state=N.END_TAG_OPEN;break}case O.QUESTION_MARK:{this._err(te.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=N.BOGUS_COMMENT,this._stateBogusComment(e);break}case O.EOF:{this._err(te.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(te.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=N.DATA,this._stateData(e)}}_stateEndTagOpen(e){if(wo(e))this._createEndTagToken(),this.state=N.TAG_NAME,this._stateTagName(e);else switch(e){case O.GREATER_THAN_SIGN:{this._err(te.missingEndTagName),this.state=N.DATA;break}case O.EOF:{this._err(te.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(te.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=N.BOGUS_COMMENT,this._stateBogusComment(e)}}_stateTagName(e){const i=this.currentToken;switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:{this.state=N.BEFORE_ATTRIBUTE_NAME;break}case O.SOLIDUS:{this.state=N.SELF_CLOSING_START_TAG;break}case O.GREATER_THAN_SIGN:{this.state=N.DATA,this.emitCurrentTagToken();break}case O.NULL:{this._err(te.unexpectedNullCharacter),i.tagName+=ri;break}case O.EOF:{this._err(te.eofInTag),this._emitEOFToken();break}default:i.tagName+=String.fromCodePoint(yc(e)?Pd(e):e)}}_stateRcdataLessThanSign(e){e===O.SOLIDUS?this.state=N.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=N.RCDATA,this._stateRcdata(e))}_stateRcdataEndTagOpen(e){wo(e)?(this.state=N.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(e)):(this._emitChars("</"),this.state=N.RCDATA,this._stateRcdata(e))}handleSpecialEndTag(e){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const i=this.currentToken;switch(i.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=N.BEFORE_ATTRIBUTE_NAME,!1;case O.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=N.SELF_CLOSING_START_TAG,!1;case O.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=N.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=N.RCDATA,this._stateRcdata(e))}_stateRawtextLessThanSign(e){e===O.SOLIDUS?this.state=N.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=N.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagOpen(e){wo(e)?(this.state=N.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(e)):(this._emitChars("</"),this.state=N.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=N.RAWTEXT,this._stateRawtext(e))}_stateScriptDataLessThanSign(e){switch(e){case O.SOLIDUS:{this.state=N.SCRIPT_DATA_END_TAG_OPEN;break}case O.EXCLAMATION_MARK:{this.state=N.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=N.SCRIPT_DATA,this._stateScriptData(e)}}_stateScriptDataEndTagOpen(e){wo(e)?(this.state=N.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(e)):(this._emitChars("</"),this.state=N.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=N.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStart(e){e===O.HYPHEN_MINUS?(this.state=N.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=N.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStartDash(e){e===O.HYPHEN_MINUS?(this.state=N.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=N.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscaped(e){switch(e){case O.HYPHEN_MINUS:{this.state=N.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case O.LESS_THAN_SIGN:{this.state=N.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case O.NULL:{this._err(te.unexpectedNullCharacter),this._emitChars(ri);break}case O.EOF:{this._err(te.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataEscapedDash(e){switch(e){case O.HYPHEN_MINUS:{this.state=N.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case O.LESS_THAN_SIGN:{this.state=N.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case O.NULL:{this._err(te.unexpectedNullCharacter),this.state=N.SCRIPT_DATA_ESCAPED,this._emitChars(ri);break}case O.EOF:{this._err(te.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=N.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedDashDash(e){switch(e){case O.HYPHEN_MINUS:{this._emitChars("-");break}case O.LESS_THAN_SIGN:{this.state=N.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case O.GREATER_THAN_SIGN:{this.state=N.SCRIPT_DATA,this._emitChars(">");break}case O.NULL:{this._err(te.unexpectedNullCharacter),this.state=N.SCRIPT_DATA_ESCAPED,this._emitChars(ri);break}case O.EOF:{this._err(te.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=N.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedLessThanSign(e){e===O.SOLIDUS?this.state=N.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:wo(e)?(this._emitChars("<"),this.state=N.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(e)):(this._emitChars("<"),this.state=N.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagOpen(e){wo(e)?(this.state=N.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(e)):(this._emitChars("</"),this.state=N.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=N.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscapeStart(e){if(this.preprocessor.startsWith(Nr.SCRIPT,!1)&&X2(this.preprocessor.peek(Nr.SCRIPT.length))){this._emitCodePoint(e);for(let i=0;i<Nr.SCRIPT.length;i++)this._emitCodePoint(this._consume());this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=N.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscaped(e){switch(e){case O.HYPHEN_MINUS:{this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case O.LESS_THAN_SIGN:{this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case O.NULL:{this._err(te.unexpectedNullCharacter),this._emitChars(ri);break}case O.EOF:{this._err(te.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDash(e){switch(e){case O.HYPHEN_MINUS:{this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case O.LESS_THAN_SIGN:{this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case O.NULL:{this._err(te.unexpectedNullCharacter),this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(ri);break}case O.EOF:{this._err(te.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDashDash(e){switch(e){case O.HYPHEN_MINUS:{this._emitChars("-");break}case O.LESS_THAN_SIGN:{this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case O.GREATER_THAN_SIGN:{this.state=N.SCRIPT_DATA,this._emitChars(">");break}case O.NULL:{this._err(te.unexpectedNullCharacter),this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(ri);break}case O.EOF:{this._err(te.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedLessThanSign(e){e===O.SOLIDUS?(this.state=N.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateScriptDataDoubleEscapeEnd(e){if(this.preprocessor.startsWith(Nr.SCRIPT,!1)&&X2(this.preprocessor.peek(Nr.SCRIPT.length))){this._emitCodePoint(e);for(let i=0;i<Nr.SCRIPT.length;i++)this._emitCodePoint(this._consume());this.state=N.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=N.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateBeforeAttributeName(e){switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:break;case O.SOLIDUS:case O.GREATER_THAN_SIGN:case O.EOF:{this.state=N.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case O.EQUALS_SIGN:{this._err(te.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=N.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=N.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateAttributeName(e){switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:case O.SOLIDUS:case O.GREATER_THAN_SIGN:case O.EOF:{this._leaveAttrName(),this.state=N.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case O.EQUALS_SIGN:{this._leaveAttrName(),this.state=N.BEFORE_ATTRIBUTE_VALUE;break}case O.QUOTATION_MARK:case O.APOSTROPHE:case O.LESS_THAN_SIGN:{this._err(te.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(e);break}case O.NULL:{this._err(te.unexpectedNullCharacter),this.currentAttr.name+=ri;break}default:this.currentAttr.name+=String.fromCodePoint(yc(e)?Pd(e):e)}}_stateAfterAttributeName(e){switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:break;case O.SOLIDUS:{this.state=N.SELF_CLOSING_START_TAG;break}case O.EQUALS_SIGN:{this.state=N.BEFORE_ATTRIBUTE_VALUE;break}case O.GREATER_THAN_SIGN:{this.state=N.DATA,this.emitCurrentTagToken();break}case O.EOF:{this._err(te.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=N.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateBeforeAttributeValue(e){switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:break;case O.QUOTATION_MARK:{this.state=N.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case O.APOSTROPHE:{this.state=N.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case O.GREATER_THAN_SIGN:{this._err(te.missingAttributeValue),this.state=N.DATA,this.emitCurrentTagToken();break}default:this.state=N.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(e)}}_stateAttributeValueDoubleQuoted(e){switch(e){case O.QUOTATION_MARK:{this.state=N.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case O.AMPERSAND:{this.returnState=N.ATTRIBUTE_VALUE_DOUBLE_QUOTED,this.state=N.CHARACTER_REFERENCE;break}case O.NULL:{this._err(te.unexpectedNullCharacter),this.currentAttr.value+=ri;break}case O.EOF:{this._err(te.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueSingleQuoted(e){switch(e){case O.APOSTROPHE:{this.state=N.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case O.AMPERSAND:{this.returnState=N.ATTRIBUTE_VALUE_SINGLE_QUOTED,this.state=N.CHARACTER_REFERENCE;break}case O.NULL:{this._err(te.unexpectedNullCharacter),this.currentAttr.value+=ri;break}case O.EOF:{this._err(te.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueUnquoted(e){switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:{this._leaveAttrValue(),this.state=N.BEFORE_ATTRIBUTE_NAME;break}case O.AMPERSAND:{this.returnState=N.ATTRIBUTE_VALUE_UNQUOTED,this.state=N.CHARACTER_REFERENCE;break}case O.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=N.DATA,this.emitCurrentTagToken();break}case O.NULL:{this._err(te.unexpectedNullCharacter),this.currentAttr.value+=ri;break}case O.QUOTATION_MARK:case O.APOSTROPHE:case O.LESS_THAN_SIGN:case O.EQUALS_SIGN:case O.GRAVE_ACCENT:{this._err(te.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(e);break}case O.EOF:{this._err(te.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAfterAttributeValueQuoted(e){switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:{this._leaveAttrValue(),this.state=N.BEFORE_ATTRIBUTE_NAME;break}case O.SOLIDUS:{this._leaveAttrValue(),this.state=N.SELF_CLOSING_START_TAG;break}case O.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=N.DATA,this.emitCurrentTagToken();break}case O.EOF:{this._err(te.eofInTag),this._emitEOFToken();break}default:this._err(te.missingWhitespaceBetweenAttributes),this.state=N.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateSelfClosingStartTag(e){switch(e){case O.GREATER_THAN_SIGN:{const i=this.currentToken;i.selfClosing=!0,this.state=N.DATA,this.emitCurrentTagToken();break}case O.EOF:{this._err(te.eofInTag),this._emitEOFToken();break}default:this._err(te.unexpectedSolidusInTag),this.state=N.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateBogusComment(e){const i=this.currentToken;switch(e){case O.GREATER_THAN_SIGN:{this.state=N.DATA,this.emitCurrentComment(i);break}case O.EOF:{this.emitCurrentComment(i),this._emitEOFToken();break}case O.NULL:{this._err(te.unexpectedNullCharacter),i.data+=ri;break}default:i.data+=String.fromCodePoint(e)}}_stateMarkupDeclarationOpen(e){this._consumeSequenceIfMatch(Nr.DASH_DASH,!0)?(this._createCommentToken(Nr.DASH_DASH.length+1),this.state=N.COMMENT_START):this._consumeSequenceIfMatch(Nr.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(Nr.DOCTYPE.length+1),this.state=N.DOCTYPE):this._consumeSequenceIfMatch(Nr.CDATA_START,!0)?this.inForeignNode?this.state=N.CDATA_SECTION:(this._err(te.cdataInHtmlContent),this._createCommentToken(Nr.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=N.BOGUS_COMMENT):this._ensureHibernation()||(this._err(te.incorrectlyOpenedComment),this._createCommentToken(2),this.state=N.BOGUS_COMMENT,this._stateBogusComment(e))}_stateCommentStart(e){switch(e){case O.HYPHEN_MINUS:{this.state=N.COMMENT_START_DASH;break}case O.GREATER_THAN_SIGN:{this._err(te.abruptClosingOfEmptyComment),this.state=N.DATA;const i=this.currentToken;this.emitCurrentComment(i);break}default:this.state=N.COMMENT,this._stateComment(e)}}_stateCommentStartDash(e){const i=this.currentToken;switch(e){case O.HYPHEN_MINUS:{this.state=N.COMMENT_END;break}case O.GREATER_THAN_SIGN:{this._err(te.abruptClosingOfEmptyComment),this.state=N.DATA,this.emitCurrentComment(i);break}case O.EOF:{this._err(te.eofInComment),this.emitCurrentComment(i),this._emitEOFToken();break}default:i.data+="-",this.state=N.COMMENT,this._stateComment(e)}}_stateComment(e){const i=this.currentToken;switch(e){case O.HYPHEN_MINUS:{this.state=N.COMMENT_END_DASH;break}case O.LESS_THAN_SIGN:{i.data+="<",this.state=N.COMMENT_LESS_THAN_SIGN;break}case O.NULL:{this._err(te.unexpectedNullCharacter),i.data+=ri;break}case O.EOF:{this._err(te.eofInComment),this.emitCurrentComment(i),this._emitEOFToken();break}default:i.data+=String.fromCodePoint(e)}}_stateCommentLessThanSign(e){const i=this.currentToken;switch(e){case O.EXCLAMATION_MARK:{i.data+="!",this.state=N.COMMENT_LESS_THAN_SIGN_BANG;break}case O.LESS_THAN_SIGN:{i.data+="<";break}default:this.state=N.COMMENT,this._stateComment(e)}}_stateCommentLessThanSignBang(e){e===O.HYPHEN_MINUS?this.state=N.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=N.COMMENT,this._stateComment(e))}_stateCommentLessThanSignBangDash(e){e===O.HYPHEN_MINUS?this.state=N.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=N.COMMENT_END_DASH,this._stateCommentEndDash(e))}_stateCommentLessThanSignBangDashDash(e){e!==O.GREATER_THAN_SIGN&&e!==O.EOF&&this._err(te.nestedComment),this.state=N.COMMENT_END,this._stateCommentEnd(e)}_stateCommentEndDash(e){const i=this.currentToken;switch(e){case O.HYPHEN_MINUS:{this.state=N.COMMENT_END;break}case O.EOF:{this._err(te.eofInComment),this.emitCurrentComment(i),this._emitEOFToken();break}default:i.data+="-",this.state=N.COMMENT,this._stateComment(e)}}_stateCommentEnd(e){const i=this.currentToken;switch(e){case O.GREATER_THAN_SIGN:{this.state=N.DATA,this.emitCurrentComment(i);break}case O.EXCLAMATION_MARK:{this.state=N.COMMENT_END_BANG;break}case O.HYPHEN_MINUS:{i.data+="-";break}case O.EOF:{this._err(te.eofInComment),this.emitCurrentComment(i),this._emitEOFToken();break}default:i.data+="--",this.state=N.COMMENT,this._stateComment(e)}}_stateCommentEndBang(e){const i=this.currentToken;switch(e){case O.HYPHEN_MINUS:{i.data+="--!",this.state=N.COMMENT_END_DASH;break}case O.GREATER_THAN_SIGN:{this._err(te.incorrectlyClosedComment),this.state=N.DATA,this.emitCurrentComment(i);break}case O.EOF:{this._err(te.eofInComment),this.emitCurrentComment(i),this._emitEOFToken();break}default:i.data+="--!",this.state=N.COMMENT,this._stateComment(e)}}_stateDoctype(e){switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:{this.state=N.BEFORE_DOCTYPE_NAME;break}case O.GREATER_THAN_SIGN:{this.state=N.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e);break}case O.EOF:{this._err(te.eofInDoctype),this._createDoctypeToken(null);const i=this.currentToken;i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:this._err(te.missingWhitespaceBeforeDoctypeName),this.state=N.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e)}}_stateBeforeDoctypeName(e){if(yc(e))this._createDoctypeToken(String.fromCharCode(Pd(e))),this.state=N.DOCTYPE_NAME;else switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:break;case O.NULL:{this._err(te.unexpectedNullCharacter),this._createDoctypeToken(ri),this.state=N.DOCTYPE_NAME;break}case O.GREATER_THAN_SIGN:{this._err(te.missingDoctypeName),this._createDoctypeToken(null);const i=this.currentToken;i.forceQuirks=!0,this.emitCurrentDoctype(i),this.state=N.DATA;break}case O.EOF:{this._err(te.eofInDoctype),this._createDoctypeToken(null);const i=this.currentToken;i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(e)),this.state=N.DOCTYPE_NAME}}_stateDoctypeName(e){const i=this.currentToken;switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:{this.state=N.AFTER_DOCTYPE_NAME;break}case O.GREATER_THAN_SIGN:{this.state=N.DATA,this.emitCurrentDoctype(i);break}case O.NULL:{this._err(te.unexpectedNullCharacter),i.name+=ri;break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:i.name+=String.fromCodePoint(yc(e)?Pd(e):e)}}_stateAfterDoctypeName(e){const i=this.currentToken;switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:break;case O.GREATER_THAN_SIGN:{this.state=N.DATA,this.emitCurrentDoctype(i);break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(Nr.PUBLIC,!1)?this.state=N.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(Nr.SYSTEM,!1)?this.state=N.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(te.invalidCharacterSequenceAfterDoctypeName),i.forceQuirks=!0,this.state=N.BOGUS_DOCTYPE,this._stateBogusDoctype(e))}}_stateAfterDoctypePublicKeyword(e){const i=this.currentToken;switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:{this.state=N.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case O.QUOTATION_MARK:{this._err(te.missingWhitespaceAfterDoctypePublicKeyword),i.publicId="",this.state=N.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case O.APOSTROPHE:{this._err(te.missingWhitespaceAfterDoctypePublicKeyword),i.publicId="",this.state=N.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case O.GREATER_THAN_SIGN:{this._err(te.missingDoctypePublicIdentifier),i.forceQuirks=!0,this.state=N.DATA,this.emitCurrentDoctype(i);break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:this._err(te.missingQuoteBeforeDoctypePublicIdentifier),i.forceQuirks=!0,this.state=N.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypePublicIdentifier(e){const i=this.currentToken;switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:break;case O.QUOTATION_MARK:{i.publicId="",this.state=N.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case O.APOSTROPHE:{i.publicId="",this.state=N.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case O.GREATER_THAN_SIGN:{this._err(te.missingDoctypePublicIdentifier),i.forceQuirks=!0,this.state=N.DATA,this.emitCurrentDoctype(i);break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:this._err(te.missingQuoteBeforeDoctypePublicIdentifier),i.forceQuirks=!0,this.state=N.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypePublicIdentifierDoubleQuoted(e){const i=this.currentToken;switch(e){case O.QUOTATION_MARK:{this.state=N.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case O.NULL:{this._err(te.unexpectedNullCharacter),i.publicId+=ri;break}case O.GREATER_THAN_SIGN:{this._err(te.abruptDoctypePublicIdentifier),i.forceQuirks=!0,this.emitCurrentDoctype(i),this.state=N.DATA;break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:i.publicId+=String.fromCodePoint(e)}}_stateDoctypePublicIdentifierSingleQuoted(e){const i=this.currentToken;switch(e){case O.APOSTROPHE:{this.state=N.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case O.NULL:{this._err(te.unexpectedNullCharacter),i.publicId+=ri;break}case O.GREATER_THAN_SIGN:{this._err(te.abruptDoctypePublicIdentifier),i.forceQuirks=!0,this.emitCurrentDoctype(i),this.state=N.DATA;break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:i.publicId+=String.fromCodePoint(e)}}_stateAfterDoctypePublicIdentifier(e){const i=this.currentToken;switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:{this.state=N.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case O.GREATER_THAN_SIGN:{this.state=N.DATA,this.emitCurrentDoctype(i);break}case O.QUOTATION_MARK:{this._err(te.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),i.systemId="",this.state=N.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case O.APOSTROPHE:{this._err(te.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),i.systemId="",this.state=N.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:this._err(te.missingQuoteBeforeDoctypeSystemIdentifier),i.forceQuirks=!0,this.state=N.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBetweenDoctypePublicAndSystemIdentifiers(e){const i=this.currentToken;switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:break;case O.GREATER_THAN_SIGN:{this.emitCurrentDoctype(i),this.state=N.DATA;break}case O.QUOTATION_MARK:{i.systemId="",this.state=N.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case O.APOSTROPHE:{i.systemId="",this.state=N.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:this._err(te.missingQuoteBeforeDoctypeSystemIdentifier),i.forceQuirks=!0,this.state=N.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateAfterDoctypeSystemKeyword(e){const i=this.currentToken;switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:{this.state=N.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case O.QUOTATION_MARK:{this._err(te.missingWhitespaceAfterDoctypeSystemKeyword),i.systemId="",this.state=N.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case O.APOSTROPHE:{this._err(te.missingWhitespaceAfterDoctypeSystemKeyword),i.systemId="",this.state=N.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case O.GREATER_THAN_SIGN:{this._err(te.missingDoctypeSystemIdentifier),i.forceQuirks=!0,this.state=N.DATA,this.emitCurrentDoctype(i);break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:this._err(te.missingQuoteBeforeDoctypeSystemIdentifier),i.forceQuirks=!0,this.state=N.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypeSystemIdentifier(e){const i=this.currentToken;switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:break;case O.QUOTATION_MARK:{i.systemId="",this.state=N.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case O.APOSTROPHE:{i.systemId="",this.state=N.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case O.GREATER_THAN_SIGN:{this._err(te.missingDoctypeSystemIdentifier),i.forceQuirks=!0,this.state=N.DATA,this.emitCurrentDoctype(i);break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:this._err(te.missingQuoteBeforeDoctypeSystemIdentifier),i.forceQuirks=!0,this.state=N.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypeSystemIdentifierDoubleQuoted(e){const i=this.currentToken;switch(e){case O.QUOTATION_MARK:{this.state=N.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case O.NULL:{this._err(te.unexpectedNullCharacter),i.systemId+=ri;break}case O.GREATER_THAN_SIGN:{this._err(te.abruptDoctypeSystemIdentifier),i.forceQuirks=!0,this.emitCurrentDoctype(i),this.state=N.DATA;break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:i.systemId+=String.fromCodePoint(e)}}_stateDoctypeSystemIdentifierSingleQuoted(e){const i=this.currentToken;switch(e){case O.APOSTROPHE:{this.state=N.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case O.NULL:{this._err(te.unexpectedNullCharacter),i.systemId+=ri;break}case O.GREATER_THAN_SIGN:{this._err(te.abruptDoctypeSystemIdentifier),i.forceQuirks=!0,this.emitCurrentDoctype(i),this.state=N.DATA;break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:i.systemId+=String.fromCodePoint(e)}}_stateAfterDoctypeSystemIdentifier(e){const i=this.currentToken;switch(e){case O.SPACE:case O.LINE_FEED:case O.TABULATION:case O.FORM_FEED:break;case O.GREATER_THAN_SIGN:{this.emitCurrentDoctype(i),this.state=N.DATA;break}case O.EOF:{this._err(te.eofInDoctype),i.forceQuirks=!0,this.emitCurrentDoctype(i),this._emitEOFToken();break}default:this._err(te.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=N.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBogusDoctype(e){const i=this.currentToken;switch(e){case O.GREATER_THAN_SIGN:{this.emitCurrentDoctype(i),this.state=N.DATA;break}case O.NULL:{this._err(te.unexpectedNullCharacter);break}case O.EOF:{this.emitCurrentDoctype(i),this._emitEOFToken();break}}}_stateCdataSection(e){switch(e){case O.RIGHT_SQUARE_BRACKET:{this.state=N.CDATA_SECTION_BRACKET;break}case O.EOF:{this._err(te.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateCdataSectionBracket(e){e===O.RIGHT_SQUARE_BRACKET?this.state=N.CDATA_SECTION_END:(this._emitChars("]"),this.state=N.CDATA_SECTION,this._stateCdataSection(e))}_stateCdataSectionEnd(e){switch(e){case O.GREATER_THAN_SIGN:{this.state=N.DATA;break}case O.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=N.CDATA_SECTION,this._stateCdataSection(e)}}_stateCharacterReference(e){e===O.NUMBER_SIGN?this.state=N.NUMERIC_CHARACTER_REFERENCE:r_(e)?(this.state=N.NAMED_CHARACTER_REFERENCE,this._stateNamedCharacterReference(e)):(this._flushCodePointConsumedAsCharacterReference(O.AMPERSAND),this._reconsumeInState(this.returnState,e))}_stateNamedCharacterReference(e){const i=this._matchNamedCharacterReference(e);if(!this._ensureHibernation())if(i){for(let s=0;s<i.length;s++)this._flushCodePointConsumedAsCharacterReference(i[s]);this.state=this.returnState}else this._flushCodePointConsumedAsCharacterReference(O.AMPERSAND),this.state=N.AMBIGUOUS_AMPERSAND}_stateAmbiguousAmpersand(e){r_(e)?this._flushCodePointConsumedAsCharacterReference(e):(e===O.SEMICOLON&&this._err(te.unknownNamedCharacterReference),this._reconsumeInState(this.returnState,e))}_stateNumericCharacterReference(e){this.charRefCode=0,e===O.LATIN_SMALL_X||e===O.LATIN_CAPITAL_X?this.state=N.HEXADEMICAL_CHARACTER_REFERENCE_START:wc(e)?(this.state=N.DECIMAL_CHARACTER_REFERENCE,this._stateDecimalCharacterReference(e)):(this._err(te.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(O.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(O.NUMBER_SIGN),this._reconsumeInState(this.returnState,e))}_stateHexademicalCharacterReferenceStart(e){AL(e)?(this.state=N.HEXADEMICAL_CHARACTER_REFERENCE,this._stateHexademicalCharacterReference(e)):(this._err(te.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(O.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(O.NUMBER_SIGN),this._unconsume(2),this.state=this.returnState)}_stateHexademicalCharacterReference(e){jA(e)?this.charRefCode=this.charRefCode*16+e-55:KA(e)?this.charRefCode=this.charRefCode*16+e-87:wc(e)?this.charRefCode=this.charRefCode*16+e-48:e===O.SEMICOLON?this.state=N.NUMERIC_CHARACTER_REFERENCE_END:(this._err(te.missingSemicolonAfterCharacterReference),this.state=N.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(e))}_stateDecimalCharacterReference(e){wc(e)?this.charRefCode=this.charRefCode*10+e-48:e===O.SEMICOLON?this.state=N.NUMERIC_CHARACTER_REFERENCE_END:(this._err(te.missingSemicolonAfterCharacterReference),this.state=N.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(e))}_stateNumericCharacterReferenceEnd(e){if(this.charRefCode===O.NULL)this._err(te.nullCharacterReference),this.charRefCode=O.REPLACEMENT_CHARACTER;else if(this.charRefCode>1114111)this._err(te.characterReferenceOutsideUnicodeRange),this.charRefCode=O.REPLACEMENT_CHARACTER;else if(VA(this.charRefCode))this._err(te.surrogateCharacterReference),this.charRefCode=O.REPLACEMENT_CHARACTER;else if(zA(this.charRefCode))this._err(te.noncharacterCharacterReference);else if(WA(this.charRefCode)||this.charRefCode===O.CARRIAGE_RETURN){this._err(te.controlCharacterReference);const i=IL.get(this.charRefCode);i!==void 0&&(this.charRefCode=i)}this._flushCodePointConsumedAsCharacterReference(this.charRefCode),this._reconsumeInState(this.returnState,e)}};const JA=new Set([_.DD,_.DT,_.LI,_.OPTGROUP,_.OPTION,_.P,_.RB,_.RP,_.RT,_.RTC]),j2=new Set([...JA,_.CAPTION,_.COLGROUP,_.TBODY,_.TD,_.TFOOT,_.TH,_.THEAD,_.TR]),Fd=new Map([[_.APPLET,se.HTML],[_.CAPTION,se.HTML],[_.HTML,se.HTML],[_.MARQUEE,se.HTML],[_.OBJECT,se.HTML],[_.TABLE,se.HTML],[_.TD,se.HTML],[_.TEMPLATE,se.HTML],[_.TH,se.HTML],[_.ANNOTATION_XML,se.MATHML],[_.MI,se.MATHML],[_.MN,se.MATHML],[_.MO,se.MATHML],[_.MS,se.MATHML],[_.MTEXT,se.MATHML],[_.DESC,se.SVG],[_.FOREIGN_OBJECT,se.SVG],[_.TITLE,se.SVG]]),wL=[_.H1,_.H2,_.H3,_.H4,_.H5,_.H6],RL=[_.TR,_.TEMPLATE,_.HTML],NL=[_.TBODY,_.TFOOT,_.THEAD,_.TEMPLATE,_.HTML],xL=[_.TABLE,_.TEMPLATE,_.HTML],DL=[_.TD,_.TH];class LL{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(e,i,s){this.treeAdapter=i,this.handler=s,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=_.UNKNOWN,this.current=e}_indexOf(e){return this.items.lastIndexOf(e,this.stackTop)}_isInTemplate(){return this.currentTagId===_.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===se.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(e,i){this.stackTop++,this.items[this.stackTop]=e,this.current=e,this.tagIDs[this.stackTop]=i,this.currentTagId=i,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(e,i,!0)}pop(){const e=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!0)}replace(e,i){const s=this._indexOf(e);this.items[s]=i,s===this.stackTop&&(this.current=i)}insertAfter(e,i,s){const n=this._indexOf(e)+1;this.items.splice(n,0,i),this.tagIDs.splice(n,0,s),this.stackTop++,n===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,n===this.stackTop)}popUntilTagNamePopped(e){let i=this.stackTop+1;do i=this.tagIDs.lastIndexOf(e,i-1);while(i>0&&this.treeAdapter.getNamespaceURI(this.items[i])!==se.HTML);this.shortenToLength(i<0?0:i)}shortenToLength(e){for(;this.stackTop>=e;){const i=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(i,this.stackTop<e)}}popUntilElementPopped(e){const i=this._indexOf(e);this.shortenToLength(i<0?0:i)}popUntilPopped(e,i){const s=this._indexOfTagNames(e,i);this.shortenToLength(s<0?0:s)}popUntilNumberedHeaderPopped(){this.popUntilPopped(wL,se.HTML)}popUntilTableCellPopped(){this.popUntilPopped(DL,se.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(e,i){for(let s=this.stackTop;s>=0;s--)if(e.includes(this.tagIDs[s])&&this.treeAdapter.getNamespaceURI(this.items[s])===i)return s;return-1}clearBackTo(e,i){const s=this._indexOfTagNames(e,i);this.shortenToLength(s+1)}clearBackToTableContext(){this.clearBackTo(xL,se.HTML)}clearBackToTableBodyContext(){this.clearBackTo(NL,se.HTML)}clearBackToTableRowContext(){this.clearBackTo(RL,se.HTML)}remove(e){const i=this._indexOf(e);i>=0&&(i===this.stackTop?this.pop():(this.items.splice(i,1),this.tagIDs.splice(i,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===_.BODY?this.items[1]:null}contains(e){return this._indexOf(e)>-1}getCommonAncestor(e){const i=this._indexOf(e)-1;return i>=0?this.items[i]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===_.HTML}hasInScope(e){for(let i=this.stackTop;i>=0;i--){const s=this.tagIDs[i],n=this.treeAdapter.getNamespaceURI(this.items[i]);if(s===e&&n===se.HTML)return!0;if(Fd.get(s)===n)return!1}return!0}hasNumberedHeaderInScope(){for(let e=this.stackTop;e>=0;e--){const i=this.tagIDs[e],s=this.treeAdapter.getNamespaceURI(this.items[e]);if(XA(i)&&s===se.HTML)return!0;if(Fd.get(i)===s)return!1}return!0}hasInListItemScope(e){for(let i=this.stackTop;i>=0;i--){const s=this.tagIDs[i],n=this.treeAdapter.getNamespaceURI(this.items[i]);if(s===e&&n===se.HTML)return!0;if((s===_.UL||s===_.OL)&&n===se.HTML||Fd.get(s)===n)return!1}return!0}hasInButtonScope(e){for(let i=this.stackTop;i>=0;i--){const s=this.tagIDs[i],n=this.treeAdapter.getNamespaceURI(this.items[i]);if(s===e&&n===se.HTML)return!0;if(s===_.BUTTON&&n===se.HTML||Fd.get(s)===n)return!1}return!0}hasInTableScope(e){for(let i=this.stackTop;i>=0;i--){const s=this.tagIDs[i];if(this.treeAdapter.getNamespaceURI(this.items[i])===se.HTML){if(s===e)return!0;if(s===_.TABLE||s===_.TEMPLATE||s===_.HTML)return!1}}return!0}hasTableBodyContextInTableScope(){for(let e=this.stackTop;e>=0;e--){const i=this.tagIDs[e];if(this.treeAdapter.getNamespaceURI(this.items[e])===se.HTML){if(i===_.TBODY||i===_.THEAD||i===_.TFOOT)return!0;if(i===_.TABLE||i===_.HTML)return!1}}return!0}hasInSelectScope(e){for(let i=this.stackTop;i>=0;i--){const s=this.tagIDs[i];if(this.treeAdapter.getNamespaceURI(this.items[i])===se.HTML){if(s===e)return!0;if(s!==_.OPTION&&s!==_.OPTGROUP)return!1}}return!0}generateImpliedEndTags(){for(;JA.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;j2.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(e){for(;this.currentTagId!==e&&j2.has(this.currentTagId);)this.pop()}}const s1=3;var Ks;(function(r){r[r.Marker=0]="Marker",r[r.Element=1]="Element"})(Ks=Ks||(Ks={}));const K2={type:Ks.Marker};class ML{constructor(e){this.treeAdapter=e,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(e,i){const s=[],n=i.length,l=this.treeAdapter.getTagName(e),u=this.treeAdapter.getNamespaceURI(e);for(let c=0;c<this.entries.length;c++){const h=this.entries[c];if(h.type===Ks.Marker)break;const{element:f}=h;if(this.treeAdapter.getTagName(f)===l&&this.treeAdapter.getNamespaceURI(f)===u){const p=this.treeAdapter.getAttrList(f);p.length===n&&s.push({idx:c,attrs:p})}}return s}_ensureNoahArkCondition(e){if(this.entries.length<s1)return;const i=this.treeAdapter.getAttrList(e),s=this._getNoahArkConditionCandidates(e,i);if(s.length<s1)return;const n=new Map(i.map(u=>[u.name,u.value]));let l=0;for(let u=0;u<s.length;u++){const c=s[u];c.attrs.every(h=>n.get(h.name)===h.value)&&(l+=1,l>=s1&&this.entries.splice(c.idx,1))}}insertMarker(){this.entries.unshift(K2)}pushElement(e,i){this._ensureNoahArkCondition(e),this.entries.unshift({type:Ks.Element,element:e,token:i})}insertElementAfterBookmark(e,i){const s=this.entries.indexOf(this.bookmark);this.entries.splice(s,0,{type:Ks.Element,element:e,token:i})}removeEntry(e){const i=this.entries.indexOf(e);i>=0&&this.entries.splice(i,1)}clearToLastMarker(){const e=this.entries.indexOf(K2);e>=0?this.entries.splice(0,e+1):this.entries.length=0}getElementEntryInScopeWithTagName(e){const i=this.entries.find(s=>s.type===Ks.Marker||this.treeAdapter.getTagName(s.element)===e);return i&&i.type===Ks.Element?i:null}getElementEntry(e){return this.entries.find(i=>i.type===Ks.Element&&i.element===e)}}function q2(r){return{nodeName:"#text",value:r,parentNode:null}}const Rl={createDocument(){return{nodeName:"#document",mode:Br.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(r,e,i){return{nodeName:r,tagName:r,attrs:i,namespaceURI:e,childNodes:[],parentNode:null}},createCommentNode(r){return{nodeName:"#comment",data:r,parentNode:null}},appendChild(r,e){r.childNodes.push(e),e.parentNode=r},insertBefore(r,e,i){const s=r.childNodes.indexOf(i);r.childNodes.splice(s,0,e),e.parentNode=r},setTemplateContent(r,e){r.content=e},getTemplateContent(r){return r.content},setDocumentType(r,e,i,s){const n=r.childNodes.find(l=>l.nodeName==="#documentType");if(n)n.name=e,n.publicId=i,n.systemId=s;else{const l={nodeName:"#documentType",name:e,publicId:i,systemId:s,parentNode:null};Rl.appendChild(r,l)}},setDocumentMode(r,e){r.mode=e},getDocumentMode(r){return r.mode},detachNode(r){if(r.parentNode){const e=r.parentNode.childNodes.indexOf(r);r.parentNode.childNodes.splice(e,1),r.parentNode=null}},insertText(r,e){if(r.childNodes.length>0){const i=r.childNodes[r.childNodes.length-1];if(Rl.isTextNode(i)){i.value+=e;return}}Rl.appendChild(r,q2(e))},insertTextBefore(r,e,i){const s=r.childNodes[r.childNodes.indexOf(i)-1];s&&Rl.isTextNode(s)?s.value+=e:Rl.insertBefore(r,q2(e),i)},adoptAttributes(r,e){const i=new Set(r.attrs.map(s=>s.name));for(let s=0;s<e.length;s++)i.has(e[s].name)||r.attrs.push(e[s])},getFirstChild(r){return r.childNodes[0]},getChildNodes(r){return r.childNodes},getParentNode(r){return r.parentNode},getAttrList(r){return r.attrs},getTagName(r){return r.tagName},getNamespaceURI(r){return r.namespaceURI},getTextNodeContent(r){return r.value},getCommentNodeContent(r){return r.data},getDocumentTypeNodeName(r){return r.name},getDocumentTypeNodePublicId(r){return r.publicId},getDocumentTypeNodeSystemId(r){return r.systemId},isTextNode(r){return r.nodeName==="#text"},isCommentNode(r){return r.nodeName==="#comment"},isDocumentTypeNode(r){return r.nodeName==="#documentType"},isElementNode(r){return Object.prototype.hasOwnProperty.call(r,"tagName")},setNodeSourceCodeLocation(r,e){r.sourceCodeLocation=e},getNodeSourceCodeLocation(r){return r.sourceCodeLocation},updateNodeSourceCodeLocation(r,e){r.sourceCodeLocation={...r.sourceCodeLocation,...e}}},QA="html",BL="about:legacy-compat",PL="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",ZA=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],FL=[...ZA,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],UL=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),eC=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],HL=[...eC,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function J2(r,e){return e.some(i=>r.startsWith(i))}function GL(r){return r.name===QA&&r.publicId===null&&(r.systemId===null||r.systemId===BL)}function VL(r){if(r.name!==QA)return Br.QUIRKS;const{systemId:e}=r;if(e&&e.toLowerCase()===PL)return Br.QUIRKS;let{publicId:i}=r;if(i!==null){if(i=i.toLowerCase(),UL.has(i))return Br.QUIRKS;let s=e===null?FL:ZA;if(J2(i,s))return Br.QUIRKS;if(s=e===null?eC:HL,J2(i,s))return Br.LIMITED_QUIRKS}return Br.NO_QUIRKS}const Q2={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},WL="definitionurl",zL="definitionURL",YL=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(r=>[r.toLowerCase(),r])),XL=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:se.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:se.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:se.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:se.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:se.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:se.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:se.XLINK}],["xml:base",{prefix:"xml",name:"base",namespace:se.XML}],["xml:lang",{prefix:"xml",name:"lang",namespace:se.XML}],["xml:space",{prefix:"xml",name:"space",namespace:se.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:se.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:se.XMLNS}]]),jL=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(r=>[r.toLowerCase(),r])),KL=new Set([_.B,_.BIG,_.BLOCKQUOTE,_.BODY,_.BR,_.CENTER,_.CODE,_.DD,_.DIV,_.DL,_.DT,_.EM,_.EMBED,_.H1,_.H2,_.H3,_.H4,_.H5,_.H6,_.HEAD,_.HR,_.I,_.IMG,_.LI,_.LISTING,_.MENU,_.META,_.NOBR,_.OL,_.P,_.PRE,_.RUBY,_.S,_.SMALL,_.SPAN,_.STRONG,_.STRIKE,_.SUB,_.SUP,_.TABLE,_.TT,_.U,_.UL,_.VAR]);function qL(r){const e=r.tagID;return e===_.FONT&&r.attrs.some(({name:s})=>s===Uo.COLOR||s===Uo.SIZE||s===Uo.FACE)||KL.has(e)}function tC(r){for(let e=0;e<r.attrs.length;e++)if(r.attrs[e].name===WL){r.attrs[e].name=zL;break}}function iC(r){for(let e=0;e<r.attrs.length;e++){const i=YL.get(r.attrs[e].name);i!=null&&(r.attrs[e].name=i)}}function Cb(r){for(let e=0;e<r.attrs.length;e++){const i=XL.get(r.attrs[e].name);i&&(r.attrs[e].prefix=i.prefix,r.attrs[e].name=i.name,r.attrs[e].namespace=i.namespace)}}function JL(r){const e=jL.get(r.tagName);e!=null&&(r.tagName=e,r.tagID=Gf(r.tagName))}function QL(r,e){return e===se.MATHML&&(r===_.MI||r===_.MO||r===_.MN||r===_.MS||r===_.MTEXT)}function ZL(r,e,i){if(e===se.MATHML&&r===_.ANNOTATION_XML){for(let s=0;s<i.length;s++)if(i[s].name===Uo.ENCODING){const n=i[s].value.toLowerCase();return n===Q2.TEXT_HTML||n===Q2.APPLICATION_XML}}return e===se.SVG&&(r===_.FOREIGN_OBJECT||r===_.DESC||r===_.TITLE)}function eM(r,e,i,s){return(!s||s===se.HTML)&&ZL(r,e,i)||(!s||s===se.MATHML)&&QL(r,e)}const tM="hidden",iM=8,rM=3;var B;(function(r){r[r.INITIAL=0]="INITIAL",r[r.BEFORE_HTML=1]="BEFORE_HTML",r[r.BEFORE_HEAD=2]="BEFORE_HEAD",r[r.IN_HEAD=3]="IN_HEAD",r[r.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",r[r.AFTER_HEAD=5]="AFTER_HEAD",r[r.IN_BODY=6]="IN_BODY",r[r.TEXT=7]="TEXT",r[r.IN_TABLE=8]="IN_TABLE",r[r.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",r[r.IN_CAPTION=10]="IN_CAPTION",r[r.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",r[r.IN_TABLE_BODY=12]="IN_TABLE_BODY",r[r.IN_ROW=13]="IN_ROW",r[r.IN_CELL=14]="IN_CELL",r[r.IN_SELECT=15]="IN_SELECT",r[r.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",r[r.IN_TEMPLATE=17]="IN_TEMPLATE",r[r.AFTER_BODY=18]="AFTER_BODY",r[r.IN_FRAMESET=19]="IN_FRAMESET",r[r.AFTER_FRAMESET=20]="AFTER_FRAMESET",r[r.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",r[r.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(B||(B={}));const sM={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},rC=new Set([_.TABLE,_.TBODY,_.TFOOT,_.THEAD,_.TR]),Z2={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:Rl,onParseError:null};let sC=class{constructor(e,i,s=null,n=null){this.fragmentContext=s,this.scriptHandler=n,this.currentToken=null,this.stopped=!1,this.insertionMode=B.INITIAL,this.originalInsertionMode=B.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...Z2,...e},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=i??this.treeAdapter.createDocument(),this.tokenizer=new OL(this.options,this),this.activeFormattingElements=new ML(this.treeAdapter),this.fragmentContextID=s?Gf(this.treeAdapter.getTagName(s)):_.UNKNOWN,this._setContextModes(s??this.document,this.fragmentContextID),this.openElements=new LL(this.document,this.treeAdapter,this)}static parse(e,i){const s=new this(i);return s.tokenizer.write(e,!0),s.document}static getFragmentParser(e,i){const s={...Z2,...i};e??(e=s.treeAdapter.createElement(X.TEMPLATE,se.HTML,[]));const n=s.treeAdapter.createElement("documentmock",se.HTML,[]),l=new this(s,n,e);return l.fragmentContextID===_.TEMPLATE&&l.tmplInsertionModeStack.unshift(B.IN_TEMPLATE),l._initTokenizerForFragmentParsing(),l._insertFakeRootElement(),l._resetInsertionMode(),l._findFormInFragmentContext(),l}getFragment(){const e=this.treeAdapter.getFirstChild(this.document),i=this.treeAdapter.createDocumentFragment();return this._adoptNodes(e,i),i}_err(e,i,s){var n;if(!this.onParseError)return;const l=(n=e.location)!==null&&n!==void 0?n:sM,u={code:i,startLine:l.startLine,startCol:l.startCol,startOffset:l.startOffset,endLine:s?l.startLine:l.endLine,endCol:s?l.startCol:l.endCol,endOffset:s?l.startOffset:l.endOffset};this.onParseError(u)}onItemPush(e,i,s){var n,l;(l=(n=this.treeAdapter).onItemPush)===null||l===void 0||l.call(n,e),s&&this.openElements.stackTop>0&&this._setContextModes(e,i)}onItemPop(e,i){var s,n;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(e,this.currentToken),(n=(s=this.treeAdapter).onItemPop)===null||n===void 0||n.call(s,e,this.openElements.current),i){let l,u;this.openElements.stackTop===0&&this.fragmentContext?(l=this.fragmentContext,u=this.fragmentContextID):{current:l,currentTagId:u}=this.openElements,this._setContextModes(l,u)}}_setContextModes(e,i){const s=e===this.document||this.treeAdapter.getNamespaceURI(e)===se.HTML;this.currentNotInHTML=!s,this.tokenizer.inForeignNode=!s&&!this._isIntegrationPoint(i,e)}_switchToTextParsing(e,i){this._insertElement(e,se.HTML),this.tokenizer.state=i,this.originalInsertionMode=this.insertionMode,this.insertionMode=B.TEXT}switchToPlaintextParsing(){this.insertionMode=B.TEXT,this.originalInsertionMode=B.IN_BODY,this.tokenizer.state=Fr.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let e=this.fragmentContext;for(;e;){if(this.treeAdapter.getTagName(e)===X.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==se.HTML))switch(this.fragmentContextID){case _.TITLE:case _.TEXTAREA:{this.tokenizer.state=Fr.RCDATA;break}case _.STYLE:case _.XMP:case _.IFRAME:case _.NOEMBED:case _.NOFRAMES:case _.NOSCRIPT:{this.tokenizer.state=Fr.RAWTEXT;break}case _.SCRIPT:{this.tokenizer.state=Fr.SCRIPT_DATA;break}case _.PLAINTEXT:{this.tokenizer.state=Fr.PLAINTEXT;break}}}_setDocumentType(e){const i=e.name||"",s=e.publicId||"",n=e.systemId||"";if(this.treeAdapter.setDocumentType(this.document,i,s,n),e.location){const u=this.treeAdapter.getChildNodes(this.document).find(c=>this.treeAdapter.isDocumentTypeNode(c));u&&this.treeAdapter.setNodeSourceCodeLocation(u,e.location)}}_attachElementToTree(e,i){if(this.options.sourceCodeLocationInfo){const s=i&&{...i,startTag:i};this.treeAdapter.setNodeSourceCodeLocation(e,s)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{const s=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(s,e)}}_appendElement(e,i){const s=this.treeAdapter.createElement(e.tagName,i,e.attrs);this._attachElementToTree(s,e.location)}_insertElement(e,i){const s=this.treeAdapter.createElement(e.tagName,i,e.attrs);this._attachElementToTree(s,e.location),this.openElements.push(s,e.tagID)}_insertFakeElement(e,i){const s=this.treeAdapter.createElement(e,se.HTML,[]);this._attachElementToTree(s,null),this.openElements.push(s,i)}_insertTemplate(e){const i=this.treeAdapter.createElement(e.tagName,se.HTML,e.attrs),s=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(i,s),this._attachElementToTree(i,e.location),this.openElements.push(i,e.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(s,null)}_insertFakeRootElement(){const e=this.treeAdapter.createElement(X.HTML,se.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(e,null),this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e,_.HTML)}_appendCommentNode(e,i){const s=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(i,s),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(s,e.location)}_insertCharacters(e){let i,s;if(this._shouldFosterParentOnInsertion()?({parent:i,beforeElement:s}=this._findFosterParentingLocation(),s?this.treeAdapter.insertTextBefore(i,e.chars,s):this.treeAdapter.insertText(i,e.chars)):(i=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(i,e.chars)),!e.location)return;const n=this.treeAdapter.getChildNodes(i),l=s?n.lastIndexOf(s):n.length,u=n[l-1];if(this.treeAdapter.getNodeSourceCodeLocation(u)){const{endLine:h,endCol:f,endOffset:p}=e.location;this.treeAdapter.updateNodeSourceCodeLocation(u,{endLine:h,endCol:f,endOffset:p})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(u,e.location)}_adoptNodes(e,i){for(let s=this.treeAdapter.getFirstChild(e);s;s=this.treeAdapter.getFirstChild(e))this.treeAdapter.detachNode(s),this.treeAdapter.appendChild(i,s)}_setEndLocation(e,i){if(this.treeAdapter.getNodeSourceCodeLocation(e)&&i.location){const s=i.location,n=this.treeAdapter.getTagName(e),l=i.type===Nt.END_TAG&&n===i.tagName?{endTag:{...s},endLine:s.endLine,endCol:s.endCol,endOffset:s.endOffset}:{endLine:s.startLine,endCol:s.startCol,endOffset:s.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(e,l)}}shouldProcessStartTagTokenInForeignContent(e){if(!this.currentNotInHTML)return!1;let i,s;return this.openElements.stackTop===0&&this.fragmentContext?(i=this.fragmentContext,s=this.fragmentContextID):{current:i,currentTagId:s}=this.openElements,e.tagID===_.SVG&&this.treeAdapter.getTagName(i)===X.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(i)===se.MATHML?!1:this.tokenizer.inForeignNode||(e.tagID===_.MGLYPH||e.tagID===_.MALIGNMARK)&&!this._isIntegrationPoint(s,i,se.HTML)}_processToken(e){switch(e.type){case Nt.CHARACTER:{this.onCharacter(e);break}case Nt.NULL_CHARACTER:{this.onNullCharacter(e);break}case Nt.COMMENT:{this.onComment(e);break}case Nt.DOCTYPE:{this.onDoctype(e);break}case Nt.START_TAG:{this._processStartTag(e);break}case Nt.END_TAG:{this.onEndTag(e);break}case Nt.EOF:{this.onEof(e);break}case Nt.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(e);break}}}_isIntegrationPoint(e,i,s){const n=this.treeAdapter.getNamespaceURI(i),l=this.treeAdapter.getAttrList(i);return eM(e,n,l,s)}_reconstructActiveFormattingElements(){const e=this.activeFormattingElements.entries.length;if(e){const i=this.activeFormattingElements.entries.findIndex(n=>n.type===Ks.Marker||this.openElements.contains(n.element)),s=i<0?e-1:i-1;for(let n=s;n>=0;n--){const l=this.activeFormattingElements.entries[n];this._insertElement(l.token,this.treeAdapter.getNamespaceURI(l.element)),l.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=B.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(_.P),this.openElements.popUntilTagNamePopped(_.P)}_resetInsertionMode(){for(let e=this.openElements.stackTop;e>=0;e--)switch(e===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[e]){case _.TR:{this.insertionMode=B.IN_ROW;return}case _.TBODY:case _.THEAD:case _.TFOOT:{this.insertionMode=B.IN_TABLE_BODY;return}case _.CAPTION:{this.insertionMode=B.IN_CAPTION;return}case _.COLGROUP:{this.insertionMode=B.IN_COLUMN_GROUP;return}case _.TABLE:{this.insertionMode=B.IN_TABLE;return}case _.BODY:{this.insertionMode=B.IN_BODY;return}case _.FRAMESET:{this.insertionMode=B.IN_FRAMESET;return}case _.SELECT:{this._resetInsertionModeForSelect(e);return}case _.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case _.HTML:{this.insertionMode=this.headElement?B.AFTER_HEAD:B.BEFORE_HEAD;return}case _.TD:case _.TH:{if(e>0){this.insertionMode=B.IN_CELL;return}break}case _.HEAD:{if(e>0){this.insertionMode=B.IN_HEAD;return}break}}this.insertionMode=B.IN_BODY}_resetInsertionModeForSelect(e){if(e>0)for(let i=e-1;i>0;i--){const s=this.openElements.tagIDs[i];if(s===_.TEMPLATE)break;if(s===_.TABLE){this.insertionMode=B.IN_SELECT_IN_TABLE;return}}this.insertionMode=B.IN_SELECT}_isElementCausesFosterParenting(e){return rC.has(e)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let e=this.openElements.stackTop;e>=0;e--){const i=this.openElements.items[e];switch(this.openElements.tagIDs[e]){case _.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(i)===se.HTML)return{parent:this.treeAdapter.getTemplateContent(i),beforeElement:null};break}case _.TABLE:{const s=this.treeAdapter.getParentNode(i);return s?{parent:s,beforeElement:i}:{parent:this.openElements.items[e-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(e){const i=this._findFosterParentingLocation();i.beforeElement?this.treeAdapter.insertBefore(i.parent,e,i.beforeElement):this.treeAdapter.appendChild(i.parent,e)}_isSpecialElement(e,i){const s=this.treeAdapter.getNamespaceURI(e);return vL[s].has(i)}onCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){D8(this,e);return}switch(this.insertionMode){case B.INITIAL:{gc(this,e);break}case B.BEFORE_HTML:{Rc(this,e);break}case B.BEFORE_HEAD:{Nc(this,e);break}case B.IN_HEAD:{xc(this,e);break}case B.IN_HEAD_NO_SCRIPT:{Dc(this,e);break}case B.AFTER_HEAD:{Lc(this,e);break}case B.IN_BODY:case B.IN_CAPTION:case B.IN_CELL:case B.IN_TEMPLATE:{oC(this,e);break}case B.TEXT:case B.IN_SELECT:case B.IN_SELECT_IN_TABLE:{this._insertCharacters(e);break}case B.IN_TABLE:case B.IN_TABLE_BODY:case B.IN_ROW:{n1(this,e);break}case B.IN_TABLE_TEXT:{dC(this,e);break}case B.IN_COLUMN_GROUP:{U0(this,e);break}case B.AFTER_BODY:{H0(this,e);break}case B.AFTER_AFTER_BODY:{b0(this,e);break}}}onNullCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){x8(this,e);return}switch(this.insertionMode){case B.INITIAL:{gc(this,e);break}case B.BEFORE_HTML:{Rc(this,e);break}case B.BEFORE_HEAD:{Nc(this,e);break}case B.IN_HEAD:{xc(this,e);break}case B.IN_HEAD_NO_SCRIPT:{Dc(this,e);break}case B.AFTER_HEAD:{Lc(this,e);break}case B.TEXT:{this._insertCharacters(e);break}case B.IN_TABLE:case B.IN_TABLE_BODY:case B.IN_ROW:{n1(this,e);break}case B.IN_COLUMN_GROUP:{U0(this,e);break}case B.AFTER_BODY:{H0(this,e);break}case B.AFTER_AFTER_BODY:{b0(this,e);break}}}onComment(e){if(this.skipNextNewLine=!1,this.currentNotInHTML){s_(this,e);return}switch(this.insertionMode){case B.INITIAL:case B.BEFORE_HTML:case B.BEFORE_HEAD:case B.IN_HEAD:case B.IN_HEAD_NO_SCRIPT:case B.AFTER_HEAD:case B.IN_BODY:case B.IN_TABLE:case B.IN_CAPTION:case B.IN_COLUMN_GROUP:case B.IN_TABLE_BODY:case B.IN_ROW:case B.IN_CELL:case B.IN_SELECT:case B.IN_SELECT_IN_TABLE:case B.IN_TEMPLATE:case B.IN_FRAMESET:case B.AFTER_FRAMESET:{s_(this,e);break}case B.IN_TABLE_TEXT:{_c(this,e);break}case B.AFTER_BODY:{hM(this,e);break}case B.AFTER_AFTER_BODY:case B.AFTER_AFTER_FRAMESET:{dM(this,e);break}}}onDoctype(e){switch(this.skipNextNewLine=!1,this.insertionMode){case B.INITIAL:{fM(this,e);break}case B.BEFORE_HEAD:case B.IN_HEAD:case B.IN_HEAD_NO_SCRIPT:case B.AFTER_HEAD:{this._err(e,te.misplacedDoctype);break}case B.IN_TABLE_TEXT:{_c(this,e);break}}}onStartTag(e){this.skipNextNewLine=!1,this.currentToken=e,this._processStartTag(e),e.selfClosing&&!e.ackSelfClosing&&this._err(e,te.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(e){this.shouldProcessStartTagTokenInForeignContent(e)?L8(this,e):this._startTagOutsideForeignContent(e)}_startTagOutsideForeignContent(e){switch(this.insertionMode){case B.INITIAL:{gc(this,e);break}case B.BEFORE_HTML:{pM(this,e);break}case B.BEFORE_HEAD:{gM(this,e);break}case B.IN_HEAD:{Js(this,e);break}case B.IN_HEAD_NO_SCRIPT:{TM(this,e);break}case B.AFTER_HEAD:{$M(this,e);break}case B.IN_BODY:{dr(this,e);break}case B.IN_TABLE:{Za(this,e);break}case B.IN_TABLE_TEXT:{_c(this,e);break}case B.IN_CAPTION:{_8(this,e);break}case B.IN_COLUMN_GROUP:{Rb(this,e);break}case B.IN_TABLE_BODY:{zf(this,e);break}case B.IN_ROW:{Yf(this,e);break}case B.IN_CELL:{E8(this,e);break}case B.IN_SELECT:{mC(this,e);break}case B.IN_SELECT_IN_TABLE:{v8(this,e);break}case B.IN_TEMPLATE:{S8(this,e);break}case B.AFTER_BODY:{k8(this,e);break}case B.IN_FRAMESET:{A8(this,e);break}case B.AFTER_FRAMESET:{O8(this,e);break}case B.AFTER_AFTER_BODY:{R8(this,e);break}case B.AFTER_AFTER_FRAMESET:{N8(this,e);break}}}onEndTag(e){this.skipNextNewLine=!1,this.currentToken=e,this.currentNotInHTML?M8(this,e):this._endTagOutsideForeignContent(e)}_endTagOutsideForeignContent(e){switch(this.insertionMode){case B.INITIAL:{gc(this,e);break}case B.BEFORE_HTML:{mM(this,e);break}case B.BEFORE_HEAD:{_M(this,e);break}case B.IN_HEAD:{bM(this,e);break}case B.IN_HEAD_NO_SCRIPT:{EM(this,e);break}case B.AFTER_HEAD:{vM(this,e);break}case B.IN_BODY:{Wf(this,e);break}case B.TEXT:{l8(this,e);break}case B.IN_TABLE:{Yc(this,e);break}case B.IN_TABLE_TEXT:{_c(this,e);break}case B.IN_CAPTION:{b8(this,e);break}case B.IN_COLUMN_GROUP:{T8(this,e);break}case B.IN_TABLE_BODY:{n_(this,e);break}case B.IN_ROW:{pC(this,e);break}case B.IN_CELL:{$8(this,e);break}case B.IN_SELECT:{gC(this,e);break}case B.IN_SELECT_IN_TABLE:{y8(this,e);break}case B.IN_TEMPLATE:{I8(this,e);break}case B.AFTER_BODY:{bC(this,e);break}case B.IN_FRAMESET:{C8(this,e);break}case B.AFTER_FRAMESET:{w8(this,e);break}case B.AFTER_AFTER_BODY:{b0(this,e);break}}}onEof(e){switch(this.insertionMode){case B.INITIAL:{gc(this,e);break}case B.BEFORE_HTML:{Rc(this,e);break}case B.BEFORE_HEAD:{Nc(this,e);break}case B.IN_HEAD:{xc(this,e);break}case B.IN_HEAD_NO_SCRIPT:{Dc(this,e);break}case B.AFTER_HEAD:{Lc(this,e);break}case B.IN_BODY:case B.IN_TABLE:case B.IN_CAPTION:case B.IN_COLUMN_GROUP:case B.IN_TABLE_BODY:case B.IN_ROW:case B.IN_CELL:case B.IN_SELECT:case B.IN_SELECT_IN_TABLE:{cC(this,e);break}case B.TEXT:{a8(this,e);break}case B.IN_TABLE_TEXT:{_c(this,e);break}case B.IN_TEMPLATE:{_C(this,e);break}case B.AFTER_BODY:case B.IN_FRAMESET:case B.AFTER_FRAMESET:case B.AFTER_AFTER_BODY:case B.AFTER_AFTER_FRAMESET:{wb(this,e);break}}}onWhitespaceCharacter(e){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.chars.charCodeAt(0)===O.LINE_FEED)){if(e.chars.length===1)return;e.chars=e.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(e);return}switch(this.insertionMode){case B.IN_HEAD:case B.IN_HEAD_NO_SCRIPT:case B.AFTER_HEAD:case B.TEXT:case B.IN_COLUMN_GROUP:case B.IN_SELECT:case B.IN_SELECT_IN_TABLE:case B.IN_FRAMESET:case B.AFTER_FRAMESET:{this._insertCharacters(e);break}case B.IN_BODY:case B.IN_CAPTION:case B.IN_CELL:case B.IN_TEMPLATE:case B.AFTER_BODY:case B.AFTER_AFTER_BODY:case B.AFTER_AFTER_FRAMESET:{nC(this,e);break}case B.IN_TABLE:case B.IN_TABLE_BODY:case B.IN_ROW:{n1(this,e);break}case B.IN_TABLE_TEXT:{hC(this,e);break}}}};function nM(r,e){let i=r.activeFormattingElements.getElementEntryInScopeWithTagName(e.tagName);return i?r.openElements.contains(i.element)?r.openElements.hasInScope(e.tagID)||(i=null):(r.activeFormattingElements.removeEntry(i),i=null):uC(r,e),i}function oM(r,e){let i=null,s=r.openElements.stackTop;for(;s>=0;s--){const n=r.openElements.items[s];if(n===e.element)break;r._isSpecialElement(n,r.openElements.tagIDs[s])&&(i=n)}return i||(r.openElements.shortenToLength(s<0?0:s),r.activeFormattingElements.removeEntry(e)),i}function lM(r,e,i){let s=e,n=r.openElements.getCommonAncestor(e);for(let l=0,u=n;u!==i;l++,u=n){n=r.openElements.getCommonAncestor(u);const c=r.activeFormattingElements.getElementEntry(u),h=c&&l>=rM;!c||h?(h&&r.activeFormattingElements.removeEntry(c),r.openElements.remove(u)):(u=aM(r,c),s===e&&(r.activeFormattingElements.bookmark=c),r.treeAdapter.detachNode(s),r.treeAdapter.appendChild(u,s),s=u)}return s}function aM(r,e){const i=r.treeAdapter.getNamespaceURI(e.element),s=r.treeAdapter.createElement(e.token.tagName,i,e.token.attrs);return r.openElements.replace(e.element,s),e.element=s,s}function uM(r,e,i){const s=r.treeAdapter.getTagName(e),n=Gf(s);if(r._isElementCausesFosterParenting(n))r._fosterParentElement(i);else{const l=r.treeAdapter.getNamespaceURI(e);n===_.TEMPLATE&&l===se.HTML&&(e=r.treeAdapter.getTemplateContent(e)),r.treeAdapter.appendChild(e,i)}}function cM(r,e,i){const s=r.treeAdapter.getNamespaceURI(i.element),{token:n}=i,l=r.treeAdapter.createElement(n.tagName,s,n.attrs);r._adoptNodes(e,l),r.treeAdapter.appendChild(e,l),r.activeFormattingElements.insertElementAfterBookmark(l,n),r.activeFormattingElements.removeEntry(i),r.openElements.remove(i.element),r.openElements.insertAfter(e,l,n.tagID)}function Ob(r,e){for(let i=0;i<iM;i++){const s=nM(r,e);if(!s)break;const n=oM(r,s);if(!n)break;r.activeFormattingElements.bookmark=s;const l=lM(r,n,s.element),u=r.openElements.getCommonAncestor(s.element);r.treeAdapter.detachNode(l),u&&uM(r,u,l),cM(r,n,s)}}function s_(r,e){r._appendCommentNode(e,r.openElements.currentTmplContentOrNode)}function hM(r,e){r._appendCommentNode(e,r.openElements.items[0])}function dM(r,e){r._appendCommentNode(e,r.document)}function wb(r,e){if(r.stopped=!0,e.location){const i=r.fragmentContext?0:2;for(let s=r.openElements.stackTop;s>=i;s--)r._setEndLocation(r.openElements.items[s],e);if(!r.fragmentContext&&r.openElements.stackTop>=0){const s=r.openElements.items[0],n=r.treeAdapter.getNodeSourceCodeLocation(s);if(n&&!n.endTag&&(r._setEndLocation(s,e),r.openElements.stackTop>=1)){const l=r.openElements.items[1],u=r.treeAdapter.getNodeSourceCodeLocation(l);u&&!u.endTag&&r._setEndLocation(l,e)}}}}function fM(r,e){r._setDocumentType(e);const i=e.forceQuirks?Br.QUIRKS:VL(e);GL(e)||r._err(e,te.nonConformingDoctype),r.treeAdapter.setDocumentMode(r.document,i),r.insertionMode=B.BEFORE_HTML}function gc(r,e){r._err(e,te.missingDoctype,!0),r.treeAdapter.setDocumentMode(r.document,Br.QUIRKS),r.insertionMode=B.BEFORE_HTML,r._processToken(e)}function pM(r,e){e.tagID===_.HTML?(r._insertElement(e,se.HTML),r.insertionMode=B.BEFORE_HEAD):Rc(r,e)}function mM(r,e){const i=e.tagID;(i===_.HTML||i===_.HEAD||i===_.BODY||i===_.BR)&&Rc(r,e)}function Rc(r,e){r._insertFakeRootElement(),r.insertionMode=B.BEFORE_HEAD,r._processToken(e)}function gM(r,e){switch(e.tagID){case _.HTML:{dr(r,e);break}case _.HEAD:{r._insertElement(e,se.HTML),r.headElement=r.openElements.current,r.insertionMode=B.IN_HEAD;break}default:Nc(r,e)}}function _M(r,e){const i=e.tagID;i===_.HEAD||i===_.BODY||i===_.HTML||i===_.BR?Nc(r,e):r._err(e,te.endTagWithoutMatchingOpenElement)}function Nc(r,e){r._insertFakeElement(X.HEAD,_.HEAD),r.headElement=r.openElements.current,r.insertionMode=B.IN_HEAD,r._processToken(e)}function Js(r,e){switch(e.tagID){case _.HTML:{dr(r,e);break}case _.BASE:case _.BASEFONT:case _.BGSOUND:case _.LINK:case _.META:{r._appendElement(e,se.HTML),e.ackSelfClosing=!0;break}case _.TITLE:{r._switchToTextParsing(e,Fr.RCDATA);break}case _.NOSCRIPT:{r.options.scriptingEnabled?r._switchToTextParsing(e,Fr.RAWTEXT):(r._insertElement(e,se.HTML),r.insertionMode=B.IN_HEAD_NO_SCRIPT);break}case _.NOFRAMES:case _.STYLE:{r._switchToTextParsing(e,Fr.RAWTEXT);break}case _.SCRIPT:{r._switchToTextParsing(e,Fr.SCRIPT_DATA);break}case _.TEMPLATE:{r._insertTemplate(e),r.activeFormattingElements.insertMarker(),r.framesetOk=!1,r.insertionMode=B.IN_TEMPLATE,r.tmplInsertionModeStack.unshift(B.IN_TEMPLATE);break}case _.HEAD:{r._err(e,te.misplacedStartTagForHeadElement);break}default:xc(r,e)}}function bM(r,e){switch(e.tagID){case _.HEAD:{r.openElements.pop(),r.insertionMode=B.AFTER_HEAD;break}case _.BODY:case _.BR:case _.HTML:{xc(r,e);break}case _.TEMPLATE:{Yl(r,e);break}default:r._err(e,te.endTagWithoutMatchingOpenElement)}}function Yl(r,e){r.openElements.tmplCount>0?(r.openElements.generateImpliedEndTagsThoroughly(),r.openElements.currentTagId!==_.TEMPLATE&&r._err(e,te.closingOfElementWithOpenChildElements),r.openElements.popUntilTagNamePopped(_.TEMPLATE),r.activeFormattingElements.clearToLastMarker(),r.tmplInsertionModeStack.shift(),r._resetInsertionMode()):r._err(e,te.endTagWithoutMatchingOpenElement)}function xc(r,e){r.openElements.pop(),r.insertionMode=B.AFTER_HEAD,r._processToken(e)}function TM(r,e){switch(e.tagID){case _.HTML:{dr(r,e);break}case _.BASEFONT:case _.BGSOUND:case _.HEAD:case _.LINK:case _.META:case _.NOFRAMES:case _.STYLE:{Js(r,e);break}case _.NOSCRIPT:{r._err(e,te.nestedNoscriptInHead);break}default:Dc(r,e)}}function EM(r,e){switch(e.tagID){case _.NOSCRIPT:{r.openElements.pop(),r.insertionMode=B.IN_HEAD;break}case _.BR:{Dc(r,e);break}default:r._err(e,te.endTagWithoutMatchingOpenElement)}}function Dc(r,e){const i=e.type===Nt.EOF?te.openElementsLeftAfterEof:te.disallowedContentInNoscriptInHead;r._err(e,i),r.openElements.pop(),r.insertionMode=B.IN_HEAD,r._processToken(e)}function $M(r,e){switch(e.tagID){case _.HTML:{dr(r,e);break}case _.BODY:{r._insertElement(e,se.HTML),r.framesetOk=!1,r.insertionMode=B.IN_BODY;break}case _.FRAMESET:{r._insertElement(e,se.HTML),r.insertionMode=B.IN_FRAMESET;break}case _.BASE:case _.BASEFONT:case _.BGSOUND:case _.LINK:case _.META:case _.NOFRAMES:case _.SCRIPT:case _.STYLE:case _.TEMPLATE:case _.TITLE:{r._err(e,te.abandonedHeadElementChild),r.openElements.push(r.headElement,_.HEAD),Js(r,e),r.openElements.remove(r.headElement);break}case _.HEAD:{r._err(e,te.misplacedStartTagForHeadElement);break}default:Lc(r,e)}}function vM(r,e){switch(e.tagID){case _.BODY:case _.HTML:case _.BR:{Lc(r,e);break}case _.TEMPLATE:{Yl(r,e);break}default:r._err(e,te.endTagWithoutMatchingOpenElement)}}function Lc(r,e){r._insertFakeElement(X.BODY,_.BODY),r.insertionMode=B.IN_BODY,Vf(r,e)}function Vf(r,e){switch(e.type){case Nt.CHARACTER:{oC(r,e);break}case Nt.WHITESPACE_CHARACTER:{nC(r,e);break}case Nt.COMMENT:{s_(r,e);break}case Nt.START_TAG:{dr(r,e);break}case Nt.END_TAG:{Wf(r,e);break}case Nt.EOF:{cC(r,e);break}}}function nC(r,e){r._reconstructActiveFormattingElements(),r._insertCharacters(e)}function oC(r,e){r._reconstructActiveFormattingElements(),r._insertCharacters(e),r.framesetOk=!1}function yM(r,e){r.openElements.tmplCount===0&&r.treeAdapter.adoptAttributes(r.openElements.items[0],e.attrs)}function SM(r,e){const i=r.openElements.tryPeekProperlyNestedBodyElement();i&&r.openElements.tmplCount===0&&(r.framesetOk=!1,r.treeAdapter.adoptAttributes(i,e.attrs))}function IM(r,e){const i=r.openElements.tryPeekProperlyNestedBodyElement();r.framesetOk&&i&&(r.treeAdapter.detachNode(i),r.openElements.popAllUpToHtmlElement(),r._insertElement(e,se.HTML),r.insertionMode=B.IN_FRAMESET)}function kM(r,e){r.openElements.hasInButtonScope(_.P)&&r._closePElement(),r._insertElement(e,se.HTML)}function AM(r,e){r.openElements.hasInButtonScope(_.P)&&r._closePElement(),XA(r.openElements.currentTagId)&&r.openElements.pop(),r._insertElement(e,se.HTML)}function CM(r,e){r.openElements.hasInButtonScope(_.P)&&r._closePElement(),r._insertElement(e,se.HTML),r.skipNextNewLine=!0,r.framesetOk=!1}function OM(r,e){const i=r.openElements.tmplCount>0;(!r.formElement||i)&&(r.openElements.hasInButtonScope(_.P)&&r._closePElement(),r._insertElement(e,se.HTML),i||(r.formElement=r.openElements.current))}function wM(r,e){r.framesetOk=!1;const i=e.tagID;for(let s=r.openElements.stackTop;s>=0;s--){const n=r.openElements.tagIDs[s];if(i===_.LI&&n===_.LI||(i===_.DD||i===_.DT)&&(n===_.DD||n===_.DT)){r.openElements.generateImpliedEndTagsWithExclusion(n),r.openElements.popUntilTagNamePopped(n);break}if(n!==_.ADDRESS&&n!==_.DIV&&n!==_.P&&r._isSpecialElement(r.openElements.items[s],n))break}r.openElements.hasInButtonScope(_.P)&&r._closePElement(),r._insertElement(e,se.HTML)}function RM(r,e){r.openElements.hasInButtonScope(_.P)&&r._closePElement(),r._insertElement(e,se.HTML),r.tokenizer.state=Fr.PLAINTEXT}function NM(r,e){r.openElements.hasInScope(_.BUTTON)&&(r.openElements.generateImpliedEndTags(),r.openElements.popUntilTagNamePopped(_.BUTTON)),r._reconstructActiveFormattingElements(),r._insertElement(e,se.HTML),r.framesetOk=!1}function xM(r,e){const i=r.activeFormattingElements.getElementEntryInScopeWithTagName(X.A);i&&(Ob(r,e),r.openElements.remove(i.element),r.activeFormattingElements.removeEntry(i)),r._reconstructActiveFormattingElements(),r._insertElement(e,se.HTML),r.activeFormattingElements.pushElement(r.openElements.current,e)}function DM(r,e){r._reconstructActiveFormattingElements(),r._insertElement(e,se.HTML),r.activeFormattingElements.pushElement(r.openElements.current,e)}function LM(r,e){r._reconstructActiveFormattingElements(),r.openElements.hasInScope(_.NOBR)&&(Ob(r,e),r._reconstructActiveFormattingElements()),r._insertElement(e,se.HTML),r.activeFormattingElements.pushElement(r.openElements.current,e)}function MM(r,e){r._reconstructActiveFormattingElements(),r._insertElement(e,se.HTML),r.activeFormattingElements.insertMarker(),r.framesetOk=!1}function BM(r,e){r.treeAdapter.getDocumentMode(r.document)!==Br.QUIRKS&&r.openElements.hasInButtonScope(_.P)&&r._closePElement(),r._insertElement(e,se.HTML),r.framesetOk=!1,r.insertionMode=B.IN_TABLE}function lC(r,e){r._reconstructActiveFormattingElements(),r._appendElement(e,se.HTML),r.framesetOk=!1,e.ackSelfClosing=!0}function aC(r){const e=YA(r,Uo.TYPE);return e!=null&&e.toLowerCase()===tM}function PM(r,e){r._reconstructActiveFormattingElements(),r._appendElement(e,se.HTML),aC(e)||(r.framesetOk=!1),e.ackSelfClosing=!0}function FM(r,e){r._appendElement(e,se.HTML),e.ackSelfClosing=!0}function UM(r,e){r.openElements.hasInButtonScope(_.P)&&r._closePElement(),r._appendElement(e,se.HTML),r.framesetOk=!1,e.ackSelfClosing=!0}function HM(r,e){e.tagName=X.IMG,e.tagID=_.IMG,lC(r,e)}function GM(r,e){r._insertElement(e,se.HTML),r.skipNextNewLine=!0,r.tokenizer.state=Fr.RCDATA,r.originalInsertionMode=r.insertionMode,r.framesetOk=!1,r.insertionMode=B.TEXT}function VM(r,e){r.openElements.hasInButtonScope(_.P)&&r._closePElement(),r._reconstructActiveFormattingElements(),r.framesetOk=!1,r._switchToTextParsing(e,Fr.RAWTEXT)}function WM(r,e){r.framesetOk=!1,r._switchToTextParsing(e,Fr.RAWTEXT)}function ey(r,e){r._switchToTextParsing(e,Fr.RAWTEXT)}function zM(r,e){r._reconstructActiveFormattingElements(),r._insertElement(e,se.HTML),r.framesetOk=!1,r.insertionMode=r.insertionMode===B.IN_TABLE||r.insertionMode===B.IN_CAPTION||r.insertionMode===B.IN_TABLE_BODY||r.insertionMode===B.IN_ROW||r.insertionMode===B.IN_CELL?B.IN_SELECT_IN_TABLE:B.IN_SELECT}function YM(r,e){r.openElements.currentTagId===_.OPTION&&r.openElements.pop(),r._reconstructActiveFormattingElements(),r._insertElement(e,se.HTML)}function XM(r,e){r.openElements.hasInScope(_.RUBY)&&r.openElements.generateImpliedEndTags(),r._insertElement(e,se.HTML)}function jM(r,e){r.openElements.hasInScope(_.RUBY)&&r.openElements.generateImpliedEndTagsWithExclusion(_.RTC),r._insertElement(e,se.HTML)}function KM(r,e){r._reconstructActiveFormattingElements(),tC(e),Cb(e),e.selfClosing?r._appendElement(e,se.MATHML):r._insertElement(e,se.MATHML),e.ackSelfClosing=!0}function qM(r,e){r._reconstructActiveFormattingElements(),iC(e),Cb(e),e.selfClosing?r._appendElement(e,se.SVG):r._insertElement(e,se.SVG),e.ackSelfClosing=!0}function ty(r,e){r._reconstructActiveFormattingElements(),r._insertElement(e,se.HTML)}function dr(r,e){switch(e.tagID){case _.I:case _.S:case _.B:case _.U:case _.EM:case _.TT:case _.BIG:case _.CODE:case _.FONT:case _.SMALL:case _.STRIKE:case _.STRONG:{DM(r,e);break}case _.A:{xM(r,e);break}case _.H1:case _.H2:case _.H3:case _.H4:case _.H5:case _.H6:{AM(r,e);break}case _.P:case _.DL:case _.OL:case _.UL:case _.DIV:case _.DIR:case _.NAV:case _.MAIN:case _.MENU:case _.ASIDE:case _.CENTER:case _.FIGURE:case _.FOOTER:case _.HEADER:case _.HGROUP:case _.DIALOG:case _.DETAILS:case _.ADDRESS:case _.ARTICLE:case _.SECTION:case _.SUMMARY:case _.FIELDSET:case _.BLOCKQUOTE:case _.FIGCAPTION:{kM(r,e);break}case _.LI:case _.DD:case _.DT:{wM(r,e);break}case _.BR:case _.IMG:case _.WBR:case _.AREA:case _.EMBED:case _.KEYGEN:{lC(r,e);break}case _.HR:{UM(r,e);break}case _.RB:case _.RTC:{XM(r,e);break}case _.RT:case _.RP:{jM(r,e);break}case _.PRE:case _.LISTING:{CM(r,e);break}case _.XMP:{VM(r,e);break}case _.SVG:{qM(r,e);break}case _.HTML:{yM(r,e);break}case _.BASE:case _.LINK:case _.META:case _.STYLE:case _.TITLE:case _.SCRIPT:case _.BGSOUND:case _.BASEFONT:case _.TEMPLATE:{Js(r,e);break}case _.BODY:{SM(r,e);break}case _.FORM:{OM(r,e);break}case _.NOBR:{LM(r,e);break}case _.MATH:{KM(r,e);break}case _.TABLE:{BM(r,e);break}case _.INPUT:{PM(r,e);break}case _.PARAM:case _.TRACK:case _.SOURCE:{FM(r,e);break}case _.IMAGE:{HM(r,e);break}case _.BUTTON:{NM(r,e);break}case _.APPLET:case _.OBJECT:case _.MARQUEE:{MM(r,e);break}case _.IFRAME:{WM(r,e);break}case _.SELECT:{zM(r,e);break}case _.OPTION:case _.OPTGROUP:{YM(r,e);break}case _.NOEMBED:{ey(r,e);break}case _.FRAMESET:{IM(r,e);break}case _.TEXTAREA:{GM(r,e);break}case _.NOSCRIPT:{r.options.scriptingEnabled?ey(r,e):ty(r,e);break}case _.PLAINTEXT:{RM(r,e);break}case _.COL:case _.TH:case _.TD:case _.TR:case _.HEAD:case _.FRAME:case _.TBODY:case _.TFOOT:case _.THEAD:case _.CAPTION:case _.COLGROUP:break;default:ty(r,e)}}function JM(r,e){if(r.openElements.hasInScope(_.BODY)&&(r.insertionMode=B.AFTER_BODY,r.options.sourceCodeLocationInfo)){const i=r.openElements.tryPeekProperlyNestedBodyElement();i&&r._setEndLocation(i,e)}}function QM(r,e){r.openElements.hasInScope(_.BODY)&&(r.insertionMode=B.AFTER_BODY,bC(r,e))}function ZM(r,e){const i=e.tagID;r.openElements.hasInScope(i)&&(r.openElements.generateImpliedEndTags(),r.openElements.popUntilTagNamePopped(i))}function e8(r){const e=r.openElements.tmplCount>0,{formElement:i}=r;e||(r.formElement=null),(i||e)&&r.openElements.hasInScope(_.FORM)&&(r.openElements.generateImpliedEndTags(),e?r.openElements.popUntilTagNamePopped(_.FORM):i&&r.openElements.remove(i))}function t8(r){r.openElements.hasInButtonScope(_.P)||r._insertFakeElement(X.P,_.P),r._closePElement()}function i8(r){r.openElements.hasInListItemScope(_.LI)&&(r.openElements.generateImpliedEndTagsWithExclusion(_.LI),r.openElements.popUntilTagNamePopped(_.LI))}function r8(r,e){const i=e.tagID;r.openElements.hasInScope(i)&&(r.openElements.generateImpliedEndTagsWithExclusion(i),r.openElements.popUntilTagNamePopped(i))}function s8(r){r.openElements.hasNumberedHeaderInScope()&&(r.openElements.generateImpliedEndTags(),r.openElements.popUntilNumberedHeaderPopped())}function n8(r,e){const i=e.tagID;r.openElements.hasInScope(i)&&(r.openElements.generateImpliedEndTags(),r.openElements.popUntilTagNamePopped(i),r.activeFormattingElements.clearToLastMarker())}function o8(r){r._reconstructActiveFormattingElements(),r._insertFakeElement(X.BR,_.BR),r.openElements.pop(),r.framesetOk=!1}function uC(r,e){const i=e.tagName,s=e.tagID;for(let n=r.openElements.stackTop;n>0;n--){const l=r.openElements.items[n],u=r.openElements.tagIDs[n];if(s===u&&(s!==_.UNKNOWN||r.treeAdapter.getTagName(l)===i)){r.openElements.generateImpliedEndTagsWithExclusion(s),r.openElements.stackTop>=n&&r.openElements.shortenToLength(n);break}if(r._isSpecialElement(l,u))break}}function Wf(r,e){switch(e.tagID){case _.A:case _.B:case _.I:case _.S:case _.U:case _.EM:case _.TT:case _.BIG:case _.CODE:case _.FONT:case _.NOBR:case _.SMALL:case _.STRIKE:case _.STRONG:{Ob(r,e);break}case _.P:{t8(r);break}case _.DL:case _.UL:case _.OL:case _.DIR:case _.DIV:case _.NAV:case _.PRE:case _.MAIN:case _.MENU:case _.ASIDE:case _.BUTTON:case _.CENTER:case _.FIGURE:case _.FOOTER:case _.HEADER:case _.HGROUP:case _.DIALOG:case _.ADDRESS:case _.ARTICLE:case _.DETAILS:case _.SECTION:case _.SUMMARY:case _.LISTING:case _.FIELDSET:case _.BLOCKQUOTE:case _.FIGCAPTION:{ZM(r,e);break}case _.LI:{i8(r);break}case _.DD:case _.DT:{r8(r,e);break}case _.H1:case _.H2:case _.H3:case _.H4:case _.H5:case _.H6:{s8(r);break}case _.BR:{o8(r);break}case _.BODY:{JM(r,e);break}case _.HTML:{QM(r,e);break}case _.FORM:{e8(r);break}case _.APPLET:case _.OBJECT:case _.MARQUEE:{n8(r,e);break}case _.TEMPLATE:{Yl(r,e);break}default:uC(r,e)}}function cC(r,e){r.tmplInsertionModeStack.length>0?_C(r,e):wb(r,e)}function l8(r,e){var i;e.tagID===_.SCRIPT&&((i=r.scriptHandler)===null||i===void 0||i.call(r,r.openElements.current)),r.openElements.pop(),r.insertionMode=r.originalInsertionMode}function a8(r,e){r._err(e,te.eofInElementThatCanContainOnlyText),r.openElements.pop(),r.insertionMode=r.originalInsertionMode,r.onEof(e)}function n1(r,e){if(rC.has(r.openElements.currentTagId))switch(r.pendingCharacterTokens.length=0,r.hasNonWhitespacePendingCharacterToken=!1,r.originalInsertionMode=r.insertionMode,r.insertionMode=B.IN_TABLE_TEXT,e.type){case Nt.CHARACTER:{dC(r,e);break}case Nt.WHITESPACE_CHARACTER:{hC(r,e);break}}else ch(r,e)}function u8(r,e){r.openElements.clearBackToTableContext(),r.activeFormattingElements.insertMarker(),r._insertElement(e,se.HTML),r.insertionMode=B.IN_CAPTION}function c8(r,e){r.openElements.clearBackToTableContext(),r._insertElement(e,se.HTML),r.insertionMode=B.IN_COLUMN_GROUP}function h8(r,e){r.openElements.clearBackToTableContext(),r._insertFakeElement(X.COLGROUP,_.COLGROUP),r.insertionMode=B.IN_COLUMN_GROUP,Rb(r,e)}function d8(r,e){r.openElements.clearBackToTableContext(),r._insertElement(e,se.HTML),r.insertionMode=B.IN_TABLE_BODY}function f8(r,e){r.openElements.clearBackToTableContext(),r._insertFakeElement(X.TBODY,_.TBODY),r.insertionMode=B.IN_TABLE_BODY,zf(r,e)}function p8(r,e){r.openElements.hasInTableScope(_.TABLE)&&(r.openElements.popUntilTagNamePopped(_.TABLE),r._resetInsertionMode(),r._processStartTag(e))}function m8(r,e){aC(e)?r._appendElement(e,se.HTML):ch(r,e),e.ackSelfClosing=!0}function g8(r,e){!r.formElement&&r.openElements.tmplCount===0&&(r._insertElement(e,se.HTML),r.formElement=r.openElements.current,r.openElements.pop())}function Za(r,e){switch(e.tagID){case _.TD:case _.TH:case _.TR:{f8(r,e);break}case _.STYLE:case _.SCRIPT:case _.TEMPLATE:{Js(r,e);break}case _.COL:{h8(r,e);break}case _.FORM:{g8(r,e);break}case _.TABLE:{p8(r,e);break}case _.TBODY:case _.TFOOT:case _.THEAD:{d8(r,e);break}case _.INPUT:{m8(r,e);break}case _.CAPTION:{u8(r,e);break}case _.COLGROUP:{c8(r,e);break}default:ch(r,e)}}function Yc(r,e){switch(e.tagID){case _.TABLE:{r.openElements.hasInTableScope(_.TABLE)&&(r.openElements.popUntilTagNamePopped(_.TABLE),r._resetInsertionMode());break}case _.TEMPLATE:{Yl(r,e);break}case _.BODY:case _.CAPTION:case _.COL:case _.COLGROUP:case _.HTML:case _.TBODY:case _.TD:case _.TFOOT:case _.TH:case _.THEAD:case _.TR:break;default:ch(r,e)}}function ch(r,e){const i=r.fosterParentingEnabled;r.fosterParentingEnabled=!0,Vf(r,e),r.fosterParentingEnabled=i}function hC(r,e){r.pendingCharacterTokens.push(e)}function dC(r,e){r.pendingCharacterTokens.push(e),r.hasNonWhitespacePendingCharacterToken=!0}function _c(r,e){let i=0;if(r.hasNonWhitespacePendingCharacterToken)for(;i<r.pendingCharacterTokens.length;i++)ch(r,r.pendingCharacterTokens[i]);else for(;i<r.pendingCharacterTokens.length;i++)r._insertCharacters(r.pendingCharacterTokens[i]);r.insertionMode=r.originalInsertionMode,r._processToken(e)}const fC=new Set([_.CAPTION,_.COL,_.COLGROUP,_.TBODY,_.TD,_.TFOOT,_.TH,_.THEAD,_.TR]);function _8(r,e){const i=e.tagID;fC.has(i)?r.openElements.hasInTableScope(_.CAPTION)&&(r.openElements.generateImpliedEndTags(),r.openElements.popUntilTagNamePopped(_.CAPTION),r.activeFormattingElements.clearToLastMarker(),r.insertionMode=B.IN_TABLE,Za(r,e)):dr(r,e)}function b8(r,e){const i=e.tagID;switch(i){case _.CAPTION:case _.TABLE:{r.openElements.hasInTableScope(_.CAPTION)&&(r.openElements.generateImpliedEndTags(),r.openElements.popUntilTagNamePopped(_.CAPTION),r.activeFormattingElements.clearToLastMarker(),r.insertionMode=B.IN_TABLE,i===_.TABLE&&Yc(r,e));break}case _.BODY:case _.COL:case _.COLGROUP:case _.HTML:case _.TBODY:case _.TD:case _.TFOOT:case _.TH:case _.THEAD:case _.TR:break;default:Wf(r,e)}}function Rb(r,e){switch(e.tagID){case _.HTML:{dr(r,e);break}case _.COL:{r._appendElement(e,se.HTML),e.ackSelfClosing=!0;break}case _.TEMPLATE:{Js(r,e);break}default:U0(r,e)}}function T8(r,e){switch(e.tagID){case _.COLGROUP:{r.openElements.currentTagId===_.COLGROUP&&(r.openElements.pop(),r.insertionMode=B.IN_TABLE);break}case _.TEMPLATE:{Yl(r,e);break}case _.COL:break;default:U0(r,e)}}function U0(r,e){r.openElements.currentTagId===_.COLGROUP&&(r.openElements.pop(),r.insertionMode=B.IN_TABLE,r._processToken(e))}function zf(r,e){switch(e.tagID){case _.TR:{r.openElements.clearBackToTableBodyContext(),r._insertElement(e,se.HTML),r.insertionMode=B.IN_ROW;break}case _.TH:case _.TD:{r.openElements.clearBackToTableBodyContext(),r._insertFakeElement(X.TR,_.TR),r.insertionMode=B.IN_ROW,Yf(r,e);break}case _.CAPTION:case _.COL:case _.COLGROUP:case _.TBODY:case _.TFOOT:case _.THEAD:{r.openElements.hasTableBodyContextInTableScope()&&(r.openElements.clearBackToTableBodyContext(),r.openElements.pop(),r.insertionMode=B.IN_TABLE,Za(r,e));break}default:Za(r,e)}}function n_(r,e){const i=e.tagID;switch(e.tagID){case _.TBODY:case _.TFOOT:case _.THEAD:{r.openElements.hasInTableScope(i)&&(r.openElements.clearBackToTableBodyContext(),r.openElements.pop(),r.insertionMode=B.IN_TABLE);break}case _.TABLE:{r.openElements.hasTableBodyContextInTableScope()&&(r.openElements.clearBackToTableBodyContext(),r.openElements.pop(),r.insertionMode=B.IN_TABLE,Yc(r,e));break}case _.BODY:case _.CAPTION:case _.COL:case _.COLGROUP:case _.HTML:case _.TD:case _.TH:case _.TR:break;default:Yc(r,e)}}function Yf(r,e){switch(e.tagID){case _.TH:case _.TD:{r.openElements.clearBackToTableRowContext(),r._insertElement(e,se.HTML),r.insertionMode=B.IN_CELL,r.activeFormattingElements.insertMarker();break}case _.CAPTION:case _.COL:case _.COLGROUP:case _.TBODY:case _.TFOOT:case _.THEAD:case _.TR:{r.openElements.hasInTableScope(_.TR)&&(r.openElements.clearBackToTableRowContext(),r.openElements.pop(),r.insertionMode=B.IN_TABLE_BODY,zf(r,e));break}default:Za(r,e)}}function pC(r,e){switch(e.tagID){case _.TR:{r.openElements.hasInTableScope(_.TR)&&(r.openElements.clearBackToTableRowContext(),r.openElements.pop(),r.insertionMode=B.IN_TABLE_BODY);break}case _.TABLE:{r.openElements.hasInTableScope(_.TR)&&(r.openElements.clearBackToTableRowContext(),r.openElements.pop(),r.insertionMode=B.IN_TABLE_BODY,n_(r,e));break}case _.TBODY:case _.TFOOT:case _.THEAD:{(r.openElements.hasInTableScope(e.tagID)||r.openElements.hasInTableScope(_.TR))&&(r.openElements.clearBackToTableRowContext(),r.openElements.pop(),r.insertionMode=B.IN_TABLE_BODY,n_(r,e));break}case _.BODY:case _.CAPTION:case _.COL:case _.COLGROUP:case _.HTML:case _.TD:case _.TH:break;default:Yc(r,e)}}function E8(r,e){const i=e.tagID;fC.has(i)?(r.openElements.hasInTableScope(_.TD)||r.openElements.hasInTableScope(_.TH))&&(r._closeTableCell(),Yf(r,e)):dr(r,e)}function $8(r,e){const i=e.tagID;switch(i){case _.TD:case _.TH:{r.openElements.hasInTableScope(i)&&(r.openElements.generateImpliedEndTags(),r.openElements.popUntilTagNamePopped(i),r.activeFormattingElements.clearToLastMarker(),r.insertionMode=B.IN_ROW);break}case _.TABLE:case _.TBODY:case _.TFOOT:case _.THEAD:case _.TR:{r.openElements.hasInTableScope(i)&&(r._closeTableCell(),pC(r,e));break}case _.BODY:case _.CAPTION:case _.COL:case _.COLGROUP:case _.HTML:break;default:Wf(r,e)}}function mC(r,e){switch(e.tagID){case _.HTML:{dr(r,e);break}case _.OPTION:{r.openElements.currentTagId===_.OPTION&&r.openElements.pop(),r._insertElement(e,se.HTML);break}case _.OPTGROUP:{r.openElements.currentTagId===_.OPTION&&r.openElements.pop(),r.openElements.currentTagId===_.OPTGROUP&&r.openElements.pop(),r._insertElement(e,se.HTML);break}case _.INPUT:case _.KEYGEN:case _.TEXTAREA:case _.SELECT:{r.openElements.hasInSelectScope(_.SELECT)&&(r.openElements.popUntilTagNamePopped(_.SELECT),r._resetInsertionMode(),e.tagID!==_.SELECT&&r._processStartTag(e));break}case _.SCRIPT:case _.TEMPLATE:{Js(r,e);break}}}function gC(r,e){switch(e.tagID){case _.OPTGROUP:{r.openElements.stackTop>0&&r.openElements.currentTagId===_.OPTION&&r.openElements.tagIDs[r.openElements.stackTop-1]===_.OPTGROUP&&r.openElements.pop(),r.openElements.currentTagId===_.OPTGROUP&&r.openElements.pop();break}case _.OPTION:{r.openElements.currentTagId===_.OPTION&&r.openElements.pop();break}case _.SELECT:{r.openElements.hasInSelectScope(_.SELECT)&&(r.openElements.popUntilTagNamePopped(_.SELECT),r._resetInsertionMode());break}case _.TEMPLATE:{Yl(r,e);break}}}function v8(r,e){const i=e.tagID;i===_.CAPTION||i===_.TABLE||i===_.TBODY||i===_.TFOOT||i===_.THEAD||i===_.TR||i===_.TD||i===_.TH?(r.openElements.popUntilTagNamePopped(_.SELECT),r._resetInsertionMode(),r._processStartTag(e)):mC(r,e)}function y8(r,e){const i=e.tagID;i===_.CAPTION||i===_.TABLE||i===_.TBODY||i===_.TFOOT||i===_.THEAD||i===_.TR||i===_.TD||i===_.TH?r.openElements.hasInTableScope(i)&&(r.openElements.popUntilTagNamePopped(_.SELECT),r._resetInsertionMode(),r.onEndTag(e)):gC(r,e)}function S8(r,e){switch(e.tagID){case _.BASE:case _.BASEFONT:case _.BGSOUND:case _.LINK:case _.META:case _.NOFRAMES:case _.SCRIPT:case _.STYLE:case _.TEMPLATE:case _.TITLE:{Js(r,e);break}case _.CAPTION:case _.COLGROUP:case _.TBODY:case _.TFOOT:case _.THEAD:{r.tmplInsertionModeStack[0]=B.IN_TABLE,r.insertionMode=B.IN_TABLE,Za(r,e);break}case _.COL:{r.tmplInsertionModeStack[0]=B.IN_COLUMN_GROUP,r.insertionMode=B.IN_COLUMN_GROUP,Rb(r,e);break}case _.TR:{r.tmplInsertionModeStack[0]=B.IN_TABLE_BODY,r.insertionMode=B.IN_TABLE_BODY,zf(r,e);break}case _.TD:case _.TH:{r.tmplInsertionModeStack[0]=B.IN_ROW,r.insertionMode=B.IN_ROW,Yf(r,e);break}default:r.tmplInsertionModeStack[0]=B.IN_BODY,r.insertionMode=B.IN_BODY,dr(r,e)}}function I8(r,e){e.tagID===_.TEMPLATE&&Yl(r,e)}function _C(r,e){r.openElements.tmplCount>0?(r.openElements.popUntilTagNamePopped(_.TEMPLATE),r.activeFormattingElements.clearToLastMarker(),r.tmplInsertionModeStack.shift(),r._resetInsertionMode(),r.onEof(e)):wb(r,e)}function k8(r,e){e.tagID===_.HTML?dr(r,e):H0(r,e)}function bC(r,e){var i;if(e.tagID===_.HTML){if(r.fragmentContext||(r.insertionMode=B.AFTER_AFTER_BODY),r.options.sourceCodeLocationInfo&&r.openElements.tagIDs[0]===_.HTML){r._setEndLocation(r.openElements.items[0],e);const s=r.openElements.items[1];s&&!(!((i=r.treeAdapter.getNodeSourceCodeLocation(s))===null||i===void 0)&&i.endTag)&&r._setEndLocation(s,e)}}else H0(r,e)}function H0(r,e){r.insertionMode=B.IN_BODY,Vf(r,e)}function A8(r,e){switch(e.tagID){case _.HTML:{dr(r,e);break}case _.FRAMESET:{r._insertElement(e,se.HTML);break}case _.FRAME:{r._appendElement(e,se.HTML),e.ackSelfClosing=!0;break}case _.NOFRAMES:{Js(r,e);break}}}function C8(r,e){e.tagID===_.FRAMESET&&!r.openElements.isRootHtmlElementCurrent()&&(r.openElements.pop(),!r.fragmentContext&&r.openElements.currentTagId!==_.FRAMESET&&(r.insertionMode=B.AFTER_FRAMESET))}function O8(r,e){switch(e.tagID){case _.HTML:{dr(r,e);break}case _.NOFRAMES:{Js(r,e);break}}}function w8(r,e){e.tagID===_.HTML&&(r.insertionMode=B.AFTER_AFTER_FRAMESET)}function R8(r,e){e.tagID===_.HTML?dr(r,e):b0(r,e)}function b0(r,e){r.insertionMode=B.IN_BODY,Vf(r,e)}function N8(r,e){switch(e.tagID){case _.HTML:{dr(r,e);break}case _.NOFRAMES:{Js(r,e);break}}}function x8(r,e){e.chars=ri,r._insertCharacters(e)}function D8(r,e){r._insertCharacters(e),r.framesetOk=!1}function TC(r){for(;r.treeAdapter.getNamespaceURI(r.openElements.current)!==se.HTML&&!r._isIntegrationPoint(r.openElements.currentTagId,r.openElements.current);)r.openElements.pop()}function L8(r,e){if(qL(e))TC(r),r._startTagOutsideForeignContent(e);else{const i=r._getAdjustedCurrentElement(),s=r.treeAdapter.getNamespaceURI(i);s===se.MATHML?tC(e):s===se.SVG&&(JL(e),iC(e)),Cb(e),e.selfClosing?r._appendElement(e,s):r._insertElement(e,s),e.ackSelfClosing=!0}}function M8(r,e){if(e.tagID===_.P||e.tagID===_.BR){TC(r),r._endTagOutsideForeignContent(e);return}for(let i=r.openElements.stackTop;i>0;i--){const s=r.openElements.items[i];if(r.treeAdapter.getNamespaceURI(s)===se.HTML){r._endTagOutsideForeignContent(e);break}const n=r.treeAdapter.getTagName(s);if(n.toLowerCase()===e.tagName){e.tagName=n,r.openElements.shortenToLength(i);break}}}const B8=new Set([X.AREA,X.BASE,X.BASEFONT,X.BGSOUND,X.BR,X.COL,X.EMBED,X.FRAME,X.HR,X.IMG,X.INPUT,X.KEYGEN,X.LINK,X.META,X.PARAM,X.SOURCE,X.TRACK,X.WBR]);function P8(r,e){return e.treeAdapter.isElementNode(r)&&e.treeAdapter.getNamespaceURI(r)===se.HTML&&B8.has(e.treeAdapter.getTagName(r))}const F8={treeAdapter:Rl,scriptingEnabled:!0};function U8(r,e){const i={...F8,...e};return EC(r,i)}function H8(r,e){let i="";const s=e.treeAdapter.isElementNode(r)&&e.treeAdapter.getTagName(r)===X.TEMPLATE&&e.treeAdapter.getNamespaceURI(r)===se.HTML?e.treeAdapter.getTemplateContent(r):r,n=e.treeAdapter.getChildNodes(s);if(n)for(const l of n)i+=EC(l,e);return i}function EC(r,e){return e.treeAdapter.isElementNode(r)?G8(r,e):e.treeAdapter.isTextNode(r)?W8(r,e):e.treeAdapter.isCommentNode(r)?z8(r,e):e.treeAdapter.isDocumentTypeNode(r)?Y8(r,e):""}function G8(r,e){const i=e.treeAdapter.getTagName(r);return`<${i}${V8(r,e)}>${P8(r,e)?"":`${H8(r,e)}</${i}>`}`}function V8(r,{treeAdapter:e}){let i="";for(const s of e.getAttrList(r)){if(i+=" ",!s.namespace)i+=s.name;else switch(s.namespace){case se.XML:{i+=`xml:${s.name}`;break}case se.XMLNS:{s.name!=="xmlns"&&(i+="xmlns:"),i+=s.name;break}case se.XLINK:{i+=`xlink:${s.name}`;break}default:i+=`${s.prefix}:${s.name}`}i+=`="${aA(s.value)}"`}return i}function W8(r,e){const{treeAdapter:i}=e,s=i.getTextNodeContent(r),n=i.getParentNode(r),l=n&&i.isElementNode(n)&&i.getTagName(n);return l&&i.getNamespaceURI(n)===se.HTML&&SL(l,e.scriptingEnabled)?s:uA(s)}function z8(r,{treeAdapter:e}){return`<!--${e.getCommentNodeContent(r)}-->`}function Y8(r,{treeAdapter:e}){return`<!DOCTYPE ${e.getDocumentTypeNodeName(r)}>`}function X8(r,e){return sC.parse(r,e)}function j8(r,e,i){typeof r=="string"&&(i=e,e=r,r=null);const s=sC.getFragmentParser(r,i);return s.tokenizer.write(e,!0),s.getFragment()}function iy(r){return new Vc(r)}function ry(r){const e=r.includes('"')?"'":'"';return e+r+e}function K8(r,e,i){let s="!DOCTYPE ";return r&&(s+=r),e?s+=` PUBLIC ${ry(e)}`:i&&(s+=" SYSTEM"),i&&(s+=` ${ry(i)}`),s}const Pa={isCommentNode:Lf,isElementNode:et,isTextNode:Sn,createDocument(){const r=new Fl([]);return r["x-mode"]=Br.NO_QUIRKS,r},createDocumentFragment(){return new Fl([])},createElement(r,e,i){const s=Object.create(null),n=Object.create(null),l=Object.create(null);for(let c=0;c<i.length;c++){const h=i[c].name;s[h]=i[c].value,n[h]=i[c].namespace,l[h]=i[c].prefix}const u=new gb(r,s,[]);return u.namespace=e,u["x-attribsNamespace"]=n,u["x-attribsPrefix"]=l,u},createCommentNode(r){return new fb(r)},appendChild(r,e){const i=r.children[r.children.length-1];i&&(i.next=e,e.prev=i),r.children.push(e),e.parent=r},insertBefore(r,e,i){const s=r.children.indexOf(i),{prev:n}=i;n&&(n.next=e,e.prev=n),i.prev=e,e.next=i,r.children.splice(s,0,e),e.parent=r},setTemplateContent(r,e){Pa.appendChild(r,e)},getTemplateContent(r){return r.children[0]},setDocumentType(r,e,i,s){const n=K8(e,i,s);let l=r.children.find(u=>q1(u)&&u.name==="!doctype");l?l.data=n??null:(l=new pb("!doctype",n),Pa.appendChild(r,l)),l["x-name"]=e??void 0,l["x-publicId"]=i??void 0,l["x-systemId"]=s??void 0},setDocumentMode(r,e){r["x-mode"]=e},getDocumentMode(r){return r["x-mode"]},detachNode(r){if(r.parent){const e=r.parent.children.indexOf(r),{prev:i,next:s}=r;r.prev=null,r.next=null,i&&(i.next=s),s&&(s.prev=i),r.parent.children.splice(e,1),r.parent=null}},insertText(r,e){const i=r.children[r.children.length-1];i&&Sn(i)?i.data+=e:Pa.appendChild(r,iy(e))},insertTextBefore(r,e,i){const s=r.children[r.children.indexOf(i)-1];s&&Sn(s)?s.data+=e:Pa.insertBefore(r,iy(e),i)},adoptAttributes(r,e){for(let i=0;i<e.length;i++){const s=e[i].name;typeof r.attribs[s]>"u"&&(r.attribs[s]=e[i].value,r["x-attribsNamespace"][s]=e[i].namespace,r["x-attribsPrefix"][s]=e[i].prefix)}},getFirstChild(r){return r.children[0]},getChildNodes(r){return r.children},getParentNode(r){return r.parent},getAttrList(r){return r.attributes},getTagName(r){return r.name},getNamespaceURI(r){return r.namespace},getTextNodeContent(r){return r.data},getCommentNodeContent(r){return r.data},getDocumentTypeNodeName(r){var e;return(e=r["x-name"])!==null&&e!==void 0?e:""},getDocumentTypeNodePublicId(r){var e;return(e=r["x-publicId"])!==null&&e!==void 0?e:""},getDocumentTypeNodeSystemId(r){var e;return(e=r["x-systemId"])!==null&&e!==void 0?e:""},isDocumentTypeNode(r){return q1(r)&&r.name==="!doctype"},setNodeSourceCodeLocation(r,e){e&&(r.startIndex=e.startOffset,r.endIndex=e.endOffset),r.sourceCodeLocation=e},getNodeSourceCodeLocation(r){return r.sourceCodeLocation},updateNodeSourceCodeLocation(r,e){e.endOffset!=null&&(r.endIndex=e.endOffset),r.sourceCodeLocation={...r.sourceCodeLocation,...e}}};function q8(r,e,i,s){const n={scriptingEnabled:typeof e.scriptingEnabled=="boolean"?e.scriptingEnabled:!0,treeAdapter:Pa,sourceCodeLocationInfo:e.sourceCodeLocationInfo};return i?X8(r,n):j8(s,r,n)}const J8={treeAdapter:Pa};function Q8(r){const e="length"in r?r:[r];for(let s=0;s<e.length;s+=1){const n=e[s];Wl(n)&&Array.prototype.splice.call(e,s,1,...n.children)}let i="";for(let s=0;s<e.length;s+=1){const n=e[s];i+=U8(n,J8)}return i}var Ne;(function(r){r[r.Tab=9]="Tab",r[r.NewLine=10]="NewLine",r[r.FormFeed=12]="FormFeed",r[r.CarriageReturn=13]="CarriageReturn",r[r.Space=32]="Space",r[r.ExclamationMark=33]="ExclamationMark",r[r.Num=35]="Num",r[r.Amp=38]="Amp",r[r.SingleQuote=39]="SingleQuote",r[r.DoubleQuote=34]="DoubleQuote",r[r.Dash=45]="Dash",r[r.Slash=47]="Slash",r[r.Zero=48]="Zero",r[r.Nine=57]="Nine",r[r.Semi=59]="Semi",r[r.Lt=60]="Lt",r[r.Eq=61]="Eq",r[r.Gt=62]="Gt",r[r.Questionmark=63]="Questionmark",r[r.UpperA=65]="UpperA",r[r.LowerA=97]="LowerA",r[r.UpperF=70]="UpperF",r[r.LowerF=102]="LowerF",r[r.UpperZ=90]="UpperZ",r[r.LowerZ=122]="LowerZ",r[r.LowerX=120]="LowerX",r[r.OpeningSquareBracket=91]="OpeningSquareBracket"})(Ne||(Ne={}));var ce;(function(r){r[r.Text=1]="Text",r[r.BeforeTagName=2]="BeforeTagName",r[r.InTagName=3]="InTagName",r[r.InSelfClosingTag=4]="InSelfClosingTag",r[r.BeforeClosingTagName=5]="BeforeClosingTagName",r[r.InClosingTagName=6]="InClosingTagName",r[r.AfterClosingTagName=7]="AfterClosingTagName",r[r.BeforeAttributeName=8]="BeforeAttributeName",r[r.InAttributeName=9]="InAttributeName",r[r.AfterAttributeName=10]="AfterAttributeName",r[r.BeforeAttributeValue=11]="BeforeAttributeValue",r[r.InAttributeValueDq=12]="InAttributeValueDq",r[r.InAttributeValueSq=13]="InAttributeValueSq",r[r.InAttributeValueNq=14]="InAttributeValueNq",r[r.BeforeDeclaration=15]="BeforeDeclaration",r[r.InDeclaration=16]="InDeclaration",r[r.InProcessingInstruction=17]="InProcessingInstruction",r[r.BeforeComment=18]="BeforeComment",r[r.CDATASequence=19]="CDATASequence",r[r.InSpecialComment=20]="InSpecialComment",r[r.InCommentLike=21]="InCommentLike",r[r.BeforeSpecialS=22]="BeforeSpecialS",r[r.SpecialStartSequence=23]="SpecialStartSequence",r[r.InSpecialTag=24]="InSpecialTag",r[r.BeforeEntity=25]="BeforeEntity",r[r.BeforeNumericEntity=26]="BeforeNumericEntity",r[r.InNamedEntity=27]="InNamedEntity",r[r.InNumericEntity=28]="InNumericEntity",r[r.InHexEntity=29]="InHexEntity"})(ce||(ce={}));function Jn(r){return r===Ne.Space||r===Ne.NewLine||r===Ne.Tab||r===Ne.FormFeed||r===Ne.CarriageReturn}function Ud(r){return r===Ne.Slash||r===Ne.Gt||Jn(r)}function sy(r){return r>=Ne.Zero&&r<=Ne.Nine}function Z8(r){return r>=Ne.LowerA&&r<=Ne.LowerZ||r>=Ne.UpperA&&r<=Ne.UpperZ}function e7(r){return r>=Ne.UpperA&&r<=Ne.UpperF||r>=Ne.LowerA&&r<=Ne.LowerF}var Tn;(function(r){r[r.NoValue=0]="NoValue",r[r.Unquoted=1]="Unquoted",r[r.Single=2]="Single",r[r.Double=3]="Double"})(Tn||(Tn={}));const xr={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])};class t7{constructor({xmlMode:e=!1,decodeEntities:i=!0},s){this.cbs=s,this.state=ce.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=ce.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=e,this.decodeEntities=i,this.entityTrie=e?$x:Oo}reset(){this.state=ce.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=ce.Text,this.currentSequence=void 0,this.running=!0,this.offset=0}write(e){this.offset+=this.buffer.length,this.buffer=e,this.parse()}end(){this.running&&this.finish()}pause(){this.running=!1}resume(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()}getIndex(){return this.index}getSectionStart(){return this.sectionStart}stateText(e){e===Ne.Lt||!this.decodeEntities&&this.fastForwardTo(Ne.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=ce.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&e===Ne.Amp&&(this.state=ce.BeforeEntity)}stateSpecialStartSequence(e){const i=this.sequenceIndex===this.currentSequence.length;if(!(i?Ud(e):(e|32)===this.currentSequence[this.sequenceIndex]))this.isSpecial=!1;else if(!i){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=ce.InTagName,this.stateInTagName(e)}stateInSpecialTag(e){if(this.sequenceIndex===this.currentSequence.length){if(e===Ne.Gt||Jn(e)){const i=this.index-this.currentSequence.length;if(this.sectionStart<i){const s=this.index;this.index=i,this.cbs.ontext(this.sectionStart,i),this.index=s}this.isSpecial=!1,this.sectionStart=i+2,this.stateInClosingTagName(e);return}this.sequenceIndex=0}(e|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===xr.TitleEnd?this.decodeEntities&&e===Ne.Amp&&(this.state=ce.BeforeEntity):this.fastForwardTo(Ne.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=Number(e===Ne.Lt)}stateCDATASequence(e){e===xr.Cdata[this.sequenceIndex]?++this.sequenceIndex===xr.Cdata.length&&(this.state=ce.InCommentLike,this.currentSequence=xr.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=ce.InDeclaration,this.stateInDeclaration(e))}fastForwardTo(e){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===e)return!0;return this.index=this.buffer.length+this.offset-1,!1}stateInCommentLike(e){e===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===xr.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=ce.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):e!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}isTagStartChar(e){return this.xmlMode?!Ud(e):Z8(e)}startSpecial(e,i){this.isSpecial=!0,this.currentSequence=e,this.sequenceIndex=i,this.state=ce.SpecialStartSequence}stateBeforeTagName(e){if(e===Ne.ExclamationMark)this.state=ce.BeforeDeclaration,this.sectionStart=this.index+1;else if(e===Ne.Questionmark)this.state=ce.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(e)){const i=e|32;this.sectionStart=this.index,!this.xmlMode&&i===xr.TitleEnd[2]?this.startSpecial(xr.TitleEnd,3):this.state=!this.xmlMode&&i===xr.ScriptEnd[2]?ce.BeforeSpecialS:ce.InTagName}else e===Ne.Slash?this.state=ce.BeforeClosingTagName:(this.state=ce.Text,this.stateText(e))}stateInTagName(e){Ud(e)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=ce.BeforeAttributeName,this.stateBeforeAttributeName(e))}stateBeforeClosingTagName(e){Jn(e)||(e===Ne.Gt?this.state=ce.Text:(this.state=this.isTagStartChar(e)?ce.InClosingTagName:ce.InSpecialComment,this.sectionStart=this.index))}stateInClosingTagName(e){(e===Ne.Gt||Jn(e))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=ce.AfterClosingTagName,this.stateAfterClosingTagName(e))}stateAfterClosingTagName(e){(e===Ne.Gt||this.fastForwardTo(Ne.Gt))&&(this.state=ce.Text,this.sectionStart=this.index+1)}stateBeforeAttributeName(e){e===Ne.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=ce.InSpecialTag,this.sequenceIndex=0):this.state=ce.Text,this.baseState=this.state,this.sectionStart=this.index+1):e===Ne.Slash?this.state=ce.InSelfClosingTag:Jn(e)||(this.state=ce.InAttributeName,this.sectionStart=this.index)}stateInSelfClosingTag(e){e===Ne.Gt?(this.cbs.onselfclosingtag(this.index),this.state=ce.Text,this.baseState=ce.Text,this.sectionStart=this.index+1,this.isSpecial=!1):Jn(e)||(this.state=ce.BeforeAttributeName,this.stateBeforeAttributeName(e))}stateInAttributeName(e){(e===Ne.Eq||Ud(e))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=ce.AfterAttributeName,this.stateAfterAttributeName(e))}stateAfterAttributeName(e){e===Ne.Eq?this.state=ce.BeforeAttributeValue:e===Ne.Slash||e===Ne.Gt?(this.cbs.onattribend(Tn.NoValue,this.index),this.state=ce.BeforeAttributeName,this.stateBeforeAttributeName(e)):Jn(e)||(this.cbs.onattribend(Tn.NoValue,this.index),this.state=ce.InAttributeName,this.sectionStart=this.index)}stateBeforeAttributeValue(e){e===Ne.DoubleQuote?(this.state=ce.InAttributeValueDq,this.sectionStart=this.index+1):e===Ne.SingleQuote?(this.state=ce.InAttributeValueSq,this.sectionStart=this.index+1):Jn(e)||(this.sectionStart=this.index,this.state=ce.InAttributeValueNq,this.stateInAttributeValueNoQuotes(e))}handleInAttributeValue(e,i){e===i||!this.decodeEntities&&this.fastForwardTo(i)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(i===Ne.DoubleQuote?Tn.Double:Tn.Single,this.index),this.state=ce.BeforeAttributeName):this.decodeEntities&&e===Ne.Amp&&(this.baseState=this.state,this.state=ce.BeforeEntity)}stateInAttributeValueDoubleQuotes(e){this.handleInAttributeValue(e,Ne.DoubleQuote)}stateInAttributeValueSingleQuotes(e){this.handleInAttributeValue(e,Ne.SingleQuote)}stateInAttributeValueNoQuotes(e){Jn(e)||e===Ne.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(Tn.Unquoted,this.index),this.state=ce.BeforeAttributeName,this.stateBeforeAttributeName(e)):this.decodeEntities&&e===Ne.Amp&&(this.baseState=this.state,this.state=ce.BeforeEntity)}stateBeforeDeclaration(e){e===Ne.OpeningSquareBracket?(this.state=ce.CDATASequence,this.sequenceIndex=0):this.state=e===Ne.Dash?ce.BeforeComment:ce.InDeclaration}stateInDeclaration(e){(e===Ne.Gt||this.fastForwardTo(Ne.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=ce.Text,this.sectionStart=this.index+1)}stateInProcessingInstruction(e){(e===Ne.Gt||this.fastForwardTo(Ne.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=ce.Text,this.sectionStart=this.index+1)}stateBeforeComment(e){e===Ne.Dash?(this.state=ce.InCommentLike,this.currentSequence=xr.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=ce.InDeclaration}stateInSpecialComment(e){(e===Ne.Gt||this.fastForwardTo(Ne.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=ce.Text,this.sectionStart=this.index+1)}stateBeforeSpecialS(e){const i=e|32;i===xr.ScriptEnd[3]?this.startSpecial(xr.ScriptEnd,4):i===xr.StyleEnd[3]?this.startSpecial(xr.StyleEnd,4):(this.state=ce.InTagName,this.stateInTagName(e))}stateBeforeEntity(e){this.entityExcess=1,this.entityResult=0,e===Ne.Num?this.state=ce.BeforeNumericEntity:e===Ne.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=ce.InNamedEntity,this.stateInNamedEntity(e))}stateInNamedEntity(e){if(this.entityExcess+=1,this.trieIndex=nA(this.entityTrie,this.trieCurrent,this.trieIndex+1,e),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];const i=this.trieCurrent&to.VALUE_LENGTH;if(i){const s=(i>>14)-1;if(!this.allowLegacyEntity()&&e!==Ne.Semi)this.trieIndex+=s;else{const n=this.index-this.entityExcess+1;n>this.sectionStart&&this.emitPartial(this.sectionStart,n),this.entityResult=this.trieIndex,this.trieIndex+=s,this.entityExcess=0,this.sectionStart=this.index+1,s===0&&this.emitNamedEntity()}}}emitNamedEntity(){if(this.state=this.baseState,this.entityResult===0)return;switch((this.entityTrie[this.entityResult]&to.VALUE_LENGTH)>>14){case 1:this.emitCodePoint(this.entityTrie[this.entityResult]&~to.VALUE_LENGTH);break;case 2:this.emitCodePoint(this.entityTrie[this.entityResult+1]);break;case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}}stateBeforeNumericEntity(e){(e|32)===Ne.LowerX?(this.entityExcess++,this.state=ce.InHexEntity):(this.state=ce.InNumericEntity,this.stateInNumericEntity(e))}emitNumericEntity(e){const i=this.index-this.entityExcess-1;i+2+Number(this.state===ce.InHexEntity)!==this.index&&(i>this.sectionStart&&this.emitPartial(this.sectionStart,i),this.sectionStart=this.index+Number(e),this.emitCodePoint(yx(this.entityResult))),this.state=this.baseState}stateInNumericEntity(e){e===Ne.Semi?this.emitNumericEntity(!0):sy(e)?(this.entityResult=this.entityResult*10+(e-Ne.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)}stateInHexEntity(e){e===Ne.Semi?this.emitNumericEntity(!0):sy(e)?(this.entityResult=this.entityResult*16+(e-Ne.Zero),this.entityExcess++):e7(e)?(this.entityResult=this.entityResult*16+((e|32)-Ne.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)}allowLegacyEntity(){return!this.xmlMode&&(this.baseState===ce.Text||this.baseState===ce.InSpecialTag)}cleanup(){this.running&&this.sectionStart!==this.index&&(this.state===ce.Text||this.state===ce.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===ce.InAttributeValueDq||this.state===ce.InAttributeValueSq||this.state===ce.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}shouldContinue(){return this.index<this.buffer.length+this.offset&&this.running}parse(){for(;this.shouldContinue();){const e=this.buffer.charCodeAt(this.index-this.offset);this.state===ce.Text?this.stateText(e):this.state===ce.SpecialStartSequence?this.stateSpecialStartSequence(e):this.state===ce.InSpecialTag?this.stateInSpecialTag(e):this.state===ce.CDATASequence?this.stateCDATASequence(e):this.state===ce.InAttributeValueDq?this.stateInAttributeValueDoubleQuotes(e):this.state===ce.InAttributeName?this.stateInAttributeName(e):this.state===ce.InCommentLike?this.stateInCommentLike(e):this.state===ce.InSpecialComment?this.stateInSpecialComment(e):this.state===ce.BeforeAttributeName?this.stateBeforeAttributeName(e):this.state===ce.InTagName?this.stateInTagName(e):this.state===ce.InClosingTagName?this.stateInClosingTagName(e):this.state===ce.BeforeTagName?this.stateBeforeTagName(e):this.state===ce.AfterAttributeName?this.stateAfterAttributeName(e):this.state===ce.InAttributeValueSq?this.stateInAttributeValueSingleQuotes(e):this.state===ce.BeforeAttributeValue?this.stateBeforeAttributeValue(e):this.state===ce.BeforeClosingTagName?this.stateBeforeClosingTagName(e):this.state===ce.AfterClosingTagName?this.stateAfterClosingTagName(e):this.state===ce.BeforeSpecialS?this.stateBeforeSpecialS(e):this.state===ce.InAttributeValueNq?this.stateInAttributeValueNoQuotes(e):this.state===ce.InSelfClosingTag?this.stateInSelfClosingTag(e):this.state===ce.InDeclaration?this.stateInDeclaration(e):this.state===ce.BeforeDeclaration?this.stateBeforeDeclaration(e):this.state===ce.BeforeComment?this.stateBeforeComment(e):this.state===ce.InProcessingInstruction?this.stateInProcessingInstruction(e):this.state===ce.InNamedEntity?this.stateInNamedEntity(e):this.state===ce.BeforeEntity?this.stateBeforeEntity(e):this.state===ce.InHexEntity?this.stateInHexEntity(e):this.state===ce.InNumericEntity?this.stateInNumericEntity(e):this.stateBeforeNumericEntity(e),this.index++}this.cleanup()}finish(){this.state===ce.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){const e=this.buffer.length+this.offset;this.state===ce.InCommentLike?this.currentSequence===xr.CdataEnd?this.cbs.oncdata(this.sectionStart,e,0):this.cbs.oncomment(this.sectionStart,e,0):this.state===ce.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===ce.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===ce.InTagName||this.state===ce.BeforeAttributeName||this.state===ce.BeforeAttributeValue||this.state===ce.AfterAttributeName||this.state===ce.InAttributeName||this.state===ce.InAttributeValueSq||this.state===ce.InAttributeValueDq||this.state===ce.InAttributeValueNq||this.state===ce.InClosingTagName||this.cbs.ontext(this.sectionStart,e)}emitPartial(e,i){this.baseState!==ce.Text&&this.baseState!==ce.InSpecialTag?this.cbs.onattribdata(e,i):this.cbs.ontext(e,i)}emitCodePoint(e){this.baseState!==ce.Text&&this.baseState!==ce.InSpecialTag?this.cbs.onattribentity(e):this.cbs.ontextentity(e)}}const xa=new Set(["input","option","optgroup","select","button","datalist","textarea"]),Gt=new Set(["p"]),ny=new Set(["thead","tbody"]),oy=new Set(["dd","dt"]),ly=new Set(["rt","rp"]),i7=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",Gt],["h1",Gt],["h2",Gt],["h3",Gt],["h4",Gt],["h5",Gt],["h6",Gt],["select",xa],["input",xa],["output",xa],["button",xa],["datalist",xa],["textarea",xa],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",oy],["dt",oy],["address",Gt],["article",Gt],["aside",Gt],["blockquote",Gt],["details",Gt],["div",Gt],["dl",Gt],["fieldset",Gt],["figcaption",Gt],["figure",Gt],["footer",Gt],["form",Gt],["header",Gt],["hr",Gt],["main",Gt],["nav",Gt],["ol",Gt],["pre",Gt],["section",Gt],["table",Gt],["ul",Gt],["rt",ly],["rp",ly],["tbody",ny],["tfoot",ny]]),r7=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),ay=new Set(["math","svg"]),uy=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),s7=/\s|\//;let n7=class{constructor(e,i={}){var s,n,l,u,c;this.options=i,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=e??{},this.lowerCaseTagNames=(s=i.lowerCaseTags)!==null&&s!==void 0?s:!i.xmlMode,this.lowerCaseAttributeNames=(n=i.lowerCaseAttributeNames)!==null&&n!==void 0?n:!i.xmlMode,this.tokenizer=new((l=i.Tokenizer)!==null&&l!==void 0?l:t7)(this.options,this),(c=(u=this.cbs).onparserinit)===null||c===void 0||c.call(u,this)}ontext(e,i){var s,n;const l=this.getSlice(e,i);this.endIndex=i-1,(n=(s=this.cbs).ontext)===null||n===void 0||n.call(s,l),this.startIndex=i}ontextentity(e){var i,s;const n=this.tokenizer.getSectionStart();this.endIndex=n-1,(s=(i=this.cbs).ontext)===null||s===void 0||s.call(i,w2(e)),this.startIndex=n}isVoidElement(e){return!this.options.xmlMode&&r7.has(e)}onopentagname(e,i){this.endIndex=i;let s=this.getSlice(e,i);this.lowerCaseTagNames&&(s=s.toLowerCase()),this.emitOpenTag(s)}emitOpenTag(e){var i,s,n,l;this.openTagStart=this.startIndex,this.tagname=e;const u=!this.options.xmlMode&&i7.get(e);if(u)for(;this.stack.length>0&&u.has(this.stack[this.stack.length-1]);){const c=this.stack.pop();(s=(i=this.cbs).onclosetag)===null||s===void 0||s.call(i,c,!0)}this.isVoidElement(e)||(this.stack.push(e),ay.has(e)?this.foreignContext.push(!0):uy.has(e)&&this.foreignContext.push(!1)),(l=(n=this.cbs).onopentagname)===null||l===void 0||l.call(n,e),this.cbs.onopentag&&(this.attribs={})}endOpenTag(e){var i,s;this.startIndex=this.openTagStart,this.attribs&&((s=(i=this.cbs).onopentag)===null||s===void 0||s.call(i,this.tagname,this.attribs,e),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""}onopentagend(e){this.endIndex=e,this.endOpenTag(!1),this.startIndex=e+1}onclosetag(e,i){var s,n,l,u,c,h;this.endIndex=i;let f=this.getSlice(e,i);if(this.lowerCaseTagNames&&(f=f.toLowerCase()),(ay.has(f)||uy.has(f))&&this.foreignContext.pop(),this.isVoidElement(f))!this.options.xmlMode&&f==="br"&&((n=(s=this.cbs).onopentagname)===null||n===void 0||n.call(s,"br"),(u=(l=this.cbs).onopentag)===null||u===void 0||u.call(l,"br",{},!0),(h=(c=this.cbs).onclosetag)===null||h===void 0||h.call(c,"br",!1));else{const p=this.stack.lastIndexOf(f);if(p!==-1)if(this.cbs.onclosetag){let g=this.stack.length-p;for(;g--;)this.cbs.onclosetag(this.stack.pop(),g!==0)}else this.stack.length=p;else!this.options.xmlMode&&f==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=i+1}onselfclosingtag(e){this.endIndex=e,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=e+1):this.onopentagend(e)}closeCurrentTag(e){var i,s;const n=this.tagname;this.endOpenTag(e),this.stack[this.stack.length-1]===n&&((s=(i=this.cbs).onclosetag)===null||s===void 0||s.call(i,n,!e),this.stack.pop())}onattribname(e,i){this.startIndex=e;const s=this.getSlice(e,i);this.attribname=this.lowerCaseAttributeNames?s.toLowerCase():s}onattribdata(e,i){this.attribvalue+=this.getSlice(e,i)}onattribentity(e){this.attribvalue+=w2(e)}onattribend(e,i){var s,n;this.endIndex=i,(n=(s=this.cbs).onattribute)===null||n===void 0||n.call(s,this.attribname,this.attribvalue,e===Tn.Double?'"':e===Tn.Single?"'":e===Tn.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""}getInstructionName(e){const i=e.search(s7);let s=i<0?e:e.substr(0,i);return this.lowerCaseTagNames&&(s=s.toLowerCase()),s}ondeclaration(e,i){this.endIndex=i;const s=this.getSlice(e,i);if(this.cbs.onprocessinginstruction){const n=this.getInstructionName(s);this.cbs.onprocessinginstruction(`!${n}`,`!${s}`)}this.startIndex=i+1}onprocessinginstruction(e,i){this.endIndex=i;const s=this.getSlice(e,i);if(this.cbs.onprocessinginstruction){const n=this.getInstructionName(s);this.cbs.onprocessinginstruction(`?${n}`,`?${s}`)}this.startIndex=i+1}oncomment(e,i,s){var n,l,u,c;this.endIndex=i,(l=(n=this.cbs).oncomment)===null||l===void 0||l.call(n,this.getSlice(e,i-s)),(c=(u=this.cbs).oncommentend)===null||c===void 0||c.call(u),this.startIndex=i+1}oncdata(e,i,s){var n,l,u,c,h,f,p,g,T,$;this.endIndex=i;const y=this.getSlice(e,i-s);this.options.xmlMode||this.options.recognizeCDATA?((l=(n=this.cbs).oncdatastart)===null||l===void 0||l.call(n),(c=(u=this.cbs).ontext)===null||c===void 0||c.call(u,y),(f=(h=this.cbs).oncdataend)===null||f===void 0||f.call(h)):((g=(p=this.cbs).oncomment)===null||g===void 0||g.call(p,`[CDATA[${y}]]`),($=(T=this.cbs).oncommentend)===null||$===void 0||$.call(T)),this.startIndex=i+1}onend(){var e,i;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(let s=this.stack.length;s>0;this.cbs.onclosetag(this.stack[--s],!0));}(i=(e=this.cbs).onend)===null||i===void 0||i.call(e)}reset(){var e,i,s,n;(i=(e=this.cbs).onreset)===null||i===void 0||i.call(e),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(n=(s=this.cbs).onparserinit)===null||n===void 0||n.call(s,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1}parseComplete(e){this.reset(),this.end(e)}getSlice(e,i){for(;e-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();let s=this.buffers[0].slice(e-this.bufferOffset,i-this.bufferOffset);for(;i-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),s+=this.buffers[0].slice(0,i-this.bufferOffset);return s}shiftBuffer(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()}write(e){var i,s;if(this.ended){(s=(i=this.cbs).onerror)===null||s===void 0||s.call(i,new Error(".write() after done!"));return}this.buffers.push(e),this.tokenizer.running&&(this.tokenizer.write(e),this.writeIndex++)}end(e){var i,s;if(this.ended){(s=(i=this.cbs).onerror)===null||s===void 0||s.call(i,Error(".end() after done!"));return}e&&this.write(e),this.ended=!0,this.tokenizer.end()}pause(){this.tokenizer.pause()}resume(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()}parseChunk(e){this.write(e)}done(e){this.end(e)}};function o7(r,e){const i=new Ex(void 0,e);return new n7(i,e).end(r),i.root}const l7=PD((r,e,i,s)=>e.xmlMode||e._useHtmlParser2?o7(r,e):q8(r,e,i,s)),Nb=pL(l7,(r,e)=>e.xmlMode||e._useHtmlParser2?Mf(r,e):Q8(r));Nb([]);const Hr=ux(Nb("",{xml:!0}));function a7(r){let e,i=r[1](r[0]).text()+"",s;return{c(){e=Ft("code"),s=Et(i)},l(n){e=Ut(n,"CODE",{});var l=Vt(e);s=$t(l,i),l.forEach(ue)},m(n,l){Ee(n,e,l),vi(e,s)},p(n,[l]){l&3&&i!==(i=n[1](n[0]).text()+"")&&Li(s,i)},i:Wi,o:Wi,d(n){n&&ue(e)}}}function u7(r,e,i){let s;ns(r,Hr,l=>i(1,s=l));let{element:n}=e;return r.$$set=l=>{"element"in l&&i(0,n=l.element)},[n,s]}let $C=class extends Ii{constructor(e){super(),ki(this,e,u7,a7,Ai,{element:0})}};function c7(r){let e,i,s;return i=new Zf({props:{element:r[0]}}),{c(){e=Ft("em"),st(i.$$.fragment)},l(n){e=Ut(n,"EM",{});var l=Vt(e);nt(i.$$.fragment,l),l.forEach(ue)},m(n,l){Ee(n,e,l),ot(i,e,null),s=!0},p(n,[l]){const u={};l&1&&(u.element=n[0]),i.$set(u)},i(n){s||(ee(i.$$.fragment,n),s=!0)},o(n){ae(i.$$.fragment,n),s=!1},d(n){n&&ue(e),lt(i)}}}function h7(r,e,i){let{element:s}=e;return r.$$set=n=>{"element"in n&&i(0,s=n.element)},[s]}class vC extends Ii{constructor(e){super(),ki(this,e,h7,c7,Ai,{element:0})}}function d7(r){let e,i;return{c(){e=Ft("img"),this.h()},l(s){e=Ut(s,"IMG",{style:!0,src:!0,alt:!0}),this.h()},h(){R0(e,"max-width","100%"),A2(e.src,i=r[0])||Ki(e,"src",i),Ki(e,"alt",r[1])},m(s,n){Ee(s,e,n)},p(s,[n]){n&1&&!A2(e.src,i=s[0])&&Ki(e,"src",i),n&2&&Ki(e,"alt",s[1])},i:Wi,o:Wi,d(s){s&&ue(e)}}}function f7(r,e,i){let s,n;ns(r,Hr,c=>i(3,n=c));let{element:l}=e,u;return r.$$set=c=>{"element"in c&&i(2,l=c.element)},r.$$.update=()=>{r.$$.dirty&12&&(n(l).attr("remote")?i(0,u=n(l).attr("remote")+"/"+n(l).attr("source")):i(0,u="./"+n(l).attr("source"))),r.$$.dirty&12&&i(1,s=n(l).attr("description"))},[u,s,l,n]}let p7=class extends Ii{constructor(e){super(),ki(this,e,f7,d7,Ai,{element:2})}};class ts{constructor(e,i,s){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=e,this.start=i,this.end=s}static range(e,i){return i?!e||!e.loc||!i.loc||e.loc.lexer!==i.loc.lexer?null:new ts(e.loc.lexer,e.loc.start,i.loc.end):e&&e.loc}}class Es{constructor(e,i){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=e,this.loc=i}range(e,i){return new Es(i,ts.range(this,e))}}class ge{constructor(e,i){this.position=void 0;var s="KaTeX parse error: "+e,n,l=i&&i.loc;if(l&&l.start<=l.end){var u=l.lexer.input;n=l.start;var c=l.end;n===u.length?s+=" at end of input: ":s+=" at position "+(n+1)+": ";var h=u.slice(n,c).replace(/[^]/g,"$&̲"),f;n>15?f="…"+u.slice(n-15,n):f=u.slice(0,n);var p;c+15<u.length?p=u.slice(c,c+15)+"…":p=u.slice(c),s+=f+h+p}var g=new Error(s);return g.name="ParseError",g.__proto__=ge.prototype,g.position=n,g}}ge.prototype.__proto__=Error.prototype;var m7=function(e,i){return e.indexOf(i)!==-1},g7=function(e,i){return e===void 0?i:e},_7=/([A-Z])/g,b7=function(e){return e.replace(_7,"-$1").toLowerCase()},T7={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},E7=/[&><"']/g;function $7(r){return String(r).replace(E7,e=>T7[e])}var yC=function r(e){return e.type==="ordgroup"||e.type==="color"?e.body.length===1?r(e.body[0]):e:e.type==="font"?r(e.body):e},v7=function(e){var i=yC(e);return i.type==="mathord"||i.type==="textord"||i.type==="atom"},y7=function(e){if(!e)throw new Error("Expected non-null, but got "+String(e));return e},S7=function(e){var i=/^\s*([^\\/#]*?)(?::|&#0*58|&#x0*3a)/i.exec(e);return i!=null?i[1]:"_relative"},Ze={contains:m7,deflt:g7,escape:$7,hyphenate:b7,getBaseElem:yC,isCharacterBox:v7,protocolFromUrl:S7},T0={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\int and \\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:r=>"#"+r},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form '\\foo:expansion' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(r,e)=>(e.push(r),e)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\sqrt` top lines, `{array}` vertical lines, `\\hline`, `\\hdashline`, `\\underline`, `\\overline`, and the borders of `\\fbox`, `\\boxed`, and `\\fcolorbox`.",processor:r=>Math.max(0,r),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\color behave like LaTeX's 2-argument \\textcolor, instead of LaTeX's one-argument \\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:r=>Math.max(0,r),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:r=>Math.max(0,r),cli:"-e, --max-expand <n>",cliProcessor:r=>r==="Infinity"?1/0:parseInt(r)},globalGroup:{type:"boolean",cli:!1}};function I7(r){if(r.default)return r.default;var e=r.type,i=Array.isArray(e)?e[0]:e;if(typeof i!="string")return i.enum[0];switch(i){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class xb{constructor(e){this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,e=e||{};for(var i in T0)if(T0.hasOwnProperty(i)){var s=T0[i];this[i]=e[i]!==void 0?s.processor?s.processor(e[i]):e[i]:I7(s)}}reportNonstrict(e,i,s){var n=this.strict;if(typeof n=="function"&&(n=n(e,i,s)),!(!n||n==="ignore")){if(n===!0||n==="error")throw new ge("LaTeX-incompatible input and strict mode is set to 'error': "+(i+" ["+e+"]"),s);n==="warn"?typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(i+" ["+e+"]")):typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+n+"': "+i+" ["+e+"]"))}}useStrictBehavior(e,i,s){var n=this.strict;if(typeof n=="function")try{n=n(e,i,s)}catch{n="error"}return!n||n==="ignore"?!1:n===!0||n==="error"?!0:n==="warn"?(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(i+" ["+e+"]")),!1):(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+n+"': "+i+" ["+e+"]")),!1)}isTrusted(e){e.url&&!e.protocol&&(e.protocol=Ze.protocolFromUrl(e.url));var i=typeof this.trust=="function"?this.trust(e):this.trust;return Boolean(i)}}class Ao{constructor(e,i,s){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=e,this.size=i,this.cramped=s}sup(){return _n[k7[this.id]]}sub(){return _n[A7[this.id]]}fracNum(){return _n[C7[this.id]]}fracDen(){return _n[O7[this.id]]}cramp(){return _n[w7[this.id]]}text(){return _n[R7[this.id]]}isTight(){return this.size>=2}}var Db=0,G0=1,za=2,io=3,Xc=4,$s=5,eu=6,$r=7,_n=[new Ao(Db,0,!1),new Ao(G0,0,!0),new Ao(za,1,!1),new Ao(io,1,!0),new Ao(Xc,2,!1),new Ao($s,2,!0),new Ao(eu,3,!1),new Ao($r,3,!0)],k7=[Xc,$s,Xc,$s,eu,$r,eu,$r],A7=[$s,$s,$s,$s,$r,$r,$r,$r],C7=[za,io,Xc,$s,eu,$r,eu,$r],O7=[io,io,$s,$s,$r,$r,$r,$r],w7=[G0,G0,io,io,$s,$s,$r,$r],R7=[Db,G0,za,io,za,io,za,io],Ye={DISPLAY:_n[Db],TEXT:_n[za],SCRIPT:_n[Xc],SCRIPTSCRIPT:_n[eu]},o_=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];function N7(r){for(var e=0;e<o_.length;e++)for(var i=o_[e],s=0;s<i.blocks.length;s++){var n=i.blocks[s];if(r>=n[0]&&r<=n[1])return i.name}return null}var E0=[];o_.forEach(r=>r.blocks.forEach(e=>E0.push(...e)));function SC(r){for(var e=0;e<E0.length;e+=2)if(r>=E0[e]&&r<=E0[e+1])return!0;return!1}var Da=80,x7=function(e,i){return"M95,"+(622+e+i)+`
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l`+e/2.075+" -"+e+`
c5.3,-9.3,12,-14,20,-14
H400000v`+(40+e)+`H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M`+(834+e)+" "+i+"h400000v"+(40+e)+"h-400000z"},D7=function(e,i){return"M263,"+(601+e+i)+`c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l`+e/2.084+" -"+e+`
c4.7,-7.3,11,-11,19,-11
H40000v`+(40+e)+`H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M`+(1001+e)+" "+i+"h400000v"+(40+e)+"h-400000z"},L7=function(e,i){return"M983 "+(10+e+i)+`
l`+e/3.13+" -"+e+`
c4,-6.7,10,-10,18,-10 H400000v`+(40+e)+`
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M`+(1001+e)+" "+i+"h400000v"+(40+e)+"h-400000z"},M7=function(e,i){return"M424,"+(2398+e+i)+`
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l`+e/4.223+" -"+e+`c4,-6.7,10,-10,18,-10 H400000
v`+(40+e)+`H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M`+(1001+e)+" "+i+`
h400000v`+(40+e)+"h-400000z"},B7=function(e,i){return"M473,"+(2713+e+i)+`
c339.3,-1799.3,509.3,-2700,510,-2702 l`+e/5.298+" -"+e+`
c3.3,-7.3,9.3,-11,18,-11 H400000v`+(40+e)+`H1017.7
s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200
c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26
s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,
606zM`+(1001+e)+" "+i+"h400000v"+(40+e)+"H1017.7z"},P7=function(e){var i=e/2;return"M400000 "+e+" H0 L"+i+" 0 l65 45 L145 "+(e-80)+" H400000z"},F7=function(e,i,s){var n=s-54-i-e;return"M702 "+(e+i)+"H400000"+(40+e)+`
H742v`+n+`l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 `+i+"H400000v"+(40+e)+"H742z"},U7=function(e,i,s){i=1e3*i;var n="";switch(e){case"sqrtMain":n=x7(i,Da);break;case"sqrtSize1":n=D7(i,Da);break;case"sqrtSize2":n=L7(i,Da);break;case"sqrtSize3":n=M7(i,Da);break;case"sqrtSize4":n=B7(i,Da);break;case"sqrtTall":n=F7(i,Da,s)}return n},H7=function(e,i){switch(e){case"⎜":return"M291 0 H417 V"+i+" H291z M291 0 H417 V"+i+" H291z";case"∣":return"M145 0 H188 V"+i+" H145z M145 0 H188 V"+i+" H145z";case"∥":return"M145 0 H188 V"+i+" H145z M145 0 H188 V"+i+" H145z"+("M367 0 H410 V"+i+" H367z M367 0 H410 V"+i+" H367z");case"⎟":return"M457 0 H583 V"+i+" H457z M457 0 H583 V"+i+" H457z";case"⎢":return"M319 0 H403 V"+i+" H319z M319 0 H403 V"+i+" H319z";case"⎥":return"M263 0 H347 V"+i+" H263z M263 0 H347 V"+i+" H263z";case"⎪":return"M384 0 H504 V"+i+" H384z M384 0 H504 V"+i+" H384z";case"⏐":return"M312 0 H355 V"+i+" H312z M312 0 H355 V"+i+" H312z";case"‖":return"M257 0 H300 V"+i+" H257z M257 0 H300 V"+i+" H257z"+("M478 0 H521 V"+i+" H478z M478 0 H521 V"+i+" H478z");default:return""}},cy={doubleleftarrow:`M262 157
l10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3
 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28
 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5
c2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5
 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87
-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7
-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z
m8 0v40h399730v-40zm0 194v40h399730v-40z`,doublerightarrow:`M399738 392l
-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5
 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88
-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68
-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18
-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782
c-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3
-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,leftarrow:`M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z`,leftbrace:`M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,leftbraceunder:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,leftgroup:`M400000 80
H435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0
 435 0h399565z`,leftgroupunder:`M400000 262
H435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219
 435 219h399565z`,leftharpoon:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3
-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5
-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7
-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,leftharpoonplus:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5
 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3
-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7
-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z
m0 0v40h400000v-40z`,leftharpoondown:`M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333
 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5
 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667
-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,leftharpoondownplus:`M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12
 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7
-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0
v40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,lefthook:`M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5
-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3
-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21
 71.5 23h399859zM103 281v-40h399897v40z`,leftlinesegment:`M40 281 V428 H0 V94 H40 V241 H400000 v40z
M40 281 V428 H0 V94 H40 V241 H400000 v40z`,leftmapsto:`M40 281 V448H0V74H40V241H400000v40z
M40 281 V448H0V74H40V241H400000v40z`,leftToFrom:`M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23
-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8
c28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3
 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,longequal:`M0 50 h400000 v40H0z m0 194h40000v40H0z
M0 50 h400000 v40H0z m0 194h40000v40H0z`,midbrace:`M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,midbraceunder:`M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,oiintSize1:`M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6
-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z
m368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8
60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,oiintSize2:`M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8
-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z
m502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2
c0 110 84 276 504 276s502.4-166 502.4-276z`,oiiintSize1:`M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6
-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z
m525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0
85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,oiiintSize2:`M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8
-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z
m770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1
c0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,rightarrow:`M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z`,rightbrace:`M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,rightbraceunder:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,rightgroup:`M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0
 3-1 3-3v-38c-76-158-257-219-435-219H0z`,rightgroupunder:`M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18
 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,rightharpoon:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3
-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2
-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58
 69.2 92 94.5zm0 0v40h399900v-40z`,rightharpoonplus:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11
-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7
 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z
m0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,rightharpoondown:`M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8
 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5
-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95
-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,rightharpoondownplus:`M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8
 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3
 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3
-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z
m0-194v40h400000v-40zm0 0v40h400000v-40z`,righthook:`M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3
 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0
-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21
 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,rightlinesegment:`M399960 241 V94 h40 V428 h-40 V281 H0 v-40z
M399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,rightToFrom:`M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23
 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32
-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142
-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,twoheadleftarrow:`M0 167c68 40
 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69
-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3
-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19
-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101
 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,twoheadrightarrow:`M400000 167
c-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3
 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42
 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333
-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70
 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,tilde1:`M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z`,tilde2:`M344 55.266c-142 0-300.638 81.316-311.5 86.418
-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9
 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114
c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751
 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,tilde3:`M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457
-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0
 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697
 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696
 -338 0-409-156.573-744-156.573z`,tilde4:`M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345
-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409
 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9
 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409
 -175.236-744-175.236z`,vec:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z`,widehat1:`M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,widehat2:`M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat3:`M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat4:`M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widecheck1:`M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,
-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,widecheck2:`M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck3:`M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck4:`M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,baraboveleftarrow:`M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202
c4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5
c-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130
s-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47
121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6
s2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11
c0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z
M100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,rightarrowabovebar:`M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32
-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0
13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39
-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5
-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,baraboveshortleftharpoon:`M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17
c2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21
c-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40
c-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z
M0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,rightharpoonaboveshortbar:`M0,241 l0,40c399126,0,399993,0,399993,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,shortbaraboveleftharpoon:`M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,
1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,
-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z
M93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,shortrightharpoonabovebar:`M53,241l0,40c398570,0,399437,0,399437,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`},G7=function(e,i){switch(e){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+i+` v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v`+i+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+i+` v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v`+i+" v1759 h84z";case"vert":return"M145 15 v585 v"+i+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-i+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+i+" v585 h43z";case"doublevert":return"M145 15 v585 v"+i+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-i+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+i+` v585 h43z
M367 15 v585 v`+i+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-i+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v`+i+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+i+` v1715 h263 v84 H319z
MM319 602 V0 H403 V602 v`+i+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+i+` v1799 H0 v-84 H319z
MM319 602 V0 H403 V602 v`+i+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+i+` v602 h84z
M403 1759 V0 H319 V1759 v`+i+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+i+` v602 h84z
M347 1759 V0 h-84 V1759 v`+i+" v602 h84z";case"lparen":return`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,`+(i+84)+`c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-`+(i+92)+`c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`;case"rparen":return`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,`+(i+9)+`
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-`+(i+144)+`c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`;default:throw new Error("Unknown stretchy delimiter.")}};let hh=class{constructor(e){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=e,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(e){return Ze.contains(this.classes,e)}toNode(){for(var e=document.createDocumentFragment(),i=0;i<this.children.length;i++)e.appendChild(this.children[i].toNode());return e}toMarkup(){for(var e="",i=0;i<this.children.length;i++)e+=this.children[i].toMarkup();return e}toText(){var e=i=>i.toText();return this.children.map(e).join("")}};var $n={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},Hd={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},hy={Å:"A",Ð:"D",Þ:"o",å:"a",ð:"d",þ:"o",А:"A",Б:"B",В:"B",Г:"F",Д:"A",Е:"E",Ж:"K",З:"3",И:"N",Й:"N",К:"K",Л:"N",М:"M",Н:"H",О:"O",П:"N",Р:"P",С:"C",Т:"T",У:"y",Ф:"O",Х:"X",Ц:"U",Ч:"h",Ш:"W",Щ:"W",Ъ:"B",Ы:"X",Ь:"B",Э:"3",Ю:"X",Я:"R",а:"a",б:"b",в:"a",г:"r",д:"y",е:"e",ж:"m",з:"e",и:"n",й:"n",к:"n",л:"n",м:"m",н:"n",о:"o",п:"n",р:"p",с:"c",т:"o",у:"y",ф:"b",х:"x",ц:"n",ч:"n",ш:"w",щ:"w",ъ:"a",ы:"m",ь:"a",э:"e",ю:"m",я:"r"};function V7(r,e){$n[r]=e}function Lb(r,e,i){if(!$n[e])throw new Error("Font metrics not found for font: "+e+".");var s=r.charCodeAt(0),n=$n[e][s];if(!n&&r[0]in hy&&(s=hy[r[0]].charCodeAt(0),n=$n[e][s]),!n&&i==="text"&&SC(s)&&(n=$n[e][77]),n)return{depth:n[0],height:n[1],italic:n[2],skew:n[3],width:n[4]}}var o1={};function W7(r){var e;if(r>=5?e=0:r>=3?e=1:e=2,!o1[e]){var i=o1[e]={cssEmPerMu:Hd.quad[e]/18};for(var s in Hd)Hd.hasOwnProperty(s)&&(i[s]=Hd[s][e])}return o1[e]}var z7=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],dy=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],fy=function(e,i){return i.size<2?e:z7[e-1][i.size-1]};class Qn{constructor(e){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=e.style,this.color=e.color,this.size=e.size||Qn.BASESIZE,this.textSize=e.textSize||this.size,this.phantom=!!e.phantom,this.font=e.font||"",this.fontFamily=e.fontFamily||"",this.fontWeight=e.fontWeight||"",this.fontShape=e.fontShape||"",this.sizeMultiplier=dy[this.size-1],this.maxSize=e.maxSize,this.minRuleThickness=e.minRuleThickness,this._fontMetrics=void 0}extend(e){var i={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var s in e)e.hasOwnProperty(s)&&(i[s]=e[s]);return new Qn(i)}havingStyle(e){return this.style===e?this:this.extend({style:e,size:fy(this.textSize,e)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(e){return this.size===e&&this.textSize===e?this:this.extend({style:this.style.text(),size:e,textSize:e,sizeMultiplier:dy[e-1]})}havingBaseStyle(e){e=e||this.style.text();var i=fy(Qn.BASESIZE,e);return this.size===i&&this.textSize===Qn.BASESIZE&&this.style===e?this:this.extend({style:e,size:i})}havingBaseSizing(){var e;switch(this.style.id){case 4:case 5:e=3;break;case 6:case 7:e=1;break;default:e=6}return this.extend({style:this.style.text(),size:e})}withColor(e){return this.extend({color:e})}withPhantom(){return this.extend({phantom:!0})}withFont(e){return this.extend({font:e})}withTextFontFamily(e){return this.extend({fontFamily:e,font:""})}withTextFontWeight(e){return this.extend({fontWeight:e,font:""})}withTextFontShape(e){return this.extend({fontShape:e,font:""})}sizingClasses(e){return e.size!==this.size?["sizing","reset-size"+e.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==Qn.BASESIZE?["sizing","reset-size"+this.size,"size"+Qn.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=W7(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}Qn.BASESIZE=6;var l_={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:803/800,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:803/800},Y7={ex:!0,em:!0,mu:!0},IC=function(e){return typeof e!="string"&&(e=e.unit),e in l_||e in Y7||e==="ex"},ci=function(e,i){var s;if(e.unit in l_)s=l_[e.unit]/i.fontMetrics().ptPerEm/i.sizeMultiplier;else if(e.unit==="mu")s=i.fontMetrics().cssEmPerMu;else{var n;if(i.style.isTight()?n=i.havingStyle(i.style.text()):n=i,e.unit==="ex")s=n.fontMetrics().xHeight;else if(e.unit==="em")s=n.fontMetrics().quad;else throw new ge("Invalid unit: '"+e.unit+"'");n!==i&&(s*=n.sizeMultiplier/i.sizeMultiplier)}return Math.min(e.number*s,i.maxSize)},$e=function(e){return+e.toFixed(4)+"em"},Vo=function(e){return e.filter(i=>i).join(" ")},kC=function(e,i,s){if(this.classes=e||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=s||{},i){i.style.isTight()&&this.classes.push("mtight");var n=i.getColor();n&&(this.style.color=n)}},AC=function(e){var i=document.createElement(e);i.className=Vo(this.classes);for(var s in this.style)this.style.hasOwnProperty(s)&&(i.style[s]=this.style[s]);for(var n in this.attributes)this.attributes.hasOwnProperty(n)&&i.setAttribute(n,this.attributes[n]);for(var l=0;l<this.children.length;l++)i.appendChild(this.children[l].toNode());return i},CC=function(e){var i="<"+e;this.classes.length&&(i+=' class="'+Ze.escape(Vo(this.classes))+'"');var s="";for(var n in this.style)this.style.hasOwnProperty(n)&&(s+=Ze.hyphenate(n)+":"+this.style[n]+";");s&&(i+=' style="'+Ze.escape(s)+'"');for(var l in this.attributes)this.attributes.hasOwnProperty(l)&&(i+=" "+l+'="'+Ze.escape(this.attributes[l])+'"');i+=">";for(var u=0;u<this.children.length;u++)i+=this.children[u].toMarkup();return i+="</"+e+">",i};class dh{constructor(e,i,s,n){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,kC.call(this,e,s,n),this.children=i||[]}setAttribute(e,i){this.attributes[e]=i}hasClass(e){return Ze.contains(this.classes,e)}toNode(){return AC.call(this,"span")}toMarkup(){return CC.call(this,"span")}}class Mb{constructor(e,i,s,n){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,kC.call(this,i,n),this.children=s||[],this.setAttribute("href",e)}setAttribute(e,i){this.attributes[e]=i}hasClass(e){return Ze.contains(this.classes,e)}toNode(){return AC.call(this,"a")}toMarkup(){return CC.call(this,"a")}}class X7{constructor(e,i,s){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=i,this.src=e,this.classes=["mord"],this.style=s}hasClass(e){return Ze.contains(this.classes,e)}toNode(){var e=document.createElement("img");e.src=this.src,e.alt=this.alt,e.className="mord";for(var i in this.style)this.style.hasOwnProperty(i)&&(e.style[i]=this.style[i]);return e}toMarkup(){var e="<img  src='"+this.src+" 'alt='"+this.alt+"' ",i="";for(var s in this.style)this.style.hasOwnProperty(s)&&(i+=Ze.hyphenate(s)+":"+this.style[s]+";");return i&&(e+=' style="'+Ze.escape(i)+'"'),e+="'/>",e}}var j7={î:"ı̂",ï:"ı̈",í:"ı́",ì:"ı̀"};class Ss{constructor(e,i,s,n,l,u,c,h){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=e,this.height=i||0,this.depth=s||0,this.italic=n||0,this.skew=l||0,this.width=u||0,this.classes=c||[],this.style=h||{},this.maxFontSize=0;var f=N7(this.text.charCodeAt(0));f&&this.classes.push(f+"_fallback"),/[îïíì]/.test(this.text)&&(this.text=j7[this.text])}hasClass(e){return Ze.contains(this.classes,e)}toNode(){var e=document.createTextNode(this.text),i=null;this.italic>0&&(i=document.createElement("span"),i.style.marginRight=$e(this.italic)),this.classes.length>0&&(i=i||document.createElement("span"),i.className=Vo(this.classes));for(var s in this.style)this.style.hasOwnProperty(s)&&(i=i||document.createElement("span"),i.style[s]=this.style[s]);return i?(i.appendChild(e),i):e}toMarkup(){var e=!1,i="<span";this.classes.length&&(e=!0,i+=' class="',i+=Ze.escape(Vo(this.classes)),i+='"');var s="";this.italic>0&&(s+="margin-right:"+this.italic+"em;");for(var n in this.style)this.style.hasOwnProperty(n)&&(s+=Ze.hyphenate(n)+":"+this.style[n]+";");s&&(e=!0,i+=' style="'+Ze.escape(s)+'"');var l=Ze.escape(this.text);return e?(i+=">",i+=l,i+="</span>",i):l}}class no{constructor(e,i){this.children=void 0,this.attributes=void 0,this.children=e||[],this.attributes=i||{}}toNode(){var e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"svg");for(var s in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,s)&&i.setAttribute(s,this.attributes[s]);for(var n=0;n<this.children.length;n++)i.appendChild(this.children[n].toNode());return i}toMarkup(){var e='<svg xmlns="http://www.w3.org/2000/svg"';for(var i in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,i)&&(e+=" "+i+"='"+this.attributes[i]+"'");e+=">";for(var s=0;s<this.children.length;s++)e+=this.children[s].toMarkup();return e+="</svg>",e}}class Wo{constructor(e,i){this.pathName=void 0,this.alternate=void 0,this.pathName=e,this.alternate=i}toNode(){var e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"path");return this.alternate?i.setAttribute("d",this.alternate):i.setAttribute("d",cy[this.pathName]),i}toMarkup(){return this.alternate?"<path d='"+this.alternate+"'/>":"<path d='"+cy[this.pathName]+"'/>"}}class a_{constructor(e){this.attributes=void 0,this.attributes=e||{}}toNode(){var e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"line");for(var s in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,s)&&i.setAttribute(s,this.attributes[s]);return i}toMarkup(){var e="<line";for(var i in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,i)&&(e+=" "+i+"='"+this.attributes[i]+"'");return e+="/>",e}}function py(r){if(r instanceof Ss)return r;throw new Error("Expected symbolNode but got "+String(r)+".")}function K7(r){if(r instanceof dh)return r;throw new Error("Expected span<HtmlDomNode> but got "+String(r)+".")}var q7={bin:1,close:1,inner:1,open:1,punct:1,rel:1},J7={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},jt={math:{},text:{}};function E(r,e,i,s,n,l){jt[r][n]={font:e,group:i,replace:s},l&&s&&(jt[r][s]=jt[r][n])}var v="math",de="text",k="main",D="ams",ni="accent-token",Oe="bin",Ir="close",du="inner",Ke="mathord",Mi="op-token",os="open",Xf="punct",M="rel",co="spacing",V="textord";E(v,k,M,"≡","\\equiv",!0);E(v,k,M,"≺","\\prec",!0);E(v,k,M,"≻","\\succ",!0);E(v,k,M,"∼","\\sim",!0);E(v,k,M,"⊥","\\perp");E(v,k,M,"⪯","\\preceq",!0);E(v,k,M,"⪰","\\succeq",!0);E(v,k,M,"≃","\\simeq",!0);E(v,k,M,"∣","\\mid",!0);E(v,k,M,"≪","\\ll",!0);E(v,k,M,"≫","\\gg",!0);E(v,k,M,"≍","\\asymp",!0);E(v,k,M,"∥","\\parallel");E(v,k,M,"⋈","\\bowtie",!0);E(v,k,M,"⌣","\\smile",!0);E(v,k,M,"⊑","\\sqsubseteq",!0);E(v,k,M,"⊒","\\sqsupseteq",!0);E(v,k,M,"≐","\\doteq",!0);E(v,k,M,"⌢","\\frown",!0);E(v,k,M,"∋","\\ni",!0);E(v,k,M,"∝","\\propto",!0);E(v,k,M,"⊢","\\vdash",!0);E(v,k,M,"⊣","\\dashv",!0);E(v,k,M,"∋","\\owns");E(v,k,Xf,".","\\ldotp");E(v,k,Xf,"⋅","\\cdotp");E(v,k,V,"#","\\#");E(de,k,V,"#","\\#");E(v,k,V,"&","\\&");E(de,k,V,"&","\\&");E(v,k,V,"ℵ","\\aleph",!0);E(v,k,V,"∀","\\forall",!0);E(v,k,V,"ℏ","\\hbar",!0);E(v,k,V,"∃","\\exists",!0);E(v,k,V,"∇","\\nabla",!0);E(v,k,V,"♭","\\flat",!0);E(v,k,V,"ℓ","\\ell",!0);E(v,k,V,"♮","\\natural",!0);E(v,k,V,"♣","\\clubsuit",!0);E(v,k,V,"℘","\\wp",!0);E(v,k,V,"♯","\\sharp",!0);E(v,k,V,"♢","\\diamondsuit",!0);E(v,k,V,"ℜ","\\Re",!0);E(v,k,V,"♡","\\heartsuit",!0);E(v,k,V,"ℑ","\\Im",!0);E(v,k,V,"♠","\\spadesuit",!0);E(v,k,V,"§","\\S",!0);E(de,k,V,"§","\\S");E(v,k,V,"¶","\\P",!0);E(de,k,V,"¶","\\P");E(v,k,V,"†","\\dag");E(de,k,V,"†","\\dag");E(de,k,V,"†","\\textdagger");E(v,k,V,"‡","\\ddag");E(de,k,V,"‡","\\ddag");E(de,k,V,"‡","\\textdaggerdbl");E(v,k,Ir,"⎱","\\rmoustache",!0);E(v,k,os,"⎰","\\lmoustache",!0);E(v,k,Ir,"⟯","\\rgroup",!0);E(v,k,os,"⟮","\\lgroup",!0);E(v,k,Oe,"∓","\\mp",!0);E(v,k,Oe,"⊖","\\ominus",!0);E(v,k,Oe,"⊎","\\uplus",!0);E(v,k,Oe,"⊓","\\sqcap",!0);E(v,k,Oe,"∗","\\ast");E(v,k,Oe,"⊔","\\sqcup",!0);E(v,k,Oe,"◯","\\bigcirc",!0);E(v,k,Oe,"∙","\\bullet",!0);E(v,k,Oe,"‡","\\ddagger");E(v,k,Oe,"≀","\\wr",!0);E(v,k,Oe,"⨿","\\amalg");E(v,k,Oe,"&","\\And");E(v,k,M,"⟵","\\longleftarrow",!0);E(v,k,M,"⇐","\\Leftarrow",!0);E(v,k,M,"⟸","\\Longleftarrow",!0);E(v,k,M,"⟶","\\longrightarrow",!0);E(v,k,M,"⇒","\\Rightarrow",!0);E(v,k,M,"⟹","\\Longrightarrow",!0);E(v,k,M,"↔","\\leftrightarrow",!0);E(v,k,M,"⟷","\\longleftrightarrow",!0);E(v,k,M,"⇔","\\Leftrightarrow",!0);E(v,k,M,"⟺","\\Longleftrightarrow",!0);E(v,k,M,"↦","\\mapsto",!0);E(v,k,M,"⟼","\\longmapsto",!0);E(v,k,M,"↗","\\nearrow",!0);E(v,k,M,"↩","\\hookleftarrow",!0);E(v,k,M,"↪","\\hookrightarrow",!0);E(v,k,M,"↘","\\searrow",!0);E(v,k,M,"↼","\\leftharpoonup",!0);E(v,k,M,"⇀","\\rightharpoonup",!0);E(v,k,M,"↙","\\swarrow",!0);E(v,k,M,"↽","\\leftharpoondown",!0);E(v,k,M,"⇁","\\rightharpoondown",!0);E(v,k,M,"↖","\\nwarrow",!0);E(v,k,M,"⇌","\\rightleftharpoons",!0);E(v,D,M,"≮","\\nless",!0);E(v,D,M,"","\\@nleqslant");E(v,D,M,"","\\@nleqq");E(v,D,M,"⪇","\\lneq",!0);E(v,D,M,"≨","\\lneqq",!0);E(v,D,M,"","\\@lvertneqq");E(v,D,M,"⋦","\\lnsim",!0);E(v,D,M,"⪉","\\lnapprox",!0);E(v,D,M,"⊀","\\nprec",!0);E(v,D,M,"⋠","\\npreceq",!0);E(v,D,M,"⋨","\\precnsim",!0);E(v,D,M,"⪹","\\precnapprox",!0);E(v,D,M,"≁","\\nsim",!0);E(v,D,M,"","\\@nshortmid");E(v,D,M,"∤","\\nmid",!0);E(v,D,M,"⊬","\\nvdash",!0);E(v,D,M,"⊭","\\nvDash",!0);E(v,D,M,"⋪","\\ntriangleleft");E(v,D,M,"⋬","\\ntrianglelefteq",!0);E(v,D,M,"⊊","\\subsetneq",!0);E(v,D,M,"","\\@varsubsetneq");E(v,D,M,"⫋","\\subsetneqq",!0);E(v,D,M,"","\\@varsubsetneqq");E(v,D,M,"≯","\\ngtr",!0);E(v,D,M,"","\\@ngeqslant");E(v,D,M,"","\\@ngeqq");E(v,D,M,"⪈","\\gneq",!0);E(v,D,M,"≩","\\gneqq",!0);E(v,D,M,"","\\@gvertneqq");E(v,D,M,"⋧","\\gnsim",!0);E(v,D,M,"⪊","\\gnapprox",!0);E(v,D,M,"⊁","\\nsucc",!0);E(v,D,M,"⋡","\\nsucceq",!0);E(v,D,M,"⋩","\\succnsim",!0);E(v,D,M,"⪺","\\succnapprox",!0);E(v,D,M,"≆","\\ncong",!0);E(v,D,M,"","\\@nshortparallel");E(v,D,M,"∦","\\nparallel",!0);E(v,D,M,"⊯","\\nVDash",!0);E(v,D,M,"⋫","\\ntriangleright");E(v,D,M,"⋭","\\ntrianglerighteq",!0);E(v,D,M,"","\\@nsupseteqq");E(v,D,M,"⊋","\\supsetneq",!0);E(v,D,M,"","\\@varsupsetneq");E(v,D,M,"⫌","\\supsetneqq",!0);E(v,D,M,"","\\@varsupsetneqq");E(v,D,M,"⊮","\\nVdash",!0);E(v,D,M,"⪵","\\precneqq",!0);E(v,D,M,"⪶","\\succneqq",!0);E(v,D,M,"","\\@nsubseteqq");E(v,D,Oe,"⊴","\\unlhd");E(v,D,Oe,"⊵","\\unrhd");E(v,D,M,"↚","\\nleftarrow",!0);E(v,D,M,"↛","\\nrightarrow",!0);E(v,D,M,"⇍","\\nLeftarrow",!0);E(v,D,M,"⇏","\\nRightarrow",!0);E(v,D,M,"↮","\\nleftrightarrow",!0);E(v,D,M,"⇎","\\nLeftrightarrow",!0);E(v,D,M,"△","\\vartriangle");E(v,D,V,"ℏ","\\hslash");E(v,D,V,"▽","\\triangledown");E(v,D,V,"◊","\\lozenge");E(v,D,V,"Ⓢ","\\circledS");E(v,D,V,"®","\\circledR");E(de,D,V,"®","\\circledR");E(v,D,V,"∡","\\measuredangle",!0);E(v,D,V,"∄","\\nexists");E(v,D,V,"℧","\\mho");E(v,D,V,"Ⅎ","\\Finv",!0);E(v,D,V,"⅁","\\Game",!0);E(v,D,V,"‵","\\backprime");E(v,D,V,"▲","\\blacktriangle");E(v,D,V,"▼","\\blacktriangledown");E(v,D,V,"■","\\blacksquare");E(v,D,V,"⧫","\\blacklozenge");E(v,D,V,"★","\\bigstar");E(v,D,V,"∢","\\sphericalangle",!0);E(v,D,V,"∁","\\complement",!0);E(v,D,V,"ð","\\eth",!0);E(de,k,V,"ð","ð");E(v,D,V,"╱","\\diagup");E(v,D,V,"╲","\\diagdown");E(v,D,V,"□","\\square");E(v,D,V,"□","\\Box");E(v,D,V,"◊","\\Diamond");E(v,D,V,"¥","\\yen",!0);E(de,D,V,"¥","\\yen",!0);E(v,D,V,"✓","\\checkmark",!0);E(de,D,V,"✓","\\checkmark");E(v,D,V,"ℶ","\\beth",!0);E(v,D,V,"ℸ","\\daleth",!0);E(v,D,V,"ℷ","\\gimel",!0);E(v,D,V,"ϝ","\\digamma",!0);E(v,D,V,"ϰ","\\varkappa");E(v,D,os,"┌","\\@ulcorner",!0);E(v,D,Ir,"┐","\\@urcorner",!0);E(v,D,os,"└","\\@llcorner",!0);E(v,D,Ir,"┘","\\@lrcorner",!0);E(v,D,M,"≦","\\leqq",!0);E(v,D,M,"⩽","\\leqslant",!0);E(v,D,M,"⪕","\\eqslantless",!0);E(v,D,M,"≲","\\lesssim",!0);E(v,D,M,"⪅","\\lessapprox",!0);E(v,D,M,"≊","\\approxeq",!0);E(v,D,Oe,"⋖","\\lessdot");E(v,D,M,"⋘","\\lll",!0);E(v,D,M,"≶","\\lessgtr",!0);E(v,D,M,"⋚","\\lesseqgtr",!0);E(v,D,M,"⪋","\\lesseqqgtr",!0);E(v,D,M,"≑","\\doteqdot");E(v,D,M,"≓","\\risingdotseq",!0);E(v,D,M,"≒","\\fallingdotseq",!0);E(v,D,M,"∽","\\backsim",!0);E(v,D,M,"⋍","\\backsimeq",!0);E(v,D,M,"⫅","\\subseteqq",!0);E(v,D,M,"⋐","\\Subset",!0);E(v,D,M,"⊏","\\sqsubset",!0);E(v,D,M,"≼","\\preccurlyeq",!0);E(v,D,M,"⋞","\\curlyeqprec",!0);E(v,D,M,"≾","\\precsim",!0);E(v,D,M,"⪷","\\precapprox",!0);E(v,D,M,"⊲","\\vartriangleleft");E(v,D,M,"⊴","\\trianglelefteq");E(v,D,M,"⊨","\\vDash",!0);E(v,D,M,"⊪","\\Vvdash",!0);E(v,D,M,"⌣","\\smallsmile");E(v,D,M,"⌢","\\smallfrown");E(v,D,M,"≏","\\bumpeq",!0);E(v,D,M,"≎","\\Bumpeq",!0);E(v,D,M,"≧","\\geqq",!0);E(v,D,M,"⩾","\\geqslant",!0);E(v,D,M,"⪖","\\eqslantgtr",!0);E(v,D,M,"≳","\\gtrsim",!0);E(v,D,M,"⪆","\\gtrapprox",!0);E(v,D,Oe,"⋗","\\gtrdot");E(v,D,M,"⋙","\\ggg",!0);E(v,D,M,"≷","\\gtrless",!0);E(v,D,M,"⋛","\\gtreqless",!0);E(v,D,M,"⪌","\\gtreqqless",!0);E(v,D,M,"≖","\\eqcirc",!0);E(v,D,M,"≗","\\circeq",!0);E(v,D,M,"≜","\\triangleq",!0);E(v,D,M,"∼","\\thicksim");E(v,D,M,"≈","\\thickapprox");E(v,D,M,"⫆","\\supseteqq",!0);E(v,D,M,"⋑","\\Supset",!0);E(v,D,M,"⊐","\\sqsupset",!0);E(v,D,M,"≽","\\succcurlyeq",!0);E(v,D,M,"⋟","\\curlyeqsucc",!0);E(v,D,M,"≿","\\succsim",!0);E(v,D,M,"⪸","\\succapprox",!0);E(v,D,M,"⊳","\\vartriangleright");E(v,D,M,"⊵","\\trianglerighteq");E(v,D,M,"⊩","\\Vdash",!0);E(v,D,M,"∣","\\shortmid");E(v,D,M,"∥","\\shortparallel");E(v,D,M,"≬","\\between",!0);E(v,D,M,"⋔","\\pitchfork",!0);E(v,D,M,"∝","\\varpropto");E(v,D,M,"◀","\\blacktriangleleft");E(v,D,M,"∴","\\therefore",!0);E(v,D,M,"∍","\\backepsilon");E(v,D,M,"▶","\\blacktriangleright");E(v,D,M,"∵","\\because",!0);E(v,D,M,"⋘","\\llless");E(v,D,M,"⋙","\\gggtr");E(v,D,Oe,"⊲","\\lhd");E(v,D,Oe,"⊳","\\rhd");E(v,D,M,"≂","\\eqsim",!0);E(v,k,M,"⋈","\\Join");E(v,D,M,"≑","\\Doteq",!0);E(v,D,Oe,"∔","\\dotplus",!0);E(v,D,Oe,"∖","\\smallsetminus");E(v,D,Oe,"⋒","\\Cap",!0);E(v,D,Oe,"⋓","\\Cup",!0);E(v,D,Oe,"⩞","\\doublebarwedge",!0);E(v,D,Oe,"⊟","\\boxminus",!0);E(v,D,Oe,"⊞","\\boxplus",!0);E(v,D,Oe,"⋇","\\divideontimes",!0);E(v,D,Oe,"⋉","\\ltimes",!0);E(v,D,Oe,"⋊","\\rtimes",!0);E(v,D,Oe,"⋋","\\leftthreetimes",!0);E(v,D,Oe,"⋌","\\rightthreetimes",!0);E(v,D,Oe,"⋏","\\curlywedge",!0);E(v,D,Oe,"⋎","\\curlyvee",!0);E(v,D,Oe,"⊝","\\circleddash",!0);E(v,D,Oe,"⊛","\\circledast",!0);E(v,D,Oe,"⋅","\\centerdot");E(v,D,Oe,"⊺","\\intercal",!0);E(v,D,Oe,"⋒","\\doublecap");E(v,D,Oe,"⋓","\\doublecup");E(v,D,Oe,"⊠","\\boxtimes",!0);E(v,D,M,"⇢","\\dashrightarrow",!0);E(v,D,M,"⇠","\\dashleftarrow",!0);E(v,D,M,"⇇","\\leftleftarrows",!0);E(v,D,M,"⇆","\\leftrightarrows",!0);E(v,D,M,"⇚","\\Lleftarrow",!0);E(v,D,M,"↞","\\twoheadleftarrow",!0);E(v,D,M,"↢","\\leftarrowtail",!0);E(v,D,M,"↫","\\looparrowleft",!0);E(v,D,M,"⇋","\\leftrightharpoons",!0);E(v,D,M,"↶","\\curvearrowleft",!0);E(v,D,M,"↺","\\circlearrowleft",!0);E(v,D,M,"↰","\\Lsh",!0);E(v,D,M,"⇈","\\upuparrows",!0);E(v,D,M,"↿","\\upharpoonleft",!0);E(v,D,M,"⇃","\\downharpoonleft",!0);E(v,k,M,"⊶","\\origof",!0);E(v,k,M,"⊷","\\imageof",!0);E(v,D,M,"⊸","\\multimap",!0);E(v,D,M,"↭","\\leftrightsquigarrow",!0);E(v,D,M,"⇉","\\rightrightarrows",!0);E(v,D,M,"⇄","\\rightleftarrows",!0);E(v,D,M,"↠","\\twoheadrightarrow",!0);E(v,D,M,"↣","\\rightarrowtail",!0);E(v,D,M,"↬","\\looparrowright",!0);E(v,D,M,"↷","\\curvearrowright",!0);E(v,D,M,"↻","\\circlearrowright",!0);E(v,D,M,"↱","\\Rsh",!0);E(v,D,M,"⇊","\\downdownarrows",!0);E(v,D,M,"↾","\\upharpoonright",!0);E(v,D,M,"⇂","\\downharpoonright",!0);E(v,D,M,"⇝","\\rightsquigarrow",!0);E(v,D,M,"⇝","\\leadsto");E(v,D,M,"⇛","\\Rrightarrow",!0);E(v,D,M,"↾","\\restriction");E(v,k,V,"‘","`");E(v,k,V,"$","\\$");E(de,k,V,"$","\\$");E(de,k,V,"$","\\textdollar");E(v,k,V,"%","\\%");E(de,k,V,"%","\\%");E(v,k,V,"_","\\_");E(de,k,V,"_","\\_");E(de,k,V,"_","\\textunderscore");E(v,k,V,"∠","\\angle",!0);E(v,k,V,"∞","\\infty",!0);E(v,k,V,"′","\\prime");E(v,k,V,"△","\\triangle");E(v,k,V,"Γ","\\Gamma",!0);E(v,k,V,"Δ","\\Delta",!0);E(v,k,V,"Θ","\\Theta",!0);E(v,k,V,"Λ","\\Lambda",!0);E(v,k,V,"Ξ","\\Xi",!0);E(v,k,V,"Π","\\Pi",!0);E(v,k,V,"Σ","\\Sigma",!0);E(v,k,V,"Υ","\\Upsilon",!0);E(v,k,V,"Φ","\\Phi",!0);E(v,k,V,"Ψ","\\Psi",!0);E(v,k,V,"Ω","\\Omega",!0);E(v,k,V,"A","Α");E(v,k,V,"B","Β");E(v,k,V,"E","Ε");E(v,k,V,"Z","Ζ");E(v,k,V,"H","Η");E(v,k,V,"I","Ι");E(v,k,V,"K","Κ");E(v,k,V,"M","Μ");E(v,k,V,"N","Ν");E(v,k,V,"O","Ο");E(v,k,V,"P","Ρ");E(v,k,V,"T","Τ");E(v,k,V,"X","Χ");E(v,k,V,"¬","\\neg",!0);E(v,k,V,"¬","\\lnot");E(v,k,V,"⊤","\\top");E(v,k,V,"⊥","\\bot");E(v,k,V,"∅","\\emptyset");E(v,D,V,"∅","\\varnothing");E(v,k,Ke,"α","\\alpha",!0);E(v,k,Ke,"β","\\beta",!0);E(v,k,Ke,"γ","\\gamma",!0);E(v,k,Ke,"δ","\\delta",!0);E(v,k,Ke,"ϵ","\\epsilon",!0);E(v,k,Ke,"ζ","\\zeta",!0);E(v,k,Ke,"η","\\eta",!0);E(v,k,Ke,"θ","\\theta",!0);E(v,k,Ke,"ι","\\iota",!0);E(v,k,Ke,"κ","\\kappa",!0);E(v,k,Ke,"λ","\\lambda",!0);E(v,k,Ke,"μ","\\mu",!0);E(v,k,Ke,"ν","\\nu",!0);E(v,k,Ke,"ξ","\\xi",!0);E(v,k,Ke,"ο","\\omicron",!0);E(v,k,Ke,"π","\\pi",!0);E(v,k,Ke,"ρ","\\rho",!0);E(v,k,Ke,"σ","\\sigma",!0);E(v,k,Ke,"τ","\\tau",!0);E(v,k,Ke,"υ","\\upsilon",!0);E(v,k,Ke,"ϕ","\\phi",!0);E(v,k,Ke,"χ","\\chi",!0);E(v,k,Ke,"ψ","\\psi",!0);E(v,k,Ke,"ω","\\omega",!0);E(v,k,Ke,"ε","\\varepsilon",!0);E(v,k,Ke,"ϑ","\\vartheta",!0);E(v,k,Ke,"ϖ","\\varpi",!0);E(v,k,Ke,"ϱ","\\varrho",!0);E(v,k,Ke,"ς","\\varsigma",!0);E(v,k,Ke,"φ","\\varphi",!0);E(v,k,Oe,"∗","*",!0);E(v,k,Oe,"+","+");E(v,k,Oe,"−","-",!0);E(v,k,Oe,"⋅","\\cdot",!0);E(v,k,Oe,"∘","\\circ",!0);E(v,k,Oe,"÷","\\div",!0);E(v,k,Oe,"±","\\pm",!0);E(v,k,Oe,"×","\\times",!0);E(v,k,Oe,"∩","\\cap",!0);E(v,k,Oe,"∪","\\cup",!0);E(v,k,Oe,"∖","\\setminus",!0);E(v,k,Oe,"∧","\\land");E(v,k,Oe,"∨","\\lor");E(v,k,Oe,"∧","\\wedge",!0);E(v,k,Oe,"∨","\\vee",!0);E(v,k,V,"√","\\surd");E(v,k,os,"⟨","\\langle",!0);E(v,k,os,"∣","\\lvert");E(v,k,os,"∥","\\lVert");E(v,k,Ir,"?","?");E(v,k,Ir,"!","!");E(v,k,Ir,"⟩","\\rangle",!0);E(v,k,Ir,"∣","\\rvert");E(v,k,Ir,"∥","\\rVert");E(v,k,M,"=","=");E(v,k,M,":",":");E(v,k,M,"≈","\\approx",!0);E(v,k,M,"≅","\\cong",!0);E(v,k,M,"≥","\\ge");E(v,k,M,"≥","\\geq",!0);E(v,k,M,"←","\\gets");E(v,k,M,">","\\gt",!0);E(v,k,M,"∈","\\in",!0);E(v,k,M,"","\\@not");E(v,k,M,"⊂","\\subset",!0);E(v,k,M,"⊃","\\supset",!0);E(v,k,M,"⊆","\\subseteq",!0);E(v,k,M,"⊇","\\supseteq",!0);E(v,D,M,"⊈","\\nsubseteq",!0);E(v,D,M,"⊉","\\nsupseteq",!0);E(v,k,M,"⊨","\\models");E(v,k,M,"←","\\leftarrow",!0);E(v,k,M,"≤","\\le");E(v,k,M,"≤","\\leq",!0);E(v,k,M,"<","\\lt",!0);E(v,k,M,"→","\\rightarrow",!0);E(v,k,M,"→","\\to");E(v,D,M,"≱","\\ngeq",!0);E(v,D,M,"≰","\\nleq",!0);E(v,k,co," ","\\ ");E(v,k,co," ","\\space");E(v,k,co," ","\\nobreakspace");E(de,k,co," ","\\ ");E(de,k,co," "," ");E(de,k,co," ","\\space");E(de,k,co," ","\\nobreakspace");E(v,k,co,null,"\\nobreak");E(v,k,co,null,"\\allowbreak");E(v,k,Xf,",",",");E(v,k,Xf,";",";");E(v,D,Oe,"⊼","\\barwedge",!0);E(v,D,Oe,"⊻","\\veebar",!0);E(v,k,Oe,"⊙","\\odot",!0);E(v,k,Oe,"⊕","\\oplus",!0);E(v,k,Oe,"⊗","\\otimes",!0);E(v,k,V,"∂","\\partial",!0);E(v,k,Oe,"⊘","\\oslash",!0);E(v,D,Oe,"⊚","\\circledcirc",!0);E(v,D,Oe,"⊡","\\boxdot",!0);E(v,k,Oe,"△","\\bigtriangleup");E(v,k,Oe,"▽","\\bigtriangledown");E(v,k,Oe,"†","\\dagger");E(v,k,Oe,"⋄","\\diamond");E(v,k,Oe,"⋆","\\star");E(v,k,Oe,"◃","\\triangleleft");E(v,k,Oe,"▹","\\triangleright");E(v,k,os,"{","\\{");E(de,k,V,"{","\\{");E(de,k,V,"{","\\textbraceleft");E(v,k,Ir,"}","\\}");E(de,k,V,"}","\\}");E(de,k,V,"}","\\textbraceright");E(v,k,os,"{","\\lbrace");E(v,k,Ir,"}","\\rbrace");E(v,k,os,"[","\\lbrack",!0);E(de,k,V,"[","\\lbrack",!0);E(v,k,Ir,"]","\\rbrack",!0);E(de,k,V,"]","\\rbrack",!0);E(v,k,os,"(","\\lparen",!0);E(v,k,Ir,")","\\rparen",!0);E(de,k,V,"<","\\textless",!0);E(de,k,V,">","\\textgreater",!0);E(v,k,os,"⌊","\\lfloor",!0);E(v,k,Ir,"⌋","\\rfloor",!0);E(v,k,os,"⌈","\\lceil",!0);E(v,k,Ir,"⌉","\\rceil",!0);E(v,k,V,"\\","\\backslash");E(v,k,V,"∣","|");E(v,k,V,"∣","\\vert");E(de,k,V,"|","\\textbar",!0);E(v,k,V,"∥","\\|");E(v,k,V,"∥","\\Vert");E(de,k,V,"∥","\\textbardbl");E(de,k,V,"~","\\textasciitilde");E(de,k,V,"\\","\\textbackslash");E(de,k,V,"^","\\textasciicircum");E(v,k,M,"↑","\\uparrow",!0);E(v,k,M,"⇑","\\Uparrow",!0);E(v,k,M,"↓","\\downarrow",!0);E(v,k,M,"⇓","\\Downarrow",!0);E(v,k,M,"↕","\\updownarrow",!0);E(v,k,M,"⇕","\\Updownarrow",!0);E(v,k,Mi,"∐","\\coprod");E(v,k,Mi,"⋁","\\bigvee");E(v,k,Mi,"⋀","\\bigwedge");E(v,k,Mi,"⨄","\\biguplus");E(v,k,Mi,"⋂","\\bigcap");E(v,k,Mi,"⋃","\\bigcup");E(v,k,Mi,"∫","\\int");E(v,k,Mi,"∫","\\intop");E(v,k,Mi,"∬","\\iint");E(v,k,Mi,"∭","\\iiint");E(v,k,Mi,"∏","\\prod");E(v,k,Mi,"∑","\\sum");E(v,k,Mi,"⨂","\\bigotimes");E(v,k,Mi,"⨁","\\bigoplus");E(v,k,Mi,"⨀","\\bigodot");E(v,k,Mi,"∮","\\oint");E(v,k,Mi,"∯","\\oiint");E(v,k,Mi,"∰","\\oiiint");E(v,k,Mi,"⨆","\\bigsqcup");E(v,k,Mi,"∫","\\smallint");E(de,k,du,"…","\\textellipsis");E(v,k,du,"…","\\mathellipsis");E(de,k,du,"…","\\ldots",!0);E(v,k,du,"…","\\ldots",!0);E(v,k,du,"⋯","\\@cdots",!0);E(v,k,du,"⋱","\\ddots",!0);E(v,k,V,"⋮","\\varvdots");E(v,k,ni,"ˊ","\\acute");E(v,k,ni,"ˋ","\\grave");E(v,k,ni,"¨","\\ddot");E(v,k,ni,"~","\\tilde");E(v,k,ni,"ˉ","\\bar");E(v,k,ni,"˘","\\breve");E(v,k,ni,"ˇ","\\check");E(v,k,ni,"^","\\hat");E(v,k,ni,"⃗","\\vec");E(v,k,ni,"˙","\\dot");E(v,k,ni,"˚","\\mathring");E(v,k,Ke,"","\\@imath");E(v,k,Ke,"","\\@jmath");E(v,k,V,"ı","ı");E(v,k,V,"ȷ","ȷ");E(de,k,V,"ı","\\i",!0);E(de,k,V,"ȷ","\\j",!0);E(de,k,V,"ß","\\ss",!0);E(de,k,V,"æ","\\ae",!0);E(de,k,V,"œ","\\oe",!0);E(de,k,V,"ø","\\o",!0);E(de,k,V,"Æ","\\AE",!0);E(de,k,V,"Œ","\\OE",!0);E(de,k,V,"Ø","\\O",!0);E(de,k,ni,"ˊ","\\'");E(de,k,ni,"ˋ","\\`");E(de,k,ni,"ˆ","\\^");E(de,k,ni,"˜","\\~");E(de,k,ni,"ˉ","\\=");E(de,k,ni,"˘","\\u");E(de,k,ni,"˙","\\.");E(de,k,ni,"¸","\\c");E(de,k,ni,"˚","\\r");E(de,k,ni,"ˇ","\\v");E(de,k,ni,"¨",'\\"');E(de,k,ni,"˝","\\H");E(de,k,ni,"◯","\\textcircled");var OC={"--":!0,"---":!0,"``":!0,"''":!0};E(de,k,V,"–","--",!0);E(de,k,V,"–","\\textendash");E(de,k,V,"—","---",!0);E(de,k,V,"—","\\textemdash");E(de,k,V,"‘","`",!0);E(de,k,V,"‘","\\textquoteleft");E(de,k,V,"’","'",!0);E(de,k,V,"’","\\textquoteright");E(de,k,V,"“","``",!0);E(de,k,V,"“","\\textquotedblleft");E(de,k,V,"”","''",!0);E(de,k,V,"”","\\textquotedblright");E(v,k,V,"°","\\degree",!0);E(de,k,V,"°","\\degree");E(de,k,V,"°","\\textdegree",!0);E(v,k,V,"£","\\pounds");E(v,k,V,"£","\\mathsterling",!0);E(de,k,V,"£","\\pounds");E(de,k,V,"£","\\textsterling",!0);E(v,D,V,"✠","\\maltese");E(de,D,V,"✠","\\maltese");var my='0123456789/@."';for(var l1=0;l1<my.length;l1++){var gy=my.charAt(l1);E(v,k,V,gy,gy)}var _y='0123456789!@*()-=+";:?/.,';for(var a1=0;a1<_y.length;a1++){var by=_y.charAt(a1);E(de,k,V,by,by)}var V0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var u1=0;u1<V0.length;u1++){var Gd=V0.charAt(u1);E(v,k,Ke,Gd,Gd),E(de,k,V,Gd,Gd)}E(v,D,V,"C","ℂ");E(de,D,V,"C","ℂ");E(v,D,V,"H","ℍ");E(de,D,V,"H","ℍ");E(v,D,V,"N","ℕ");E(de,D,V,"N","ℕ");E(v,D,V,"P","ℙ");E(de,D,V,"P","ℙ");E(v,D,V,"Q","ℚ");E(de,D,V,"Q","ℚ");E(v,D,V,"R","ℝ");E(de,D,V,"R","ℝ");E(v,D,V,"Z","ℤ");E(de,D,V,"Z","ℤ");E(v,k,Ke,"h","ℎ");E(de,k,Ke,"h","ℎ");var rt="";for(var Dr=0;Dr<V0.length;Dr++){var Ri=V0.charAt(Dr);rt=String.fromCharCode(55349,56320+Dr),E(v,k,Ke,Ri,rt),E(de,k,V,Ri,rt),rt=String.fromCharCode(55349,56372+Dr),E(v,k,Ke,Ri,rt),E(de,k,V,Ri,rt),rt=String.fromCharCode(55349,56424+Dr),E(v,k,Ke,Ri,rt),E(de,k,V,Ri,rt),rt=String.fromCharCode(55349,56580+Dr),E(v,k,Ke,Ri,rt),E(de,k,V,Ri,rt),rt=String.fromCharCode(55349,56736+Dr),E(v,k,Ke,Ri,rt),E(de,k,V,Ri,rt),rt=String.fromCharCode(55349,56788+Dr),E(v,k,Ke,Ri,rt),E(de,k,V,Ri,rt),rt=String.fromCharCode(55349,56840+Dr),E(v,k,Ke,Ri,rt),E(de,k,V,Ri,rt),rt=String.fromCharCode(55349,56944+Dr),E(v,k,Ke,Ri,rt),E(de,k,V,Ri,rt),Dr<26&&(rt=String.fromCharCode(55349,56632+Dr),E(v,k,Ke,Ri,rt),E(de,k,V,Ri,rt),rt=String.fromCharCode(55349,56476+Dr),E(v,k,Ke,Ri,rt),E(de,k,V,Ri,rt))}rt=String.fromCharCode(55349,56668);E(v,k,Ke,"k",rt);E(de,k,V,"k",rt);for(var Al=0;Al<10;Al++){var Co=Al.toString();rt=String.fromCharCode(55349,57294+Al),E(v,k,Ke,Co,rt),E(de,k,V,Co,rt),rt=String.fromCharCode(55349,57314+Al),E(v,k,Ke,Co,rt),E(de,k,V,Co,rt),rt=String.fromCharCode(55349,57324+Al),E(v,k,Ke,Co,rt),E(de,k,V,Co,rt),rt=String.fromCharCode(55349,57334+Al),E(v,k,Ke,Co,rt),E(de,k,V,Co,rt)}var u_="ÐÞþ";for(var c1=0;c1<u_.length;c1++){var Vd=u_.charAt(c1);E(v,k,Ke,Vd,Vd),E(de,k,V,Vd,Vd)}var Wd=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["","",""],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],Ty=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],Q7=function(e,i){var s=e.charCodeAt(0),n=e.charCodeAt(1),l=(s-55296)*1024+(n-56320)+65536,u=i==="math"?0:1;if(119808<=l&&l<120484){var c=Math.floor((l-119808)/26);return[Wd[c][2],Wd[c][u]]}else if(120782<=l&&l<=120831){var h=Math.floor((l-120782)/10);return[Ty[h][2],Ty[h][u]]}else{if(l===120485||l===120486)return[Wd[0][2],Wd[0][u]];if(120486<l&&l<120782)return["",""];throw new ge("Unsupported character: "+e)}},jf=function(e,i,s){return jt[s][e]&&jt[s][e].replace&&(e=jt[s][e].replace),{value:e,metrics:Lb(e,i,s)}},js=function(e,i,s,n,l){var u=jf(e,i,s),c=u.metrics;e=u.value;var h;if(c){var f=c.italic;(s==="text"||n&&n.font==="mathit")&&(f=0),h=new Ss(e,c.height,c.depth,f,c.skew,c.width,l)}else typeof console<"u"&&console.warn("No character metrics "+("for '"+e+"' in style '"+i+"' and mode '"+s+"'")),h=new Ss(e,0,0,0,0,0,l);if(n){h.maxFontSize=n.sizeMultiplier,n.style.isTight()&&h.classes.push("mtight");var p=n.getColor();p&&(h.style.color=p)}return h},Z7=function(e,i,s,n){return n===void 0&&(n=[]),s.font==="boldsymbol"&&jf(e,"Main-Bold",i).metrics?js(e,"Main-Bold",i,s,n.concat(["mathbf"])):e==="\\"||jt[i][e].font==="main"?js(e,"Main-Regular",i,s,n):js(e,"AMS-Regular",i,s,n.concat(["amsrm"]))},e9=function(e,i,s,n,l){return l!=="textord"&&jf(e,"Math-BoldItalic",i).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}},t9=function(e,i,s){var n=e.mode,l=e.text,u=["mord"],c=n==="math"||n==="text"&&i.font,h=c?i.font:i.fontFamily;if(l.charCodeAt(0)===55349){var[f,p]=Q7(l,n);return js(l,f,n,i,u.concat(p))}else if(h){var g,T;if(h==="boldsymbol"){var $=e9(l,n,i,u,s);g=$.fontName,T=[$.fontClass]}else c?(g=NC[h].fontName,T=[h]):(g=zd(h,i.fontWeight,i.fontShape),T=[h,i.fontWeight,i.fontShape]);if(jf(l,g,n).metrics)return js(l,g,n,i,u.concat(T));if(OC.hasOwnProperty(l)&&g.slice(0,10)==="Typewriter"){for(var y=[],R=0;R<l.length;R++)y.push(js(l[R],g,n,i,u.concat(T)));return RC(y)}}if(s==="mathord")return js(l,"Math-Italic",n,i,u.concat(["mathnormal"]));if(s==="textord"){var C=jt[n][l]&&jt[n][l].font;if(C==="ams"){var x=zd("amsrm",i.fontWeight,i.fontShape);return js(l,x,n,i,u.concat("amsrm",i.fontWeight,i.fontShape))}else if(C==="main"||!C){var j=zd("textrm",i.fontWeight,i.fontShape);return js(l,j,n,i,u.concat(i.fontWeight,i.fontShape))}else{var F=zd(C,i.fontWeight,i.fontShape);return js(l,F,n,i,u.concat(F,i.fontWeight,i.fontShape))}}else throw new Error("unexpected type: "+s+" in makeOrd")},i9=(r,e)=>{if(Vo(r.classes)!==Vo(e.classes)||r.skew!==e.skew||r.maxFontSize!==e.maxFontSize)return!1;if(r.classes.length===1){var i=r.classes[0];if(i==="mbin"||i==="mord")return!1}for(var s in r.style)if(r.style.hasOwnProperty(s)&&r.style[s]!==e.style[s])return!1;for(var n in e.style)if(e.style.hasOwnProperty(n)&&r.style[n]!==e.style[n])return!1;return!0},r9=r=>{for(var e=0;e<r.length-1;e++){var i=r[e],s=r[e+1];i instanceof Ss&&s instanceof Ss&&i9(i,s)&&(i.text+=s.text,i.height=Math.max(i.height,s.height),i.depth=Math.max(i.depth,s.depth),i.italic=s.italic,r.splice(e+1,1),e--)}return r},Bb=function(e){for(var i=0,s=0,n=0,l=0;l<e.children.length;l++){var u=e.children[l];u.height>i&&(i=u.height),u.depth>s&&(s=u.depth),u.maxFontSize>n&&(n=u.maxFontSize)}e.height=i,e.depth=s,e.maxFontSize=n},Lr=function(e,i,s,n){var l=new dh(e,i,s,n);return Bb(l),l},wC=(r,e,i,s)=>new dh(r,e,i,s),s9=function(e,i,s){var n=Lr([e],[],i);return n.height=Math.max(s||i.fontMetrics().defaultRuleThickness,i.minRuleThickness),n.style.borderBottomWidth=$e(n.height),n.maxFontSize=1,n},n9=function(e,i,s,n){var l=new Mb(e,i,s,n);return Bb(l),l},RC=function(e){var i=new hh(e);return Bb(i),i},o9=function(e,i){return e instanceof hh?Lr([],[e],i):e},l9=function(e){if(e.positionType==="individualShift"){for(var i=e.children,s=[i[0]],n=-i[0].shift-i[0].elem.depth,l=n,u=1;u<i.length;u++){var c=-i[u].shift-l-i[u].elem.depth,h=c-(i[u-1].elem.height+i[u-1].elem.depth);l=l+c,s.push({type:"kern",size:h}),s.push(i[u])}return{children:s,depth:n}}var f;if(e.positionType==="top"){for(var p=e.positionData,g=0;g<e.children.length;g++){var T=e.children[g];p-=T.type==="kern"?T.size:T.elem.height+T.elem.depth}f=p}else if(e.positionType==="bottom")f=-e.positionData;else{var $=e.children[0];if($.type!=="elem")throw new Error('First child must have type "elem".');if(e.positionType==="shift")f=-$.elem.depth-e.positionData;else if(e.positionType==="firstBaseline")f=-$.elem.depth;else throw new Error("Invalid positionType "+e.positionType+".")}return{children:e.children,depth:f}},a9=function(e,i){for(var{children:s,depth:n}=l9(e),l=0,u=0;u<s.length;u++){var c=s[u];if(c.type==="elem"){var h=c.elem;l=Math.max(l,h.maxFontSize,h.height)}}l+=2;var f=Lr(["pstrut"],[]);f.style.height=$e(l);for(var p=[],g=n,T=n,$=n,y=0;y<s.length;y++){var R=s[y];if(R.type==="kern")$+=R.size;else{var C=R.elem,x=R.wrapperClasses||[],j=R.wrapperStyle||{},F=Lr(x,[f,C],void 0,j);F.style.top=$e(-l-$-C.depth),R.marginLeft&&(F.style.marginLeft=R.marginLeft),R.marginRight&&(F.style.marginRight=R.marginRight),p.push(F),$+=C.height+C.depth}g=Math.min(g,$),T=Math.max(T,$)}var q=Lr(["vlist"],p);q.style.height=$e(T);var W;if(g<0){var ne=Lr([],[]),P=Lr(["vlist"],[ne]);P.style.height=$e(-g);var Q=Lr(["vlist-s"],[new Ss("​")]);W=[Lr(["vlist-r"],[q,Q]),Lr(["vlist-r"],[P])]}else W=[Lr(["vlist-r"],[q])];var re=Lr(["vlist-t"],W);return W.length===2&&re.classes.push("vlist-t2"),re.height=T,re.depth=-g,re},u9=(r,e)=>{var i=Lr(["mspace"],[],e),s=ci(r,e);return i.style.marginRight=$e(s),i},zd=function(e,i,s){var n="";switch(e){case"amsrm":n="AMS";break;case"textrm":n="Main";break;case"textsf":n="SansSerif";break;case"texttt":n="Typewriter";break;default:n=e}var l;return i==="textbf"&&s==="textit"?l="BoldItalic":i==="textbf"?l="Bold":i==="textit"?l="Italic":l="Regular",n+"-"+l},NC={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},xC={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]},c9=function(e,i){var[s,n,l]=xC[e],u=new Wo(s),c=new no([u],{width:$e(n),height:$e(l),style:"width:"+$e(n),viewBox:"0 0 "+1e3*n+" "+1e3*l,preserveAspectRatio:"xMinYMin"}),h=wC(["overlay"],[c],i);return h.height=l,h.style.height=$e(l),h.style.width=$e(n),h},K={fontMap:NC,makeSymbol:js,mathsym:Z7,makeSpan:Lr,makeSvgSpan:wC,makeLineSpan:s9,makeAnchor:n9,makeFragment:RC,wrapFragment:o9,makeVList:a9,makeOrd:t9,makeGlue:u9,staticSvg:c9,svgData:xC,tryCombineChars:r9},ui={number:3,unit:"mu"},Cl={number:4,unit:"mu"},qn={number:5,unit:"mu"},h9={mord:{mop:ui,mbin:Cl,mrel:qn,minner:ui},mop:{mord:ui,mop:ui,mrel:qn,minner:ui},mbin:{mord:Cl,mop:Cl,mopen:Cl,minner:Cl},mrel:{mord:qn,mop:qn,mopen:qn,minner:qn},mopen:{},mclose:{mop:ui,mbin:Cl,mrel:qn,minner:ui},mpunct:{mord:ui,mop:ui,mrel:qn,mopen:ui,mclose:ui,mpunct:ui,minner:ui},minner:{mord:ui,mop:ui,mbin:Cl,mrel:qn,mopen:ui,mpunct:ui,minner:ui}},d9={mord:{mop:ui},mop:{mord:ui,mop:ui},mbin:{},mrel:{},mopen:{},mclose:{mop:ui},mpunct:{},minner:{mop:ui}},DC={},W0={},z0={};function Ae(r){for(var{type:e,names:i,props:s,handler:n,htmlBuilder:l,mathmlBuilder:u}=r,c={type:e,numArgs:s.numArgs,argTypes:s.argTypes,allowedInArgument:!!s.allowedInArgument,allowedInText:!!s.allowedInText,allowedInMath:s.allowedInMath===void 0?!0:s.allowedInMath,numOptionalArgs:s.numOptionalArgs||0,infix:!!s.infix,primitive:!!s.primitive,handler:n},h=0;h<i.length;++h)DC[i[h]]=c;e&&(l&&(W0[e]=l),u&&(z0[e]=u))}function Xl(r){var{type:e,htmlBuilder:i,mathmlBuilder:s}=r;Ae({type:e,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:i,mathmlBuilder:s})}var Y0=function(e){return e.type==="ordgroup"&&e.body.length===1?e.body[0]:e},yi=function(e){return e.type==="ordgroup"?e.body:[e]},oo=K.makeSpan,f9=["leftmost","mbin","mopen","mrel","mop","mpunct"],p9=["rightmost","mrel","mclose","mpunct"],m9={display:Ye.DISPLAY,text:Ye.TEXT,script:Ye.SCRIPT,scriptscript:Ye.SCRIPTSCRIPT},g9={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},Yi=function(e,i,s,n){n===void 0&&(n=[null,null]);for(var l=[],u=0;u<e.length;u++){var c=Mt(e[u],i);if(c instanceof hh){var h=c.children;l.push(...h)}else l.push(c)}if(K.tryCombineChars(l),!s)return l;var f=i;if(e.length===1){var p=e[0];p.type==="sizing"?f=i.havingSize(p.size):p.type==="styling"&&(f=i.havingStyle(m9[p.style]))}var g=oo([n[0]||"leftmost"],[],i),T=oo([n[1]||"rightmost"],[],i),$=s==="root";return Ey(l,(y,R)=>{var C=R.classes[0],x=y.classes[0];C==="mbin"&&Ze.contains(p9,x)?R.classes[0]="mord":x==="mbin"&&Ze.contains(f9,C)&&(y.classes[0]="mord")},{node:g},T,$),Ey(l,(y,R)=>{var C=c_(R),x=c_(y),j=C&&x?y.hasClass("mtight")?d9[C][x]:h9[C][x]:null;if(j)return K.makeGlue(j,f)},{node:g},T,$),l},Ey=function r(e,i,s,n,l){n&&e.push(n);for(var u=0;u<e.length;u++){var c=e[u],h=LC(c);if(h){r(h.children,i,s,null,l);continue}var f=!c.hasClass("mspace");if(f){var p=i(c,s.node);p&&(s.insertAfter?s.insertAfter(p):(e.unshift(p),u++))}f?s.node=c:l&&c.hasClass("newline")&&(s.node=oo(["leftmost"])),s.insertAfter=(g=>T=>{e.splice(g+1,0,T),u++})(u)}n&&e.pop()},LC=function(e){return e instanceof hh||e instanceof Mb||e instanceof dh&&e.hasClass("enclosing")?e:null},_9=function r(e,i){var s=LC(e);if(s){var n=s.children;if(n.length){if(i==="right")return r(n[n.length-1],"right");if(i==="left")return r(n[0],"left")}}return e},c_=function(e,i){return e?(i&&(e=_9(e,i)),g9[e.classes[0]]||null):null},jc=function(e,i){var s=["nulldelimiter"].concat(e.baseSizingClasses());return oo(i.concat(s))},Mt=function(e,i,s){if(!e)return oo();if(W0[e.type]){var n=W0[e.type](e,i);if(s&&i.size!==s.size){n=oo(i.sizingClasses(s),[n],i);var l=i.sizeMultiplier/s.sizeMultiplier;n.height*=l,n.depth*=l}return n}else throw new ge("Got group of unknown type: '"+e.type+"'")};function Yd(r,e){var i=oo(["base"],r,e),s=oo(["strut"]);return s.style.height=$e(i.height+i.depth),i.depth&&(s.style.verticalAlign=$e(-i.depth)),i.children.unshift(s),i}function h_(r,e){var i=null;r.length===1&&r[0].type==="tag"&&(i=r[0].tag,r=r[0].body);var s=Yi(r,e,"root"),n;s.length===2&&s[1].hasClass("tag")&&(n=s.pop());for(var l=[],u=[],c=0;c<s.length;c++)if(u.push(s[c]),s[c].hasClass("mbin")||s[c].hasClass("mrel")||s[c].hasClass("allowbreak")){for(var h=!1;c<s.length-1&&s[c+1].hasClass("mspace")&&!s[c+1].hasClass("newline");)c++,u.push(s[c]),s[c].hasClass("nobreak")&&(h=!0);h||(l.push(Yd(u,e)),u=[])}else s[c].hasClass("newline")&&(u.pop(),u.length>0&&(l.push(Yd(u,e)),u=[]),l.push(s[c]));u.length>0&&l.push(Yd(u,e));var f;i?(f=Yd(Yi(i,e,!0)),f.classes=["tag"],l.push(f)):n&&l.push(n);var p=oo(["katex-html"],l);if(p.setAttribute("aria-hidden","true"),f){var g=f.children[0];g.style.height=$e(p.height+p.depth),p.depth&&(g.style.verticalAlign=$e(-p.depth))}return p}function MC(r){return new hh(r)}class bs{constructor(e,i,s){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=e,this.attributes={},this.children=i||[],this.classes=s||[]}setAttribute(e,i){this.attributes[e]=i}getAttribute(e){return this.attributes[e]}toNode(){var e=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(var i in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,i)&&e.setAttribute(i,this.attributes[i]);this.classes.length>0&&(e.className=Vo(this.classes));for(var s=0;s<this.children.length;s++)e.appendChild(this.children[s].toNode());return e}toMarkup(){var e="<"+this.type;for(var i in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,i)&&(e+=" "+i+'="',e+=Ze.escape(this.attributes[i]),e+='"');this.classes.length>0&&(e+=' class ="'+Ze.escape(Vo(this.classes))+'"'),e+=">";for(var s=0;s<this.children.length;s++)e+=this.children[s].toMarkup();return e+="</"+this.type+">",e}toText(){return this.children.map(e=>e.toText()).join("")}}let Mc=class{constructor(e){this.text=void 0,this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return Ze.escape(this.toText())}toText(){return this.text}};class b9{constructor(e){this.width=void 0,this.character=void 0,this.width=e,e>=.05555&&e<=.05556?this.character=" ":e>=.1666&&e<=.1667?this.character=" ":e>=.2222&&e<=.2223?this.character=" ":e>=.2777&&e<=.2778?this.character="  ":e>=-.05556&&e<=-.05555?this.character=" ⁣":e>=-.1667&&e<=-.1666?this.character=" ⁣":e>=-.2223&&e<=-.2222?this.character=" ⁣":e>=-.2778&&e<=-.2777?this.character=" ⁣":this.character=null}toNode(){if(this.character)return document.createTextNode(this.character);var e=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return e.setAttribute("width",$e(this.width)),e}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+$e(this.width)+'"/>'}toText(){return this.character?this.character:" "}}var me={MathNode:bs,TextNode:Mc,SpaceNode:b9,newDocumentFragment:MC},Is=function(e,i,s){return jt[i][e]&&jt[i][e].replace&&e.charCodeAt(0)!==55349&&!(OC.hasOwnProperty(e)&&s&&(s.fontFamily&&s.fontFamily.slice(4,6)==="tt"||s.font&&s.font.slice(4,6)==="tt"))&&(e=jt[i][e].replace),new me.TextNode(e)},Pb=function(e){return e.length===1?e[0]:new me.MathNode("mrow",e)},Fb=function(e,i){if(i.fontFamily==="texttt")return"monospace";if(i.fontFamily==="textsf")return i.fontShape==="textit"&&i.fontWeight==="textbf"?"sans-serif-bold-italic":i.fontShape==="textit"?"sans-serif-italic":i.fontWeight==="textbf"?"bold-sans-serif":"sans-serif";if(i.fontShape==="textit"&&i.fontWeight==="textbf")return"bold-italic";if(i.fontShape==="textit")return"italic";if(i.fontWeight==="textbf")return"bold";var s=i.font;if(!s||s==="mathnormal")return null;var n=e.mode;if(s==="mathit")return"italic";if(s==="boldsymbol")return e.type==="textord"?"bold":"bold-italic";if(s==="mathbf")return"bold";if(s==="mathbb")return"double-struck";if(s==="mathfrak")return"fraktur";if(s==="mathscr"||s==="mathcal")return"script";if(s==="mathsf")return"sans-serif";if(s==="mathtt")return"monospace";var l=e.text;if(Ze.contains(["\\imath","\\jmath"],l))return null;jt[n][l]&&jt[n][l].replace&&(l=jt[n][l].replace);var u=K.fontMap[s].fontName;return Lb(l,u,n)?K.fontMap[s].variant:null},Vr=function(e,i,s){if(e.length===1){var n=zt(e[0],i);return s&&n instanceof bs&&n.type==="mo"&&(n.setAttribute("lspace","0em"),n.setAttribute("rspace","0em")),[n]}for(var l=[],u,c=0;c<e.length;c++){var h=zt(e[c],i);if(h instanceof bs&&u instanceof bs){if(h.type==="mtext"&&u.type==="mtext"&&h.getAttribute("mathvariant")===u.getAttribute("mathvariant")){u.children.push(...h.children);continue}else if(h.type==="mn"&&u.type==="mn"){u.children.push(...h.children);continue}else if(h.type==="mi"&&h.children.length===1&&u.type==="mn"){var f=h.children[0];if(f instanceof Mc&&f.text==="."){u.children.push(...h.children);continue}}else if(u.type==="mi"&&u.children.length===1){var p=u.children[0];if(p instanceof Mc&&p.text==="̸"&&(h.type==="mo"||h.type==="mi"||h.type==="mn")){var g=h.children[0];g instanceof Mc&&g.text.length>0&&(g.text=g.text.slice(0,1)+"̸"+g.text.slice(1),l.pop())}}}l.push(h),u=h}return l},zo=function(e,i,s){return Pb(Vr(e,i,s))},zt=function(e,i){if(!e)return new me.MathNode("mrow");if(z0[e.type]){var s=z0[e.type](e,i);return s}else throw new ge("Got group of unknown type: '"+e.type+"'")};function $y(r,e,i,s,n){var l=Vr(r,i),u;l.length===1&&l[0]instanceof bs&&Ze.contains(["mrow","mtable"],l[0].type)?u=l[0]:u=new me.MathNode("mrow",l);var c=new me.MathNode("annotation",[new me.TextNode(e)]);c.setAttribute("encoding","application/x-tex");var h=new me.MathNode("semantics",[u,c]),f=new me.MathNode("math",[h]);f.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),s&&f.setAttribute("display","block");var p=n?"katex":"katex-mathml";return K.makeSpan([p],[f])}var BC=function(e){return new Qn({style:e.displayMode?Ye.DISPLAY:Ye.TEXT,maxSize:e.maxSize,minRuleThickness:e.minRuleThickness})},PC=function(e,i){if(i.displayMode){var s=["katex-display"];i.leqno&&s.push("leqno"),i.fleqn&&s.push("fleqn"),e=K.makeSpan(s,[e])}return e},T9=function(e,i,s){var n=BC(s),l;if(s.output==="mathml")return $y(e,i,n,s.displayMode,!0);if(s.output==="html"){var u=h_(e,n);l=K.makeSpan(["katex"],[u])}else{var c=$y(e,i,n,s.displayMode,!1),h=h_(e,n);l=K.makeSpan(["katex"],[c,h])}return PC(l,s)},E9=function(e,i,s){var n=BC(s),l=h_(e,n),u=K.makeSpan(["katex"],[l]);return PC(u,s)},$9={widehat:"^",widecheck:"ˇ",widetilde:"~",utilde:"~",overleftarrow:"←",underleftarrow:"←",xleftarrow:"←",overrightarrow:"→",underrightarrow:"→",xrightarrow:"→",underbrace:"⏟",overbrace:"⏞",overgroup:"⏠",undergroup:"⏡",overleftrightarrow:"↔",underleftrightarrow:"↔",xleftrightarrow:"↔",Overrightarrow:"⇒",xRightarrow:"⇒",overleftharpoon:"↼",xleftharpoonup:"↼",overrightharpoon:"⇀",xrightharpoonup:"⇀",xLeftarrow:"⇐",xLeftrightarrow:"⇔",xhookleftarrow:"↩",xhookrightarrow:"↪",xmapsto:"↦",xrightharpoondown:"⇁",xleftharpoondown:"↽",xrightleftharpoons:"⇌",xleftrightharpoons:"⇋",xtwoheadleftarrow:"↞",xtwoheadrightarrow:"↠",xlongequal:"=",xtofrom:"⇄",xrightleftarrows:"⇄",xrightequilibrium:"⇌",xleftequilibrium:"⇋","\\cdrightarrow":"→","\\cdleftarrow":"←","\\cdlongequal":"="},v9=function(e){var i=new me.MathNode("mo",[new me.TextNode($9[e.replace(/^\\/,"")])]);return i.setAttribute("stretchy","true"),i},y9={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},S9=function(e){return e.type==="ordgroup"?e.body.length:1},I9=function(e,i){function s(){var c=4e5,h=e.label.slice(1);if(Ze.contains(["widehat","widecheck","widetilde","utilde"],h)){var f=e,p=S9(f.base),g,T,$;if(p>5)h==="widehat"||h==="widecheck"?(g=420,c=2364,$=.42,T=h+"4"):(g=312,c=2340,$=.34,T="tilde4");else{var y=[1,1,2,2,3,3][p];h==="widehat"||h==="widecheck"?(c=[0,1062,2364,2364,2364][y],g=[0,239,300,360,420][y],$=[0,.24,.3,.3,.36,.42][y],T=h+y):(c=[0,600,1033,2339,2340][y],g=[0,260,286,306,312][y],$=[0,.26,.286,.3,.306,.34][y],T="tilde"+y)}var R=new Wo(T),C=new no([R],{width:"100%",height:$e($),viewBox:"0 0 "+c+" "+g,preserveAspectRatio:"none"});return{span:K.makeSvgSpan([],[C],i),minWidth:0,height:$}}else{var x=[],j=y9[h],[F,q,W]=j,ne=W/1e3,P=F.length,Q,re;if(P===1){var Y=j[3];Q=["hide-tail"],re=[Y]}else if(P===2)Q=["halfarrow-left","halfarrow-right"],re=["xMinYMin","xMaxYMin"];else if(P===3)Q=["brace-left","brace-center","brace-right"],re=["xMinYMin","xMidYMin","xMaxYMin"];else throw new Error(`Correct katexImagesData or update code here to support
                    `+P+" children.");for(var _e=0;_e<P;_e++){var Xe=new Wo(F[_e]),At=new no([Xe],{width:"400em",height:$e(ne),viewBox:"0 0 "+c+" "+W,preserveAspectRatio:re[_e]+" slice"}),vt=K.makeSvgSpan([Q[_e]],[At],i);if(P===1)return{span:vt,minWidth:q,height:ne};vt.style.height=$e(ne),x.push(vt)}return{span:K.makeSpan(["stretchy"],x,i),minWidth:q,height:ne}}}var{span:n,minWidth:l,height:u}=s();return n.height=u,n.style.height=$e(u),l>0&&(n.style.minWidth=$e(l)),n},k9=function(e,i,s,n,l){var u,c=e.height+e.depth+s+n;if(/fbox|color|angl/.test(i)){if(u=K.makeSpan(["stretchy",i],[],l),i==="fbox"){var h=l.color&&l.getColor();h&&(u.style.borderColor=h)}}else{var f=[];/^[bx]cancel$/.test(i)&&f.push(new a_({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(i)&&f.push(new a_({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));var p=new no(f,{width:"100%",height:$e(c)});u=K.makeSvgSpan([],[p],l)}return u.height=c,u.style.height=$e(c),u},lo={encloseSpan:k9,mathMLnode:v9,svgSpan:I9};function ht(r,e){if(!r||r.type!==e)throw new Error("Expected node of type "+e+", but got "+(r?"node of type "+r.type:String(r)));return r}function Ub(r){var e=Kf(r);if(!e)throw new Error("Expected node of symbol group type, but got "+(r?"node of type "+r.type:String(r)));return e}function Kf(r){return r&&(r.type==="atom"||J7.hasOwnProperty(r.type))?r:null}var Hb=(r,e)=>{var i,s,n;r&&r.type==="supsub"?(s=ht(r.base,"accent"),i=s.base,r.base=i,n=K7(Mt(r,e)),r.base=s):(s=ht(r,"accent"),i=s.base);var l=Mt(i,e.havingCrampedStyle()),u=s.isShifty&&Ze.isCharacterBox(i),c=0;if(u){var h=Ze.getBaseElem(i),f=Mt(h,e.havingCrampedStyle());c=py(f).skew}var p=s.label==="\\c",g=p?l.height+l.depth:Math.min(l.height,e.fontMetrics().xHeight),T;if(s.isStretchy)T=lo.svgSpan(s,e),T=K.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:l},{type:"elem",elem:T,wrapperClasses:["svg-align"],wrapperStyle:c>0?{width:"calc(100% - "+$e(2*c)+")",marginLeft:$e(2*c)}:void 0}]},e);else{var $,y;s.label==="\\vec"?($=K.staticSvg("vec",e),y=K.svgData.vec[1]):($=K.makeOrd({mode:s.mode,text:s.label},e,"textord"),$=py($),$.italic=0,y=$.width,p&&(g+=$.depth)),T=K.makeSpan(["accent-body"],[$]);var R=s.label==="\\textcircled";R&&(T.classes.push("accent-full"),g=l.height);var C=c;R||(C-=y/2),T.style.left=$e(C),s.label==="\\textcircled"&&(T.style.top=".2em"),T=K.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:l},{type:"kern",size:-g},{type:"elem",elem:T}]},e)}var x=K.makeSpan(["mord","accent"],[T],e);return n?(n.children[0]=x,n.height=Math.max(x.height,n.height),n.classes[0]="mord",n):x},FC=(r,e)=>{var i=r.isStretchy?lo.mathMLnode(r.label):new me.MathNode("mo",[Is(r.label,r.mode)]),s=new me.MathNode("mover",[zt(r.base,e),i]);return s.setAttribute("accent","true"),s},A9=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map(r=>"\\"+r).join("|"));Ae({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(r,e)=>{var i=Y0(e[0]),s=!A9.test(r.funcName),n=!s||r.funcName==="\\widehat"||r.funcName==="\\widetilde"||r.funcName==="\\widecheck";return{type:"accent",mode:r.parser.mode,label:r.funcName,isStretchy:s,isShifty:n,base:i}},htmlBuilder:Hb,mathmlBuilder:FC});Ae({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(r,e)=>{var i=e[0],s=r.parser.mode;return s==="math"&&(r.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+r.funcName+" works only in text mode"),s="text"),{type:"accent",mode:s,label:r.funcName,isStretchy:!1,isShifty:!0,base:i}},htmlBuilder:Hb,mathmlBuilder:FC});Ae({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:(r,e)=>{var{parser:i,funcName:s}=r,n=e[0];return{type:"accentUnder",mode:i.mode,label:s,base:n}},htmlBuilder:(r,e)=>{var i=Mt(r.base,e),s=lo.svgSpan(r,e),n=r.label==="\\utilde"?.12:0,l=K.makeVList({positionType:"top",positionData:i.height,children:[{type:"elem",elem:s,wrapperClasses:["svg-align"]},{type:"kern",size:n},{type:"elem",elem:i}]},e);return K.makeSpan(["mord","accentunder"],[l],e)},mathmlBuilder:(r,e)=>{var i=lo.mathMLnode(r.label),s=new me.MathNode("munder",[zt(r.base,e),i]);return s.setAttribute("accentunder","true"),s}});var Xd=r=>{var e=new me.MathNode("mpadded",r?[r]:[]);return e.setAttribute("width","+0.6em"),e.setAttribute("lspace","0.3em"),e};Ae({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(r,e,i){var{parser:s,funcName:n}=r;return{type:"xArrow",mode:s.mode,label:n,body:e[0],below:i[0]}},htmlBuilder(r,e){var i=e.style,s=e.havingStyle(i.sup()),n=K.wrapFragment(Mt(r.body,s,e),e),l=r.label.slice(0,2)==="\\x"?"x":"cd";n.classes.push(l+"-arrow-pad");var u;r.below&&(s=e.havingStyle(i.sub()),u=K.wrapFragment(Mt(r.below,s,e),e),u.classes.push(l+"-arrow-pad"));var c=lo.svgSpan(r,e),h=-e.fontMetrics().axisHeight+.5*c.height,f=-e.fontMetrics().axisHeight-.5*c.height-.111;(n.depth>.25||r.label==="\\xleftequilibrium")&&(f-=n.depth);var p;if(u){var g=-e.fontMetrics().axisHeight+u.height+.5*c.height+.111;p=K.makeVList({positionType:"individualShift",children:[{type:"elem",elem:n,shift:f},{type:"elem",elem:c,shift:h},{type:"elem",elem:u,shift:g}]},e)}else p=K.makeVList({positionType:"individualShift",children:[{type:"elem",elem:n,shift:f},{type:"elem",elem:c,shift:h}]},e);return p.children[0].children[0].children[1].classes.push("svg-align"),K.makeSpan(["mrel","x-arrow"],[p],e)},mathmlBuilder(r,e){var i=lo.mathMLnode(r.label);i.setAttribute("minsize",r.label.charAt(0)==="x"?"1.75em":"3.0em");var s;if(r.body){var n=Xd(zt(r.body,e));if(r.below){var l=Xd(zt(r.below,e));s=new me.MathNode("munderover",[i,l,n])}else s=new me.MathNode("mover",[i,n])}else if(r.below){var u=Xd(zt(r.below,e));s=new me.MathNode("munder",[i,u])}else s=Xd(),s=new me.MathNode("mover",[i,s]);return s}});var C9=K.makeSpan;function UC(r,e){var i=Yi(r.body,e,!0);return C9([r.mclass],i,e)}function HC(r,e){var i,s=Vr(r.body,e);return r.mclass==="minner"?i=new me.MathNode("mpadded",s):r.mclass==="mord"?r.isCharacterBox?(i=s[0],i.type="mi"):i=new me.MathNode("mi",s):(r.isCharacterBox?(i=s[0],i.type="mo"):i=new me.MathNode("mo",s),r.mclass==="mbin"?(i.attributes.lspace="0.22em",i.attributes.rspace="0.22em"):r.mclass==="mpunct"?(i.attributes.lspace="0em",i.attributes.rspace="0.17em"):r.mclass==="mopen"||r.mclass==="mclose"?(i.attributes.lspace="0em",i.attributes.rspace="0em"):r.mclass==="minner"&&(i.attributes.lspace="0.0556em",i.attributes.width="+0.1111em")),i}Ae({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler(r,e){var{parser:i,funcName:s}=r,n=e[0];return{type:"mclass",mode:i.mode,mclass:"m"+s.slice(5),body:yi(n),isCharacterBox:Ze.isCharacterBox(n)}},htmlBuilder:UC,mathmlBuilder:HC});var qf=r=>{var e=r.type==="ordgroup"&&r.body.length?r.body[0]:r;return e.type==="atom"&&(e.family==="bin"||e.family==="rel")?"m"+e.family:"mord"};Ae({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler(r,e){var{parser:i}=r;return{type:"mclass",mode:i.mode,mclass:qf(e[0]),body:yi(e[1]),isCharacterBox:Ze.isCharacterBox(e[1])}}});Ae({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler(r,e){var{parser:i,funcName:s}=r,n=e[1],l=e[0],u;s!=="\\stackrel"?u=qf(n):u="mrel";var c={type:"op",mode:n.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:s!=="\\stackrel",body:yi(n)},h={type:"supsub",mode:l.mode,base:c,sup:s==="\\underset"?null:l,sub:s==="\\underset"?l:null};return{type:"mclass",mode:i.mode,mclass:u,body:[h],isCharacterBox:Ze.isCharacterBox(h)}},htmlBuilder:UC,mathmlBuilder:HC});Ae({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler(r,e){var{parser:i}=r;return{type:"pmb",mode:i.mode,mclass:qf(e[0]),body:yi(e[0])}},htmlBuilder(r,e){var i=Yi(r.body,e,!0),s=K.makeSpan([r.mclass],i,e);return s.style.textShadow="0.02em 0.01em 0.04px",s},mathmlBuilder(r,e){var i=Vr(r.body,e),s=new me.MathNode("mstyle",i);return s.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),s}});var O9={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},vy=()=>({type:"styling",body:[],mode:"math",style:"display"}),yy=r=>r.type==="textord"&&r.text==="@",w9=(r,e)=>(r.type==="mathord"||r.type==="atom")&&r.text===e;function R9(r,e,i){var s=O9[r];switch(s){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return i.callFunction(s,[e[0]],[e[1]]);case"\\uparrow":case"\\downarrow":{var n=i.callFunction("\\\\cdleft",[e[0]],[]),l={type:"atom",text:s,mode:"math",family:"rel"},u=i.callFunction("\\Big",[l],[]),c=i.callFunction("\\\\cdright",[e[1]],[]),h={type:"ordgroup",mode:"math",body:[n,u,c]};return i.callFunction("\\\\cdparent",[h],[])}case"\\\\cdlongequal":return i.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{var f={type:"textord",text:"\\Vert",mode:"math"};return i.callFunction("\\Big",[f],[])}default:return{type:"textord",text:" ",mode:"math"}}}function N9(r){var e=[];for(r.gullet.beginGroup(),r.gullet.macros.set("\\cr","\\\\\\relax"),r.gullet.beginGroup();;){e.push(r.parseExpression(!1,"\\\\")),r.gullet.endGroup(),r.gullet.beginGroup();var i=r.fetch().text;if(i==="&"||i==="\\\\")r.consume();else if(i==="\\end"){e[e.length-1].length===0&&e.pop();break}else throw new ge("Expected \\\\ or \\cr or \\end",r.nextToken)}for(var s=[],n=[s],l=0;l<e.length;l++){for(var u=e[l],c=vy(),h=0;h<u.length;h++)if(!yy(u[h]))c.body.push(u[h]);else{s.push(c),h+=1;var f=Ub(u[h]).text,p=new Array(2);if(p[0]={type:"ordgroup",mode:"math",body:[]},p[1]={type:"ordgroup",mode:"math",body:[]},!("=|.".indexOf(f)>-1))if("<>AV".indexOf(f)>-1)for(var g=0;g<2;g++){for(var T=!0,$=h+1;$<u.length;$++){if(w9(u[$],f)){T=!1,h=$;break}if(yy(u[$]))throw new ge("Missing a "+f+" character to complete a CD arrow.",u[$]);p[g].body.push(u[$])}if(T)throw new ge("Missing a "+f+" character to complete a CD arrow.",u[h])}else throw new ge('Expected one of "<>AV=|." after @',u[h]);var y=R9(f,p,r),R={type:"styling",body:[y],mode:"math",style:"display"};s.push(R),c=vy()}l%2===0?s.push(c):s.shift(),s=[],n.push(s)}r.gullet.endGroup(),r.gullet.endGroup();var C=new Array(n[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25});return{type:"array",mode:"math",body:n,arraystretch:1,addJot:!0,rowGaps:[null],cols:C,colSeparationType:"CD",hLinesBeforeRow:new Array(n.length+1).fill([])}}Ae({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler(r,e){var{parser:i,funcName:s}=r;return{type:"cdlabel",mode:i.mode,side:s.slice(4),label:e[0]}},htmlBuilder(r,e){var i=e.havingStyle(e.style.sup()),s=K.wrapFragment(Mt(r.label,i,e),e);return s.classes.push("cd-label-"+r.side),s.style.bottom=$e(.8-s.depth),s.height=0,s.depth=0,s},mathmlBuilder(r,e){var i=new me.MathNode("mrow",[zt(r.label,e)]);return i=new me.MathNode("mpadded",[i]),i.setAttribute("width","0"),r.side==="left"&&i.setAttribute("lspace","-1width"),i.setAttribute("voffset","0.7em"),i=new me.MathNode("mstyle",[i]),i.setAttribute("displaystyle","false"),i.setAttribute("scriptlevel","1"),i}});Ae({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler(r,e){var{parser:i}=r;return{type:"cdlabelparent",mode:i.mode,fragment:e[0]}},htmlBuilder(r,e){var i=K.wrapFragment(Mt(r.fragment,e),e);return i.classes.push("cd-vert-arrow"),i},mathmlBuilder(r,e){return new me.MathNode("mrow",[zt(r.fragment,e)])}});Ae({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler(r,e){for(var{parser:i}=r,s=ht(e[0],"ordgroup"),n=s.body,l="",u=0;u<n.length;u++){var c=ht(n[u],"textord");l+=c.text}var h=parseInt(l),f;if(isNaN(h))throw new ge("\\@char has non-numeric argument "+l);if(h<0||h>=1114111)throw new ge("\\@char with invalid code point "+l);return h<=65535?f=String.fromCharCode(h):(h-=65536,f=String.fromCharCode((h>>10)+55296,(h&1023)+56320)),{type:"textord",mode:i.mode,text:f}}});var GC=(r,e)=>{var i=Yi(r.body,e.withColor(r.color),!1);return K.makeFragment(i)},VC=(r,e)=>{var i=Vr(r.body,e.withColor(r.color)),s=new me.MathNode("mstyle",i);return s.setAttribute("mathcolor",r.color),s};Ae({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(r,e){var{parser:i}=r,s=ht(e[0],"color-token").color,n=e[1];return{type:"color",mode:i.mode,color:s,body:yi(n)}},htmlBuilder:GC,mathmlBuilder:VC});Ae({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(r,e){var{parser:i,breakOnTokenText:s}=r,n=ht(e[0],"color-token").color;i.gullet.macros.set("\\current@color",n);var l=i.parseExpression(!0,s);return{type:"color",mode:i.mode,color:n,body:l}},htmlBuilder:GC,mathmlBuilder:VC});Ae({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(r,e,i){var{parser:s}=r,n=s.gullet.future().text==="["?s.parseSizeGroup(!0):null,l=!s.settings.displayMode||!s.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:s.mode,newLine:l,size:n&&ht(n,"size").value}},htmlBuilder(r,e){var i=K.makeSpan(["mspace"],[],e);return r.newLine&&(i.classes.push("newline"),r.size&&(i.style.marginTop=$e(ci(r.size,e)))),i},mathmlBuilder(r,e){var i=new me.MathNode("mspace");return r.newLine&&(i.setAttribute("linebreak","newline"),r.size&&i.setAttribute("height",$e(ci(r.size,e)))),i}});var d_={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},WC=r=>{var e=r.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(e))throw new ge("Expected a control sequence",r);return e},x9=r=>{var e=r.gullet.popToken();return e.text==="="&&(e=r.gullet.popToken(),e.text===" "&&(e=r.gullet.popToken())),e},zC=(r,e,i,s)=>{var n=r.gullet.macros.get(i.text);n==null&&(i.noexpand=!0,n={tokens:[i],numArgs:0,unexpandable:!r.gullet.isExpandable(i.text)}),r.gullet.macros.set(e,n,s)};Ae({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(r){var{parser:e,funcName:i}=r;e.consumeSpaces();var s=e.fetch();if(d_[s.text])return(i==="\\global"||i==="\\\\globallong")&&(s.text=d_[s.text]),ht(e.parseFunction(),"internal");throw new ge("Invalid token after macro prefix",s)}});Ae({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(r){var{parser:e,funcName:i}=r,s=e.gullet.popToken(),n=s.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(n))throw new ge("Expected a control sequence",s);for(var l=0,u,c=[[]];e.gullet.future().text!=="{";)if(s=e.gullet.popToken(),s.text==="#"){if(e.gullet.future().text==="{"){u=e.gullet.future(),c[l].push("{");break}if(s=e.gullet.popToken(),!/^[1-9]$/.test(s.text))throw new ge('Invalid argument number "'+s.text+'"');if(parseInt(s.text)!==l+1)throw new ge('Argument number "'+s.text+'" out of order');l++,c.push([])}else{if(s.text==="EOF")throw new ge("Expected a macro definition");c[l].push(s.text)}var{tokens:h}=e.gullet.consumeArg();return u&&h.unshift(u),(i==="\\edef"||i==="\\xdef")&&(h=e.gullet.expandTokens(h),h.reverse()),e.gullet.macros.set(n,{tokens:h,numArgs:l,delimiters:c},i===d_[i]),{type:"internal",mode:e.mode}}});Ae({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(r){var{parser:e,funcName:i}=r,s=WC(e.gullet.popToken());e.gullet.consumeSpaces();var n=x9(e);return zC(e,s,n,i==="\\\\globallet"),{type:"internal",mode:e.mode}}});Ae({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(r){var{parser:e,funcName:i}=r,s=WC(e.gullet.popToken()),n=e.gullet.popToken(),l=e.gullet.popToken();return zC(e,s,l,i==="\\\\globalfuture"),e.gullet.pushToken(l),e.gullet.pushToken(n),{type:"internal",mode:e.mode}}});var Sc=function(e,i,s){var n=jt.math[e]&&jt.math[e].replace,l=Lb(n||e,i,s);if(!l)throw new Error("Unsupported symbol "+e+" and font size "+i+".");return l},Gb=function(e,i,s,n){var l=s.havingBaseStyle(i),u=K.makeSpan(n.concat(l.sizingClasses(s)),[e],s),c=l.sizeMultiplier/s.sizeMultiplier;return u.height*=c,u.depth*=c,u.maxFontSize=l.sizeMultiplier,u},YC=function(e,i,s){var n=i.havingBaseStyle(s),l=(1-i.sizeMultiplier/n.sizeMultiplier)*i.fontMetrics().axisHeight;e.classes.push("delimcenter"),e.style.top=$e(l),e.height-=l,e.depth+=l},D9=function(e,i,s,n,l,u){var c=K.makeSymbol(e,"Main-Regular",l,n),h=Gb(c,i,n,u);return s&&YC(h,n,i),h},L9=function(e,i,s,n){return K.makeSymbol(e,"Size"+i+"-Regular",s,n)},XC=function(e,i,s,n,l,u){var c=L9(e,i,l,n),h=Gb(K.makeSpan(["delimsizing","size"+i],[c],n),Ye.TEXT,n,u);return s&&YC(h,n,Ye.TEXT),h},h1=function(e,i,s){var n;i==="Size1-Regular"?n="delim-size1":n="delim-size4";var l=K.makeSpan(["delimsizinginner",n],[K.makeSpan([],[K.makeSymbol(e,i,s)])]);return{type:"elem",elem:l}},d1=function(e,i,s){var n=$n["Size4-Regular"][e.charCodeAt(0)]?$n["Size4-Regular"][e.charCodeAt(0)][4]:$n["Size1-Regular"][e.charCodeAt(0)][4],l=new Wo("inner",H7(e,Math.round(1e3*i))),u=new no([l],{width:$e(n),height:$e(i),style:"width:"+$e(n),viewBox:"0 0 "+1e3*n+" "+Math.round(1e3*i),preserveAspectRatio:"xMinYMin"}),c=K.makeSvgSpan([],[u],s);return c.height=i,c.style.height=$e(i),c.style.width=$e(n),{type:"elem",elem:c}},f_=.008,jd={type:"kern",size:-1*f_},M9=["|","\\lvert","\\rvert","\\vert"],B9=["\\|","\\lVert","\\rVert","\\Vert"],jC=function(e,i,s,n,l,u){var c,h,f,p,g="",T=0;c=f=p=e,h=null;var $="Size1-Regular";e==="\\uparrow"?f=p="⏐":e==="\\Uparrow"?f=p="‖":e==="\\downarrow"?c=f="⏐":e==="\\Downarrow"?c=f="‖":e==="\\updownarrow"?(c="\\uparrow",f="⏐",p="\\downarrow"):e==="\\Updownarrow"?(c="\\Uparrow",f="‖",p="\\Downarrow"):Ze.contains(M9,e)?(f="∣",g="vert",T=333):Ze.contains(B9,e)?(f="∥",g="doublevert",T=556):e==="["||e==="\\lbrack"?(c="⎡",f="⎢",p="⎣",$="Size4-Regular",g="lbrack",T=667):e==="]"||e==="\\rbrack"?(c="⎤",f="⎥",p="⎦",$="Size4-Regular",g="rbrack",T=667):e==="\\lfloor"||e==="⌊"?(f=c="⎢",p="⎣",$="Size4-Regular",g="lfloor",T=667):e==="\\lceil"||e==="⌈"?(c="⎡",f=p="⎢",$="Size4-Regular",g="lceil",T=667):e==="\\rfloor"||e==="⌋"?(f=c="⎥",p="⎦",$="Size4-Regular",g="rfloor",T=667):e==="\\rceil"||e==="⌉"?(c="⎤",f=p="⎥",$="Size4-Regular",g="rceil",T=667):e==="("||e==="\\lparen"?(c="⎛",f="⎜",p="⎝",$="Size4-Regular",g="lparen",T=875):e===")"||e==="\\rparen"?(c="⎞",f="⎟",p="⎠",$="Size4-Regular",g="rparen",T=875):e==="\\{"||e==="\\lbrace"?(c="⎧",h="⎨",p="⎩",f="⎪",$="Size4-Regular"):e==="\\}"||e==="\\rbrace"?(c="⎫",h="⎬",p="⎭",f="⎪",$="Size4-Regular"):e==="\\lgroup"||e==="⟮"?(c="⎧",p="⎩",f="⎪",$="Size4-Regular"):e==="\\rgroup"||e==="⟯"?(c="⎫",p="⎭",f="⎪",$="Size4-Regular"):e==="\\lmoustache"||e==="⎰"?(c="⎧",p="⎭",f="⎪",$="Size4-Regular"):(e==="\\rmoustache"||e==="⎱")&&(c="⎫",p="⎩",f="⎪",$="Size4-Regular");var y=Sc(c,$,l),R=y.height+y.depth,C=Sc(f,$,l),x=C.height+C.depth,j=Sc(p,$,l),F=j.height+j.depth,q=0,W=1;if(h!==null){var ne=Sc(h,$,l);q=ne.height+ne.depth,W=2}var P=R+F+q,Q=Math.max(0,Math.ceil((i-P)/(W*x))),re=P+Q*W*x,Y=n.fontMetrics().axisHeight;s&&(Y*=n.sizeMultiplier);var _e=re/2-Y,Xe=[];if(g.length>0){var At=re-R-F,vt=Math.round(re*1e3),je=G7(g,Math.round(At*1e3)),we=new Wo(g,je),xe=(T/1e3).toFixed(3)+"em",St=(vt/1e3).toFixed(3)+"em",It=new no([we],{width:xe,height:St,viewBox:"0 0 "+T+" "+vt}),bt=K.makeSvgSpan([],[It],n);bt.height=vt/1e3,bt.style.width=xe,bt.style.height=St,Xe.push({type:"elem",elem:bt})}else{if(Xe.push(h1(p,$,l)),Xe.push(jd),h===null){var ei=re-R-F+2*f_;Xe.push(d1(f,ei,n))}else{var z=(re-R-F-q)/2+2*f_;Xe.push(d1(f,z,n)),Xe.push(jd),Xe.push(h1(h,$,l)),Xe.push(jd),Xe.push(d1(f,z,n))}Xe.push(jd),Xe.push(h1(c,$,l))}var Ce=n.havingBaseStyle(Ye.TEXT),pr=K.makeVList({positionType:"bottom",positionData:_e,children:Xe},Ce);return Gb(K.makeSpan(["delimsizing","mult"],[pr],Ce),Ye.TEXT,n,u)},f1=80,p1=.08,m1=function(e,i,s,n,l){var u=U7(e,n,s),c=new Wo(e,u),h=new no([c],{width:"400em",height:$e(i),viewBox:"0 0 400000 "+s,preserveAspectRatio:"xMinYMin slice"});return K.makeSvgSpan(["hide-tail"],[h],l)},P9=function(e,i){var s=i.havingBaseSizing(),n=QC("\\surd",e*s.sizeMultiplier,JC,s),l=s.sizeMultiplier,u=Math.max(0,i.minRuleThickness-i.fontMetrics().sqrtRuleThickness),c,h=0,f=0,p=0,g;return n.type==="small"?(p=1e3+1e3*u+f1,e<1?l=1:e<1.4&&(l=.7),h=(1+u+p1)/l,f=(1+u)/l,c=m1("sqrtMain",h,p,u,i),c.style.minWidth="0.853em",g=.833/l):n.type==="large"?(p=(1e3+f1)*Bc[n.size],f=(Bc[n.size]+u)/l,h=(Bc[n.size]+u+p1)/l,c=m1("sqrtSize"+n.size,h,p,u,i),c.style.minWidth="1.02em",g=1/l):(h=e+u+p1,f=e+u,p=Math.floor(1e3*e+u)+f1,c=m1("sqrtTall",h,p,u,i),c.style.minWidth="0.742em",g=1.056),c.height=f,c.style.height=$e(h),{span:c,advanceWidth:g,ruleWidth:(i.fontMetrics().sqrtRuleThickness+u)*l}},KC=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","\\surd"],F9=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱"],qC=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],Bc=[0,1.2,1.8,2.4,3],U9=function(e,i,s,n,l){if(e==="<"||e==="\\lt"||e==="⟨"?e="\\langle":(e===">"||e==="\\gt"||e==="⟩")&&(e="\\rangle"),Ze.contains(KC,e)||Ze.contains(qC,e))return XC(e,i,!1,s,n,l);if(Ze.contains(F9,e))return jC(e,Bc[i],!1,s,n,l);throw new ge("Illegal delimiter: '"+e+"'")},H9=[{type:"small",style:Ye.SCRIPTSCRIPT},{type:"small",style:Ye.SCRIPT},{type:"small",style:Ye.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],G9=[{type:"small",style:Ye.SCRIPTSCRIPT},{type:"small",style:Ye.SCRIPT},{type:"small",style:Ye.TEXT},{type:"stack"}],JC=[{type:"small",style:Ye.SCRIPTSCRIPT},{type:"small",style:Ye.SCRIPT},{type:"small",style:Ye.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],V9=function(e){if(e.type==="small")return"Main-Regular";if(e.type==="large")return"Size"+e.size+"-Regular";if(e.type==="stack")return"Size4-Regular";throw new Error("Add support for delim type '"+e.type+"' here.")},QC=function(e,i,s,n){for(var l=Math.min(2,3-n.style.size),u=l;u<s.length&&s[u].type!=="stack";u++){var c=Sc(e,V9(s[u]),"math"),h=c.height+c.depth;if(s[u].type==="small"){var f=n.havingBaseStyle(s[u].style);h*=f.sizeMultiplier}if(h>i)return s[u]}return s[s.length-1]},ZC=function(e,i,s,n,l,u){e==="<"||e==="\\lt"||e==="⟨"?e="\\langle":(e===">"||e==="\\gt"||e==="⟩")&&(e="\\rangle");var c;Ze.contains(qC,e)?c=H9:Ze.contains(KC,e)?c=JC:c=G9;var h=QC(e,i,c,n);return h.type==="small"?D9(e,h.style,s,n,l,u):h.type==="large"?XC(e,h.size,s,n,l,u):jC(e,i,s,n,l,u)},W9=function(e,i,s,n,l,u){var c=n.fontMetrics().axisHeight*n.sizeMultiplier,h=901,f=5/n.fontMetrics().ptPerEm,p=Math.max(i-c,s+c),g=Math.max(p/500*h,2*p-f);return ZC(e,g,!0,n,l,u)},ro={sqrtImage:P9,sizedDelim:U9,sizeToMaxHeight:Bc,customSizedDelim:ZC,leftRightDelim:W9},Sy={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},z9=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","<",">","\\langle","⟨","\\rangle","⟩","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function Jf(r,e){var i=Kf(r);if(i&&Ze.contains(z9,i.text))return i;throw i?new ge("Invalid delimiter '"+i.text+"' after '"+e.funcName+"'",r):new ge("Invalid delimiter type '"+r.type+"'",r)}Ae({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(r,e)=>{var i=Jf(e[0],r);return{type:"delimsizing",mode:r.parser.mode,size:Sy[r.funcName].size,mclass:Sy[r.funcName].mclass,delim:i.text}},htmlBuilder:(r,e)=>r.delim==="."?K.makeSpan([r.mclass]):ro.sizedDelim(r.delim,r.size,e,r.mode,[r.mclass]),mathmlBuilder:r=>{var e=[];r.delim!=="."&&e.push(Is(r.delim,r.mode));var i=new me.MathNode("mo",e);r.mclass==="mopen"||r.mclass==="mclose"?i.setAttribute("fence","true"):i.setAttribute("fence","false"),i.setAttribute("stretchy","true");var s=$e(ro.sizeToMaxHeight[r.size]);return i.setAttribute("minsize",s),i.setAttribute("maxsize",s),i}});function Iy(r){if(!r.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}Ae({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:(r,e)=>{var i=r.parser.gullet.macros.get("\\current@color");if(i&&typeof i!="string")throw new ge("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:r.parser.mode,delim:Jf(e[0],r).text,color:i}}});Ae({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:(r,e)=>{var i=Jf(e[0],r),s=r.parser;++s.leftrightDepth;var n=s.parseExpression(!1);--s.leftrightDepth,s.expect("\\right",!1);var l=ht(s.parseFunction(),"leftright-right");return{type:"leftright",mode:s.mode,body:n,left:i.text,right:l.delim,rightColor:l.color}},htmlBuilder:(r,e)=>{Iy(r);for(var i=Yi(r.body,e,!0,["mopen","mclose"]),s=0,n=0,l=!1,u=0;u<i.length;u++)i[u].isMiddle?l=!0:(s=Math.max(i[u].height,s),n=Math.max(i[u].depth,n));s*=e.sizeMultiplier,n*=e.sizeMultiplier;var c;if(r.left==="."?c=jc(e,["mopen"]):c=ro.leftRightDelim(r.left,s,n,e,r.mode,["mopen"]),i.unshift(c),l)for(var h=1;h<i.length;h++){var f=i[h],p=f.isMiddle;p&&(i[h]=ro.leftRightDelim(p.delim,s,n,p.options,r.mode,[]))}var g;if(r.right===".")g=jc(e,["mclose"]);else{var T=r.rightColor?e.withColor(r.rightColor):e;g=ro.leftRightDelim(r.right,s,n,T,r.mode,["mclose"])}return i.push(g),K.makeSpan(["minner"],i,e)},mathmlBuilder:(r,e)=>{Iy(r);var i=Vr(r.body,e);if(r.left!=="."){var s=new me.MathNode("mo",[Is(r.left,r.mode)]);s.setAttribute("fence","true"),i.unshift(s)}if(r.right!=="."){var n=new me.MathNode("mo",[Is(r.right,r.mode)]);n.setAttribute("fence","true"),r.rightColor&&n.setAttribute("mathcolor",r.rightColor),i.push(n)}return Pb(i)}});Ae({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:(r,e)=>{var i=Jf(e[0],r);if(!r.parser.leftrightDepth)throw new ge("\\middle without preceding \\left",i);return{type:"middle",mode:r.parser.mode,delim:i.text}},htmlBuilder:(r,e)=>{var i;if(r.delim===".")i=jc(e,[]);else{i=ro.sizedDelim(r.delim,1,e,r.mode,[]);var s={delim:r.delim,options:e};i.isMiddle=s}return i},mathmlBuilder:(r,e)=>{var i=r.delim==="\\vert"||r.delim==="|"?Is("|","text"):Is(r.delim,r.mode),s=new me.MathNode("mo",[i]);return s.setAttribute("fence","true"),s.setAttribute("lspace","0.05em"),s.setAttribute("rspace","0.05em"),s}});var Vb=(r,e)=>{var i=K.wrapFragment(Mt(r.body,e),e),s=r.label.slice(1),n=e.sizeMultiplier,l,u=0,c=Ze.isCharacterBox(r.body);if(s==="sout")l=K.makeSpan(["stretchy","sout"]),l.height=e.fontMetrics().defaultRuleThickness/n,u=-.5*e.fontMetrics().xHeight;else if(s==="phase"){var h=ci({number:.6,unit:"pt"},e),f=ci({number:.35,unit:"ex"},e),p=e.havingBaseSizing();n=n/p.sizeMultiplier;var g=i.height+i.depth+h+f;i.style.paddingLeft=$e(g/2+h);var T=Math.floor(1e3*g*n),$=P7(T),y=new no([new Wo("phase",$)],{width:"400em",height:$e(T/1e3),viewBox:"0 0 400000 "+T,preserveAspectRatio:"xMinYMin slice"});l=K.makeSvgSpan(["hide-tail"],[y],e),l.style.height=$e(g),u=i.depth+h+f}else{/cancel/.test(s)?c||i.classes.push("cancel-pad"):s==="angl"?i.classes.push("anglpad"):i.classes.push("boxpad");var R=0,C=0,x=0;/box/.test(s)?(x=Math.max(e.fontMetrics().fboxrule,e.minRuleThickness),R=e.fontMetrics().fboxsep+(s==="colorbox"?0:x),C=R):s==="angl"?(x=Math.max(e.fontMetrics().defaultRuleThickness,e.minRuleThickness),R=4*x,C=Math.max(0,.25-i.depth)):(R=c?.2:0,C=R),l=lo.encloseSpan(i,s,R,C,e),/fbox|boxed|fcolorbox/.test(s)?(l.style.borderStyle="solid",l.style.borderWidth=$e(x)):s==="angl"&&x!==.049&&(l.style.borderTopWidth=$e(x),l.style.borderRightWidth=$e(x)),u=i.depth+C,r.backgroundColor&&(l.style.backgroundColor=r.backgroundColor,r.borderColor&&(l.style.borderColor=r.borderColor))}var j;if(r.backgroundColor)j=K.makeVList({positionType:"individualShift",children:[{type:"elem",elem:l,shift:u},{type:"elem",elem:i,shift:0}]},e);else{var F=/cancel|phase/.test(s)?["svg-align"]:[];j=K.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:0},{type:"elem",elem:l,shift:u,wrapperClasses:F}]},e)}return/cancel/.test(s)&&(j.height=i.height,j.depth=i.depth),/cancel/.test(s)&&!c?K.makeSpan(["mord","cancel-lap"],[j],e):K.makeSpan(["mord"],[j],e)},Wb=(r,e)=>{var i=0,s=new me.MathNode(r.label.indexOf("colorbox")>-1?"mpadded":"menclose",[zt(r.body,e)]);switch(r.label){case"\\cancel":s.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":s.setAttribute("notation","downdiagonalstrike");break;case"\\phase":s.setAttribute("notation","phasorangle");break;case"\\sout":s.setAttribute("notation","horizontalstrike");break;case"\\fbox":s.setAttribute("notation","box");break;case"\\angl":s.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(i=e.fontMetrics().fboxsep*e.fontMetrics().ptPerEm,s.setAttribute("width","+"+2*i+"pt"),s.setAttribute("height","+"+2*i+"pt"),s.setAttribute("lspace",i+"pt"),s.setAttribute("voffset",i+"pt"),r.label==="\\fcolorbox"){var n=Math.max(e.fontMetrics().fboxrule,e.minRuleThickness);s.setAttribute("style","border: "+n+"em solid "+String(r.borderColor))}break;case"\\xcancel":s.setAttribute("notation","updiagonalstrike downdiagonalstrike");break}return r.backgroundColor&&s.setAttribute("mathbackground",r.backgroundColor),s};Ae({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(r,e,i){var{parser:s,funcName:n}=r,l=ht(e[0],"color-token").color,u=e[1];return{type:"enclose",mode:s.mode,label:n,backgroundColor:l,body:u}},htmlBuilder:Vb,mathmlBuilder:Wb});Ae({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(r,e,i){var{parser:s,funcName:n}=r,l=ht(e[0],"color-token").color,u=ht(e[1],"color-token").color,c=e[2];return{type:"enclose",mode:s.mode,label:n,backgroundColor:u,borderColor:l,body:c}},htmlBuilder:Vb,mathmlBuilder:Wb});Ae({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(r,e){var{parser:i}=r;return{type:"enclose",mode:i.mode,label:"\\fbox",body:e[0]}}});Ae({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler(r,e){var{parser:i,funcName:s}=r,n=e[0];return{type:"enclose",mode:i.mode,label:s,body:n}},htmlBuilder:Vb,mathmlBuilder:Wb});Ae({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(r,e){var{parser:i}=r;return{type:"enclose",mode:i.mode,label:"\\angl",body:e[0]}}});var e4={};function wn(r){for(var{type:e,names:i,props:s,handler:n,htmlBuilder:l,mathmlBuilder:u}=r,c={type:e,numArgs:s.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:n},h=0;h<i.length;++h)e4[i[h]]=c;l&&(W0[e]=l),u&&(z0[e]=u)}var t4={};function A(r,e){t4[r]=e}function ky(r){var e=[];r.consumeSpaces();var i=r.fetch().text;for(i==="\\relax"&&(r.consume(),r.consumeSpaces(),i=r.fetch().text);i==="\\hline"||i==="\\hdashline";)r.consume(),e.push(i==="\\hdashline"),r.consumeSpaces(),i=r.fetch().text;return e}var Qf=r=>{var e=r.parser.settings;if(!e.displayMode)throw new ge("{"+r.envName+"} can be used only in display mode.")};function zb(r){if(r.indexOf("ed")===-1)return r.indexOf("*")===-1}function tl(r,e,i){var{hskipBeforeAndAfter:s,addJot:n,cols:l,arraystretch:u,colSeparationType:c,autoTag:h,singleRow:f,emptySingleRow:p,maxNumCols:g,leqno:T}=e;if(r.gullet.beginGroup(),f||r.gullet.macros.set("\\cr","\\\\\\relax"),!u){var $=r.gullet.expandMacroAsText("\\arraystretch");if($==null)u=1;else if(u=parseFloat($),!u||u<0)throw new ge("Invalid \\arraystretch: "+$)}r.gullet.beginGroup();var y=[],R=[y],C=[],x=[],j=h!=null?[]:void 0;function F(){h&&r.gullet.macros.set("\\@eqnsw","1",!0)}function q(){j&&(r.gullet.macros.get("\\df@tag")?(j.push(r.subparse([new Es("\\df@tag")])),r.gullet.macros.set("\\df@tag",void 0,!0)):j.push(Boolean(h)&&r.gullet.macros.get("\\@eqnsw")==="1"))}for(F(),x.push(ky(r));;){var W=r.parseExpression(!1,f?"\\end":"\\\\");r.gullet.endGroup(),r.gullet.beginGroup(),W={type:"ordgroup",mode:r.mode,body:W},i&&(W={type:"styling",mode:r.mode,style:i,body:[W]}),y.push(W);var ne=r.fetch().text;if(ne==="&"){if(g&&y.length===g){if(f||c)throw new ge("Too many tab characters: &",r.nextToken);r.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}r.consume()}else if(ne==="\\end"){q(),y.length===1&&W.type==="styling"&&W.body[0].body.length===0&&(R.length>1||!p)&&R.pop(),x.length<R.length+1&&x.push([]);break}else if(ne==="\\\\"){r.consume();var P=void 0;r.gullet.future().text!==" "&&(P=r.parseSizeGroup(!0)),C.push(P?P.value:null),q(),x.push(ky(r)),y=[],R.push(y),F()}else throw new ge("Expected & or \\\\ or \\cr or \\end",r.nextToken)}return r.gullet.endGroup(),r.gullet.endGroup(),{type:"array",mode:r.mode,addJot:n,arraystretch:u,body:R,cols:l,rowGaps:C,hskipBeforeAndAfter:s,hLinesBeforeRow:x,colSeparationType:c,tags:j,leqno:T}}function Yb(r){return r.slice(0,1)==="d"?"display":"text"}var Rn=function(e,i){var s,n,l=e.body.length,u=e.hLinesBeforeRow,c=0,h=new Array(l),f=[],p=Math.max(i.fontMetrics().arrayRuleWidth,i.minRuleThickness),g=1/i.fontMetrics().ptPerEm,T=5*g;if(e.colSeparationType&&e.colSeparationType==="small"){var $=i.havingStyle(Ye.SCRIPT).sizeMultiplier;T=.2778*($/i.sizeMultiplier)}var y=e.colSeparationType==="CD"?ci({number:3,unit:"ex"},i):12*g,R=3*g,C=e.arraystretch*y,x=.7*C,j=.3*C,F=0;function q(Ln){for(var us=0;us<Ln.length;++us)us>0&&(F+=.25),f.push({pos:F,isDashed:Ln[us]})}for(q(u[0]),s=0;s<e.body.length;++s){var W=e.body[s],ne=x,P=j;c<W.length&&(c=W.length);var Q=new Array(W.length);for(n=0;n<W.length;++n){var re=Mt(W[n],i);P<re.depth&&(P=re.depth),ne<re.height&&(ne=re.height),Q[n]=re}var Y=e.rowGaps[s],_e=0;Y&&(_e=ci(Y,i),_e>0&&(_e+=j,P<_e&&(P=_e),_e=0)),e.addJot&&(P+=R),Q.height=ne,Q.depth=P,F+=ne,Q.pos=F,F+=P+_e,h[s]=Q,q(u[s+1])}var Xe=F/2+i.fontMetrics().axisHeight,At=e.cols||[],vt=[],je,we,xe=[];if(e.tags&&e.tags.some(Ln=>Ln))for(s=0;s<l;++s){var St=h[s],It=St.pos-Xe,bt=e.tags[s],ei=void 0;bt===!0?ei=K.makeSpan(["eqn-num"],[],i):bt===!1?ei=K.makeSpan([],[],i):ei=K.makeSpan([],Yi(bt,i,!0),i),ei.depth=St.depth,ei.height=St.height,xe.push({type:"elem",elem:ei,shift:It})}for(n=0,we=0;n<c||we<At.length;++n,++we){for(var z=At[we]||{},Ce=!0;z.type==="separator";){if(Ce||(je=K.makeSpan(["arraycolsep"],[]),je.style.width=$e(i.fontMetrics().doubleRuleSep),vt.push(je)),z.separator==="|"||z.separator===":"){var pr=z.separator==="|"?"solid":"dashed",qe=K.makeSpan(["vertical-separator"],[],i);qe.style.height=$e(F),qe.style.borderRightWidth=$e(p),qe.style.borderRightStyle=pr,qe.style.margin="0 "+$e(-p/2);var Kl=F-Xe;Kl&&(qe.style.verticalAlign=$e(-Kl)),vt.push(qe)}else throw new ge("Invalid separator type: "+z.separator);we++,z=At[we]||{},Ce=!1}if(!(n>=c)){var ft=void 0;(n>0||e.hskipBeforeAndAfter)&&(ft=Ze.deflt(z.pregap,T),ft!==0&&(je=K.makeSpan(["arraycolsep"],[]),je.style.width=$e(ft),vt.push(je)));var pi=[];for(s=0;s<l;++s){var ls=h[s],Wr=ls[n];if(Wr){var Cs=ls.pos-Xe;Wr.depth=ls.depth,Wr.height=ls.height,pi.push({type:"elem",elem:Wr,shift:Cs})}}pi=K.makeVList({positionType:"individualShift",children:pi},i),pi=K.makeSpan(["col-align-"+(z.align||"c")],[pi]),vt.push(pi),(n<c-1||e.hskipBeforeAndAfter)&&(ft=Ze.deflt(z.postgap,T),ft!==0&&(je=K.makeSpan(["arraycolsep"],[]),je.style.width=$e(ft),vt.push(je)))}}if(h=K.makeSpan(["mtable"],vt),f.length>0){for(var Os=K.makeLineSpan("hline",i,p),gu=K.makeLineSpan("hdashline",i,p),as=[{type:"elem",elem:h,shift:0}];f.length>0;){var po=f.pop(),ws=po.pos-Xe;po.isDashed?as.push({type:"elem",elem:gu,shift:ws}):as.push({type:"elem",elem:Os,shift:ws})}h=K.makeVList({positionType:"individualShift",children:as},i)}if(xe.length===0)return K.makeSpan(["mord"],[h],i);var Bi=K.makeVList({positionType:"individualShift",children:xe},i);return Bi=K.makeSpan(["tag"],[Bi],i),K.makeFragment([h,Bi])},Y9={c:"center ",l:"left ",r:"right "},Nn=function(e,i){for(var s=[],n=new me.MathNode("mtd",[],["mtr-glue"]),l=new me.MathNode("mtd",[],["mml-eqn-num"]),u=0;u<e.body.length;u++){for(var c=e.body[u],h=[],f=0;f<c.length;f++)h.push(new me.MathNode("mtd",[zt(c[f],i)]));e.tags&&e.tags[u]&&(h.unshift(n),h.push(n),e.leqno?h.unshift(l):h.push(l)),s.push(new me.MathNode("mtr",h))}var p=new me.MathNode("mtable",s),g=e.arraystretch===.5?.1:.16+e.arraystretch-1+(e.addJot?.09:0);p.setAttribute("rowspacing",$e(g));var T="",$="";if(e.cols&&e.cols.length>0){var y=e.cols,R="",C=!1,x=0,j=y.length;y[0].type==="separator"&&(T+="top ",x=1),y[y.length-1].type==="separator"&&(T+="bottom ",j-=1);for(var F=x;F<j;F++)y[F].type==="align"?($+=Y9[y[F].align],C&&(R+="none "),C=!0):y[F].type==="separator"&&C&&(R+=y[F].separator==="|"?"solid ":"dashed ",C=!1);p.setAttribute("columnalign",$.trim()),/[sd]/.test(R)&&p.setAttribute("columnlines",R.trim())}if(e.colSeparationType==="align"){for(var q=e.cols||[],W="",ne=1;ne<q.length;ne++)W+=ne%2?"0em ":"1em ";p.setAttribute("columnspacing",W.trim())}else e.colSeparationType==="alignat"||e.colSeparationType==="gather"?p.setAttribute("columnspacing","0em"):e.colSeparationType==="small"?p.setAttribute("columnspacing","0.2778em"):e.colSeparationType==="CD"?p.setAttribute("columnspacing","0.5em"):p.setAttribute("columnspacing","1em");var P="",Q=e.hLinesBeforeRow;T+=Q[0].length>0?"left ":"",T+=Q[Q.length-1].length>0?"right ":"";for(var re=1;re<Q.length-1;re++)P+=Q[re].length===0?"none ":Q[re][0]?"dashed ":"solid ";return/[sd]/.test(P)&&p.setAttribute("rowlines",P.trim()),T!==""&&(p=new me.MathNode("menclose",[p]),p.setAttribute("notation",T.trim())),e.arraystretch&&e.arraystretch<1&&(p=new me.MathNode("mstyle",[p]),p.setAttribute("scriptlevel","1")),p},i4=function(e,i){e.envName.indexOf("ed")===-1&&Qf(e);var s=[],n=e.envName.indexOf("at")>-1?"alignat":"align",l=e.envName==="split",u=tl(e.parser,{cols:s,addJot:!0,autoTag:l?void 0:zb(e.envName),emptySingleRow:!0,colSeparationType:n,maxNumCols:l?2:void 0,leqno:e.parser.settings.leqno},"display"),c,h=0,f={type:"ordgroup",mode:e.mode,body:[]};if(i[0]&&i[0].type==="ordgroup"){for(var p="",g=0;g<i[0].body.length;g++){var T=ht(i[0].body[g],"textord");p+=T.text}c=Number(p),h=c*2}var $=!h;u.body.forEach(function(x){for(var j=1;j<x.length;j+=2){var F=ht(x[j],"styling"),q=ht(F.body[0],"ordgroup");q.body.unshift(f)}if($)h<x.length&&(h=x.length);else{var W=x.length/2;if(c<W)throw new ge("Too many math in a row: "+("expected "+c+", but got "+W),x[0])}});for(var y=0;y<h;++y){var R="r",C=0;y%2===1?R="l":y>0&&$&&(C=1),s[y]={type:"align",align:R,pregap:C,postgap:0}}return u.colSeparationType=$?"align":"alignat",u};wn({type:"array",names:["array","darray"],props:{numArgs:1},handler(r,e){var i=Kf(e[0]),s=i?[e[0]]:ht(e[0],"ordgroup").body,n=s.map(function(u){var c=Ub(u),h=c.text;if("lcr".indexOf(h)!==-1)return{type:"align",align:h};if(h==="|")return{type:"separator",separator:"|"};if(h===":")return{type:"separator",separator:":"};throw new ge("Unknown column alignment: "+h,u)}),l={cols:n,hskipBeforeAndAfter:!0,maxNumCols:n.length};return tl(r.parser,l,Yb(r.envName))},htmlBuilder:Rn,mathmlBuilder:Nn});wn({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(r){var e={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[r.envName.replace("*","")],i="c",s={hskipBeforeAndAfter:!1,cols:[{type:"align",align:i}]};if(r.envName.charAt(r.envName.length-1)==="*"){var n=r.parser;if(n.consumeSpaces(),n.fetch().text==="["){if(n.consume(),n.consumeSpaces(),i=n.fetch().text,"lcr".indexOf(i)===-1)throw new ge("Expected l or c or r",n.nextToken);n.consume(),n.consumeSpaces(),n.expect("]"),n.consume(),s.cols=[{type:"align",align:i}]}}var l=tl(r.parser,s,Yb(r.envName)),u=Math.max(0,...l.body.map(c=>c.length));return l.cols=new Array(u).fill({type:"align",align:i}),e?{type:"leftright",mode:r.mode,body:[l],left:e[0],right:e[1],rightColor:void 0}:l},htmlBuilder:Rn,mathmlBuilder:Nn});wn({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(r){var e={arraystretch:.5},i=tl(r.parser,e,"script");return i.colSeparationType="small",i},htmlBuilder:Rn,mathmlBuilder:Nn});wn({type:"array",names:["subarray"],props:{numArgs:1},handler(r,e){var i=Kf(e[0]),s=i?[e[0]]:ht(e[0],"ordgroup").body,n=s.map(function(u){var c=Ub(u),h=c.text;if("lc".indexOf(h)!==-1)return{type:"align",align:h};throw new ge("Unknown column alignment: "+h,u)});if(n.length>1)throw new ge("{subarray} can contain only one column");var l={cols:n,hskipBeforeAndAfter:!1,arraystretch:.5};if(l=tl(r.parser,l,"script"),l.body.length>0&&l.body[0].length>1)throw new ge("{subarray} can contain only one column");return l},htmlBuilder:Rn,mathmlBuilder:Nn});wn({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(r){var e={arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},i=tl(r.parser,e,Yb(r.envName));return{type:"leftright",mode:r.mode,body:[i],left:r.envName.indexOf("r")>-1?".":"\\{",right:r.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:Rn,mathmlBuilder:Nn});wn({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:i4,htmlBuilder:Rn,mathmlBuilder:Nn});wn({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(r){Ze.contains(["gather","gather*"],r.envName)&&Qf(r);var e={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:zb(r.envName),emptySingleRow:!0,leqno:r.parser.settings.leqno};return tl(r.parser,e,"display")},htmlBuilder:Rn,mathmlBuilder:Nn});wn({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:i4,htmlBuilder:Rn,mathmlBuilder:Nn});wn({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(r){Qf(r);var e={autoTag:zb(r.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:r.parser.settings.leqno};return tl(r.parser,e,"display")},htmlBuilder:Rn,mathmlBuilder:Nn});wn({type:"array",names:["CD"],props:{numArgs:0},handler(r){return Qf(r),N9(r.parser)},htmlBuilder:Rn,mathmlBuilder:Nn});A("\\nonumber","\\gdef\\@eqnsw{0}");A("\\notag","\\nonumber");Ae({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(r,e){throw new ge(r.funcName+" valid only within array environment")}});var Ay=e4;Ae({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler(r,e){var{parser:i,funcName:s}=r,n=e[0];if(n.type!=="ordgroup")throw new ge("Invalid environment name",n);for(var l="",u=0;u<n.body.length;++u)l+=ht(n.body[u],"textord").text;if(s==="\\begin"){if(!Ay.hasOwnProperty(l))throw new ge("No such environment: "+l,n);var c=Ay[l],{args:h,optArgs:f}=i.parseArguments("\\begin{"+l+"}",c),p={mode:i.mode,envName:l,parser:i},g=c.handler(p,h,f);i.expect("\\end",!1);var T=i.nextToken,$=ht(i.parseFunction(),"environment");if($.name!==l)throw new ge("Mismatch: \\begin{"+l+"} matched by \\end{"+$.name+"}",T);return g}return{type:"environment",mode:i.mode,name:l,nameGroup:n}}});var r4=(r,e)=>{var i=r.font,s=e.withFont(i);return Mt(r.body,s)},s4=(r,e)=>{var i=r.font,s=e.withFont(i);return zt(r.body,s)},Cy={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};Ae({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(r,e)=>{var{parser:i,funcName:s}=r,n=Y0(e[0]),l=s;return l in Cy&&(l=Cy[l]),{type:"font",mode:i.mode,font:l.slice(1),body:n}},htmlBuilder:r4,mathmlBuilder:s4});Ae({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:(r,e)=>{var{parser:i}=r,s=e[0],n=Ze.isCharacterBox(s);return{type:"mclass",mode:i.mode,mclass:qf(s),body:[{type:"font",mode:i.mode,font:"boldsymbol",body:s}],isCharacterBox:n}}});Ae({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:(r,e)=>{var{parser:i,funcName:s,breakOnTokenText:n}=r,{mode:l}=i,u=i.parseExpression(!0,n),c="math"+s.slice(1);return{type:"font",mode:l,font:c,body:{type:"ordgroup",mode:i.mode,body:u}}},htmlBuilder:r4,mathmlBuilder:s4});var n4=(r,e)=>{var i=e;return r==="display"?i=i.id>=Ye.SCRIPT.id?i.text():Ye.DISPLAY:r==="text"&&i.size===Ye.DISPLAY.size?i=Ye.TEXT:r==="script"?i=Ye.SCRIPT:r==="scriptscript"&&(i=Ye.SCRIPTSCRIPT),i},Xb=(r,e)=>{var i=n4(r.size,e.style),s=i.fracNum(),n=i.fracDen(),l;l=e.havingStyle(s);var u=Mt(r.numer,l,e);if(r.continued){var c=8.5/e.fontMetrics().ptPerEm,h=3.5/e.fontMetrics().ptPerEm;u.height=u.height<c?c:u.height,u.depth=u.depth<h?h:u.depth}l=e.havingStyle(n);var f=Mt(r.denom,l,e),p,g,T;r.hasBarLine?(r.barSize?(g=ci(r.barSize,e),p=K.makeLineSpan("frac-line",e,g)):p=K.makeLineSpan("frac-line",e),g=p.height,T=p.height):(p=null,g=0,T=e.fontMetrics().defaultRuleThickness);var $,y,R;i.size===Ye.DISPLAY.size||r.size==="display"?($=e.fontMetrics().num1,g>0?y=3*T:y=7*T,R=e.fontMetrics().denom1):(g>0?($=e.fontMetrics().num2,y=T):($=e.fontMetrics().num3,y=3*T),R=e.fontMetrics().denom2);var C;if(p){var j=e.fontMetrics().axisHeight;$-u.depth-(j+.5*g)<y&&($+=y-($-u.depth-(j+.5*g))),j-.5*g-(f.height-R)<y&&(R+=y-(j-.5*g-(f.height-R)));var F=-(j-.5*g);C=K.makeVList({positionType:"individualShift",children:[{type:"elem",elem:f,shift:R},{type:"elem",elem:p,shift:F},{type:"elem",elem:u,shift:-$}]},e)}else{var x=$-u.depth-(f.height-R);x<y&&($+=.5*(y-x),R+=.5*(y-x)),C=K.makeVList({positionType:"individualShift",children:[{type:"elem",elem:f,shift:R},{type:"elem",elem:u,shift:-$}]},e)}l=e.havingStyle(i),C.height*=l.sizeMultiplier/e.sizeMultiplier,C.depth*=l.sizeMultiplier/e.sizeMultiplier;var q;i.size===Ye.DISPLAY.size?q=e.fontMetrics().delim1:i.size===Ye.SCRIPTSCRIPT.size?q=e.havingStyle(Ye.SCRIPT).fontMetrics().delim2:q=e.fontMetrics().delim2;var W,ne;return r.leftDelim==null?W=jc(e,["mopen"]):W=ro.customSizedDelim(r.leftDelim,q,!0,e.havingStyle(i),r.mode,["mopen"]),r.continued?ne=K.makeSpan([]):r.rightDelim==null?ne=jc(e,["mclose"]):ne=ro.customSizedDelim(r.rightDelim,q,!0,e.havingStyle(i),r.mode,["mclose"]),K.makeSpan(["mord"].concat(l.sizingClasses(e)),[W,K.makeSpan(["mfrac"],[C]),ne],e)},jb=(r,e)=>{var i=new me.MathNode("mfrac",[zt(r.numer,e),zt(r.denom,e)]);if(!r.hasBarLine)i.setAttribute("linethickness","0px");else if(r.barSize){var s=ci(r.barSize,e);i.setAttribute("linethickness",$e(s))}var n=n4(r.size,e.style);if(n.size!==e.style.size){i=new me.MathNode("mstyle",[i]);var l=n.size===Ye.DISPLAY.size?"true":"false";i.setAttribute("displaystyle",l),i.setAttribute("scriptlevel","0")}if(r.leftDelim!=null||r.rightDelim!=null){var u=[];if(r.leftDelim!=null){var c=new me.MathNode("mo",[new me.TextNode(r.leftDelim.replace("\\",""))]);c.setAttribute("fence","true"),u.push(c)}if(u.push(i),r.rightDelim!=null){var h=new me.MathNode("mo",[new me.TextNode(r.rightDelim.replace("\\",""))]);h.setAttribute("fence","true"),u.push(h)}return Pb(u)}return i};Ae({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(r,e)=>{var{parser:i,funcName:s}=r,n=e[0],l=e[1],u,c=null,h=null,f="auto";switch(s){case"\\dfrac":case"\\frac":case"\\tfrac":u=!0;break;case"\\\\atopfrac":u=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":u=!1,c="(",h=")";break;case"\\\\bracefrac":u=!1,c="\\{",h="\\}";break;case"\\\\brackfrac":u=!1,c="[",h="]";break;default:throw new Error("Unrecognized genfrac command")}switch(s){case"\\dfrac":case"\\dbinom":f="display";break;case"\\tfrac":case"\\tbinom":f="text";break}return{type:"genfrac",mode:i.mode,continued:!1,numer:n,denom:l,hasBarLine:u,leftDelim:c,rightDelim:h,size:f,barSize:null}},htmlBuilder:Xb,mathmlBuilder:jb});Ae({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:(r,e)=>{var{parser:i,funcName:s}=r,n=e[0],l=e[1];return{type:"genfrac",mode:i.mode,continued:!0,numer:n,denom:l,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}});Ae({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler(r){var{parser:e,funcName:i,token:s}=r,n;switch(i){case"\\over":n="\\frac";break;case"\\choose":n="\\binom";break;case"\\atop":n="\\\\atopfrac";break;case"\\brace":n="\\\\bracefrac";break;case"\\brack":n="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:e.mode,replaceWith:n,token:s}}});var Oy=["display","text","script","scriptscript"],wy=function(e){var i=null;return e.length>0&&(i=e,i=i==="."?null:i),i};Ae({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(r,e){var{parser:i}=r,s=e[4],n=e[5],l=Y0(e[0]),u=l.type==="atom"&&l.family==="open"?wy(l.text):null,c=Y0(e[1]),h=c.type==="atom"&&c.family==="close"?wy(c.text):null,f=ht(e[2],"size"),p,g=null;f.isBlank?p=!0:(g=f.value,p=g.number>0);var T="auto",$=e[3];if($.type==="ordgroup"){if($.body.length>0){var y=ht($.body[0],"textord");T=Oy[Number(y.text)]}}else $=ht($,"textord"),T=Oy[Number($.text)];return{type:"genfrac",mode:i.mode,numer:s,denom:n,continued:!1,hasBarLine:p,barSize:g,leftDelim:u,rightDelim:h,size:T}},htmlBuilder:Xb,mathmlBuilder:jb});Ae({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(r,e){var{parser:i,funcName:s,token:n}=r;return{type:"infix",mode:i.mode,replaceWith:"\\\\abovefrac",size:ht(e[0],"size").value,token:n}}});Ae({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(r,e)=>{var{parser:i,funcName:s}=r,n=e[0],l=y7(ht(e[1],"infix").size),u=e[2],c=l.number>0;return{type:"genfrac",mode:i.mode,numer:n,denom:u,continued:!1,hasBarLine:c,barSize:l,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:Xb,mathmlBuilder:jb});var o4=(r,e)=>{var i=e.style,s,n;r.type==="supsub"?(s=r.sup?Mt(r.sup,e.havingStyle(i.sup()),e):Mt(r.sub,e.havingStyle(i.sub()),e),n=ht(r.base,"horizBrace")):n=ht(r,"horizBrace");var l=Mt(n.base,e.havingBaseStyle(Ye.DISPLAY)),u=lo.svgSpan(n,e),c;if(n.isOver?(c=K.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:l},{type:"kern",size:.1},{type:"elem",elem:u}]},e),c.children[0].children[0].children[1].classes.push("svg-align")):(c=K.makeVList({positionType:"bottom",positionData:l.depth+.1+u.height,children:[{type:"elem",elem:u},{type:"kern",size:.1},{type:"elem",elem:l}]},e),c.children[0].children[0].children[0].classes.push("svg-align")),s){var h=K.makeSpan(["mord",n.isOver?"mover":"munder"],[c],e);n.isOver?c=K.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:h},{type:"kern",size:.2},{type:"elem",elem:s}]},e):c=K.makeVList({positionType:"bottom",positionData:h.depth+.2+s.height+s.depth,children:[{type:"elem",elem:s},{type:"kern",size:.2},{type:"elem",elem:h}]},e)}return K.makeSpan(["mord",n.isOver?"mover":"munder"],[c],e)},X9=(r,e)=>{var i=lo.mathMLnode(r.label);return new me.MathNode(r.isOver?"mover":"munder",[zt(r.base,e),i])};Ae({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler(r,e){var{parser:i,funcName:s}=r;return{type:"horizBrace",mode:i.mode,label:s,isOver:/^\\over/.test(s),base:e[0]}},htmlBuilder:o4,mathmlBuilder:X9});Ae({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(r,e)=>{var{parser:i}=r,s=e[1],n=ht(e[0],"url").url;return i.settings.isTrusted({command:"\\href",url:n})?{type:"href",mode:i.mode,href:n,body:yi(s)}:i.formatUnsupportedCmd("\\href")},htmlBuilder:(r,e)=>{var i=Yi(r.body,e,!1);return K.makeAnchor(r.href,[],i,e)},mathmlBuilder:(r,e)=>{var i=zo(r.body,e);return i instanceof bs||(i=new bs("mrow",[i])),i.setAttribute("href",r.href),i}});Ae({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(r,e)=>{var{parser:i}=r,s=ht(e[0],"url").url;if(!i.settings.isTrusted({command:"\\url",url:s}))return i.formatUnsupportedCmd("\\url");for(var n=[],l=0;l<s.length;l++){var u=s[l];u==="~"&&(u="\\textasciitilde"),n.push({type:"textord",mode:"text",text:u})}var c={type:"text",mode:i.mode,font:"\\texttt",body:n};return{type:"href",mode:i.mode,href:s,body:yi(c)}}});Ae({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(r,e){var{parser:i}=r;return{type:"hbox",mode:i.mode,body:yi(e[0])}},htmlBuilder(r,e){var i=Yi(r.body,e,!1);return K.makeFragment(i)},mathmlBuilder(r,e){return new me.MathNode("mrow",Vr(r.body,e))}});Ae({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(r,e)=>{var{parser:i,funcName:s,token:n}=r,l=ht(e[0],"raw").string,u=e[1];i.settings.strict&&i.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");var c,h={};switch(s){case"\\htmlClass":h.class=l,c={command:"\\htmlClass",class:l};break;case"\\htmlId":h.id=l,c={command:"\\htmlId",id:l};break;case"\\htmlStyle":h.style=l,c={command:"\\htmlStyle",style:l};break;case"\\htmlData":{for(var f=l.split(","),p=0;p<f.length;p++){var g=f[p].split("=");if(g.length!==2)throw new ge("Error parsing key-value for \\htmlData");h["data-"+g[0].trim()]=g[1].trim()}c={command:"\\htmlData",attributes:h};break}default:throw new Error("Unrecognized html command")}return i.settings.isTrusted(c)?{type:"html",mode:i.mode,attributes:h,body:yi(u)}:i.formatUnsupportedCmd(s)},htmlBuilder:(r,e)=>{var i=Yi(r.body,e,!1),s=["enclosing"];r.attributes.class&&s.push(...r.attributes.class.trim().split(/\s+/));var n=K.makeSpan(s,i,e);for(var l in r.attributes)l!=="class"&&r.attributes.hasOwnProperty(l)&&n.setAttribute(l,r.attributes[l]);return n},mathmlBuilder:(r,e)=>zo(r.body,e)});Ae({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(r,e)=>{var{parser:i}=r;return{type:"htmlmathml",mode:i.mode,html:yi(e[0]),mathml:yi(e[1])}},htmlBuilder:(r,e)=>{var i=Yi(r.html,e,!1);return K.makeFragment(i)},mathmlBuilder:(r,e)=>zo(r.mathml,e)});var g1=function(e){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(e))return{number:+e,unit:"bp"};var i=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(e);if(!i)throw new ge("Invalid size: '"+e+"' in \\includegraphics");var s={number:+(i[1]+i[2]),unit:i[3]};if(!IC(s))throw new ge("Invalid unit: '"+s.unit+"' in \\includegraphics.");return s};Ae({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(r,e,i)=>{var{parser:s}=r,n={number:0,unit:"em"},l={number:.9,unit:"em"},u={number:0,unit:"em"},c="";if(i[0])for(var h=ht(i[0],"raw").string,f=h.split(","),p=0;p<f.length;p++){var g=f[p].split("=");if(g.length===2){var T=g[1].trim();switch(g[0].trim()){case"alt":c=T;break;case"width":n=g1(T);break;case"height":l=g1(T);break;case"totalheight":u=g1(T);break;default:throw new ge("Invalid key: '"+g[0]+"' in \\includegraphics.")}}}var $=ht(e[0],"url").url;return c===""&&(c=$,c=c.replace(/^.*[\\/]/,""),c=c.substring(0,c.lastIndexOf("."))),s.settings.isTrusted({command:"\\includegraphics",url:$})?{type:"includegraphics",mode:s.mode,alt:c,width:n,height:l,totalheight:u,src:$}:s.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:(r,e)=>{var i=ci(r.height,e),s=0;r.totalheight.number>0&&(s=ci(r.totalheight,e)-i);var n=0;r.width.number>0&&(n=ci(r.width,e));var l={height:$e(i+s)};n>0&&(l.width=$e(n)),s>0&&(l.verticalAlign=$e(-s));var u=new X7(r.src,r.alt,l);return u.height=i,u.depth=s,u},mathmlBuilder:(r,e)=>{var i=new me.MathNode("mglyph",[]);i.setAttribute("alt",r.alt);var s=ci(r.height,e),n=0;if(r.totalheight.number>0&&(n=ci(r.totalheight,e)-s,i.setAttribute("valign",$e(-n))),i.setAttribute("height",$e(s+n)),r.width.number>0){var l=ci(r.width,e);i.setAttribute("width",$e(l))}return i.setAttribute("src",r.src),i}});Ae({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(r,e){var{parser:i,funcName:s}=r,n=ht(e[0],"size");if(i.settings.strict){var l=s[1]==="m",u=n.value.unit==="mu";l?(u||i.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+s+" supports only mu units, "+("not "+n.value.unit+" units")),i.mode!=="math"&&i.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+s+" works only in math mode")):u&&i.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+s+" doesn't support mu units")}return{type:"kern",mode:i.mode,dimension:n.value}},htmlBuilder(r,e){return K.makeGlue(r.dimension,e)},mathmlBuilder(r,e){var i=ci(r.dimension,e);return new me.SpaceNode(i)}});Ae({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(r,e)=>{var{parser:i,funcName:s}=r,n=e[0];return{type:"lap",mode:i.mode,alignment:s.slice(5),body:n}},htmlBuilder:(r,e)=>{var i;r.alignment==="clap"?(i=K.makeSpan([],[Mt(r.body,e)]),i=K.makeSpan(["inner"],[i],e)):i=K.makeSpan(["inner"],[Mt(r.body,e)]);var s=K.makeSpan(["fix"],[]),n=K.makeSpan([r.alignment],[i,s],e),l=K.makeSpan(["strut"]);return l.style.height=$e(n.height+n.depth),n.depth&&(l.style.verticalAlign=$e(-n.depth)),n.children.unshift(l),n=K.makeSpan(["thinbox"],[n],e),K.makeSpan(["mord","vbox"],[n],e)},mathmlBuilder:(r,e)=>{var i=new me.MathNode("mpadded",[zt(r.body,e)]);if(r.alignment!=="rlap"){var s=r.alignment==="llap"?"-1":"-0.5";i.setAttribute("lspace",s+"width")}return i.setAttribute("width","0px"),i}});Ae({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(r,e){var{funcName:i,parser:s}=r,n=s.mode;s.switchMode("math");var l=i==="\\("?"\\)":"$",u=s.parseExpression(!1,l);return s.expect(l),s.switchMode(n),{type:"styling",mode:s.mode,style:"text",body:u}}});Ae({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(r,e){throw new ge("Mismatched "+r.funcName)}});var Ry=(r,e)=>{switch(e.style.size){case Ye.DISPLAY.size:return r.display;case Ye.TEXT.size:return r.text;case Ye.SCRIPT.size:return r.script;case Ye.SCRIPTSCRIPT.size:return r.scriptscript;default:return r.text}};Ae({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(r,e)=>{var{parser:i}=r;return{type:"mathchoice",mode:i.mode,display:yi(e[0]),text:yi(e[1]),script:yi(e[2]),scriptscript:yi(e[3])}},htmlBuilder:(r,e)=>{var i=Ry(r,e),s=Yi(i,e,!1);return K.makeFragment(s)},mathmlBuilder:(r,e)=>{var i=Ry(r,e);return zo(i,e)}});var l4=(r,e,i,s,n,l,u)=>{r=K.makeSpan([],[r]);var c=i&&Ze.isCharacterBox(i),h,f;if(e){var p=Mt(e,s.havingStyle(n.sup()),s);f={elem:p,kern:Math.max(s.fontMetrics().bigOpSpacing1,s.fontMetrics().bigOpSpacing3-p.depth)}}if(i){var g=Mt(i,s.havingStyle(n.sub()),s);h={elem:g,kern:Math.max(s.fontMetrics().bigOpSpacing2,s.fontMetrics().bigOpSpacing4-g.height)}}var T;if(f&&h){var $=s.fontMetrics().bigOpSpacing5+h.elem.height+h.elem.depth+h.kern+r.depth+u;T=K.makeVList({positionType:"bottom",positionData:$,children:[{type:"kern",size:s.fontMetrics().bigOpSpacing5},{type:"elem",elem:h.elem,marginLeft:$e(-l)},{type:"kern",size:h.kern},{type:"elem",elem:r},{type:"kern",size:f.kern},{type:"elem",elem:f.elem,marginLeft:$e(l)},{type:"kern",size:s.fontMetrics().bigOpSpacing5}]},s)}else if(h){var y=r.height-u;T=K.makeVList({positionType:"top",positionData:y,children:[{type:"kern",size:s.fontMetrics().bigOpSpacing5},{type:"elem",elem:h.elem,marginLeft:$e(-l)},{type:"kern",size:h.kern},{type:"elem",elem:r}]},s)}else if(f){var R=r.depth+u;T=K.makeVList({positionType:"bottom",positionData:R,children:[{type:"elem",elem:r},{type:"kern",size:f.kern},{type:"elem",elem:f.elem,marginLeft:$e(l)},{type:"kern",size:s.fontMetrics().bigOpSpacing5}]},s)}else return r;var C=[T];if(h&&l!==0&&!c){var x=K.makeSpan(["mspace"],[],s);x.style.marginRight=$e(l),C.unshift(x)}return K.makeSpan(["mop","op-limits"],C,s)},a4=["\\smallint"],fu=(r,e)=>{var i,s,n=!1,l;r.type==="supsub"?(i=r.sup,s=r.sub,l=ht(r.base,"op"),n=!0):l=ht(r,"op");var u=e.style,c=!1;u.size===Ye.DISPLAY.size&&l.symbol&&!Ze.contains(a4,l.name)&&(c=!0);var h;if(l.symbol){var f=c?"Size2-Regular":"Size1-Regular",p="";if((l.name==="\\oiint"||l.name==="\\oiiint")&&(p=l.name.slice(1),l.name=p==="oiint"?"\\iint":"\\iiint"),h=K.makeSymbol(l.name,f,"math",e,["mop","op-symbol",c?"large-op":"small-op"]),p.length>0){var g=h.italic,T=K.staticSvg(p+"Size"+(c?"2":"1"),e);h=K.makeVList({positionType:"individualShift",children:[{type:"elem",elem:h,shift:0},{type:"elem",elem:T,shift:c?.08:0}]},e),l.name="\\"+p,h.classes.unshift("mop"),h.italic=g}}else if(l.body){var $=Yi(l.body,e,!0);$.length===1&&$[0]instanceof Ss?(h=$[0],h.classes[0]="mop"):h=K.makeSpan(["mop"],$,e)}else{for(var y=[],R=1;R<l.name.length;R++)y.push(K.mathsym(l.name[R],l.mode,e));h=K.makeSpan(["mop"],y,e)}var C=0,x=0;return(h instanceof Ss||l.name==="\\oiint"||l.name==="\\oiiint")&&!l.suppressBaseShift&&(C=(h.height-h.depth)/2-e.fontMetrics().axisHeight,x=h.italic),n?l4(h,i,s,e,u,x,C):(C&&(h.style.position="relative",h.style.top=$e(C)),h)},fh=(r,e)=>{var i;if(r.symbol)i=new bs("mo",[Is(r.name,r.mode)]),Ze.contains(a4,r.name)&&i.setAttribute("largeop","false");else if(r.body)i=new bs("mo",Vr(r.body,e));else{i=new bs("mi",[new Mc(r.name.slice(1))]);var s=new bs("mo",[Is("⁡","text")]);r.parentIsSupSub?i=new bs("mrow",[i,s]):i=MC([i,s])}return i},j9={"∏":"\\prod","∐":"\\coprod","∑":"\\sum","⋀":"\\bigwedge","⋁":"\\bigvee","⋂":"\\bigcap","⋃":"\\bigcup","⨀":"\\bigodot","⨁":"\\bigoplus","⨂":"\\bigotimes","⨄":"\\biguplus","⨆":"\\bigsqcup"};Ae({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","∏","∐","∑","⋀","⋁","⋂","⋃","⨀","⨁","⨂","⨄","⨆"],props:{numArgs:0},handler:(r,e)=>{var{parser:i,funcName:s}=r,n=s;return n.length===1&&(n=j9[n]),{type:"op",mode:i.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:n}},htmlBuilder:fu,mathmlBuilder:fh});Ae({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:(r,e)=>{var{parser:i}=r,s=e[0];return{type:"op",mode:i.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:yi(s)}},htmlBuilder:fu,mathmlBuilder:fh});var K9={"∫":"\\int","∬":"\\iint","∭":"\\iiint","∮":"\\oint","∯":"\\oiint","∰":"\\oiiint"};Ae({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler(r){var{parser:e,funcName:i}=r;return{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:i}},htmlBuilder:fu,mathmlBuilder:fh});Ae({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler(r){var{parser:e,funcName:i}=r;return{type:"op",mode:e.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:i}},htmlBuilder:fu,mathmlBuilder:fh});Ae({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","∫","∬","∭","∮","∯","∰"],props:{numArgs:0},handler(r){var{parser:e,funcName:i}=r,s=i;return s.length===1&&(s=K9[s]),{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:s}},htmlBuilder:fu,mathmlBuilder:fh});var u4=(r,e)=>{var i,s,n=!1,l;r.type==="supsub"?(i=r.sup,s=r.sub,l=ht(r.base,"operatorname"),n=!0):l=ht(r,"operatorname");var u;if(l.body.length>0){for(var c=l.body.map(g=>{var T=g.text;return typeof T=="string"?{type:"textord",mode:g.mode,text:T}:g}),h=Yi(c,e.withFont("mathrm"),!0),f=0;f<h.length;f++){var p=h[f];p instanceof Ss&&(p.text=p.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}u=K.makeSpan(["mop"],h,e)}else u=K.makeSpan(["mop"],[],e);return n?l4(u,i,s,e,e.style,0,0):u},q9=(r,e)=>{for(var i=Vr(r.body,e.withFont("mathrm")),s=!0,n=0;n<i.length;n++){var l=i[n];if(!(l instanceof me.SpaceNode))if(l instanceof me.MathNode)switch(l.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":{var u=l.children[0];l.children.length===1&&u instanceof me.TextNode?u.text=u.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):s=!1;break}default:s=!1}else s=!1}if(s){var c=i.map(p=>p.toText()).join("");i=[new me.TextNode(c)]}var h=new me.MathNode("mi",i);h.setAttribute("mathvariant","normal");var f=new me.MathNode("mo",[Is("⁡","text")]);return r.parentIsSupSub?new me.MathNode("mrow",[h,f]):me.newDocumentFragment([h,f])};Ae({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:(r,e)=>{var{parser:i,funcName:s}=r,n=e[0];return{type:"operatorname",mode:i.mode,body:yi(n),alwaysHandleSupSub:s==="\\operatornamewithlimits",limits:!1,parentIsSupSub:!1}},htmlBuilder:u4,mathmlBuilder:q9});A("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@");Xl({type:"ordgroup",htmlBuilder(r,e){return r.semisimple?K.makeFragment(Yi(r.body,e,!1)):K.makeSpan(["mord"],Yi(r.body,e,!0),e)},mathmlBuilder(r,e){return zo(r.body,e,!0)}});Ae({type:"overline",names:["\\overline"],props:{numArgs:1},handler(r,e){var{parser:i}=r,s=e[0];return{type:"overline",mode:i.mode,body:s}},htmlBuilder(r,e){var i=Mt(r.body,e.havingCrampedStyle()),s=K.makeLineSpan("overline-line",e),n=e.fontMetrics().defaultRuleThickness,l=K.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i},{type:"kern",size:3*n},{type:"elem",elem:s},{type:"kern",size:n}]},e);return K.makeSpan(["mord","overline"],[l],e)},mathmlBuilder(r,e){var i=new me.MathNode("mo",[new me.TextNode("‾")]);i.setAttribute("stretchy","true");var s=new me.MathNode("mover",[zt(r.body,e),i]);return s.setAttribute("accent","true"),s}});Ae({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(r,e)=>{var{parser:i}=r,s=e[0];return{type:"phantom",mode:i.mode,body:yi(s)}},htmlBuilder:(r,e)=>{var i=Yi(r.body,e.withPhantom(),!1);return K.makeFragment(i)},mathmlBuilder:(r,e)=>{var i=Vr(r.body,e);return new me.MathNode("mphantom",i)}});Ae({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(r,e)=>{var{parser:i}=r,s=e[0];return{type:"hphantom",mode:i.mode,body:s}},htmlBuilder:(r,e)=>{var i=K.makeSpan([],[Mt(r.body,e.withPhantom())]);if(i.height=0,i.depth=0,i.children)for(var s=0;s<i.children.length;s++)i.children[s].height=0,i.children[s].depth=0;return i=K.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i}]},e),K.makeSpan(["mord"],[i],e)},mathmlBuilder:(r,e)=>{var i=Vr(yi(r.body),e),s=new me.MathNode("mphantom",i),n=new me.MathNode("mpadded",[s]);return n.setAttribute("height","0px"),n.setAttribute("depth","0px"),n}});Ae({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(r,e)=>{var{parser:i}=r,s=e[0];return{type:"vphantom",mode:i.mode,body:s}},htmlBuilder:(r,e)=>{var i=K.makeSpan(["inner"],[Mt(r.body,e.withPhantom())]),s=K.makeSpan(["fix"],[]);return K.makeSpan(["mord","rlap"],[i,s],e)},mathmlBuilder:(r,e)=>{var i=Vr(yi(r.body),e),s=new me.MathNode("mphantom",i),n=new me.MathNode("mpadded",[s]);return n.setAttribute("width","0px"),n}});Ae({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(r,e){var{parser:i}=r,s=ht(e[0],"size").value,n=e[1];return{type:"raisebox",mode:i.mode,dy:s,body:n}},htmlBuilder(r,e){var i=Mt(r.body,e),s=ci(r.dy,e);return K.makeVList({positionType:"shift",positionData:-s,children:[{type:"elem",elem:i}]},e)},mathmlBuilder(r,e){var i=new me.MathNode("mpadded",[zt(r.body,e)]),s=r.dy.number+r.dy.unit;return i.setAttribute("voffset",s),i}});Ae({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0},handler(r){var{parser:e}=r;return{type:"internal",mode:e.mode}}});Ae({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,argTypes:["size","size","size"]},handler(r,e,i){var{parser:s}=r,n=i[0],l=ht(e[0],"size"),u=ht(e[1],"size");return{type:"rule",mode:s.mode,shift:n&&ht(n,"size").value,width:l.value,height:u.value}},htmlBuilder(r,e){var i=K.makeSpan(["mord","rule"],[],e),s=ci(r.width,e),n=ci(r.height,e),l=r.shift?ci(r.shift,e):0;return i.style.borderRightWidth=$e(s),i.style.borderTopWidth=$e(n),i.style.bottom=$e(l),i.width=s,i.height=n+l,i.depth=-l,i.maxFontSize=n*1.125*e.sizeMultiplier,i},mathmlBuilder(r,e){var i=ci(r.width,e),s=ci(r.height,e),n=r.shift?ci(r.shift,e):0,l=e.color&&e.getColor()||"black",u=new me.MathNode("mspace");u.setAttribute("mathbackground",l),u.setAttribute("width",$e(i)),u.setAttribute("height",$e(s));var c=new me.MathNode("mpadded",[u]);return n>=0?c.setAttribute("height",$e(n)):(c.setAttribute("height",$e(n)),c.setAttribute("depth",$e(-n))),c.setAttribute("voffset",$e(n)),c}});function c4(r,e,i){for(var s=Yi(r,e,!1),n=e.sizeMultiplier/i.sizeMultiplier,l=0;l<s.length;l++){var u=s[l].classes.indexOf("sizing");u<0?Array.prototype.push.apply(s[l].classes,e.sizingClasses(i)):s[l].classes[u+1]==="reset-size"+e.size&&(s[l].classes[u+1]="reset-size"+i.size),s[l].height*=n,s[l].depth*=n}return K.makeFragment(s)}var Ny=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],J9=(r,e)=>{var i=e.havingSize(r.size);return c4(r.body,i,e)};Ae({type:"sizing",names:Ny,props:{numArgs:0,allowedInText:!0},handler:(r,e)=>{var{breakOnTokenText:i,funcName:s,parser:n}=r,l=n.parseExpression(!1,i);return{type:"sizing",mode:n.mode,size:Ny.indexOf(s)+1,body:l}},htmlBuilder:J9,mathmlBuilder:(r,e)=>{var i=e.havingSize(r.size),s=Vr(r.body,i),n=new me.MathNode("mstyle",s);return n.setAttribute("mathsize",$e(i.sizeMultiplier)),n}});Ae({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(r,e,i)=>{var{parser:s}=r,n=!1,l=!1,u=i[0]&&ht(i[0],"ordgroup");if(u)for(var c="",h=0;h<u.body.length;++h){var f=u.body[h];if(c=f.text,c==="t")n=!0;else if(c==="b")l=!0;else{n=!1,l=!1;break}}else n=!0,l=!0;var p=e[0];return{type:"smash",mode:s.mode,body:p,smashHeight:n,smashDepth:l}},htmlBuilder:(r,e)=>{var i=K.makeSpan([],[Mt(r.body,e)]);if(!r.smashHeight&&!r.smashDepth)return i;if(r.smashHeight&&(i.height=0,i.children))for(var s=0;s<i.children.length;s++)i.children[s].height=0;if(r.smashDepth&&(i.depth=0,i.children))for(var n=0;n<i.children.length;n++)i.children[n].depth=0;var l=K.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i}]},e);return K.makeSpan(["mord"],[l],e)},mathmlBuilder:(r,e)=>{var i=new me.MathNode("mpadded",[zt(r.body,e)]);return r.smashHeight&&i.setAttribute("height","0px"),r.smashDepth&&i.setAttribute("depth","0px"),i}});Ae({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(r,e,i){var{parser:s}=r,n=i[0],l=e[0];return{type:"sqrt",mode:s.mode,body:l,index:n}},htmlBuilder(r,e){var i=Mt(r.body,e.havingCrampedStyle());i.height===0&&(i.height=e.fontMetrics().xHeight),i=K.wrapFragment(i,e);var s=e.fontMetrics(),n=s.defaultRuleThickness,l=n;e.style.id<Ye.TEXT.id&&(l=e.fontMetrics().xHeight);var u=n+l/4,c=i.height+i.depth+u+n,{span:h,ruleWidth:f,advanceWidth:p}=ro.sqrtImage(c,e),g=h.height-f;g>i.height+i.depth+u&&(u=(u+g-i.height-i.depth)/2);var T=h.height-i.height-u-f;i.style.paddingLeft=$e(p);var $=K.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i,wrapperClasses:["svg-align"]},{type:"kern",size:-(i.height+T)},{type:"elem",elem:h},{type:"kern",size:f}]},e);if(r.index){var y=e.havingStyle(Ye.SCRIPTSCRIPT),R=Mt(r.index,y,e),C=.6*($.height-$.depth),x=K.makeVList({positionType:"shift",positionData:-C,children:[{type:"elem",elem:R}]},e),j=K.makeSpan(["root"],[x]);return K.makeSpan(["mord","sqrt"],[j,$],e)}else return K.makeSpan(["mord","sqrt"],[$],e)},mathmlBuilder(r,e){var{body:i,index:s}=r;return s?new me.MathNode("mroot",[zt(i,e),zt(s,e)]):new me.MathNode("msqrt",[zt(i,e)])}});var xy={display:Ye.DISPLAY,text:Ye.TEXT,script:Ye.SCRIPT,scriptscript:Ye.SCRIPTSCRIPT};Ae({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(r,e){var{breakOnTokenText:i,funcName:s,parser:n}=r,l=n.parseExpression(!0,i),u=s.slice(1,s.length-5);return{type:"styling",mode:n.mode,style:u,body:l}},htmlBuilder(r,e){var i=xy[r.style],s=e.havingStyle(i).withFont("");return c4(r.body,s,e)},mathmlBuilder(r,e){var i=xy[r.style],s=e.havingStyle(i),n=Vr(r.body,s),l=new me.MathNode("mstyle",n),u={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]},c=u[r.style];return l.setAttribute("scriptlevel",c[0]),l.setAttribute("displaystyle",c[1]),l}});var Q9=function(e,i){var s=e.base;if(s)if(s.type==="op"){var n=s.limits&&(i.style.size===Ye.DISPLAY.size||s.alwaysHandleSupSub);return n?fu:null}else if(s.type==="operatorname"){var l=s.alwaysHandleSupSub&&(i.style.size===Ye.DISPLAY.size||s.limits);return l?u4:null}else{if(s.type==="accent")return Ze.isCharacterBox(s.base)?Hb:null;if(s.type==="horizBrace"){var u=!e.sub;return u===s.isOver?o4:null}else return null}else return null};Xl({type:"supsub",htmlBuilder(r,e){var i=Q9(r,e);if(i)return i(r,e);var{base:s,sup:n,sub:l}=r,u=Mt(s,e),c,h,f=e.fontMetrics(),p=0,g=0,T=s&&Ze.isCharacterBox(s);if(n){var $=e.havingStyle(e.style.sup());c=Mt(n,$,e),T||(p=u.height-$.fontMetrics().supDrop*$.sizeMultiplier/e.sizeMultiplier)}if(l){var y=e.havingStyle(e.style.sub());h=Mt(l,y,e),T||(g=u.depth+y.fontMetrics().subDrop*y.sizeMultiplier/e.sizeMultiplier)}var R;e.style===Ye.DISPLAY?R=f.sup1:e.style.cramped?R=f.sup3:R=f.sup2;var C=e.sizeMultiplier,x=$e(.5/f.ptPerEm/C),j=null;if(h){var F=r.base&&r.base.type==="op"&&r.base.name&&(r.base.name==="\\oiint"||r.base.name==="\\oiiint");(u instanceof Ss||F)&&(j=$e(-u.italic))}var q;if(c&&h){p=Math.max(p,R,c.depth+.25*f.xHeight),g=Math.max(g,f.sub2);var W=f.defaultRuleThickness,ne=4*W;if(p-c.depth-(h.height-g)<ne){g=ne-(p-c.depth)+h.height;var P=.8*f.xHeight-(p-c.depth);P>0&&(p+=P,g-=P)}var Q=[{type:"elem",elem:h,shift:g,marginRight:x,marginLeft:j},{type:"elem",elem:c,shift:-p,marginRight:x}];q=K.makeVList({positionType:"individualShift",children:Q},e)}else if(h){g=Math.max(g,f.sub1,h.height-.8*f.xHeight);var re=[{type:"elem",elem:h,marginLeft:j,marginRight:x}];q=K.makeVList({positionType:"shift",positionData:g,children:re},e)}else if(c)p=Math.max(p,R,c.depth+.25*f.xHeight),q=K.makeVList({positionType:"shift",positionData:-p,children:[{type:"elem",elem:c,marginRight:x}]},e);else throw new Error("supsub must have either sup or sub.");var Y=c_(u,"right")||"mord";return K.makeSpan([Y],[u,K.makeSpan(["msupsub"],[q])],e)},mathmlBuilder(r,e){var i=!1,s,n;r.base&&r.base.type==="horizBrace"&&(n=!!r.sup,n===r.base.isOver&&(i=!0,s=r.base.isOver)),r.base&&(r.base.type==="op"||r.base.type==="operatorname")&&(r.base.parentIsSupSub=!0);var l=[zt(r.base,e)];r.sub&&l.push(zt(r.sub,e)),r.sup&&l.push(zt(r.sup,e));var u;if(i)u=s?"mover":"munder";else if(r.sub)if(r.sup){var f=r.base;f&&f.type==="op"&&f.limits&&e.style===Ye.DISPLAY||f&&f.type==="operatorname"&&f.alwaysHandleSupSub&&(e.style===Ye.DISPLAY||f.limits)?u="munderover":u="msubsup"}else{var h=r.base;h&&h.type==="op"&&h.limits&&(e.style===Ye.DISPLAY||h.alwaysHandleSupSub)||h&&h.type==="operatorname"&&h.alwaysHandleSupSub&&(h.limits||e.style===Ye.DISPLAY)?u="munder":u="msub"}else{var c=r.base;c&&c.type==="op"&&c.limits&&(e.style===Ye.DISPLAY||c.alwaysHandleSupSub)||c&&c.type==="operatorname"&&c.alwaysHandleSupSub&&(c.limits||e.style===Ye.DISPLAY)?u="mover":u="msup"}return new me.MathNode(u,l)}});Xl({type:"atom",htmlBuilder(r,e){return K.mathsym(r.text,r.mode,e,["m"+r.family])},mathmlBuilder(r,e){var i=new me.MathNode("mo",[Is(r.text,r.mode)]);if(r.family==="bin"){var s=Fb(r,e);s==="bold-italic"&&i.setAttribute("mathvariant",s)}else r.family==="punct"?i.setAttribute("separator","true"):(r.family==="open"||r.family==="close")&&i.setAttribute("stretchy","false");return i}});var h4={mi:"italic",mn:"normal",mtext:"normal"};Xl({type:"mathord",htmlBuilder(r,e){return K.makeOrd(r,e,"mathord")},mathmlBuilder(r,e){var i=new me.MathNode("mi",[Is(r.text,r.mode,e)]),s=Fb(r,e)||"italic";return s!==h4[i.type]&&i.setAttribute("mathvariant",s),i}});Xl({type:"textord",htmlBuilder(r,e){return K.makeOrd(r,e,"textord")},mathmlBuilder(r,e){var i=Is(r.text,r.mode,e),s=Fb(r,e)||"normal",n;return r.mode==="text"?n=new me.MathNode("mtext",[i]):/[0-9]/.test(r.text)?n=new me.MathNode("mn",[i]):r.text==="\\prime"?n=new me.MathNode("mo",[i]):n=new me.MathNode("mi",[i]),s!==h4[n.type]&&n.setAttribute("mathvariant",s),n}});var _1={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},b1={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};Xl({type:"spacing",htmlBuilder(r,e){if(b1.hasOwnProperty(r.text)){var i=b1[r.text].className||"";if(r.mode==="text"){var s=K.makeOrd(r,e,"textord");return s.classes.push(i),s}else return K.makeSpan(["mspace",i],[K.mathsym(r.text,r.mode,e)],e)}else{if(_1.hasOwnProperty(r.text))return K.makeSpan(["mspace",_1[r.text]],[],e);throw new ge('Unknown type of space "'+r.text+'"')}},mathmlBuilder(r,e){var i;if(b1.hasOwnProperty(r.text))i=new me.MathNode("mtext",[new me.TextNode(" ")]);else{if(_1.hasOwnProperty(r.text))return new me.MathNode("mspace");throw new ge('Unknown type of space "'+r.text+'"')}return i}});var Dy=()=>{var r=new me.MathNode("mtd",[]);return r.setAttribute("width","50%"),r};Xl({type:"tag",mathmlBuilder(r,e){var i=new me.MathNode("mtable",[new me.MathNode("mtr",[Dy(),new me.MathNode("mtd",[zo(r.body,e)]),Dy(),new me.MathNode("mtd",[zo(r.tag,e)])])]);return i.setAttribute("width","100%"),i}});var Ly={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},My={"\\textbf":"textbf","\\textmd":"textmd"},Z9={"\\textit":"textit","\\textup":"textup"},By=(r,e)=>{var i=r.font;return i?Ly[i]?e.withTextFontFamily(Ly[i]):My[i]?e.withTextFontWeight(My[i]):e.withTextFontShape(Z9[i]):e};Ae({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(r,e){var{parser:i,funcName:s}=r,n=e[0];return{type:"text",mode:i.mode,body:yi(n),font:s}},htmlBuilder(r,e){var i=By(r,e),s=Yi(r.body,i,!0);return K.makeSpan(["mord","text"],s,i)},mathmlBuilder(r,e){var i=By(r,e);return zo(r.body,i)}});Ae({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler(r,e){var{parser:i}=r;return{type:"underline",mode:i.mode,body:e[0]}},htmlBuilder(r,e){var i=Mt(r.body,e),s=K.makeLineSpan("underline-line",e),n=e.fontMetrics().defaultRuleThickness,l=K.makeVList({positionType:"top",positionData:i.height,children:[{type:"kern",size:n},{type:"elem",elem:s},{type:"kern",size:3*n},{type:"elem",elem:i}]},e);return K.makeSpan(["mord","underline"],[l],e)},mathmlBuilder(r,e){var i=new me.MathNode("mo",[new me.TextNode("‾")]);i.setAttribute("stretchy","true");var s=new me.MathNode("munder",[zt(r.body,e),i]);return s.setAttribute("accentunder","true"),s}});Ae({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(r,e){var{parser:i}=r;return{type:"vcenter",mode:i.mode,body:e[0]}},htmlBuilder(r,e){var i=Mt(r.body,e),s=e.fontMetrics().axisHeight,n=.5*(i.height-s-(i.depth+s));return K.makeVList({positionType:"shift",positionData:n,children:[{type:"elem",elem:i}]},e)},mathmlBuilder(r,e){return new me.MathNode("mpadded",[zt(r.body,e)],["vcenter"])}});Ae({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(r,e,i){throw new ge("\\verb ended by end of line instead of matching delimiter")},htmlBuilder(r,e){for(var i=Py(r),s=[],n=e.havingStyle(e.style.text()),l=0;l<i.length;l++){var u=i[l];u==="~"&&(u="\\textasciitilde"),s.push(K.makeSymbol(u,"Typewriter-Regular",r.mode,n,["mord","texttt"]))}return K.makeSpan(["mord","text"].concat(n.sizingClasses(e)),K.tryCombineChars(s),n)},mathmlBuilder(r,e){var i=new me.TextNode(Py(r)),s=new me.MathNode("mtext",[i]);return s.setAttribute("mathvariant","monospace"),s}});var Py=r=>r.body.replace(/ /g,r.star?"␣":" "),Lo=DC,d4=`[ \r
	]`,eB="\\\\[a-zA-Z@]+",tB="\\\\[^\uD800-\uDFFF]",iB="("+eB+")"+d4+"*",rB=`\\\\(
|[ \r	]+
?)[ \r	]*`,p_="[̀-ͯ]",sB=new RegExp(p_+"+$"),nB="("+d4+"+)|"+(rB+"|")+"([!-\\[\\]-‧‪-퟿豈-￿]"+(p_+"*")+"|[\uD800-\uDBFF][\uDC00-\uDFFF]"+(p_+"*")+"|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5"+("|"+iB)+("|"+tB+")");class Fy{constructor(e,i){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=e,this.settings=i,this.tokenRegex=new RegExp(nB,"g"),this.catcodes={"%":14,"~":13}}setCatcode(e,i){this.catcodes[e]=i}lex(){var e=this.input,i=this.tokenRegex.lastIndex;if(i===e.length)return new Es("EOF",new ts(this,i,i));var s=this.tokenRegex.exec(e);if(s===null||s.index!==i)throw new ge("Unexpected character: '"+e[i]+"'",new Es(e[i],new ts(this,i,i+1)));var n=s[6]||s[3]||(s[2]?"\\ ":" ");if(this.catcodes[n]===14){var l=e.indexOf(`
`,this.tokenRegex.lastIndex);return l===-1?(this.tokenRegex.lastIndex=e.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=l+1,this.lex()}return new Es(n,new ts(this,i,this.tokenRegex.lastIndex))}}class oB{constructor(e,i){e===void 0&&(e={}),i===void 0&&(i={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=i,this.builtins=e,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(this.undefStack.length===0)throw new ge("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");var e=this.undefStack.pop();for(var i in e)e.hasOwnProperty(i)&&(e[i]==null?delete this.current[i]:this.current[i]=e[i])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(e){return this.current.hasOwnProperty(e)||this.builtins.hasOwnProperty(e)}get(e){return this.current.hasOwnProperty(e)?this.current[e]:this.builtins[e]}set(e,i,s){if(s===void 0&&(s=!1),s){for(var n=0;n<this.undefStack.length;n++)delete this.undefStack[n][e];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][e]=i)}else{var l=this.undefStack[this.undefStack.length-1];l&&!l.hasOwnProperty(e)&&(l[e]=this.current[e])}i==null?delete this.current[e]:this.current[e]=i}}var lB=t4;A("\\noexpand",function(r){var e=r.popToken();return r.isExpandable(e.text)&&(e.noexpand=!0,e.treatAsRelax=!0),{tokens:[e],numArgs:0}});A("\\expandafter",function(r){var e=r.popToken();return r.expandOnce(!0),{tokens:[e],numArgs:0}});A("\\@firstoftwo",function(r){var e=r.consumeArgs(2);return{tokens:e[0],numArgs:0}});A("\\@secondoftwo",function(r){var e=r.consumeArgs(2);return{tokens:e[1],numArgs:0}});A("\\@ifnextchar",function(r){var e=r.consumeArgs(3);r.consumeSpaces();var i=r.future();return e[0].length===1&&e[0][0].text===i.text?{tokens:e[1],numArgs:0}:{tokens:e[2],numArgs:0}});A("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}");A("\\TextOrMath",function(r){var e=r.consumeArgs(2);return r.mode==="text"?{tokens:e[0],numArgs:0}:{tokens:e[1],numArgs:0}});var Uy={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};A("\\char",function(r){var e=r.popToken(),i,s="";if(e.text==="'")i=8,e=r.popToken();else if(e.text==='"')i=16,e=r.popToken();else if(e.text==="`")if(e=r.popToken(),e.text[0]==="\\")s=e.text.charCodeAt(1);else{if(e.text==="EOF")throw new ge("\\char` missing argument");s=e.text.charCodeAt(0)}else i=10;if(i){if(s=Uy[e.text],s==null||s>=i)throw new ge("Invalid base-"+i+" digit "+e.text);for(var n;(n=Uy[r.future().text])!=null&&n<i;)s*=i,s+=n,r.popToken()}return"\\@char{"+s+"}"});var Kb=(r,e,i)=>{var s=r.consumeArg().tokens;if(s.length!==1)throw new ge("\\newcommand's first argument must be a macro name");var n=s[0].text,l=r.isDefined(n);if(l&&!e)throw new ge("\\newcommand{"+n+"} attempting to redefine "+(n+"; use \\renewcommand"));if(!l&&!i)throw new ge("\\renewcommand{"+n+"} when command "+n+" does not yet exist; use \\newcommand");var u=0;if(s=r.consumeArg().tokens,s.length===1&&s[0].text==="["){for(var c="",h=r.expandNextToken();h.text!=="]"&&h.text!=="EOF";)c+=h.text,h=r.expandNextToken();if(!c.match(/^\s*[0-9]+\s*$/))throw new ge("Invalid number of arguments: "+c);u=parseInt(c),s=r.consumeArg().tokens}return r.macros.set(n,{tokens:s,numArgs:u}),""};A("\\newcommand",r=>Kb(r,!1,!0));A("\\renewcommand",r=>Kb(r,!0,!1));A("\\providecommand",r=>Kb(r,!0,!0));A("\\message",r=>{var e=r.consumeArgs(1)[0];return console.log(e.reverse().map(i=>i.text).join("")),""});A("\\errmessage",r=>{var e=r.consumeArgs(1)[0];return console.error(e.reverse().map(i=>i.text).join("")),""});A("\\show",r=>{var e=r.popToken(),i=e.text;return console.log(e,r.macros.get(i),Lo[i],jt.math[i],jt.text[i]),""});A("\\bgroup","{");A("\\egroup","}");A("~","\\nobreakspace");A("\\lq","`");A("\\rq","'");A("\\aa","\\r a");A("\\AA","\\r A");A("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`©}");A("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}");A("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`®}");A("ℬ","\\mathscr{B}");A("ℰ","\\mathscr{E}");A("ℱ","\\mathscr{F}");A("ℋ","\\mathscr{H}");A("ℐ","\\mathscr{I}");A("ℒ","\\mathscr{L}");A("ℳ","\\mathscr{M}");A("ℛ","\\mathscr{R}");A("ℭ","\\mathfrak{C}");A("ℌ","\\mathfrak{H}");A("ℨ","\\mathfrak{Z}");A("\\Bbbk","\\Bbb{k}");A("·","\\cdotp");A("\\llap","\\mathllap{\\textrm{#1}}");A("\\rlap","\\mathrlap{\\textrm{#1}}");A("\\clap","\\mathclap{\\textrm{#1}}");A("\\mathstrut","\\vphantom{(}");A("\\underbar","\\underline{\\text{#1}}");A("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}');A("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`≠}}");A("\\ne","\\neq");A("≠","\\neq");A("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`∉}}");A("∉","\\notin");A("≘","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`≘}}");A("≙","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`≘}}");A("≚","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`≚}}");A("≛","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`≛}}");A("≝","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`≝}}");A("≞","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`≞}}");A("≟","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`≟}}");A("⟂","\\perp");A("‼","\\mathclose{!\\mkern-0.8mu!}");A("∌","\\notni");A("⌜","\\ulcorner");A("⌝","\\urcorner");A("⌞","\\llcorner");A("⌟","\\lrcorner");A("©","\\copyright");A("®","\\textregistered");A("️","\\textregistered");A("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}');A("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}');A("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}');A("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}');A("\\vdots","\\mathord{\\varvdots\\rule{0pt}{15pt}}");A("⋮","\\vdots");A("\\varGamma","\\mathit{\\Gamma}");A("\\varDelta","\\mathit{\\Delta}");A("\\varTheta","\\mathit{\\Theta}");A("\\varLambda","\\mathit{\\Lambda}");A("\\varXi","\\mathit{\\Xi}");A("\\varPi","\\mathit{\\Pi}");A("\\varSigma","\\mathit{\\Sigma}");A("\\varUpsilon","\\mathit{\\Upsilon}");A("\\varPhi","\\mathit{\\Phi}");A("\\varPsi","\\mathit{\\Psi}");A("\\varOmega","\\mathit{\\Omega}");A("\\substack","\\begin{subarray}{c}#1\\end{subarray}");A("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu\\relax");A("\\boxed","\\fbox{$\\displaystyle{#1}$}");A("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;");A("\\implies","\\DOTSB\\;\\Longrightarrow\\;");A("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");var Hy={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};A("\\dots",function(r){var e="\\dotso",i=r.expandAfterFuture().text;return i in Hy?e=Hy[i]:(i.slice(0,4)==="\\not"||i in jt.math&&Ze.contains(["bin","rel"],jt.math[i].group))&&(e="\\dotsb"),e});var qb={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};A("\\dotso",function(r){var e=r.future().text;return e in qb?"\\ldots\\,":"\\ldots"});A("\\dotsc",function(r){var e=r.future().text;return e in qb&&e!==","?"\\ldots\\,":"\\ldots"});A("\\cdots",function(r){var e=r.future().text;return e in qb?"\\@cdots\\,":"\\@cdots"});A("\\dotsb","\\cdots");A("\\dotsm","\\cdots");A("\\dotsi","\\!\\cdots");A("\\dotsx","\\ldots\\,");A("\\DOTSI","\\relax");A("\\DOTSB","\\relax");A("\\DOTSX","\\relax");A("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax");A("\\,","\\tmspace+{3mu}{.1667em}");A("\\thinspace","\\,");A("\\>","\\mskip{4mu}");A("\\:","\\tmspace+{4mu}{.2222em}");A("\\medspace","\\:");A("\\;","\\tmspace+{5mu}{.2777em}");A("\\thickspace","\\;");A("\\!","\\tmspace-{3mu}{.1667em}");A("\\negthinspace","\\!");A("\\negmedspace","\\tmspace-{4mu}{.2222em}");A("\\negthickspace","\\tmspace-{5mu}{.277em}");A("\\enspace","\\kern.5em ");A("\\enskip","\\hskip.5em\\relax");A("\\quad","\\hskip1em\\relax");A("\\qquad","\\hskip2em\\relax");A("\\tag","\\@ifstar\\tag@literal\\tag@paren");A("\\tag@paren","\\tag@literal{({#1})}");A("\\tag@literal",r=>{if(r.macros.get("\\df@tag"))throw new ge("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"});A("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}");A("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)");A("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}");A("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1");A("\\newline","\\\\\\relax");A("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");var f4=$e($n["Main-Regular"]["T".charCodeAt(0)][1]-.7*$n["Main-Regular"]["A".charCodeAt(0)][1]);A("\\LaTeX","\\textrm{\\html@mathml{"+("L\\kern-.36em\\raisebox{"+f4+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{LaTeX}}");A("\\KaTeX","\\textrm{\\html@mathml{"+("K\\kern-.17em\\raisebox{"+f4+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{KaTeX}}");A("\\hspace","\\@ifstar\\@hspacer\\@hspace");A("\\@hspace","\\hskip #1\\relax");A("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax");A("\\ordinarycolon",":");A("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}");A("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}');A("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}');A("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}');A("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}');A("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}');A("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}');A("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}');A("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}');A("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}');A("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}');A("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}');A("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}');A("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}');A("∷","\\dblcolon");A("∹","\\eqcolon");A("≔","\\coloneqq");A("≕","\\eqqcolon");A("⩴","\\Coloneqq");A("\\ratio","\\vcentcolon");A("\\coloncolon","\\dblcolon");A("\\colonequals","\\coloneqq");A("\\coloncolonequals","\\Coloneqq");A("\\equalscolon","\\eqqcolon");A("\\equalscoloncolon","\\Eqqcolon");A("\\colonminus","\\coloneq");A("\\coloncolonminus","\\Coloneq");A("\\minuscolon","\\eqcolon");A("\\minuscoloncolon","\\Eqcolon");A("\\coloncolonapprox","\\Colonapprox");A("\\coloncolonsim","\\Colonsim");A("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}");A("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}");A("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}");A("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}");A("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`∌}}");A("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}");A("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}");A("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}");A("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}");A("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}");A("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}");A("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}");A("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}");A("\\gvertneqq","\\html@mathml{\\@gvertneqq}{≩}");A("\\lvertneqq","\\html@mathml{\\@lvertneqq}{≨}");A("\\ngeqq","\\html@mathml{\\@ngeqq}{≱}");A("\\ngeqslant","\\html@mathml{\\@ngeqslant}{≱}");A("\\nleqq","\\html@mathml{\\@nleqq}{≰}");A("\\nleqslant","\\html@mathml{\\@nleqslant}{≰}");A("\\nshortmid","\\html@mathml{\\@nshortmid}{∤}");A("\\nshortparallel","\\html@mathml{\\@nshortparallel}{∦}");A("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{⊈}");A("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{⊉}");A("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{⊊}");A("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{⫋}");A("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{⊋}");A("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{⫌}");A("\\imath","\\html@mathml{\\@imath}{ı}");A("\\jmath","\\html@mathml{\\@jmath}{ȷ}");A("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`⟦}}");A("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`⟧}}");A("⟦","\\llbracket");A("⟧","\\rrbracket");A("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`⦃}}");A("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`⦄}}");A("⦃","\\lBrace");A("⦄","\\rBrace");A("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`⦵}}");A("⦵","\\minuso");A("\\darr","\\downarrow");A("\\dArr","\\Downarrow");A("\\Darr","\\Downarrow");A("\\lang","\\langle");A("\\rang","\\rangle");A("\\uarr","\\uparrow");A("\\uArr","\\Uparrow");A("\\Uarr","\\Uparrow");A("\\N","\\mathbb{N}");A("\\R","\\mathbb{R}");A("\\Z","\\mathbb{Z}");A("\\alef","\\aleph");A("\\alefsym","\\aleph");A("\\Alpha","\\mathrm{A}");A("\\Beta","\\mathrm{B}");A("\\bull","\\bullet");A("\\Chi","\\mathrm{X}");A("\\clubs","\\clubsuit");A("\\cnums","\\mathbb{C}");A("\\Complex","\\mathbb{C}");A("\\Dagger","\\ddagger");A("\\diamonds","\\diamondsuit");A("\\empty","\\emptyset");A("\\Epsilon","\\mathrm{E}");A("\\Eta","\\mathrm{H}");A("\\exist","\\exists");A("\\harr","\\leftrightarrow");A("\\hArr","\\Leftrightarrow");A("\\Harr","\\Leftrightarrow");A("\\hearts","\\heartsuit");A("\\image","\\Im");A("\\infin","\\infty");A("\\Iota","\\mathrm{I}");A("\\isin","\\in");A("\\Kappa","\\mathrm{K}");A("\\larr","\\leftarrow");A("\\lArr","\\Leftarrow");A("\\Larr","\\Leftarrow");A("\\lrarr","\\leftrightarrow");A("\\lrArr","\\Leftrightarrow");A("\\Lrarr","\\Leftrightarrow");A("\\Mu","\\mathrm{M}");A("\\natnums","\\mathbb{N}");A("\\Nu","\\mathrm{N}");A("\\Omicron","\\mathrm{O}");A("\\plusmn","\\pm");A("\\rarr","\\rightarrow");A("\\rArr","\\Rightarrow");A("\\Rarr","\\Rightarrow");A("\\real","\\Re");A("\\reals","\\mathbb{R}");A("\\Reals","\\mathbb{R}");A("\\Rho","\\mathrm{P}");A("\\sdot","\\cdot");A("\\sect","\\S");A("\\spades","\\spadesuit");A("\\sub","\\subset");A("\\sube","\\subseteq");A("\\supe","\\supseteq");A("\\Tau","\\mathrm{T}");A("\\thetasym","\\vartheta");A("\\weierp","\\wp");A("\\Zeta","\\mathrm{Z}");A("\\argmin","\\DOTSB\\operatorname*{arg\\,min}");A("\\argmax","\\DOTSB\\operatorname*{arg\\,max}");A("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits");A("\\bra","\\mathinner{\\langle{#1}|}");A("\\ket","\\mathinner{|{#1}\\rangle}");A("\\braket","\\mathinner{\\langle{#1}\\rangle}");A("\\Bra","\\left\\langle#1\\right|");A("\\Ket","\\left|#1\\right\\rangle");var p4=r=>e=>{var i=e.consumeArg().tokens,s=e.consumeArg().tokens,n=e.consumeArg().tokens,l=e.consumeArg().tokens,u=e.macros.get("|"),c=e.macros.get("\\|");e.macros.beginGroup();var h=g=>T=>{r&&(T.macros.set("|",u),n.length&&T.macros.set("\\|",c));var $=g;if(!g&&n.length){var y=T.future();y.text==="|"&&(T.popToken(),$=!0)}return{tokens:$?n:s,numArgs:0}};e.macros.set("|",h(!1)),n.length&&e.macros.set("\\|",h(!0));var f=e.consumeArg().tokens,p=e.expandTokens([...l,...f,...i]);return e.macros.endGroup(),{tokens:p.reverse(),numArgs:0}};A("\\bra@ket",p4(!1));A("\\bra@set",p4(!0));A("\\Braket","\\bra@ket{\\left\\langle}{\\,\\middle\\vert\\,}{\\,\\middle\\vert\\,}{\\right\\rangle}");A("\\Set","\\bra@set{\\left\\{\\:}{\\;\\middle\\vert\\;}{\\;\\middle\\Vert\\;}{\\:\\right\\}}");A("\\set","\\bra@set{\\{\\,}{\\mid}{}{\\,\\}}");A("\\angln","{\\angl n}");A("\\blue","\\textcolor{##6495ed}{#1}");A("\\orange","\\textcolor{##ffa500}{#1}");A("\\pink","\\textcolor{##ff00af}{#1}");A("\\red","\\textcolor{##df0030}{#1}");A("\\green","\\textcolor{##28ae7b}{#1}");A("\\gray","\\textcolor{gray}{#1}");A("\\purple","\\textcolor{##9d38bd}{#1}");A("\\blueA","\\textcolor{##ccfaff}{#1}");A("\\blueB","\\textcolor{##80f6ff}{#1}");A("\\blueC","\\textcolor{##63d9ea}{#1}");A("\\blueD","\\textcolor{##11accd}{#1}");A("\\blueE","\\textcolor{##0c7f99}{#1}");A("\\tealA","\\textcolor{##94fff5}{#1}");A("\\tealB","\\textcolor{##26edd5}{#1}");A("\\tealC","\\textcolor{##01d1c1}{#1}");A("\\tealD","\\textcolor{##01a995}{#1}");A("\\tealE","\\textcolor{##208170}{#1}");A("\\greenA","\\textcolor{##b6ffb0}{#1}");A("\\greenB","\\textcolor{##8af281}{#1}");A("\\greenC","\\textcolor{##74cf70}{#1}");A("\\greenD","\\textcolor{##1fab54}{#1}");A("\\greenE","\\textcolor{##0d923f}{#1}");A("\\goldA","\\textcolor{##ffd0a9}{#1}");A("\\goldB","\\textcolor{##ffbb71}{#1}");A("\\goldC","\\textcolor{##ff9c39}{#1}");A("\\goldD","\\textcolor{##e07d10}{#1}");A("\\goldE","\\textcolor{##a75a05}{#1}");A("\\redA","\\textcolor{##fca9a9}{#1}");A("\\redB","\\textcolor{##ff8482}{#1}");A("\\redC","\\textcolor{##f9685d}{#1}");A("\\redD","\\textcolor{##e84d39}{#1}");A("\\redE","\\textcolor{##bc2612}{#1}");A("\\maroonA","\\textcolor{##ffbde0}{#1}");A("\\maroonB","\\textcolor{##ff92c6}{#1}");A("\\maroonC","\\textcolor{##ed5fa6}{#1}");A("\\maroonD","\\textcolor{##ca337c}{#1}");A("\\maroonE","\\textcolor{##9e034e}{#1}");A("\\purpleA","\\textcolor{##ddd7ff}{#1}");A("\\purpleB","\\textcolor{##c6b9fc}{#1}");A("\\purpleC","\\textcolor{##aa87ff}{#1}");A("\\purpleD","\\textcolor{##7854ab}{#1}");A("\\purpleE","\\textcolor{##543b78}{#1}");A("\\mintA","\\textcolor{##f5f9e8}{#1}");A("\\mintB","\\textcolor{##edf2df}{#1}");A("\\mintC","\\textcolor{##e0e5cc}{#1}");A("\\grayA","\\textcolor{##f6f7f7}{#1}");A("\\grayB","\\textcolor{##f0f1f2}{#1}");A("\\grayC","\\textcolor{##e3e5e6}{#1}");A("\\grayD","\\textcolor{##d6d8da}{#1}");A("\\grayE","\\textcolor{##babec2}{#1}");A("\\grayF","\\textcolor{##888d93}{#1}");A("\\grayG","\\textcolor{##626569}{#1}");A("\\grayH","\\textcolor{##3b3e40}{#1}");A("\\grayI","\\textcolor{##21242c}{#1}");A("\\kaBlue","\\textcolor{##314453}{#1}");A("\\kaGreen","\\textcolor{##71B307}{#1}");var m4={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class aB{constructor(e,i,s){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=i,this.expansionCount=0,this.feed(e),this.macros=new oB(lB,i.macros),this.mode=s,this.stack=[]}feed(e){this.lexer=new Fy(e,this.settings)}switchMode(e){this.mode=e}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return this.stack.length===0&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(e){this.stack.push(e)}pushTokens(e){this.stack.push(...e)}scanArgument(e){var i,s,n;if(e){if(this.consumeSpaces(),this.future().text!=="[")return null;i=this.popToken(),{tokens:n,end:s}=this.consumeArg(["]"])}else({tokens:n,start:i,end:s}=this.consumeArg());return this.pushToken(new Es("EOF",s.loc)),this.pushTokens(n),i.range(s,"")}consumeSpaces(){for(;;){var e=this.future();if(e.text===" ")this.stack.pop();else break}}consumeArg(e){var i=[],s=e&&e.length>0;s||this.consumeSpaces();var n=this.future(),l,u=0,c=0;do{if(l=this.popToken(),i.push(l),l.text==="{")++u;else if(l.text==="}"){if(--u,u===-1)throw new ge("Extra }",l)}else if(l.text==="EOF")throw new ge("Unexpected end of input in a macro argument, expected '"+(e&&s?e[c]:"}")+"'",l);if(e&&s)if((u===0||u===1&&e[c]==="{")&&l.text===e[c]){if(++c,c===e.length){i.splice(-c,c);break}}else c=0}while(u!==0||s);return n.text==="{"&&i[i.length-1].text==="}"&&(i.pop(),i.shift()),i.reverse(),{tokens:i,start:n,end:l}}consumeArgs(e,i){if(i){if(i.length!==e+1)throw new ge("The length of delimiters doesn't match the number of args!");for(var s=i[0],n=0;n<s.length;n++){var l=this.popToken();if(s[n]!==l.text)throw new ge("Use of the macro doesn't match its definition",l)}}for(var u=[],c=0;c<e;c++)u.push(this.consumeArg(i&&i[c+1]).tokens);return u}expandOnce(e){var i=this.popToken(),s=i.text,n=i.noexpand?null:this._getExpansion(s);if(n==null||e&&n.unexpandable){if(e&&n==null&&s[0]==="\\"&&!this.isDefined(s))throw new ge("Undefined control sequence: "+s);return this.pushToken(i),i}if(this.expansionCount++,this.expansionCount>this.settings.maxExpand)throw new ge("Too many expansions: infinite loop or need to increase maxExpand setting");var l=n.tokens,u=this.consumeArgs(n.numArgs,n.delimiters);if(n.numArgs){l=l.slice();for(var c=l.length-1;c>=0;--c){var h=l[c];if(h.text==="#"){if(c===0)throw new ge("Incomplete placeholder at end of macro body",h);if(h=l[--c],h.text==="#")l.splice(c+1,1);else if(/^[1-9]$/.test(h.text))l.splice(c,2,...u[+h.text-1]);else throw new ge("Not a valid argument number",h)}}}return this.pushTokens(l),l}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;){var e=this.expandOnce();if(e instanceof Es)return e.treatAsRelax&&(e.text="\\relax"),this.stack.pop()}throw new Error}expandMacro(e){return this.macros.has(e)?this.expandTokens([new Es(e)]):void 0}expandTokens(e){var i=[],s=this.stack.length;for(this.pushTokens(e);this.stack.length>s;){var n=this.expandOnce(!0);n instanceof Es&&(n.treatAsRelax&&(n.noexpand=!1,n.treatAsRelax=!1),i.push(this.stack.pop()))}return i}expandMacroAsText(e){var i=this.expandMacro(e);return i&&i.map(s=>s.text).join("")}_getExpansion(e){var i=this.macros.get(e);if(i==null)return i;if(e.length===1){var s=this.lexer.catcodes[e];if(s!=null&&s!==13)return}var n=typeof i=="function"?i(this):i;if(typeof n=="string"){var l=0;if(n.indexOf("#")!==-1)for(var u=n.replace(/##/g,"");u.indexOf("#"+(l+1))!==-1;)++l;for(var c=new Fy(n,this.settings),h=[],f=c.lex();f.text!=="EOF";)h.push(f),f=c.lex();h.reverse();var p={tokens:h,numArgs:l};return p}return n}isDefined(e){return this.macros.has(e)||Lo.hasOwnProperty(e)||jt.math.hasOwnProperty(e)||jt.text.hasOwnProperty(e)||m4.hasOwnProperty(e)}isExpandable(e){var i=this.macros.get(e);return i!=null?typeof i=="string"||typeof i=="function"||!i.unexpandable:Lo.hasOwnProperty(e)&&!Lo[e].primitive}}var Gy=/^[₊₋₌₍₎₀₁₂₃₄₅₆₇₈₉ₐₑₕᵢⱼₖₗₘₙₒₚᵣₛₜᵤᵥₓᵦᵧᵨᵩᵪ]/,Kd=Object.freeze({"₊":"+","₋":"-","₌":"=","₍":"(","₎":")","₀":"0","₁":"1","₂":"2","₃":"3","₄":"4","₅":"5","₆":"6","₇":"7","₈":"8","₉":"9","ₐ":"a","ₑ":"e","ₕ":"h","ᵢ":"i","ⱼ":"j","ₖ":"k","ₗ":"l","ₘ":"m","ₙ":"n","ₒ":"o","ₚ":"p","ᵣ":"r","ₛ":"s","ₜ":"t","ᵤ":"u","ᵥ":"v","ₓ":"x","ᵦ":"β","ᵧ":"γ","ᵨ":"ρ","ᵩ":"ϕ","ᵪ":"χ","⁺":"+","⁻":"-","⁼":"=","⁽":"(","⁾":")","⁰":"0","¹":"1","²":"2","³":"3","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9","ᴬ":"A","ᴮ":"B","ᴰ":"D","ᴱ":"E","ᴳ":"G","ᴴ":"H","ᴵ":"I","ᴶ":"J","ᴷ":"K","ᴸ":"L","ᴹ":"M","ᴺ":"N","ᴼ":"O","ᴾ":"P","ᴿ":"R","ᵀ":"T","ᵁ":"U","ⱽ":"V","ᵂ":"W","ᵃ":"a","ᵇ":"b","ᶜ":"c","ᵈ":"d","ᵉ":"e","ᶠ":"f","ᵍ":"g",ʰ:"h","ⁱ":"i",ʲ:"j","ᵏ":"k",ˡ:"l","ᵐ":"m",ⁿ:"n","ᵒ":"o","ᵖ":"p",ʳ:"r",ˢ:"s","ᵗ":"t","ᵘ":"u","ᵛ":"v",ʷ:"w",ˣ:"x",ʸ:"y","ᶻ":"z","ᵝ":"β","ᵞ":"γ","ᵟ":"δ","ᵠ":"ϕ","ᵡ":"χ","ᶿ":"θ"}),T1={"́":{text:"\\'",math:"\\acute"},"̀":{text:"\\`",math:"\\grave"},"̈":{text:'\\"',math:"\\ddot"},"̃":{text:"\\~",math:"\\tilde"},"̄":{text:"\\=",math:"\\bar"},"̆":{text:"\\u",math:"\\breve"},"̌":{text:"\\v",math:"\\check"},"̂":{text:"\\^",math:"\\hat"},"̇":{text:"\\.",math:"\\dot"},"̊":{text:"\\r",math:"\\mathring"},"̋":{text:"\\H"},"̧":{text:"\\c"}},Vy={á:"á",à:"à",ä:"ä",ǟ:"ǟ",ã:"ã",ā:"ā",ă:"ă",ắ:"ắ",ằ:"ằ",ẵ:"ẵ",ǎ:"ǎ",â:"â",ấ:"ấ",ầ:"ầ",ẫ:"ẫ",ȧ:"ȧ",ǡ:"ǡ",å:"å",ǻ:"ǻ",ḃ:"ḃ",ć:"ć",ḉ:"ḉ",č:"č",ĉ:"ĉ",ċ:"ċ",ç:"ç",ď:"ď",ḋ:"ḋ",ḑ:"ḑ",é:"é",è:"è",ë:"ë",ẽ:"ẽ",ē:"ē",ḗ:"ḗ",ḕ:"ḕ",ĕ:"ĕ",ḝ:"ḝ",ě:"ě",ê:"ê",ế:"ế",ề:"ề",ễ:"ễ",ė:"ė",ȩ:"ȩ",ḟ:"ḟ",ǵ:"ǵ",ḡ:"ḡ",ğ:"ğ",ǧ:"ǧ",ĝ:"ĝ",ġ:"ġ",ģ:"ģ",ḧ:"ḧ",ȟ:"ȟ",ĥ:"ĥ",ḣ:"ḣ",ḩ:"ḩ",í:"í",ì:"ì",ï:"ï",ḯ:"ḯ",ĩ:"ĩ",ī:"ī",ĭ:"ĭ",ǐ:"ǐ",î:"î",ǰ:"ǰ",ĵ:"ĵ",ḱ:"ḱ",ǩ:"ǩ",ķ:"ķ",ĺ:"ĺ",ľ:"ľ",ļ:"ļ",ḿ:"ḿ",ṁ:"ṁ",ń:"ń",ǹ:"ǹ",ñ:"ñ",ň:"ň",ṅ:"ṅ",ņ:"ņ",ó:"ó",ò:"ò",ö:"ö",ȫ:"ȫ",õ:"õ",ṍ:"ṍ",ṏ:"ṏ",ȭ:"ȭ",ō:"ō",ṓ:"ṓ",ṑ:"ṑ",ŏ:"ŏ",ǒ:"ǒ",ô:"ô",ố:"ố",ồ:"ồ",ỗ:"ỗ",ȯ:"ȯ",ȱ:"ȱ",ő:"ő",ṕ:"ṕ",ṗ:"ṗ",ŕ:"ŕ",ř:"ř",ṙ:"ṙ",ŗ:"ŗ",ś:"ś",ṥ:"ṥ",š:"š",ṧ:"ṧ",ŝ:"ŝ",ṡ:"ṡ",ş:"ş",ẗ:"ẗ",ť:"ť",ṫ:"ṫ",ţ:"ţ",ú:"ú",ù:"ù",ü:"ü",ǘ:"ǘ",ǜ:"ǜ",ǖ:"ǖ",ǚ:"ǚ",ũ:"ũ",ṹ:"ṹ",ū:"ū",ṻ:"ṻ",ŭ:"ŭ",ǔ:"ǔ",û:"û",ů:"ů",ű:"ű",ṽ:"ṽ",ẃ:"ẃ",ẁ:"ẁ",ẅ:"ẅ",ŵ:"ŵ",ẇ:"ẇ",ẘ:"ẘ",ẍ:"ẍ",ẋ:"ẋ",ý:"ý",ỳ:"ỳ",ÿ:"ÿ",ỹ:"ỹ",ȳ:"ȳ",ŷ:"ŷ",ẏ:"ẏ",ẙ:"ẙ",ź:"ź",ž:"ž",ẑ:"ẑ",ż:"ż",Á:"Á",À:"À",Ä:"Ä",Ǟ:"Ǟ",Ã:"Ã",Ā:"Ā",Ă:"Ă",Ắ:"Ắ",Ằ:"Ằ",Ẵ:"Ẵ",Ǎ:"Ǎ",Â:"Â",Ấ:"Ấ",Ầ:"Ầ",Ẫ:"Ẫ",Ȧ:"Ȧ",Ǡ:"Ǡ",Å:"Å",Ǻ:"Ǻ",Ḃ:"Ḃ",Ć:"Ć",Ḉ:"Ḉ",Č:"Č",Ĉ:"Ĉ",Ċ:"Ċ",Ç:"Ç",Ď:"Ď",Ḋ:"Ḋ",Ḑ:"Ḑ",É:"É",È:"È",Ë:"Ë",Ẽ:"Ẽ",Ē:"Ē",Ḗ:"Ḗ",Ḕ:"Ḕ",Ĕ:"Ĕ",Ḝ:"Ḝ",Ě:"Ě",Ê:"Ê",Ế:"Ế",Ề:"Ề",Ễ:"Ễ",Ė:"Ė",Ȩ:"Ȩ",Ḟ:"Ḟ",Ǵ:"Ǵ",Ḡ:"Ḡ",Ğ:"Ğ",Ǧ:"Ǧ",Ĝ:"Ĝ",Ġ:"Ġ",Ģ:"Ģ",Ḧ:"Ḧ",Ȟ:"Ȟ",Ĥ:"Ĥ",Ḣ:"Ḣ",Ḩ:"Ḩ",Í:"Í",Ì:"Ì",Ï:"Ï",Ḯ:"Ḯ",Ĩ:"Ĩ",Ī:"Ī",Ĭ:"Ĭ",Ǐ:"Ǐ",Î:"Î",İ:"İ",Ĵ:"Ĵ",Ḱ:"Ḱ",Ǩ:"Ǩ",Ķ:"Ķ",Ĺ:"Ĺ",Ľ:"Ľ",Ļ:"Ļ",Ḿ:"Ḿ",Ṁ:"Ṁ",Ń:"Ń",Ǹ:"Ǹ",Ñ:"Ñ",Ň:"Ň",Ṅ:"Ṅ",Ņ:"Ņ",Ó:"Ó",Ò:"Ò",Ö:"Ö",Ȫ:"Ȫ",Õ:"Õ",Ṍ:"Ṍ",Ṏ:"Ṏ",Ȭ:"Ȭ",Ō:"Ō",Ṓ:"Ṓ",Ṑ:"Ṑ",Ŏ:"Ŏ",Ǒ:"Ǒ",Ô:"Ô",Ố:"Ố",Ồ:"Ồ",Ỗ:"Ỗ",Ȯ:"Ȯ",Ȱ:"Ȱ",Ő:"Ő",Ṕ:"Ṕ",Ṗ:"Ṗ",Ŕ:"Ŕ",Ř:"Ř",Ṙ:"Ṙ",Ŗ:"Ŗ",Ś:"Ś",Ṥ:"Ṥ",Š:"Š",Ṧ:"Ṧ",Ŝ:"Ŝ",Ṡ:"Ṡ",Ş:"Ş",Ť:"Ť",Ṫ:"Ṫ",Ţ:"Ţ",Ú:"Ú",Ù:"Ù",Ü:"Ü",Ǘ:"Ǘ",Ǜ:"Ǜ",Ǖ:"Ǖ",Ǚ:"Ǚ",Ũ:"Ũ",Ṹ:"Ṹ",Ū:"Ū",Ṻ:"Ṻ",Ŭ:"Ŭ",Ǔ:"Ǔ",Û:"Û",Ů:"Ů",Ű:"Ű",Ṽ:"Ṽ",Ẃ:"Ẃ",Ẁ:"Ẁ",Ẅ:"Ẅ",Ŵ:"Ŵ",Ẇ:"Ẇ",Ẍ:"Ẍ",Ẋ:"Ẋ",Ý:"Ý",Ỳ:"Ỳ",Ÿ:"Ÿ",Ỹ:"Ỹ",Ȳ:"Ȳ",Ŷ:"Ŷ",Ẏ:"Ẏ",Ź:"Ź",Ž:"Ž",Ẑ:"Ẑ",Ż:"Ż",ά:"ά",ὰ:"ὰ",ᾱ:"ᾱ",ᾰ:"ᾰ",έ:"έ",ὲ:"ὲ",ή:"ή",ὴ:"ὴ",ί:"ί",ὶ:"ὶ",ϊ:"ϊ",ΐ:"ΐ",ῒ:"ῒ",ῑ:"ῑ",ῐ:"ῐ",ό:"ό",ὸ:"ὸ",ύ:"ύ",ὺ:"ὺ",ϋ:"ϋ",ΰ:"ΰ",ῢ:"ῢ",ῡ:"ῡ",ῠ:"ῠ",ώ:"ώ",ὼ:"ὼ",Ύ:"Ύ",Ὺ:"Ὺ",Ϋ:"Ϋ",Ῡ:"Ῡ",Ῠ:"Ῠ",Ώ:"Ώ",Ὼ:"Ὼ"};let g4=class m_{constructor(e,i){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new aB(e,i,this.mode),this.settings=i,this.leftrightDepth=0}expect(e,i){if(i===void 0&&(i=!0),this.fetch().text!==e)throw new ge("Expected '"+e+"', got '"+this.fetch().text+"'",this.fetch());i&&this.consume()}consume(){this.nextToken=null}fetch(){return this.nextToken==null&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(e){this.mode=e,this.gullet.switchMode(e)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{var e=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),e}finally{this.gullet.endGroups()}}subparse(e){var i=this.nextToken;this.consume(),this.gullet.pushToken(new Es("}")),this.gullet.pushTokens(e);var s=this.parseExpression(!1);return this.expect("}"),this.nextToken=i,s}parseExpression(e,i){for(var s=[];;){this.mode==="math"&&this.consumeSpaces();var n=this.fetch();if(m_.endOfExpression.indexOf(n.text)!==-1||i&&n.text===i||e&&Lo[n.text]&&Lo[n.text].infix)break;var l=this.parseAtom(i);if(l){if(l.type==="internal")continue}else break;s.push(l)}return this.mode==="text"&&this.formLigatures(s),this.handleInfixNodes(s)}handleInfixNodes(e){for(var i=-1,s,n=0;n<e.length;n++)if(e[n].type==="infix"){if(i!==-1)throw new ge("only one infix operator per group",e[n].token);i=n,s=e[n].replaceWith}if(i!==-1&&s){var l,u,c=e.slice(0,i),h=e.slice(i+1);c.length===1&&c[0].type==="ordgroup"?l=c[0]:l={type:"ordgroup",mode:this.mode,body:c},h.length===1&&h[0].type==="ordgroup"?u=h[0]:u={type:"ordgroup",mode:this.mode,body:h};var f;return s==="\\\\abovefrac"?f=this.callFunction(s,[l,e[i],u],[]):f=this.callFunction(s,[l,u],[]),[f]}else return e}handleSupSubscript(e){var i=this.fetch(),s=i.text;this.consume(),this.consumeSpaces();var n=this.parseGroup(e);if(!n)throw new ge("Expected group after '"+s+"'",i);return n}formatUnsupportedCmd(e){for(var i=[],s=0;s<e.length;s++)i.push({type:"textord",mode:"text",text:e[s]});var n={type:"text",mode:this.mode,body:i},l={type:"color",mode:this.mode,color:this.settings.errorColor,body:[n]};return l}parseAtom(e){var i=this.parseGroup("atom",e);if(this.mode==="text")return i;for(var s,n;;){this.consumeSpaces();var l=this.fetch();if(l.text==="\\limits"||l.text==="\\nolimits"){if(i&&i.type==="op"){var u=l.text==="\\limits";i.limits=u,i.alwaysHandleSupSub=!0}else if(i&&i.type==="operatorname")i.alwaysHandleSupSub&&(i.limits=l.text==="\\limits");else throw new ge("Limit controls must follow a math operator",l);this.consume()}else if(l.text==="^"){if(s)throw new ge("Double superscript",l);s=this.handleSupSubscript("superscript")}else if(l.text==="_"){if(n)throw new ge("Double subscript",l);n=this.handleSupSubscript("subscript")}else if(l.text==="'"){if(s)throw new ge("Double superscript",l);var c={type:"textord",mode:this.mode,text:"\\prime"},h=[c];for(this.consume();this.fetch().text==="'";)h.push(c),this.consume();this.fetch().text==="^"&&h.push(this.handleSupSubscript("superscript")),s={type:"ordgroup",mode:this.mode,body:h}}else if(Kd[l.text]){var f=Kd[l.text],p=Gy.test(l.text);for(this.consume();;){var g=this.fetch().text;if(!Kd[g]||Gy.test(g)!==p)break;this.consume(),f+=Kd[g]}var T=new m_(f,this.settings).parse();p?n={type:"ordgroup",mode:"math",body:T}:s={type:"ordgroup",mode:"math",body:T}}else break}return s||n?{type:"supsub",mode:this.mode,base:i,sup:s,sub:n}:i}parseFunction(e,i){var s=this.fetch(),n=s.text,l=Lo[n];if(!l)return null;if(this.consume(),i&&i!=="atom"&&!l.allowedInArgument)throw new ge("Got function '"+n+"' with no arguments"+(i?" as "+i:""),s);if(this.mode==="text"&&!l.allowedInText)throw new ge("Can't use function '"+n+"' in text mode",s);if(this.mode==="math"&&l.allowedInMath===!1)throw new ge("Can't use function '"+n+"' in math mode",s);var{args:u,optArgs:c}=this.parseArguments(n,l);return this.callFunction(n,u,c,s,e)}callFunction(e,i,s,n,l){var u={funcName:e,parser:this,token:n,breakOnTokenText:l},c=Lo[e];if(c&&c.handler)return c.handler(u,i,s);throw new ge("No function handler for "+e)}parseArguments(e,i){var s=i.numArgs+i.numOptionalArgs;if(s===0)return{args:[],optArgs:[]};for(var n=[],l=[],u=0;u<s;u++){var c=i.argTypes&&i.argTypes[u],h=u<i.numOptionalArgs;(i.primitive&&c==null||i.type==="sqrt"&&u===1&&l[0]==null)&&(c="primitive");var f=this.parseGroupOfType("argument to '"+e+"'",c,h);if(h)l.push(f);else if(f!=null)n.push(f);else throw new ge("Null argument, please report this as a bug")}return{args:n,optArgs:l}}parseGroupOfType(e,i,s){switch(i){case"color":return this.parseColorGroup(s);case"size":return this.parseSizeGroup(s);case"url":return this.parseUrlGroup(s);case"math":case"text":return this.parseArgumentGroup(s,i);case"hbox":{var n=this.parseArgumentGroup(s,"text");return n!=null?{type:"styling",mode:n.mode,body:[n],style:"text"}:null}case"raw":{var l=this.parseStringGroup("raw",s);return l!=null?{type:"raw",mode:"text",string:l.text}:null}case"primitive":{if(s)throw new ge("A primitive argument cannot be optional");var u=this.parseGroup(e);if(u==null)throw new ge("Expected group as "+e,this.fetch());return u}case"original":case null:case void 0:return this.parseArgumentGroup(s);default:throw new ge("Unknown group type as "+e,this.fetch())}}consumeSpaces(){for(;this.fetch().text===" ";)this.consume()}parseStringGroup(e,i){var s=this.gullet.scanArgument(i);if(s==null)return null;for(var n="",l;(l=this.fetch()).text!=="EOF";)n+=l.text,this.consume();return this.consume(),s.text=n,s}parseRegexGroup(e,i){for(var s=this.fetch(),n=s,l="",u;(u=this.fetch()).text!=="EOF"&&e.test(l+u.text);)n=u,l+=n.text,this.consume();if(l==="")throw new ge("Invalid "+i+": '"+s.text+"'",s);return s.range(n,l)}parseColorGroup(e){var i=this.parseStringGroup("color",e);if(i==null)return null;var s=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i.exec(i.text);if(!s)throw new ge("Invalid color: '"+i.text+"'",i);var n=s[0];return/^[0-9a-f]{6}$/i.test(n)&&(n="#"+n),{type:"color-token",mode:this.mode,color:n}}parseSizeGroup(e){var i,s=!1;if(this.gullet.consumeSpaces(),!e&&this.gullet.future().text!=="{"?i=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size"):i=this.parseStringGroup("size",e),!i)return null;!e&&i.text.length===0&&(i.text="0pt",s=!0);var n=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(i.text);if(!n)throw new ge("Invalid size: '"+i.text+"'",i);var l={number:+(n[1]+n[2]),unit:n[3]};if(!IC(l))throw new ge("Invalid unit: '"+l.unit+"'",i);return{type:"size",mode:this.mode,value:l,isBlank:s}}parseUrlGroup(e){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);var i=this.parseStringGroup("url",e);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),i==null)return null;var s=i.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:s}}parseArgumentGroup(e,i){var s=this.gullet.scanArgument(e);if(s==null)return null;var n=this.mode;i&&this.switchMode(i),this.gullet.beginGroup();var l=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();var u={type:"ordgroup",mode:this.mode,loc:s.loc,body:l};return i&&this.switchMode(n),u}parseGroup(e,i){var s=this.fetch(),n=s.text,l;if(n==="{"||n==="\\begingroup"){this.consume();var u=n==="{"?"}":"\\endgroup";this.gullet.beginGroup();var c=this.parseExpression(!1,u),h=this.fetch();this.expect(u),this.gullet.endGroup(),l={type:"ordgroup",mode:this.mode,loc:ts.range(s,h),body:c,semisimple:n==="\\begingroup"||void 0}}else if(l=this.parseFunction(i,e)||this.parseSymbol(),l==null&&n[0]==="\\"&&!m4.hasOwnProperty(n)){if(this.settings.throwOnError)throw new ge("Undefined control sequence: "+n,s);l=this.formatUnsupportedCmd(n),this.consume()}return l}formLigatures(e){for(var i=e.length-1,s=0;s<i;++s){var n=e[s],l=n.text;l==="-"&&e[s+1].text==="-"&&(s+1<i&&e[s+2].text==="-"?(e.splice(s,3,{type:"textord",mode:"text",loc:ts.range(n,e[s+2]),text:"---"}),i-=2):(e.splice(s,2,{type:"textord",mode:"text",loc:ts.range(n,e[s+1]),text:"--"}),i-=1)),(l==="'"||l==="`")&&e[s+1].text===l&&(e.splice(s,2,{type:"textord",mode:"text",loc:ts.range(n,e[s+1]),text:l+l}),i-=1)}}parseSymbol(){var e=this.fetch(),i=e.text;if(/^\\verb[^a-zA-Z]/.test(i)){this.consume();var s=i.slice(5),n=s.charAt(0)==="*";if(n&&(s=s.slice(1)),s.length<2||s.charAt(0)!==s.slice(-1))throw new ge(`\\verb assertion failed --
                    please report what input caused this bug`);return s=s.slice(1,-1),{type:"verb",mode:"text",body:s,star:n}}Vy.hasOwnProperty(i[0])&&!jt[this.mode][i[0]]&&(this.settings.strict&&this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+i[0]+'" used in math mode',e),i=Vy[i[0]]+i.slice(1));var l=sB.exec(i);l&&(i=i.substring(0,l.index),i==="i"?i="ı":i==="j"&&(i="ȷ"));var u;if(jt[this.mode][i]){this.settings.strict&&this.mode==="math"&&u_.indexOf(i)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+i[0]+'" used in math mode',e);var c=jt[this.mode][i].group,h=ts.range(e),f;if(q7.hasOwnProperty(c)){var p=c;f={type:"atom",mode:this.mode,family:p,loc:h,text:i}}else f={type:c,mode:this.mode,loc:h,text:i};u=f}else if(i.charCodeAt(0)>=128)this.settings.strict&&(SC(i.charCodeAt(0))?this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+i[0]+'" used in math mode',e):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+i[0]+'"'+(" ("+i.charCodeAt(0)+")"),e)),u={type:"textord",mode:"text",loc:ts.range(e),text:i};else return null;if(this.consume(),l)for(var g=0;g<l[0].length;g++){var T=l[0][g];if(!T1[T])throw new ge("Unknown accent ' "+T+"'",e);var $=T1[T][this.mode]||T1[T].text;if(!$)throw new ge("Accent "+T+" unsupported in "+this.mode+" mode",e);u={type:"accent",mode:this.mode,loc:ts.range(e),label:$,isStretchy:!1,isShifty:!0,base:u}}return u}};g4.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var Jb=function(e,i){if(!(typeof e=="string"||e instanceof String))throw new TypeError("KaTeX can only parse string typed expression");var s=new g4(e,i);delete s.gullet.macros.current["\\df@tag"];var n=s.parse();if(delete s.gullet.macros.current["\\current@color"],delete s.gullet.macros.current["\\color"],s.gullet.macros.get("\\df@tag")){if(!i.displayMode)throw new ge("\\tag works only in display equations");n=[{type:"tag",mode:"text",body:n,tag:s.subparse([new Es("\\df@tag")])}]}return n},_4=function(e,i,s){i.textContent="";var n=Qb(e,s).toNode();i.appendChild(n)};typeof document<"u"&&document.compatMode!=="CSS1Compat"&&(typeof console<"u"&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."),_4=function(){throw new ge("KaTeX doesn't work in quirks mode.")});var uB=function(e,i){var s=Qb(e,i).toMarkup();return s},cB=function(e,i){var s=new xb(i);return Jb(e,s)},b4=function(e,i,s){if(s.throwOnError||!(e instanceof ge))throw e;var n=K.makeSpan(["katex-error"],[new Ss(i)]);return n.setAttribute("title",e.toString()),n.setAttribute("style","color:"+s.errorColor),n},Qb=function(e,i){var s=new xb(i);try{var n=Jb(e,s);return T9(n,e,s)}catch(l){return b4(l,e,s)}},hB=function(e,i){var s=new xb(i);try{var n=Jb(e,s);return E9(n,e,s)}catch(l){return b4(l,e,s)}},Wy={version:"0.16.4",render:_4,renderToString:uB,ParseError:ge,SETTINGS_SCHEMA:T0,__parse:cB,__renderToDomTree:Qb,__renderToHTMLTree:hB,__setFontMetrics:V7,__defineSymbol:E,__defineMacro:A,__domTree:{Span:dh,Anchor:Mb,SymbolNode:Ss,SvgNode:no,PathNode:Wo,LineNode:a_}};function dB(r){let e,i=Wy.renderToString(r[1],{throwOnError:!1,displayMode:r[0]})+"",s;return{c(){e=new rx(!1),s=dt(),this.h()},l(n){e=sx(n,!1),s=dt(),this.h()},h(){e.a=s},m(n,l){e.m(i,n,l),Ee(n,s,l)},p(n,[l]){l&3&&i!==(i=Wy.renderToString(n[1],{throwOnError:!1,displayMode:n[0]})+"")&&e.p(i)},i:Wi,o:Wi,d(n){n&&ue(s),n&&e.d()}}}function fB(r,e,i){let s,n;ns(r,Hr,c=>i(3,n=c));let{element:l}=e,u;return r.$$set=c=>{"element"in c&&i(2,l=c.element)},r.$$.update=()=>{r.$$.dirty&12&&(l.tagName=="me"?i(0,u=n(l).attr("mode")!=="inline"):l.tagName=="m"?i(0,u=n(l).attr("mode")==="display"):i(0,u=!1)),r.$$.dirty&12&&i(1,s=n(l).text())},[u,s,l,n]}class T4 extends Ii{constructor(e){super(),ki(this,e,fB,dB,Ai,{element:2})}}function pB(r){let e,i,s,n;return i=new Zf({props:{element:r[0]}}),{c(){e=Et('"'),st(i.$$.fragment),s=Et('"')},l(l){e=$t(l,'"'),nt(i.$$.fragment,l),s=$t(l,'"')},m(l,u){Ee(l,e,u),ot(i,l,u),Ee(l,s,u),n=!0},p(l,[u]){const c={};u&1&&(c.element=l[0]),i.$set(c)},i(l){n||(ee(i.$$.fragment,l),n=!0)},o(l){ae(i.$$.fragment,l),n=!1},d(l){l&&ue(e),lt(i,l),l&&ue(s)}}}function mB(r,e,i){let{element:s}=e;return r.$$set=n=>{"element"in n&&i(0,s=n.element)},[s]}class E4 extends Ii{constructor(e){super(),ki(this,e,mB,pB,Ai,{element:0})}}function gB(r){let e,i;return e=new Zf({props:{element:r[0]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&1&&(l.element=s[0]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function _B(r){let e;return{c(){e=Et(r[2])},l(i){e=$t(i,r[2])},m(i,s){Ee(i,e,s)},p:Wi,i:Wi,o:Wi,d(i){i&&ue(e)}}}function bB(r){let e,i,s,n,l;const u=[_B,gB],c=[];function h(f,p){return p&3&&(i=null),i==null&&(i=f[1](f[0]).text()===""),i?0:1}return s=h(r,-1),n=c[s]=u[s](r),{c(){e=Ft("a"),n.c(),this.h()},l(f){e=Ut(f,"A",{href:!0});var p=Vt(e);n.l(p),p.forEach(ue),this.h()},h(){Ki(e,"href",r[2])},m(f,p){Ee(f,e,p),c[s].m(e,null),l=!0},p(f,[p]){let g=s;s=h(f,p),s===g?c[s].p(f,p):(mt(),ae(c[g],1,1,()=>{c[g]=null}),gt(),n=c[s],n?n.p(f,p):(n=c[s]=u[s](f),n.c()),ee(n,1),n.m(e,null))},i(f){l||(ee(n),l=!0)},o(f){ae(n),l=!1},d(f){f&&ue(e),c[s].d()}}}function TB(r,e,i){let s;ns(r,Hr,u=>i(1,s=u));let{element:n}=e,l=s(n).attr("href");return r.$$set=u=>{"element"in u&&i(0,n=u.element)},[n,s,l]}class EB extends Ii{constructor(e){super(),ki(this,e,TB,bB,Ai,{element:0})}}function zy(r,e,i){const s=r.slice();return s[2]=e[i],s}function $B(r){let e,i;return e=new EB({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function vB(r){let e,i;return e=new p7({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function yB(r){let e,i;return e=new E4({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function SB(r){let e,i;return e=new $C({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function IB(r){let e,i;return e=new vC({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function kB(r){let e,i;return e=new T4({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function AB(r){let e=r[1](r[2]).text()+"",i;return{c(){i=Et(e)},l(s){i=$t(s,e)},m(s,n){Ee(s,i,n)},p(s,n){n&3&&e!==(e=s[1](s[2]).text()+"")&&Li(i,e)},i:Wi,o:Wi,d(s){s&&ue(i)}}}function Yy(r){let e,i,s,n;const l=[AB,kB,IB,SB,yB,vB,$B],u=[];function c(h,f){return"tagName"in h[2]?h[2].tagName==="m"||h[2].tagName==="me"?1:h[2].tagName==="em"?2:h[2].tagName==="c"?3:h[2].tagName==="q"?4:h[2].tagName==="image"?5:h[2].tagName==="url"?6:-1:0}return~(e=c(r))&&(i=u[e]=l[e](r)),{c(){i&&i.c(),s=dt()},l(h){i&&i.l(h),s=dt()},m(h,f){~e&&u[e].m(h,f),Ee(h,s,f),n=!0},p(h,f){let p=e;e=c(h),e===p?~e&&u[e].p(h,f):(i&&(mt(),ae(u[p],1,1,()=>{u[p]=null}),gt()),~e?(i=u[e],i?i.p(h,f):(i=u[e]=l[e](h),i.c()),ee(i,1),i.m(s.parentNode,s)):i=null)},i(h){n||(ee(i),n=!0)},o(h){ae(i),n=!1},d(h){~e&&u[e].d(h),h&&ue(s)}}}function CB(r){let e,i,s=r[1](r[0]).contents(),n=[];for(let u=0;u<s.length;u+=1)n[u]=Yy(zy(r,s,u));const l=u=>ae(n[u],1,1,()=>{n[u]=null});return{c(){for(let u=0;u<n.length;u+=1)n[u].c();e=dt()},l(u){for(let c=0;c<n.length;c+=1)n[c].l(u);e=dt()},m(u,c){for(let h=0;h<n.length;h+=1)n[h].m(u,c);Ee(u,e,c),i=!0},p(u,[c]){if(c&3){s=u[1](u[0]).contents();let h;for(h=0;h<s.length;h+=1){const f=zy(u,s,h);n[h]?(n[h].p(f,c),ee(n[h],1)):(n[h]=Yy(f),n[h].c(),ee(n[h],1),n[h].m(e.parentNode,e))}for(mt(),h=s.length;h<n.length;h+=1)l(h);gt()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)ee(n[c]);i=!0}},o(u){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)ae(n[c]);i=!1},d(u){di(n,u),u&&ue(e)}}}function OB(r,e,i){let s;ns(r,Hr,l=>i(1,s=l));let{element:n}=e;return r.$$set=l=>{"element"in l&&i(0,n=l.element)},[n,s]}class Zf extends Ii{constructor(e){super(),ki(this,e,OB,CB,Ai,{element:0})}}function wB(r){let e,i,s;return i=new Zf({props:{element:r[0]}}),{c(){e=Ft("p"),st(i.$$.fragment)},l(n){e=Ut(n,"P",{});var l=Vt(e);nt(i.$$.fragment,l),l.forEach(ue)},m(n,l){Ee(n,e,l),ot(i,e,null),s=!0},p(n,[l]){const u={};l&1&&(u.element=n[0]),i.$set(u)},i(n){s||(ee(i.$$.fragment,n),s=!0)},o(n){ae(i.$$.fragment,n),s=!1},d(n){n&&ue(e),lt(i)}}}function RB(r,e,i){let{element:s}=e;return r.$$set=n=>{"element"in n&&i(0,s=n.element)},[s]}class Zb extends Ii{constructor(e){super(),ki(this,e,RB,wB,Ai,{element:0})}}function NB(r){let e,i,s;return i=new S4({props:{element:r[0]}}),{c(){e=Ft("li"),st(i.$$.fragment)},l(n){e=Ut(n,"LI",{});var l=Vt(e);nt(i.$$.fragment,l),l.forEach(ue)},m(n,l){Ee(n,e,l),ot(i,e,null),s=!0},p(n,[l]){const u={};l&1&&(u.element=n[0]),i.$set(u)},i(n){s||(ee(i.$$.fragment,n),s=!0)},o(n){ae(i.$$.fragment,n),s=!1},d(n){n&&ue(e),lt(i)}}}function xB(r,e,i){let{element:s}=e;return r.$$set=n=>{"element"in n&&i(0,s=n.element)},[s]}class $4 extends Ii{constructor(e){super(),ki(this,e,xB,NB,Ai,{element:0})}}function Xy(r,e,i){const s=r.slice();return s[3]=e[i],s}function jy(r,e,i){const s=r.slice();return s[3]=e[i],s}function Ky(r){let e,i,s,n;const l=[LB,DB],u=[];function c(h,f){return h[1]?0:1}return e=c(r),i=u[e]=l[e](r),{c(){i.c(),s=dt()},l(h){i.l(h),s=dt()},m(h,f){u[e].m(h,f),Ee(h,s,f),n=!0},p(h,f){let p=e;e=c(h),e===p?u[e].p(h,f):(mt(),ae(u[p],1,1,()=>{u[p]=null}),gt(),i=u[e],i?i.p(h,f):(i=u[e]=l[e](h),i.c()),ee(i,1),i.m(s.parentNode,s))},i(h){n||(ee(i),n=!0)},o(h){ae(i),n=!1},d(h){u[e].d(h),h&&ue(s)}}}function DB(r){let e,i,s=r[2](r[0]).children("item"),n=[];for(let u=0;u<s.length;u+=1)n[u]=qy(Xy(r,s,u));const l=u=>ae(n[u],1,1,()=>{n[u]=null});return{c(){e=Ft("ul");for(let u=0;u<n.length;u+=1)n[u].c()},l(u){e=Ut(u,"UL",{});var c=Vt(e);for(let h=0;h<n.length;h+=1)n[h].l(c);c.forEach(ue)},m(u,c){Ee(u,e,c);for(let h=0;h<n.length;h+=1)n[h].m(e,null);i=!0},p(u,c){if(c&5){s=u[2](u[0]).children("item");let h;for(h=0;h<s.length;h+=1){const f=Xy(u,s,h);n[h]?(n[h].p(f,c),ee(n[h],1)):(n[h]=qy(f),n[h].c(),ee(n[h],1),n[h].m(e,null))}for(mt(),h=s.length;h<n.length;h+=1)l(h);gt()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)ee(n[c]);i=!0}},o(u){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)ae(n[c]);i=!1},d(u){u&&ue(e),di(n,u)}}}function LB(r){let e,i,s=r[2](r[0]).children("item"),n=[];for(let u=0;u<s.length;u+=1)n[u]=Jy(jy(r,s,u));const l=u=>ae(n[u],1,1,()=>{n[u]=null});return{c(){e=Ft("ol");for(let u=0;u<n.length;u+=1)n[u].c()},l(u){e=Ut(u,"OL",{});var c=Vt(e);for(let h=0;h<n.length;h+=1)n[h].l(c);c.forEach(ue)},m(u,c){Ee(u,e,c);for(let h=0;h<n.length;h+=1)n[h].m(e,null);i=!0},p(u,c){if(c&5){s=u[2](u[0]).children("item");let h;for(h=0;h<s.length;h+=1){const f=jy(u,s,h);n[h]?(n[h].p(f,c),ee(n[h],1)):(n[h]=Jy(f),n[h].c(),ee(n[h],1),n[h].m(e,null))}for(mt(),h=s.length;h<n.length;h+=1)l(h);gt()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)ee(n[c]);i=!0}},o(u){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)ae(n[c]);i=!1},d(u){u&&ue(e),di(n,u)}}}function qy(r){let e,i;return e=new $4({props:{element:r[3]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&5&&(l.element=s[3]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function Jy(r){let e,i;return e=new $4({props:{element:r[3]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&5&&(l.element=s[3]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function MB(r){let e=r[2](r[0]).children("item"),i,s,n=e&&Ky(r);return{c(){n&&n.c(),i=dt()},l(l){n&&n.l(l),i=dt()},m(l,u){n&&n.m(l,u),Ee(l,i,u),s=!0},p(l,[u]){u&5&&(e=l[2](l[0]).children("item")),e?n?(n.p(l,u),u&5&&ee(n,1)):(n=Ky(l),n.c(),ee(n,1),n.m(i.parentNode,i)):n&&(mt(),ae(n,1,1,()=>{n=null}),gt())},i(l){s||(ee(n),s=!0)},o(l){ae(n),s=!1},d(l){n&&n.d(l),l&&ue(i)}}}function BB(r,e,i){let s,n;ns(r,Hr,u=>i(2,n=u));let{element:l}=e;return r.$$set=u=>{"element"in u&&i(0,l=u.element)},r.$$.update=()=>{r.$$.dirty&1&&i(1,s=l.attribs.mode=="ordered")},[l,s,n]}class eT extends Ii{constructor(e){super(),ki(this,e,BB,MB,Ai,{element:0})}}const Pc=(r,e)=>e(r).parents("division").length,Yo=(r,e)=>{if(e(r).attr("label"))return e(r).attr("label");if(Pc(r,e)===0)return"Chapter";if(Pc(r,e)===1)return"Section";{let i="sub".repeat(Pc(r,e)-1)+"section";return i.charAt(0).toUpperCase()+i.slice(1)}},Cn=(r,e)=>{let i=`${e(r).prevAll("division").length+1}`;return e(r).attr("number")&&(i=e(r).attr("number")),Pc(r,e)===0?`${i}`:`${Cn(e(r).parent("division")[0],e)}.${i}`},tT=(r,e)=>e(r).parents("knowl").length,Ro=(r,e)=>e(r).attr("mode")?e(r).attr("mode"):e(r).parent("knowl").length>0?Ro(e(r).parent("knowl")[0],e):"knowl",Xo=(r,e)=>e(r).attr("label")?e(r).attr("label"):tT(r,e)===0?Ro(r,e)==="exercise"?"Exercise":Ro(r,e)==="activity"?"Activity":Ro(r,e)==="theorem"?"Theorem":Ro(r,e)==="lemma"?"Lemma":Ro(r,e)==="conjecture"?"Conjecture":Ro(r,e)==="definition"?"Definition":"Knowl":["exercise","activity"].includes(Ro(r,e))?"Task":"Part",ao=(r,e)=>{let i=`${e(r).prevAll("knowl").length+1}`;return e(r).attr("number")&&(i=e(r).attr("number")),tT(r,e)>0?`${ao(e(r).parent("knowl")[0],e)}.${i}`:e(r).parents("division").length===0?`${i}`:Cn(e(r).closest("division")[0],e)+`.${i}`};function Qy(r,e,i){const s=r.slice();return s[2]=e[i],s}function PB(r){let e,i;return e=new E4({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function FB(r){let e,i;return e=new $C({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function UB(r){let e,i;return e=new vC({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function HB(r){let e,i;return e=new T4({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function GB(r){let e=r[1](r[2]).text()+"",i;return{c(){i=Et(e)},l(s){i=$t(s,e)},m(s,n){Ee(s,i,n)},p(s,n){n&3&&e!==(e=s[1](s[2]).text()+"")&&Li(i,e)},i:Wi,o:Wi,d(s){s&&ue(i)}}}function Zy(r){let e,i,s,n;const l=[GB,HB,UB,FB,PB],u=[];function c(h,f){return"tagName"in h[2]?h[2].tagName==="m"||h[2].tagName==="me"?1:h[2].tagName==="em"?2:h[2].tagName==="c"?3:h[2].tagName==="q"?4:-1:0}return~(e=c(r))&&(i=u[e]=l[e](r)),{c(){i&&i.c(),s=dt()},l(h){i&&i.l(h),s=dt()},m(h,f){~e&&u[e].m(h,f),Ee(h,s,f),n=!0},p(h,f){let p=e;e=c(h),e===p?~e&&u[e].p(h,f):(i&&(mt(),ae(u[p],1,1,()=>{u[p]=null}),gt()),~e?(i=u[e],i?i.p(h,f):(i=u[e]=l[e](h),i.c()),ee(i,1),i.m(s.parentNode,s)):i=null)},i(h){n||(ee(i),n=!0)},o(h){ae(i),n=!1},d(h){~e&&u[e].d(h),h&&ue(s)}}}function VB(r){let e,i,s=r[1](r[0]).contents(),n=[];for(let u=0;u<s.length;u+=1)n[u]=Zy(Qy(r,s,u));const l=u=>ae(n[u],1,1,()=>{n[u]=null});return{c(){for(let u=0;u<n.length;u+=1)n[u].c();e=dt()},l(u){for(let c=0;c<n.length;c+=1)n[c].l(u);e=dt()},m(u,c){for(let h=0;h<n.length;h+=1)n[h].m(u,c);Ee(u,e,c),i=!0},p(u,[c]){if(c&3){s=u[1](u[0]).contents();let h;for(h=0;h<s.length;h+=1){const f=Qy(u,s,h);n[h]?(n[h].p(f,c),ee(n[h],1)):(n[h]=Zy(f),n[h].c(),ee(n[h],1),n[h].m(e.parentNode,e))}for(mt(),h=s.length;h<n.length;h+=1)l(h);gt()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)ee(n[c]);i=!0}},o(u){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)ae(n[c]);i=!1},d(u){di(n,u),u&&ue(e)}}}function WB(r,e,i){let s;ns(r,Hr,l=>i(1,s=l));let{element:n}=e;return r.$$set=l=>{"element"in l&&i(0,n=l.element)},[n,s]}class ph extends Ii{constructor(e){super(),ki(this,e,WB,VB,Ai,{element:0})}}function eS(r,e,i){const s=r.slice();return s[2]=e[i],s}function zB(r){let e,i;return e=new eT({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function YB(r){let e,i;return e=new Zb({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function tS(r){let e,i,s,n;const l=[YB,zB],u=[];function c(h,f){return h[2].tagName==="p"?0:h[2].tagName==="list"?1:-1}return~(e=c(r))&&(i=u[e]=l[e](r)),{c(){i&&i.c(),s=dt()},l(h){i&&i.l(h),s=dt()},m(h,f){~e&&u[e].m(h,f),Ee(h,s,f),n=!0},p(h,f){let p=e;e=c(h),e===p?~e&&u[e].p(h,f):(i&&(mt(),ae(u[p],1,1,()=>{u[p]=null}),gt()),~e?(i=u[e],i?i.p(h,f):(i=u[e]=l[e](h),i.c()),ee(i,1),i.m(s.parentNode,s)):i=null)},i(h){n||(ee(i),n=!0)},o(h){ae(i),n=!1},d(h){~e&&u[e].d(h),h&&ue(s)}}}function XB(r){let e,i,s=r[1](r[0]).children(),n=[];for(let u=0;u<s.length;u+=1)n[u]=tS(eS(r,s,u));const l=u=>ae(n[u],1,1,()=>{n[u]=null});return{c(){for(let u=0;u<n.length;u+=1)n[u].c();e=dt()},l(u){for(let c=0;c<n.length;c+=1)n[c].l(u);e=dt()},m(u,c){for(let h=0;h<n.length;h+=1)n[h].m(u,c);Ee(u,e,c),i=!0},p(u,[c]){if(c&3){s=u[1](u[0]).children();let h;for(h=0;h<s.length;h+=1){const f=eS(u,s,h);n[h]?(n[h].p(f,c),ee(n[h],1)):(n[h]=tS(f),n[h].c(),ee(n[h],1),n[h].m(e.parentNode,e))}for(mt(),h=s.length;h<n.length;h+=1)l(h);gt()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)ee(n[c]);i=!0}},o(u){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)ae(n[c]);i=!1},d(u){di(n,u),u&&ue(e)}}}function jB(r,e,i){let s;ns(r,Hr,l=>i(1,s=l));let{element:n}=e;return r.$$set=l=>{"element"in l&&i(0,n=l.element)},[n,s]}class v4 extends Ii{constructor(e){super(),ki(this,e,jB,XB,Ai,{element:0})}}function iS(r,e,i){const s=r.slice();return s[2]=e[i],s}function KB(r){let e,i;return e=new eT({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function qB(r){let e,i;return e=new Zb({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function rS(r){let e,i,s,n;const l=[qB,KB],u=[];function c(h,f){return h[2].tagName==="p"?0:h[2].tagName==="list"?1:-1}return~(e=c(r))&&(i=u[e]=l[e](r)),{c(){i&&i.c(),s=dt()},l(h){i&&i.l(h),s=dt()},m(h,f){~e&&u[e].m(h,f),Ee(h,s,f),n=!0},p(h,f){let p=e;e=c(h),e===p?~e&&u[e].p(h,f):(i&&(mt(),ae(u[p],1,1,()=>{u[p]=null}),gt()),~e?(i=u[e],i?i.p(h,f):(i=u[e]=l[e](h),i.c()),ee(i,1),i.m(s.parentNode,s)):i=null)},i(h){n||(ee(i),n=!0)},o(h){ae(i),n=!1},d(h){~e&&u[e].d(h),h&&ue(s)}}}function JB(r){let e,i,s=r[1](r[0]).children(),n=[];for(let u=0;u<s.length;u+=1)n[u]=rS(iS(r,s,u));const l=u=>ae(n[u],1,1,()=>{n[u]=null});return{c(){for(let u=0;u<n.length;u+=1)n[u].c();e=dt()},l(u){for(let c=0;c<n.length;c+=1)n[c].l(u);e=dt()},m(u,c){for(let h=0;h<n.length;h+=1)n[h].m(u,c);Ee(u,e,c),i=!0},p(u,[c]){if(c&3){s=u[1](u[0]).children();let h;for(h=0;h<s.length;h+=1){const f=iS(u,s,h);n[h]?(n[h].p(f,c),ee(n[h],1)):(n[h]=rS(f),n[h].c(),ee(n[h],1),n[h].m(e.parentNode,e))}for(mt(),h=s.length;h<n.length;h+=1)l(h);gt()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)ee(n[c]);i=!0}},o(u){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)ae(n[c]);i=!1},d(u){di(n,u),u&&ue(e)}}}function QB(r,e,i){let s;ns(r,Hr,l=>i(1,s=l));let{element:n}=e;return r.$$set=l=>{"element"in l&&i(0,n=l.element)},[n,s]}class y4 extends Ii{constructor(e){super(),ki(this,e,QB,JB,Ai,{element:0})}}function sS(r,e,i){const s=r.slice();return s[2]=e[i],s}function nS(r,e,i){const s=r.slice();return s[5]=e[i],s}function oS(r,e,i){const s=r.slice();return s[8]=e[i],s}function lS(r,e,i){const s=r.slice();return s[11]=e[i],s}function aS(r,e,i){const s=r.slice();return s[14]=e[i],s}function uS(r,e,i){const s=r.slice();return s[14]=e[i],s}function ZB(r){let e,i,s=r[1](r[0]).children("title:first"),n=[];for(let c=0;c<s.length;c+=1)n[c]=hS(aS(r,s,c));const l=c=>ae(n[c],1,1,()=>{n[c]=null});let u=null;return s.length||(u=cS(r)),{c(){e=Ft("h4");for(let c=0;c<n.length;c+=1)n[c].c();u&&u.c()},l(c){e=Ut(c,"H4",{});var h=Vt(e);for(let f=0;f<n.length;f+=1)n[f].l(h);u&&u.l(h),h.forEach(ue)},m(c,h){Ee(c,e,h);for(let f=0;f<n.length;f+=1)n[f].m(e,null);u&&u.m(e,null),i=!0},p(c,h){if(h&3){s=c[1](c[0]).children("title:first");let f;for(f=0;f<s.length;f+=1){const p=aS(c,s,f);n[f]?(n[f].p(p,h),ee(n[f],1)):(n[f]=hS(p),n[f].c(),ee(n[f],1),n[f].m(e,null))}for(mt(),f=s.length;f<n.length;f+=1)l(f);gt(),!s.length&&u?u.p(c,h):s.length?u&&(u.d(1),u=null):(u=cS(c),u.c(),u.m(e,null))}},i(c){if(!i){for(let h=0;h<s.length;h+=1)ee(n[h]);i=!0}},o(c){n=n.filter(Boolean);for(let h=0;h<n.length;h+=1)ae(n[h]);i=!1},d(c){c&&ue(e),di(n,c),u&&u.d()}}}function eP(r){let e,i,s=r[1](r[0]).children("title:first"),n=[];for(let c=0;c<s.length;c+=1)n[c]=fS(uS(r,s,c));const l=c=>ae(n[c],1,1,()=>{n[c]=null});let u=null;return s.length||(u=dS(r)),{c(){e=Ft("h3");for(let c=0;c<n.length;c+=1)n[c].c();u&&u.c()},l(c){e=Ut(c,"H3",{});var h=Vt(e);for(let f=0;f<n.length;f+=1)n[f].l(h);u&&u.l(h),h.forEach(ue)},m(c,h){Ee(c,e,h);for(let f=0;f<n.length;f+=1)n[f].m(e,null);u&&u.m(e,null),i=!0},p(c,h){if(h&3){s=c[1](c[0]).children("title:first");let f;for(f=0;f<s.length;f+=1){const p=uS(c,s,f);n[f]?(n[f].p(p,h),ee(n[f],1)):(n[f]=fS(p),n[f].c(),ee(n[f],1),n[f].m(e,null))}for(mt(),f=s.length;f<n.length;f+=1)l(f);gt(),!s.length&&u?u.p(c,h):s.length?u&&(u.d(1),u=null):(u=dS(c),u.c(),u.m(e,null))}},i(c){if(!i){for(let h=0;h<s.length;h+=1)ee(n[h]);i=!0}},o(c){n=n.filter(Boolean);for(let h=0;h<n.length;h+=1)ae(n[h]);i=!1},d(c){c&&ue(e),di(n,c),u&&u.d()}}}function cS(r){let e=Xo(r[0],r[1])+"",i,s,n=ao(r[0],r[1])+"",l,u;return{c(){i=Et(e),s=xi(),l=Et(n),u=Et(".")},l(c){i=$t(c,e),s=Di(c),l=$t(c,n),u=$t(c,".")},m(c,h){Ee(c,i,h),Ee(c,s,h),Ee(c,l,h),Ee(c,u,h)},p(c,h){h&3&&e!==(e=Xo(c[0],c[1])+"")&&Li(i,e),h&3&&n!==(n=ao(c[0],c[1])+"")&&Li(l,n)},d(c){c&&ue(i),c&&ue(s),c&&ue(l),c&&ue(u)}}}function hS(r){let e=Xo(r[0],r[1])+"",i,s,n=ao(r[0],r[1])+"",l,u,c,h,f;return c=new ph({props:{element:r[14]}}),{c(){i=Et(e),s=xi(),l=Et(n),u=Et(`:
                `),st(c.$$.fragment),h=Et(".")},l(p){i=$t(p,e),s=Di(p),l=$t(p,n),u=$t(p,`:
                `),nt(c.$$.fragment,p),h=$t(p,".")},m(p,g){Ee(p,i,g),Ee(p,s,g),Ee(p,l,g),Ee(p,u,g),ot(c,p,g),Ee(p,h,g),f=!0},p(p,g){(!f||g&3)&&e!==(e=Xo(p[0],p[1])+"")&&Li(i,e),(!f||g&3)&&n!==(n=ao(p[0],p[1])+"")&&Li(l,n);const T={};g&3&&(T.element=p[14]),c.$set(T)},i(p){f||(ee(c.$$.fragment,p),f=!0)},o(p){ae(c.$$.fragment,p),f=!1},d(p){p&&ue(i),p&&ue(s),p&&ue(l),p&&ue(u),lt(c,p),p&&ue(h)}}}function dS(r){let e=Xo(r[0],r[1])+"",i,s,n=ao(r[0],r[1])+"",l,u;return{c(){i=Et(e),s=xi(),l=Et(n),u=Et(".")},l(c){i=$t(c,e),s=Di(c),l=$t(c,n),u=$t(c,".")},m(c,h){Ee(c,i,h),Ee(c,s,h),Ee(c,l,h),Ee(c,u,h)},p(c,h){h&3&&e!==(e=Xo(c[0],c[1])+"")&&Li(i,e),h&3&&n!==(n=ao(c[0],c[1])+"")&&Li(l,n)},d(c){c&&ue(i),c&&ue(s),c&&ue(l),c&&ue(u)}}}function fS(r){let e=Xo(r[0],r[1])+"",i,s,n=ao(r[0],r[1])+"",l,u,c,h,f;return c=new ph({props:{element:r[14]}}),{c(){i=Et(e),s=xi(),l=Et(n),u=Et(`:
                `),st(c.$$.fragment),h=Et(".")},l(p){i=$t(p,e),s=Di(p),l=$t(p,n),u=$t(p,`:
                `),nt(c.$$.fragment,p),h=$t(p,".")},m(p,g){Ee(p,i,g),Ee(p,s,g),Ee(p,l,g),Ee(p,u,g),ot(c,p,g),Ee(p,h,g),f=!0},p(p,g){(!f||g&3)&&e!==(e=Xo(p[0],p[1])+"")&&Li(i,e),(!f||g&3)&&n!==(n=ao(p[0],p[1])+"")&&Li(l,n);const T={};g&3&&(T.element=p[14]),c.$set(T)},i(p){f||(ee(c.$$.fragment,p),f=!0)},o(p){ae(c.$$.fragment,p),f=!1},d(p){p&&ue(i),p&&ue(s),p&&ue(l),p&&ue(u),lt(c,p),p&&ue(h)}}}function pS(r){let e,i;return e=new v4({props:{element:r[11]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[11]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function mS(r){let e,i,s=r[1](r[0]).children("content:first"),n=[];for(let u=0;u<s.length;u+=1)n[u]=gS(oS(r,s,u));const l=u=>ae(n[u],1,1,()=>{n[u]=null});return{c(){for(let u=0;u<n.length;u+=1)n[u].c();e=dt()},l(u){for(let c=0;c<n.length;c+=1)n[c].l(u);e=dt()},m(u,c){for(let h=0;h<n.length;h+=1)n[h].m(u,c);Ee(u,e,c),i=!0},p(u,c){if(c&3){s=u[1](u[0]).children("content:first");let h;for(h=0;h<s.length;h+=1){const f=oS(u,s,h);n[h]?(n[h].p(f,c),ee(n[h],1)):(n[h]=gS(f),n[h].c(),ee(n[h],1),n[h].m(e.parentNode,e))}for(mt(),h=s.length;h<n.length;h+=1)l(h);gt()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)ee(n[c]);i=!0}},o(u){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)ae(n[c]);i=!1},d(u){di(n,u),u&&ue(e)}}}function gS(r){let e,i;return e=new rT({props:{element:r[8]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[8]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function _S(r){let e,i;return e=new iT({props:{element:r[5]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[5]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function bS(r){let e,i;return e=new y4({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function tP(r){let e,i,s,n,l,u,c,h,f;const p=[eP,ZB],g=[];function T(P,Q){return Q&3&&(i=null),i==null&&(i=tT(P[0],P[1])===0),i?0:1}s=T(r,-1),n=g[s]=p[s](r);let $=r[1](r[0]).children("intro:first"),y=[];for(let P=0;P<$.length;P+=1)y[P]=pS(lS(r,$,P));const R=P=>ae(y[P],1,1,()=>{y[P]=null});let C=r[1](r[0]).children("knowl"),x=[];for(let P=0;P<C.length;P+=1)x[P]=_S(nS(r,C,P));const j=P=>ae(x[P],1,1,()=>{x[P]=null});let F=null;C.length||(F=mS(r));let q=r[1](r[0]).children("outtro:first"),W=[];for(let P=0;P<q.length;P+=1)W[P]=bS(sS(r,q,P));const ne=P=>ae(W[P],1,1,()=>{W[P]=null});return{c(){e=Ft("div"),n.c(),l=xi(),u=Ft("div");for(let P=0;P<y.length;P+=1)y[P].c();c=xi();for(let P=0;P<x.length;P+=1)x[P].c();F&&F.c(),h=xi();for(let P=0;P<W.length;P+=1)W[P].c();this.h()},l(P){e=Ut(P,"DIV",{});var Q=Vt(e);n.l(Q),l=Di(Q),u=Ut(Q,"DIV",{style:!0});var re=Vt(u);for(let Y=0;Y<y.length;Y+=1)y[Y].l(re);c=Di(re);for(let Y=0;Y<x.length;Y+=1)x[Y].l(re);F&&F.l(re),h=Di(re);for(let Y=0;Y<W.length;Y+=1)W[Y].l(re);re.forEach(ue),Q.forEach(ue),this.h()},h(){R0(u,"margin-left","3em")},m(P,Q){Ee(P,e,Q),g[s].m(e,null),vi(e,l),vi(e,u);for(let re=0;re<y.length;re+=1)y[re].m(u,null);vi(u,c);for(let re=0;re<x.length;re+=1)x[re].m(u,null);F&&F.m(u,null),vi(u,h);for(let re=0;re<W.length;re+=1)W[re].m(u,null);f=!0},p(P,[Q]){let re=s;if(s=T(P,Q),s===re?g[s].p(P,Q):(mt(),ae(g[re],1,1,()=>{g[re]=null}),gt(),n=g[s],n?n.p(P,Q):(n=g[s]=p[s](P),n.c()),ee(n,1),n.m(e,l)),Q&3){$=P[1](P[0]).children("intro:first");let Y;for(Y=0;Y<$.length;Y+=1){const _e=lS(P,$,Y);y[Y]?(y[Y].p(_e,Q),ee(y[Y],1)):(y[Y]=pS(_e),y[Y].c(),ee(y[Y],1),y[Y].m(u,c))}for(mt(),Y=$.length;Y<y.length;Y+=1)R(Y);gt()}if(Q&3){C=P[1](P[0]).children("knowl");let Y;for(Y=0;Y<C.length;Y+=1){const _e=nS(P,C,Y);x[Y]?(x[Y].p(_e,Q),ee(x[Y],1)):(x[Y]=_S(_e),x[Y].c(),ee(x[Y],1),x[Y].m(u,h))}for(mt(),Y=C.length;Y<x.length;Y+=1)j(Y);gt(),!C.length&&F?F.p(P,Q):C.length?F&&(mt(),ae(F,1,1,()=>{F=null}),gt()):(F=mS(P),F.c(),ee(F,1),F.m(u,h))}if(Q&3){q=P[1](P[0]).children("outtro:first");let Y;for(Y=0;Y<q.length;Y+=1){const _e=sS(P,q,Y);W[Y]?(W[Y].p(_e,Q),ee(W[Y],1)):(W[Y]=bS(_e),W[Y].c(),ee(W[Y],1),W[Y].m(u,null))}for(mt(),Y=q.length;Y<W.length;Y+=1)ne(Y);gt()}},i(P){if(!f){ee(n);for(let Q=0;Q<$.length;Q+=1)ee(y[Q]);for(let Q=0;Q<C.length;Q+=1)ee(x[Q]);for(let Q=0;Q<q.length;Q+=1)ee(W[Q]);f=!0}},o(P){ae(n),y=y.filter(Boolean);for(let Q=0;Q<y.length;Q+=1)ae(y[Q]);x=x.filter(Boolean);for(let Q=0;Q<x.length;Q+=1)ae(x[Q]);W=W.filter(Boolean);for(let Q=0;Q<W.length;Q+=1)ae(W[Q]);f=!1},d(P){P&&ue(e),g[s].d(),di(y,P),di(x,P),F&&F.d(),di(W,P)}}}function iP(r,e,i){let s;ns(r,Hr,l=>i(1,s=l));let{element:n}=e;return r.$$set=l=>{"element"in l&&i(0,n=l.element)},[n,s]}class iT extends Ii{constructor(e){super(),ki(this,e,iP,tP,Ai,{element:0})}}function TS(r,e,i){const s=r.slice();return s[3]=e[i],s}function rP(r){let e,i;return e=new iT({props:{element:r[3]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&5&&(l.element=s[3]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function sP(r){let e,i;return e=new eT({props:{element:r[3]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&5&&(l.element=s[3]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function nP(r){let e,i;return e=new Zb({props:{element:r[3]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&5&&(l.element=s[3]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function ES(r){let e,i,s,n;const l=[nP,sP,rP],u=[];function c(h,f){return h[3].tagName==="p"?0:h[3].tagName==="list"?1:h[1]&&h[3].tagName==="knowl"?2:-1}return~(e=c(r))&&(i=u[e]=l[e](r)),{c(){i&&i.c(),s=dt()},l(h){i&&i.l(h),s=dt()},m(h,f){~e&&u[e].m(h,f),Ee(h,s,f),n=!0},p(h,f){let p=e;e=c(h),e===p?~e&&u[e].p(h,f):(i&&(mt(),ae(u[p],1,1,()=>{u[p]=null}),gt()),~e?(i=u[e],i?i.p(h,f):(i=u[e]=l[e](h),i.c()),ee(i,1),i.m(s.parentNode,s)):i=null)},i(h){n||(ee(i),n=!0)},o(h){ae(i),n=!1},d(h){~e&&u[e].d(h),h&&ue(s)}}}function oP(r){let e,i,s=r[2](r[0]).children(),n=[];for(let u=0;u<s.length;u+=1)n[u]=ES(TS(r,s,u));const l=u=>ae(n[u],1,1,()=>{n[u]=null});return{c(){for(let u=0;u<n.length;u+=1)n[u].c();e=dt()},l(u){for(let c=0;c<n.length;c+=1)n[c].l(u);e=dt()},m(u,c){for(let h=0;h<n.length;h+=1)n[h].m(u,c);Ee(u,e,c),i=!0},p(u,[c]){if(c&7){s=u[2](u[0]).children();let h;for(h=0;h<s.length;h+=1){const f=TS(u,s,h);n[h]?(n[h].p(f,c),ee(n[h],1)):(n[h]=ES(f),n[h].c(),ee(n[h],1),n[h].m(e.parentNode,e))}for(mt(),h=s.length;h<n.length;h+=1)l(h);gt()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)ee(n[c]);i=!0}},o(u){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)ae(n[c]);i=!1},d(u){di(n,u),u&&ue(e)}}}function lP(r,e,i){let s;ns(r,Hr,u=>i(2,s=u));let{element:n}=e,{allowKnowls:l=!1}=e;return r.$$set=u=>{"element"in u&&i(0,n=u.element),"allowKnowls"in u&&i(1,l=u.allowKnowls)},[n,l,s]}class S4 extends Ii{constructor(e){super(),ki(this,e,lP,oP,Ai,{element:0,allowKnowls:1})}}function aP(r){let e,i,s;return i=new S4({props:{element:r[0],allowKnowls:r[1]}}),{c(){e=Ft("div"),st(i.$$.fragment)},l(n){e=Ut(n,"DIV",{});var l=Vt(e);nt(i.$$.fragment,l),l.forEach(ue)},m(n,l){Ee(n,e,l),ot(i,e,null),s=!0},p(n,[l]){const u={};l&1&&(u.element=n[0]),l&2&&(u.allowKnowls=n[1]),i.$set(u)},i(n){s||(ee(i.$$.fragment,n),s=!0)},o(n){ae(i.$$.fragment,n),s=!1},d(n){n&&ue(e),lt(i)}}}function uP(r,e,i){let{element:s}=e,{allowKnowls:n=!1}=e;return r.$$set=l=>{"element"in l&&i(0,s=l.element),"allowKnowls"in l&&i(1,n=l.allowKnowls)},[s,n]}class rT extends Ii{constructor(e){super(),ki(this,e,uP,aP,Ai,{element:0,allowKnowls:1})}}function $S(r,e,i){const s=r.slice();return s[2]=e[i],s}function vS(r,e,i){const s=r.slice();return s[5]=e[i],s}function yS(r,e,i){const s=r.slice();return s[8]=e[i],s}function SS(r,e,i){const s=r.slice();return s[11]=e[i],s}function IS(r,e,i){const s=r.slice();return s[14]=e[i],s}function kS(r,e,i){const s=r.slice();return s[14]=e[i],s}function cP(r){let e,i,s=r[1](r[0]).children("title:first"),n=[];for(let c=0;c<s.length;c+=1)n[c]=CS(IS(r,s,c));const l=c=>ae(n[c],1,1,()=>{n[c]=null});let u=null;return s.length||(u=AS(r)),{c(){e=Ft("h2");for(let c=0;c<n.length;c+=1)n[c].c();u&&u.c()},l(c){e=Ut(c,"H2",{});var h=Vt(e);for(let f=0;f<n.length;f+=1)n[f].l(h);u&&u.l(h),h.forEach(ue)},m(c,h){Ee(c,e,h);for(let f=0;f<n.length;f+=1)n[f].m(e,null);u&&u.m(e,null),i=!0},p(c,h){if(h&3){s=c[1](c[0]).children("title:first");let f;for(f=0;f<s.length;f+=1){const p=IS(c,s,f);n[f]?(n[f].p(p,h),ee(n[f],1)):(n[f]=CS(p),n[f].c(),ee(n[f],1),n[f].m(e,null))}for(mt(),f=s.length;f<n.length;f+=1)l(f);gt(),!s.length&&u?u.p(c,h):s.length?u&&(u.d(1),u=null):(u=AS(c),u.c(),u.m(e,null))}},i(c){if(!i){for(let h=0;h<s.length;h+=1)ee(n[h]);i=!0}},o(c){n=n.filter(Boolean);for(let h=0;h<n.length;h+=1)ae(n[h]);i=!1},d(c){c&&ue(e),di(n,c),u&&u.d()}}}function hP(r){let e,i,s=r[1](r[0]).children("title:first"),n=[];for(let c=0;c<s.length;c+=1)n[c]=wS(kS(r,s,c));const l=c=>ae(n[c],1,1,()=>{n[c]=null});let u=null;return s.length||(u=OS(r)),{c(){e=Ft("h1");for(let c=0;c<n.length;c+=1)n[c].c();u&&u.c()},l(c){e=Ut(c,"H1",{});var h=Vt(e);for(let f=0;f<n.length;f+=1)n[f].l(h);u&&u.l(h),h.forEach(ue)},m(c,h){Ee(c,e,h);for(let f=0;f<n.length;f+=1)n[f].m(e,null);u&&u.m(e,null),i=!0},p(c,h){if(h&3){s=c[1](c[0]).children("title:first");let f;for(f=0;f<s.length;f+=1){const p=kS(c,s,f);n[f]?(n[f].p(p,h),ee(n[f],1)):(n[f]=wS(p),n[f].c(),ee(n[f],1),n[f].m(e,null))}for(mt(),f=s.length;f<n.length;f+=1)l(f);gt(),!s.length&&u?u.p(c,h):s.length?u&&(u.d(1),u=null):(u=OS(c),u.c(),u.m(e,null))}},i(c){if(!i){for(let h=0;h<s.length;h+=1)ee(n[h]);i=!0}},o(c){n=n.filter(Boolean);for(let h=0;h<n.length;h+=1)ae(n[h]);i=!1},d(c){c&&ue(e),di(n,c),u&&u.d()}}}function AS(r){let e=Yo(r[0],r[1])+"",i,s,n=Cn(r[0],r[1])+"",l,u;return{c(){i=Et(e),s=xi(),l=Et(n),u=Et(".")},l(c){i=$t(c,e),s=Di(c),l=$t(c,n),u=$t(c,".")},m(c,h){Ee(c,i,h),Ee(c,s,h),Ee(c,l,h),Ee(c,u,h)},p(c,h){h&3&&e!==(e=Yo(c[0],c[1])+"")&&Li(i,e),h&3&&n!==(n=Cn(c[0],c[1])+"")&&Li(l,n)},d(c){c&&ue(i),c&&ue(s),c&&ue(l),c&&ue(u)}}}function CS(r){let e=Yo(r[0],r[1])+"",i,s,n=Cn(r[0],r[1])+"",l,u,c,h,f;return c=new ph({props:{element:r[14]}}),{c(){i=Et(e),s=xi(),l=Et(n),u=Et(`:
                `),st(c.$$.fragment),h=Et(".")},l(p){i=$t(p,e),s=Di(p),l=$t(p,n),u=$t(p,`:
                `),nt(c.$$.fragment,p),h=$t(p,".")},m(p,g){Ee(p,i,g),Ee(p,s,g),Ee(p,l,g),Ee(p,u,g),ot(c,p,g),Ee(p,h,g),f=!0},p(p,g){(!f||g&3)&&e!==(e=Yo(p[0],p[1])+"")&&Li(i,e),(!f||g&3)&&n!==(n=Cn(p[0],p[1])+"")&&Li(l,n);const T={};g&3&&(T.element=p[14]),c.$set(T)},i(p){f||(ee(c.$$.fragment,p),f=!0)},o(p){ae(c.$$.fragment,p),f=!1},d(p){p&&ue(i),p&&ue(s),p&&ue(l),p&&ue(u),lt(c,p),p&&ue(h)}}}function OS(r){let e=Yo(r[0],r[1])+"",i,s,n=Cn(r[0],r[1])+"",l,u;return{c(){i=Et(e),s=xi(),l=Et(n),u=Et(".")},l(c){i=$t(c,e),s=Di(c),l=$t(c,n),u=$t(c,".")},m(c,h){Ee(c,i,h),Ee(c,s,h),Ee(c,l,h),Ee(c,u,h)},p(c,h){h&3&&e!==(e=Yo(c[0],c[1])+"")&&Li(i,e),h&3&&n!==(n=Cn(c[0],c[1])+"")&&Li(l,n)},d(c){c&&ue(i),c&&ue(s),c&&ue(l),c&&ue(u)}}}function wS(r){let e=Yo(r[0],r[1])+"",i,s,n=Cn(r[0],r[1])+"",l,u,c,h,f;return c=new ph({props:{element:r[14]}}),{c(){i=Et(e),s=xi(),l=Et(n),u=Et(`:
                `),st(c.$$.fragment),h=Et(".")},l(p){i=$t(p,e),s=Di(p),l=$t(p,n),u=$t(p,`:
                `),nt(c.$$.fragment,p),h=$t(p,".")},m(p,g){Ee(p,i,g),Ee(p,s,g),Ee(p,l,g),Ee(p,u,g),ot(c,p,g),Ee(p,h,g),f=!0},p(p,g){(!f||g&3)&&e!==(e=Yo(p[0],p[1])+"")&&Li(i,e),(!f||g&3)&&n!==(n=Cn(p[0],p[1])+"")&&Li(l,n);const T={};g&3&&(T.element=p[14]),c.$set(T)},i(p){f||(ee(c.$$.fragment,p),f=!0)},o(p){ae(c.$$.fragment,p),f=!1},d(p){p&&ue(i),p&&ue(s),p&&ue(l),p&&ue(u),lt(c,p),p&&ue(h)}}}function RS(r){let e,i;return e=new v4({props:{element:r[11]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[11]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function NS(r){let e,i,s=r[1](r[0]).children("content:first"),n=[];for(let u=0;u<s.length;u+=1)n[u]=xS(yS(r,s,u));const l=u=>ae(n[u],1,1,()=>{n[u]=null});return{c(){for(let u=0;u<n.length;u+=1)n[u].c();e=dt()},l(u){for(let c=0;c<n.length;c+=1)n[c].l(u);e=dt()},m(u,c){for(let h=0;h<n.length;h+=1)n[h].m(u,c);Ee(u,e,c),i=!0},p(u,c){if(c&3){s=u[1](u[0]).children("content:first");let h;for(h=0;h<s.length;h+=1){const f=yS(u,s,h);n[h]?(n[h].p(f,c),ee(n[h],1)):(n[h]=xS(f),n[h].c(),ee(n[h],1),n[h].m(e.parentNode,e))}for(mt(),h=s.length;h<n.length;h+=1)l(h);gt()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)ee(n[c]);i=!0}},o(u){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)ae(n[c]);i=!1},d(u){di(n,u),u&&ue(e)}}}function xS(r){let e,i;return e=new rT({props:{element:r[8],allowKnowls:!0}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[8]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function DS(r){let e,i;return e=new I4({props:{element:r[5]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[5]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function LS(r){let e,i;return e=new y4({props:{element:r[2]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&3&&(l.element=s[2]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function dP(r){let e,i,s,n,l,u,c,h,f;const p=[hP,cP],g=[];function T(P,Q){return Q&3&&(i=null),i==null&&(i=Pc(P[0],P[1])===0),i?0:1}s=T(r,-1),n=g[s]=p[s](r);let $=r[1](r[0]).children("intro:first"),y=[];for(let P=0;P<$.length;P+=1)y[P]=RS(SS(r,$,P));const R=P=>ae(y[P],1,1,()=>{y[P]=null});let C=r[1](r[0]).children("division"),x=[];for(let P=0;P<C.length;P+=1)x[P]=DS(vS(r,C,P));const j=P=>ae(x[P],1,1,()=>{x[P]=null});let F=null;C.length||(F=NS(r));let q=r[1](r[0]).children("outtro:first"),W=[];for(let P=0;P<q.length;P+=1)W[P]=LS($S(r,q,P));const ne=P=>ae(W[P],1,1,()=>{W[P]=null});return{c(){e=Ft("div"),n.c(),l=xi(),u=Ft("div");for(let P=0;P<y.length;P+=1)y[P].c();c=xi();for(let P=0;P<x.length;P+=1)x[P].c();F&&F.c(),h=xi();for(let P=0;P<W.length;P+=1)W[P].c()},l(P){e=Ut(P,"DIV",{});var Q=Vt(e);n.l(Q),l=Di(Q),u=Ut(Q,"DIV",{});var re=Vt(u);for(let Y=0;Y<y.length;Y+=1)y[Y].l(re);c=Di(re);for(let Y=0;Y<x.length;Y+=1)x[Y].l(re);F&&F.l(re),h=Di(re);for(let Y=0;Y<W.length;Y+=1)W[Y].l(re);re.forEach(ue),Q.forEach(ue)},m(P,Q){Ee(P,e,Q),g[s].m(e,null),vi(e,l),vi(e,u);for(let re=0;re<y.length;re+=1)y[re].m(u,null);vi(u,c);for(let re=0;re<x.length;re+=1)x[re].m(u,null);F&&F.m(u,null),vi(u,h);for(let re=0;re<W.length;re+=1)W[re].m(u,null);f=!0},p(P,[Q]){let re=s;if(s=T(P,Q),s===re?g[s].p(P,Q):(mt(),ae(g[re],1,1,()=>{g[re]=null}),gt(),n=g[s],n?n.p(P,Q):(n=g[s]=p[s](P),n.c()),ee(n,1),n.m(e,l)),Q&3){$=P[1](P[0]).children("intro:first");let Y;for(Y=0;Y<$.length;Y+=1){const _e=SS(P,$,Y);y[Y]?(y[Y].p(_e,Q),ee(y[Y],1)):(y[Y]=RS(_e),y[Y].c(),ee(y[Y],1),y[Y].m(u,c))}for(mt(),Y=$.length;Y<y.length;Y+=1)R(Y);gt()}if(Q&3){C=P[1](P[0]).children("division");let Y;for(Y=0;Y<C.length;Y+=1){const _e=vS(P,C,Y);x[Y]?(x[Y].p(_e,Q),ee(x[Y],1)):(x[Y]=DS(_e),x[Y].c(),ee(x[Y],1),x[Y].m(u,h))}for(mt(),Y=C.length;Y<x.length;Y+=1)j(Y);gt(),!C.length&&F?F.p(P,Q):C.length?F&&(mt(),ae(F,1,1,()=>{F=null}),gt()):(F=NS(P),F.c(),ee(F,1),F.m(u,h))}if(Q&3){q=P[1](P[0]).children("outtro:first");let Y;for(Y=0;Y<q.length;Y+=1){const _e=$S(P,q,Y);W[Y]?(W[Y].p(_e,Q),ee(W[Y],1)):(W[Y]=LS(_e),W[Y].c(),ee(W[Y],1),W[Y].m(u,null))}for(mt(),Y=q.length;Y<W.length;Y+=1)ne(Y);gt()}},i(P){if(!f){ee(n);for(let Q=0;Q<$.length;Q+=1)ee(y[Q]);for(let Q=0;Q<C.length;Q+=1)ee(x[Q]);for(let Q=0;Q<q.length;Q+=1)ee(W[Q]);f=!0}},o(P){ae(n),y=y.filter(Boolean);for(let Q=0;Q<y.length;Q+=1)ae(y[Q]);x=x.filter(Boolean);for(let Q=0;Q<x.length;Q+=1)ae(x[Q]);W=W.filter(Boolean);for(let Q=0;Q<W.length;Q+=1)ae(W[Q]);f=!1},d(P){P&&ue(e),g[s].d(),di(y,P),di(x,P),F&&F.d(),di(W,P)}}}function fP(r,e,i){let s;ns(r,Hr,l=>i(1,s=l));let{element:n}=e;return r.$$set=l=>{"element"in l&&i(0,n=l.element)},[n,s]}class I4 extends Ii{constructor(e){super(),ki(this,e,fP,dP,Ai,{element:0})}}function MS(r,e,i){const s=r.slice();return s[3]=e[i],s}function BS(r,e,i){const s=r.slice();return s[3]=e[i],s}function PS(r,e,i){const s=r.slice();return s[3]=e[i],s}function FS(r,e,i){const s=r.slice();return s[3]=e[i],s}function US(r){let e,i,s;return i=new ph({props:{element:r[3]}}),{c(){e=Ft("h1"),st(i.$$.fragment),this.h()},l(n){e=Ut(n,"H1",{style:!0});var l=Vt(e);nt(i.$$.fragment,l),l.forEach(ue),this.h()},h(){R0(e,"text-align","center"),R0(e,"font-size","2.5em")},m(n,l){Ee(n,e,l),ot(i,e,null),s=!0},p(n,l){const u={};l&1&&(u.element=n[3]),i.$set(u)},i(n){s||(ee(i.$$.fragment,n),s=!0)},o(n){ae(i.$$.fragment,n),s=!1},d(n){n&&ue(e),lt(i)}}}function HS(r){let e,i,s=r[0].children("content:first"),n=[];for(let c=0;c<s.length;c+=1)n[c]=zS(BS(r,s,c));const l=c=>ae(n[c],1,1,()=>{n[c]=null});let u=null;return s.length||(u=GS(r)),{c(){for(let c=0;c<n.length;c+=1)n[c].c();e=dt(),u&&u.c()},l(c){for(let h=0;h<n.length;h+=1)n[h].l(c);e=dt(),u&&u.l(c)},m(c,h){for(let f=0;f<n.length;f+=1)n[f].m(c,h);Ee(c,e,h),u&&u.m(c,h),i=!0},p(c,h){if(h&1){s=c[0].children("content:first");let f;for(f=0;f<s.length;f+=1){const p=BS(c,s,f);n[f]?(n[f].p(p,h),ee(n[f],1)):(n[f]=zS(p),n[f].c(),ee(n[f],1),n[f].m(e.parentNode,e))}for(mt(),f=s.length;f<n.length;f+=1)l(f);gt(),!s.length&&u?u.p(c,h):s.length?u&&(mt(),ae(u,1,1,()=>{u=null}),gt()):(u=GS(c),u.c(),ee(u,1),u.m(e.parentNode,e))}},i(c){if(!i){for(let h=0;h<s.length;h+=1)ee(n[h]);i=!0}},o(c){n=n.filter(Boolean);for(let h=0;h<n.length;h+=1)ae(n[h]);i=!1},d(c){di(n,c),c&&ue(e),u&&u.d(c)}}}function GS(r){let e,i,s=r[0].children("knowl:first"),n=[];for(let c=0;c<s.length;c+=1)n[c]=WS(PS(r,s,c));const l=c=>ae(n[c],1,1,()=>{n[c]=null});let u=null;return s.length||(u=VS()),{c(){for(let c=0;c<n.length;c+=1)n[c].c();e=dt(),u&&u.c()},l(c){for(let h=0;h<n.length;h+=1)n[h].l(c);e=dt(),u&&u.l(c)},m(c,h){for(let f=0;f<n.length;f+=1)n[f].m(c,h);Ee(c,e,h),u&&u.m(c,h),i=!0},p(c,h){if(h&1){s=c[0].children("knowl:first");let f;for(f=0;f<s.length;f+=1){const p=PS(c,s,f);n[f]?(n[f].p(p,h),ee(n[f],1)):(n[f]=WS(p),n[f].c(),ee(n[f],1),n[f].m(e.parentNode,e))}for(mt(),f=s.length;f<n.length;f+=1)l(f);gt(),!s.length&&u?u.p(c,h):s.length?u&&(u.d(1),u=null):(u=VS(),u.c(),u.m(e.parentNode,e))}},i(c){if(!i){for(let h=0;h<s.length;h+=1)ee(n[h]);i=!0}},o(c){n=n.filter(Boolean);for(let h=0;h<n.length;h+=1)ae(n[h]);i=!1},d(c){di(n,c),c&&ue(e),u&&u.d(c)}}}function VS(r){let e,i;return{c(){e=Ft("div"),i=Et("(No SpaTeXt elements found.)"),this.h()},l(s){e=Ut(s,"DIV",{class:!0});var n=Vt(e);i=$t(n,"(No SpaTeXt elements found.)"),n.forEach(ue),this.h()},h(){Ki(e,"class","warning svelte-qolqgz")},m(s,n){Ee(s,e,n),vi(e,i)},p:Wi,d(s){s&&ue(e)}}}function WS(r){let e,i;return e=new iT({props:{element:r[3]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&1&&(l.element=s[3]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function zS(r){let e,i;return e=new rT({props:{element:r[3],allowKnowls:!0}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&1&&(l.element=s[3]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function YS(r){let e,i;return e=new I4({props:{element:r[3]}}),{c(){st(e.$$.fragment)},l(s){nt(e.$$.fragment,s)},m(s,n){ot(e,s,n),i=!0},p(s,n){const l={};n&1&&(l.element=s[3]),e.$set(l)},i(s){i||(ee(e.$$.fragment,s),i=!0)},o(s){ae(e.$$.fragment,s),i=!1},d(s){lt(e,s)}}}function pP(r){let e,i,s,n=r[0].children("title"),l=[];for(let g=0;g<n.length;g+=1)l[g]=US(FS(r,n,g));const u=g=>ae(l[g],1,1,()=>{l[g]=null});let c=r[0].children("division"),h=[];for(let g=0;g<c.length;g+=1)h[g]=YS(MS(r,c,g));const f=g=>ae(h[g],1,1,()=>{h[g]=null});let p=null;return c.length||(p=HS(r)),{c(){for(let g=0;g<l.length;g+=1)l[g].c();e=xi();for(let g=0;g<h.length;g+=1)h[g].c();i=dt(),p&&p.c()},l(g){for(let T=0;T<l.length;T+=1)l[T].l(g);e=Di(g);for(let T=0;T<h.length;T+=1)h[T].l(g);i=dt(),p&&p.l(g)},m(g,T){for(let $=0;$<l.length;$+=1)l[$].m(g,T);Ee(g,e,T);for(let $=0;$<h.length;$+=1)h[$].m(g,T);Ee(g,i,T),p&&p.m(g,T),s=!0},p(g,[T]){if(T&1){n=g[0].children("title");let $;for($=0;$<n.length;$+=1){const y=FS(g,n,$);l[$]?(l[$].p(y,T),ee(l[$],1)):(l[$]=US(y),l[$].c(),ee(l[$],1),l[$].m(e.parentNode,e))}for(mt(),$=n.length;$<l.length;$+=1)u($);gt()}if(T&1){c=g[0].children("division");let $;for($=0;$<c.length;$+=1){const y=MS(g,c,$);h[$]?(h[$].p(y,T),ee(h[$],1)):(h[$]=YS(y),h[$].c(),ee(h[$],1),h[$].m(i.parentNode,i))}for(mt(),$=c.length;$<h.length;$+=1)f($);gt(),!c.length&&p?p.p(g,T):c.length?p&&(mt(),ae(p,1,1,()=>{p=null}),gt()):(p=HS(g),p.c(),ee(p,1),p.m(i.parentNode,i))}},i(g){if(!s){for(let T=0;T<n.length;T+=1)ee(l[T]);for(let T=0;T<c.length;T+=1)ee(h[T]);s=!0}},o(g){l=l.filter(Boolean);for(let T=0;T<l.length;T+=1)ae(l[T]);h=h.filter(Boolean);for(let T=0;T<h.length;T+=1)ae(h[T]);s=!1},d(g){di(l,g),g&&ue(e),di(h,g),g&&ue(i),p&&p.d(g)}}}function mP(r,e,i){let s,n;ns(r,Hr,u=>i(2,n=u));let{stx:l}=e;return r.$$set=u=>{"stx"in u&&i(1,l=u.stx)},r.$$.update=()=>{r.$$.dirty&2&&Hr.update(()=>Nb(l,{xml:!0})),r.$$.dirty&4&&i(0,s=n("spatext:first"))},[s,l,n]}class gP extends Ii{constructor(e){super(),ki(this,e,mP,pP,Ai,{stx:1})}}class Bt{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,i,s){let n=[];return this.decompose(0,e,n,2),s.length&&s.decompose(0,s.length,n,3),this.decompose(i,this.length,n,1),En.from(n,this.length-(i-e)+s.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,i=this.length){let s=[];return this.decompose(e,i,s,0),En.from(s,i-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let i=this.scanIdentical(e,1),s=this.length-this.scanIdentical(e,-1),n=new Fc(this),l=new Fc(e);for(let u=i,c=i;;){if(n.next(u),l.next(u),u=0,n.lineBreak!=l.lineBreak||n.done!=l.done||n.value!=l.value)return!1;if(c+=n.value.length,n.done||c>=s)return!0}}iter(e=1){return new Fc(this,e)}iterRange(e,i=this.length){return new k4(this,e,i)}iterLines(e,i){let s;if(e==null)s=this.iter();else{i==null&&(i=this.lines+1);let n=this.line(e).from;s=this.iterRange(n,Math.max(n,i==this.lines+1?this.length:i<=1?0:this.line(i-1).to))}return new A4(s)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Bt.empty:e.length<=32?new $i(e):En.from($i.split(e,[]))}}class $i extends Bt{constructor(e,i=_P(e)){super(),this.text=e,this.length=i}get lines(){return this.text.length}get children(){return null}lineInner(e,i,s,n){for(let l=0;;l++){let u=this.text[l],c=n+u.length;if((i?s:c)>=e)return new bP(n,c,s,u);n=c+1,s++}}decompose(e,i,s,n){let l=e<=0&&i>=this.length?this:new $i(XS(this.text,e,i),Math.min(i,this.length)-Math.max(0,e));if(n&1){let u=s.pop(),c=$0(l.text,u.text.slice(),0,l.length);if(c.length<=32)s.push(new $i(c,u.length+l.length));else{let h=c.length>>1;s.push(new $i(c.slice(0,h)),new $i(c.slice(h)))}}else s.push(l)}replace(e,i,s){if(!(s instanceof $i))return super.replace(e,i,s);let n=$0(this.text,$0(s.text,XS(this.text,0,e)),i),l=this.length+s.length-(i-e);return n.length<=32?new $i(n,l):En.from($i.split(n,[]),l)}sliceString(e,i=this.length,s=`
`){let n="";for(let l=0,u=0;l<=i&&u<this.text.length;u++){let c=this.text[u],h=l+c.length;l>e&&u&&(n+=s),e<h&&i>l&&(n+=c.slice(Math.max(0,e-l),i-l)),l=h+1}return n}flatten(e){for(let i of this.text)e.push(i)}scanIdentical(){return 0}static split(e,i){let s=[],n=-1;for(let l of e)s.push(l),n+=l.length+1,s.length==32&&(i.push(new $i(s,n)),s=[],n=-1);return n>-1&&i.push(new $i(s,n)),i}}class En extends Bt{constructor(e,i){super(),this.children=e,this.length=i,this.lines=0;for(let s of e)this.lines+=s.lines}lineInner(e,i,s,n){for(let l=0;;l++){let u=this.children[l],c=n+u.length,h=s+u.lines-1;if((i?h:c)>=e)return u.lineInner(e,i,s,n);n=c+1,s=h+1}}decompose(e,i,s,n){for(let l=0,u=0;u<=i&&l<this.children.length;l++){let c=this.children[l],h=u+c.length;if(e<=h&&i>=u){let f=n&((u<=e?1:0)|(h>=i?2:0));u>=e&&h<=i&&!f?s.push(c):c.decompose(e-u,i-u,s,f)}u=h+1}}replace(e,i,s){if(s.lines<this.lines)for(let n=0,l=0;n<this.children.length;n++){let u=this.children[n],c=l+u.length;if(e>=l&&i<=c){let h=u.replace(e-l,i-l,s),f=this.lines-u.lines+h.lines;if(h.lines<f>>5-1&&h.lines>f>>5+1){let p=this.children.slice();return p[n]=h,new En(p,this.length-(i-e)+s.length)}return super.replace(l,c,h)}l=c+1}return super.replace(e,i,s)}sliceString(e,i=this.length,s=`
`){let n="";for(let l=0,u=0;l<this.children.length&&u<=i;l++){let c=this.children[l],h=u+c.length;u>e&&l&&(n+=s),e<h&&i>u&&(n+=c.sliceString(e-u,i-u,s)),u=h+1}return n}flatten(e){for(let i of this.children)i.flatten(e)}scanIdentical(e,i){if(!(e instanceof En))return 0;let s=0,[n,l,u,c]=i>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;n+=i,l+=i){if(n==u||l==c)return s;let h=this.children[n],f=e.children[l];if(h!=f)return s+h.scanIdentical(f,i);s+=h.length+1}}static from(e,i=e.reduce((s,n)=>s+n.length+1,-1)){let s=0;for(let $ of e)s+=$.lines;if(s<32){let $=[];for(let y of e)y.flatten($);return new $i($,i)}let n=Math.max(32,s>>5),l=n<<1,u=n>>1,c=[],h=0,f=-1,p=[];function g($){let y;if($.lines>l&&$ instanceof En)for(let R of $.children)g(R);else $.lines>u&&(h>u||!h)?(T(),c.push($)):$ instanceof $i&&h&&(y=p[p.length-1])instanceof $i&&$.lines+y.lines<=32?(h+=$.lines,f+=$.length+1,p[p.length-1]=new $i(y.text.concat($.text),y.length+1+$.length)):(h+$.lines>n&&T(),h+=$.lines,f+=$.length+1,p.push($))}function T(){h!=0&&(c.push(p.length==1?p[0]:En.from(p,f)),f=-1,h=p.length=0)}for(let $ of e)g($);return T(),c.length==1?c[0]:new En(c,i)}}Bt.empty=new $i([""],0);function _P(r){let e=-1;for(let i of r)e+=i.length+1;return e}function $0(r,e,i=0,s=1e9){for(let n=0,l=0,u=!0;l<r.length&&n<=s;l++){let c=r[l],h=n+c.length;h>=i&&(h>s&&(c=c.slice(0,s-n)),n<i&&(c=c.slice(i-n)),u?(e[e.length-1]+=c,u=!1):e.push(c)),n=h+1}return e}function XS(r,e,i){return $0(r,[""],e,i)}class Fc{constructor(e,i=1){this.dir=i,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[i>0?1:(e instanceof $i?e.text.length:e.children.length)<<1]}nextInner(e,i){for(this.done=this.lineBreak=!1;;){let s=this.nodes.length-1,n=this.nodes[s],l=this.offsets[s],u=l>>1,c=n instanceof $i?n.text.length:n.children.length;if(u==(i>0?c:0)){if(s==0)return this.done=!0,this.value="",this;i>0&&this.offsets[s-1]++,this.nodes.pop(),this.offsets.pop()}else if((l&1)==(i>0?0:1)){if(this.offsets[s]+=i,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(n instanceof $i){let h=n.text[u+(i<0?-1:0)];if(this.offsets[s]+=i,h.length>Math.max(0,e))return this.value=e==0?h:i>0?h.slice(e):h.slice(0,h.length-e),this;e-=h.length}else{let h=n.children[u+(i<0?-1:0)];e>h.length?(e-=h.length,this.offsets[s]+=i):(i<0&&this.offsets[s]--,this.nodes.push(h),this.offsets.push(i>0?1:(h instanceof $i?h.text.length:h.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class k4{constructor(e,i,s){this.value="",this.done=!1,this.cursor=new Fc(e,i>s?-1:1),this.pos=i>s?e.length:0,this.from=Math.min(i,s),this.to=Math.max(i,s)}nextInner(e,i){if(i<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,i<0?this.pos-this.to:this.from-this.pos);let s=i<0?this.pos-this.from:this.to-this.pos;e>s&&(e=s),s-=e;let{value:n}=this.cursor.next(e);return this.pos+=(n.length+e)*i,this.value=n.length<=s?n:i<0?n.slice(n.length-s):n.slice(0,s),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class A4{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:i,lineBreak:s,value:n}=this.inner.next(e);return i?(this.done=!0,this.value=""):s?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Bt.prototype[Symbol.iterator]=function(){return this.iter()},Fc.prototype[Symbol.iterator]=k4.prototype[Symbol.iterator]=A4.prototype[Symbol.iterator]=function(){return this});class bP{constructor(e,i,s,n){this.from=e,this.to=i,this.number=s,this.text=n}get length(){return this.to-this.from}}let Ya="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(r=>r?parseInt(r,36):1);for(let r=1;r<Ya.length;r++)Ya[r]+=Ya[r-1];function TP(r){for(let e=1;e<Ya.length;e+=2)if(Ya[e]>r)return Ya[e-1]<=r;return!1}function jS(r){return r>=127462&&r<=127487}const KS=8205;function vr(r,e,i=!0,s=!0){return(i?C4:EP)(r,e,s)}function C4(r,e,i){if(e==r.length)return e;e&&O4(r.charCodeAt(e))&&w4(r.charCodeAt(e-1))&&e--;let s=er(r,e);for(e+=Ts(s);e<r.length;){let n=er(r,e);if(s==KS||n==KS||i&&TP(n))e+=Ts(n),s=n;else if(jS(n)){let l=0,u=e-2;for(;u>=0&&jS(er(r,u));)l++,u-=2;if(l%2==0)break;e+=2}else break}return e}function EP(r,e,i){for(;e>0;){let s=C4(r,e-2,i);if(s<e)return s;e--}return 0}function O4(r){return r>=56320&&r<57344}function w4(r){return r>=55296&&r<56320}function er(r,e){let i=r.charCodeAt(e);if(!w4(i)||e+1==r.length)return i;let s=r.charCodeAt(e+1);return O4(s)?(i-55296<<10)+(s-56320)+65536:i}function sT(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function Ts(r){return r<65536?1:2}const g_=/\r\n?|\n/;var Er=function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r}(Er||(Er={}));class kn{constructor(e){this.sections=e}get length(){let e=0;for(let i=0;i<this.sections.length;i+=2)e+=this.sections[i];return e}get newLength(){let e=0;for(let i=0;i<this.sections.length;i+=2){let s=this.sections[i+1];e+=s<0?this.sections[i]:s}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let i=0,s=0,n=0;i<this.sections.length;){let l=this.sections[i++],u=this.sections[i++];u<0?(e(s,n,l),n+=l):n+=u,s+=l}}iterChangedRanges(e,i=!1){__(this,e,i)}get invertedDesc(){let e=[];for(let i=0;i<this.sections.length;){let s=this.sections[i++],n=this.sections[i++];n<0?e.push(s,n):e.push(n,s)}return new kn(e)}composeDesc(e){return this.empty?e:e.empty?this:R4(this,e)}mapDesc(e,i=!1){return e.empty?this:b_(this,e,i)}mapPos(e,i=-1,s=Er.Simple){let n=0,l=0;for(let u=0;u<this.sections.length;){let c=this.sections[u++],h=this.sections[u++],f=n+c;if(h<0){if(f>e)return l+(e-n);l+=c}else{if(s!=Er.Simple&&f>=e&&(s==Er.TrackDel&&n<e&&f>e||s==Er.TrackBefore&&n<e||s==Er.TrackAfter&&f>e))return null;if(f>e||f==e&&i<0&&!c)return e==n||i<0?l:l+h;l+=h}n=f}if(e>n)throw new RangeError(`Position ${e} is out of range for changeset of length ${n}`);return l}touchesRange(e,i=e){for(let s=0,n=0;s<this.sections.length&&n<=i;){let l=this.sections[s++],u=this.sections[s++],c=n+l;if(u>=0&&n<=i&&c>=e)return n<e&&c>i?"cover":!0;n=c}return!1}toString(){let e="";for(let i=0;i<this.sections.length;){let s=this.sections[i++],n=this.sections[i++];e+=(e?" ":"")+s+(n>=0?":"+n:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(i=>typeof i!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new kn(e)}static create(e){return new kn(e)}}class Hi extends kn{constructor(e,i){super(e),this.inserted=i}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return __(this,(i,s,n,l,u)=>e=e.replace(n,n+(s-i),u),!1),e}mapDesc(e,i=!1){return b_(this,e,i,!0)}invert(e){let i=this.sections.slice(),s=[];for(let n=0,l=0;n<i.length;n+=2){let u=i[n],c=i[n+1];if(c>=0){i[n]=c,i[n+1]=u;let h=n>>1;for(;s.length<h;)s.push(Bt.empty);s.push(u?e.slice(l,l+u):Bt.empty)}l+=u}return new Hi(i,s)}compose(e){return this.empty?e:e.empty?this:R4(this,e,!0)}map(e,i=!1){return e.empty?this:b_(this,e,i,!0)}iterChanges(e,i=!1){__(this,e,i)}get desc(){return kn.create(this.sections)}filter(e){let i=[],s=[],n=[],l=new Kc(this);e:for(let u=0,c=0;;){let h=u==e.length?1e9:e[u++];for(;c<h||c==h&&l.len==0;){if(l.done)break e;let p=Math.min(l.len,h-c);cr(n,p,-1);let g=l.ins==-1?-1:l.off==0?l.ins:0;cr(i,p,g),g>0&&Mo(s,i,l.text),l.forward(p),c+=p}let f=e[u++];for(;c<f;){if(l.done)break e;let p=Math.min(l.len,f-c);cr(i,p,-1),cr(n,p,l.ins==-1?-1:l.off==0?l.ins:0),l.forward(p),c+=p}}return{changes:new Hi(i,s),filtered:kn.create(n)}}toJSON(){let e=[];for(let i=0;i<this.sections.length;i+=2){let s=this.sections[i],n=this.sections[i+1];n<0?e.push(s):n==0?e.push([s]):e.push([s].concat(this.inserted[i>>1].toJSON()))}return e}static of(e,i,s){let n=[],l=[],u=0,c=null;function h(p=!1){if(!p&&!n.length)return;u<i&&cr(n,i-u,-1);let g=new Hi(n,l);c=c?c.compose(g.map(c)):g,n=[],l=[],u=0}function f(p){if(Array.isArray(p))for(let g of p)f(g);else if(p instanceof Hi){if(p.length!=i)throw new RangeError(`Mismatched change set length (got ${p.length}, expected ${i})`);h(),c=c?c.compose(p.map(c)):p}else{let{from:g,to:T=g,insert:$}=p;if(g>T||g<0||T>i)throw new RangeError(`Invalid change range ${g} to ${T} (in doc of length ${i})`);let y=$?typeof $=="string"?Bt.of($.split(s||g_)):$:Bt.empty,R=y.length;if(g==T&&R==0)return;g<u&&h(),g>u&&cr(n,g-u,-1),cr(n,T-g,R),Mo(l,n,y),u=T}}return f(e),h(!c),c}static empty(e){return new Hi(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let i=[],s=[];for(let n=0;n<e.length;n++){let l=e[n];if(typeof l=="number")i.push(l,-1);else{if(!Array.isArray(l)||typeof l[0]!="number"||l.some((u,c)=>c&&typeof u!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(l.length==1)i.push(l[0],0);else{for(;s.length<n;)s.push(Bt.empty);s[n]=Bt.of(l.slice(1)),i.push(l[0],s[n].length)}}}return new Hi(i,s)}static createSet(e,i){return new Hi(e,i)}}function cr(r,e,i,s=!1){if(e==0&&i<=0)return;let n=r.length-2;n>=0&&i<=0&&i==r[n+1]?r[n]+=e:e==0&&r[n]==0?r[n+1]+=i:s?(r[n]+=e,r[n+1]+=i):r.push(e,i)}function Mo(r,e,i){if(i.length==0)return;let s=e.length-2>>1;if(s<r.length)r[r.length-1]=r[r.length-1].append(i);else{for(;r.length<s;)r.push(Bt.empty);r.push(i)}}function __(r,e,i){let s=r.inserted;for(let n=0,l=0,u=0;u<r.sections.length;){let c=r.sections[u++],h=r.sections[u++];if(h<0)n+=c,l+=c;else{let f=n,p=l,g=Bt.empty;for(;f+=c,p+=h,h&&s&&(g=g.append(s[u-2>>1])),!(i||u==r.sections.length||r.sections[u+1]<0);)c=r.sections[u++],h=r.sections[u++];e(n,f,l,p,g),n=f,l=p}}}function b_(r,e,i,s=!1){let n=[],l=s?[]:null,u=new Kc(r),c=new Kc(e);for(let h=-1;;)if(u.ins==-1&&c.ins==-1){let f=Math.min(u.len,c.len);cr(n,f,-1),u.forward(f),c.forward(f)}else if(c.ins>=0&&(u.ins<0||h==u.i||u.off==0&&(c.len<u.len||c.len==u.len&&!i))){let f=c.len;for(cr(n,c.ins,-1);f;){let p=Math.min(u.len,f);u.ins>=0&&h<u.i&&u.len<=p&&(cr(n,0,u.ins),l&&Mo(l,n,u.text),h=u.i),u.forward(p),f-=p}c.next()}else if(u.ins>=0){let f=0,p=u.len;for(;p;)if(c.ins==-1){let g=Math.min(p,c.len);f+=g,p-=g,c.forward(g)}else if(c.ins==0&&c.len<p)p-=c.len,c.next();else break;cr(n,f,h<u.i?u.ins:0),l&&h<u.i&&Mo(l,n,u.text),h=u.i,u.forward(u.len-p)}else{if(u.done&&c.done)return l?Hi.createSet(n,l):kn.create(n);throw new Error("Mismatched change set lengths")}}function R4(r,e,i=!1){let s=[],n=i?[]:null,l=new Kc(r),u=new Kc(e);for(let c=!1;;){if(l.done&&u.done)return n?Hi.createSet(s,n):kn.create(s);if(l.ins==0)cr(s,l.len,0,c),l.next();else if(u.len==0&&!u.done)cr(s,0,u.ins,c),n&&Mo(n,s,u.text),u.next();else{if(l.done||u.done)throw new Error("Mismatched change set lengths");{let h=Math.min(l.len2,u.len),f=s.length;if(l.ins==-1){let p=u.ins==-1?-1:u.off?0:u.ins;cr(s,h,p,c),n&&p&&Mo(n,s,u.text)}else u.ins==-1?(cr(s,l.off?0:l.len,h,c),n&&Mo(n,s,l.textBit(h))):(cr(s,l.off?0:l.len,u.off?0:u.ins,c),n&&!u.off&&Mo(n,s,u.text));c=(l.ins>h||u.ins>=0&&u.len>h)&&(c||s.length>f),l.forward2(h),u.forward(h)}}}}class Kc{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length?Bt.empty:e[i]}textBit(e){let{inserted:i}=this.set,s=this.i-2>>1;return s>=i.length&&!e?Bt.empty:i[s].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Ll{constructor(e,i,s){this.from=e,this.to=i,this.flags=s}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,i=-1){let s,n;return this.empty?s=n=e.mapPos(this.from,i):(s=e.mapPos(this.from,1),n=e.mapPos(this.to,-1)),s==this.from&&n==this.to?this:new Ll(s,n,this.flags)}extend(e,i=e){if(e<=this.anchor&&i>=this.anchor)return he.range(e,i);let s=Math.abs(e-this.anchor)>Math.abs(i-this.anchor)?e:i;return he.range(this.anchor,s)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return he.range(e.anchor,e.head)}static create(e,i,s){return new Ll(e,i,s)}}class he{constructor(e,i){this.ranges=e,this.mainIndex=i}map(e,i=-1){return e.empty?this:he.create(this.ranges.map(s=>s.map(e,i)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new he([this.main],0)}addRange(e,i=!0){return he.create([e].concat(this.ranges),i?0:this.mainIndex+1)}replaceRange(e,i=this.mainIndex){let s=this.ranges.slice();return s[i]=e,he.create(s,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new he(e.ranges.map(i=>Ll.fromJSON(i)),e.main)}static single(e,i=e){return new he([he.range(e,i)],0)}static create(e,i=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let s=0,n=0;n<e.length;n++){let l=e[n];if(l.empty?l.from<=s:l.from<s)return he.normalized(e.slice(),i);s=l.to}return new he(e,i)}static cursor(e,i=0,s,n){return Ll.create(e,e,(i==0?0:i<0?4:8)|(s==null?3:Math.min(2,s))|(n??33554431)<<5)}static range(e,i,s,n){let l=(s??33554431)<<5|(n==null?3:Math.min(2,n));return i<e?Ll.create(i,e,24|l):Ll.create(e,i,(i>e?4:0)|l)}static normalized(e,i=0){let s=e[i];e.sort((n,l)=>n.from-l.from),i=e.indexOf(s);for(let n=1;n<e.length;n++){let l=e[n],u=e[n-1];if(l.empty?l.from<=u.to:l.from<u.to){let c=u.from,h=Math.max(l.to,u.to);n<=i&&i--,e.splice(--n,2,l.anchor>l.head?he.range(h,c):he.range(c,h))}}return new he(e,i)}}function N4(r,e){for(let i of r.ranges)if(i.to>e)throw new RangeError("Selection points outside of document")}let nT=0;class Pe{constructor(e,i,s,n,l){this.combine=e,this.compareInput=i,this.compare=s,this.isStatic=n,this.id=nT++,this.default=e([]),this.extensions=typeof l=="function"?l(this):l}static define(e={}){return new Pe(e.combine||(i=>i),e.compareInput||((i,s)=>i===s),e.compare||(e.combine?(i,s)=>i===s:oT),!!e.static,e.enables)}of(e){return new v0([],this,0,e)}compute(e,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new v0(e,this,1,i)}computeN(e,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new v0(e,this,2,i)}from(e,i){return i||(i=s=>s),this.compute([e],s=>i(s.field(e)))}}function oT(r,e){return r==e||r.length==e.length&&r.every((i,s)=>i===e[s])}class v0{constructor(e,i,s,n){this.dependencies=e,this.facet=i,this.type=s,this.value=n,this.id=nT++}dynamicSlot(e){var i;let s=this.value,n=this.facet.compareInput,l=this.id,u=e[l]>>1,c=this.type==2,h=!1,f=!1,p=[];for(let g of this.dependencies)g=="doc"?h=!0:g=="selection"?f=!0:((i=e[g.id])!==null&&i!==void 0?i:1)&1||p.push(e[g.id]);return{create(g){return g.values[u]=s(g),1},update(g,T){if(h&&T.docChanged||f&&(T.docChanged||T.selection)||T_(g,p)){let $=s(g);if(c?!qS($,g.values[u],n):!n($,g.values[u]))return g.values[u]=$,1}return 0},reconfigure:(g,T)=>{let $,y=T.config.address[l];if(y!=null){let R=j0(T,y);if(this.dependencies.every(C=>C instanceof Pe?T.facet(C)===g.facet(C):C instanceof sr?T.field(C,!1)==g.field(C,!1):!0)||(c?qS($=s(g),R,n):n($=s(g),R)))return g.values[u]=R,0}else $=s(g);return g.values[u]=$,1}}}}function qS(r,e,i){if(r.length!=e.length)return!1;for(let s=0;s<r.length;s++)if(!i(r[s],e[s]))return!1;return!0}function T_(r,e){let i=!1;for(let s of e)Uc(r,s)&1&&(i=!0);return i}function $P(r,e,i){let s=i.map(h=>r[h.id]),n=i.map(h=>h.type),l=s.filter(h=>!(h&1)),u=r[e.id]>>1;function c(h){let f=[];for(let p=0;p<s.length;p++){let g=j0(h,s[p]);if(n[p]==2)for(let T of g)f.push(T);else f.push(g)}return e.combine(f)}return{create(h){for(let f of s)Uc(h,f);return h.values[u]=c(h),1},update(h,f){if(!T_(h,l))return 0;let p=c(h);return e.compare(p,h.values[u])?0:(h.values[u]=p,1)},reconfigure(h,f){let p=T_(h,s),g=f.config.facets[e.id],T=f.facet(e);if(g&&!p&&oT(i,g))return h.values[u]=T,0;let $=c(h);return e.compare($,T)?(h.values[u]=T,0):(h.values[u]=$,1)}}}const JS=Pe.define({static:!0});class sr{constructor(e,i,s,n,l){this.id=e,this.createF=i,this.updateF=s,this.compareF=n,this.spec=l,this.provides=void 0}static define(e){let i=new sr(nT++,e.create,e.update,e.compare||((s,n)=>s===n),e);return e.provide&&(i.provides=e.provide(i)),i}create(e){let i=e.facet(JS).find(s=>s.field==this);return((i==null?void 0:i.create)||this.createF)(e)}slot(e){let i=e[this.id]>>1;return{create:s=>(s.values[i]=this.create(s),1),update:(s,n)=>{let l=s.values[i],u=this.updateF(l,n);return this.compareF(l,u)?0:(s.values[i]=u,1)},reconfigure:(s,n)=>n.config.address[this.id]!=null?(s.values[i]=n.field(this),0):(s.values[i]=this.create(s),1)}}init(e){return[this,JS.of({field:this,create:e})]}get extension(){return this}}const Nl={lowest:4,low:3,default:2,high:1,highest:0};function bc(r){return e=>new x4(e,r)}const pu={highest:bc(Nl.highest),high:bc(Nl.high),default:bc(Nl.default),low:bc(Nl.low),lowest:bc(Nl.lowest)};class x4{constructor(e,i){this.inner=e,this.prec=i}}class ep{of(e){return new E_(this,e)}reconfigure(e){return ep.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class E_{constructor(e,i){this.compartment=e,this.inner=i}}class X0{constructor(e,i,s,n,l,u){for(this.base=e,this.compartments=i,this.dynamicSlots=s,this.address=n,this.staticValues=l,this.facets=u,this.statusTemplate=[];this.statusTemplate.length<s.length;)this.statusTemplate.push(0)}staticFacet(e){let i=this.address[e.id];return i==null?e.default:this.staticValues[i>>1]}static resolve(e,i,s){let n=[],l=Object.create(null),u=new Map;for(let T of vP(e,i,u))T instanceof sr?n.push(T):(l[T.facet.id]||(l[T.facet.id]=[])).push(T);let c=Object.create(null),h=[],f=[];for(let T of n)c[T.id]=f.length<<1,f.push($=>T.slot($));let p=s==null?void 0:s.config.facets;for(let T in l){let $=l[T],y=$[0].facet,R=p&&p[T]||[];if($.every(C=>C.type==0))if(c[y.id]=h.length<<1|1,oT(R,$))h.push(s.facet(y));else{let C=y.combine($.map(x=>x.value));h.push(s&&y.compare(C,s.facet(y))?s.facet(y):C)}else{for(let C of $)C.type==0?(c[C.id]=h.length<<1|1,h.push(C.value)):(c[C.id]=f.length<<1,f.push(x=>C.dynamicSlot(x)));c[y.id]=f.length<<1,f.push(C=>$P(C,y,$))}}let g=f.map(T=>T(c));return new X0(e,u,g,c,h,l)}}function vP(r,e,i){let s=[[],[],[],[],[]],n=new Map;function l(u,c){let h=n.get(u);if(h!=null){if(h<=c)return;let f=s[h].indexOf(u);f>-1&&s[h].splice(f,1),u instanceof E_&&i.delete(u.compartment)}if(n.set(u,c),Array.isArray(u))for(let f of u)l(f,c);else if(u instanceof E_){if(i.has(u.compartment))throw new RangeError("Duplicate use of compartment in extensions");let f=e.get(u.compartment)||u.inner;i.set(u.compartment,f),l(f,c)}else if(u instanceof x4)l(u.inner,u.prec);else if(u instanceof sr)s[c].push(u),u.provides&&l(u.provides,c);else if(u instanceof v0)s[c].push(u),u.facet.extensions&&l(u.facet.extensions,Nl.default);else{let f=u.extension;if(!f)throw new Error(`Unrecognized extension value in extension set (${u}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);l(f,c)}}return l(r,Nl.default),s.reduce((u,c)=>u.concat(c))}function Uc(r,e){if(e&1)return 2;let i=e>>1,s=r.status[i];if(s==4)throw new Error("Cyclic dependency between fields and/or facets");if(s&2)return s;r.status[i]=4;let n=r.computeSlot(r,r.config.dynamicSlots[i]);return r.status[i]=2|n}function j0(r,e){return e&1?r.config.staticValues[e>>1]:r.values[e>>1]}const D4=Pe.define(),L4=Pe.define({combine:r=>r.some(e=>e),static:!0}),M4=Pe.define({combine:r=>r.length?r[0]:void 0,static:!0}),B4=Pe.define(),P4=Pe.define(),F4=Pe.define(),U4=Pe.define({combine:r=>r.length?r[0]:!1});class ho{constructor(e,i){this.type=e,this.value=i}static define(){return new yP}}class yP{of(e){return new ho(this,e)}}class SP{constructor(e){this.map=e}of(e){return new ct(this,e)}}class ct{constructor(e,i){this.type=e,this.value=i}map(e){let i=this.type.map(this.value,e);return i===void 0?void 0:i==this.value?this:new ct(this.type,i)}is(e){return this.type==e}static define(e={}){return new SP(e.map||(i=>i))}static mapEffects(e,i){if(!e.length)return e;let s=[];for(let n of e){let l=n.map(i);l&&s.push(l)}return s}}ct.reconfigure=ct.define();ct.appendConfig=ct.define();class Vi{constructor(e,i,s,n,l,u){this.startState=e,this.changes=i,this.selection=s,this.effects=n,this.annotations=l,this.scrollIntoView=u,this._doc=null,this._state=null,s&&N4(s,i.newLength),l.some(c=>c.type==Vi.time)||(this.annotations=l.concat(Vi.time.of(Date.now())))}static create(e,i,s,n,l,u){return new Vi(e,i,s,n,l,u)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let i of this.annotations)if(i.type==e)return i.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let i=this.annotation(Vi.userEvent);return!!(i&&(i==e||i.length>e.length&&i.slice(0,e.length)==e&&i[e.length]=="."))}}Vi.time=ho.define();Vi.userEvent=ho.define();Vi.addToHistory=ho.define();Vi.remote=ho.define();function IP(r,e){let i=[];for(let s=0,n=0;;){let l,u;if(s<r.length&&(n==e.length||e[n]>=r[s]))l=r[s++],u=r[s++];else if(n<e.length)l=e[n++],u=e[n++];else return i;!i.length||i[i.length-1]<l?i.push(l,u):i[i.length-1]<u&&(i[i.length-1]=u)}}function H4(r,e,i){var s;let n,l,u;return i?(n=e.changes,l=Hi.empty(e.changes.length),u=r.changes.compose(e.changes)):(n=e.changes.map(r.changes),l=r.changes.mapDesc(e.changes,!0),u=r.changes.compose(n)),{changes:u,selection:e.selection?e.selection.map(l):(s=r.selection)===null||s===void 0?void 0:s.map(n),effects:ct.mapEffects(r.effects,n).concat(ct.mapEffects(e.effects,l)),annotations:r.annotations.length?r.annotations.concat(e.annotations):e.annotations,scrollIntoView:r.scrollIntoView||e.scrollIntoView}}function $_(r,e,i){let s=e.selection,n=Xa(e.annotations);return e.userEvent&&(n=n.concat(Vi.userEvent.of(e.userEvent))),{changes:e.changes instanceof Hi?e.changes:Hi.of(e.changes||[],i,r.facet(M4)),selection:s&&(s instanceof he?s:he.single(s.anchor,s.head)),effects:Xa(e.effects),annotations:n,scrollIntoView:!!e.scrollIntoView}}function G4(r,e,i){let s=$_(r,e.length?e[0]:{},r.doc.length);e.length&&e[0].filter===!1&&(i=!1);for(let l=1;l<e.length;l++){e[l].filter===!1&&(i=!1);let u=!!e[l].sequential;s=H4(s,$_(r,e[l],u?s.changes.newLength:r.doc.length),u)}let n=Vi.create(r,s.changes,s.selection,s.effects,s.annotations,s.scrollIntoView);return AP(i?kP(n):n)}function kP(r){let e=r.startState,i=!0;for(let n of e.facet(B4)){let l=n(r);if(l===!1){i=!1;break}Array.isArray(l)&&(i=i===!0?l:IP(i,l))}if(i!==!0){let n,l;if(i===!1)l=r.changes.invertedDesc,n=Hi.empty(e.doc.length);else{let u=r.changes.filter(i);n=u.changes,l=u.filtered.mapDesc(u.changes).invertedDesc}r=Vi.create(e,n,r.selection&&r.selection.map(l),ct.mapEffects(r.effects,l),r.annotations,r.scrollIntoView)}let s=e.facet(P4);for(let n=s.length-1;n>=0;n--){let l=s[n](r);l instanceof Vi?r=l:Array.isArray(l)&&l.length==1&&l[0]instanceof Vi?r=l[0]:r=G4(e,Xa(l),!1)}return r}function AP(r){let e=r.startState,i=e.facet(F4),s=r;for(let n=i.length-1;n>=0;n--){let l=i[n](r);l&&Object.keys(l).length&&(s=H4(s,$_(e,l,r.changes.newLength),!0))}return s==r?r:Vi.create(e,r.changes,r.selection,s.effects,s.annotations,s.scrollIntoView)}const CP=[];function Xa(r){return r==null?CP:Array.isArray(r)?r:[r]}var si=function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r}(si||(si={}));const OP=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let v_;try{v_=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function wP(r){if(v_)return v_.test(r);for(let e=0;e<r.length;e++){let i=r[e];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||OP.test(i)))return!0}return!1}function RP(r){return e=>{if(!/\S/.test(e))return si.Space;if(wP(e))return si.Word;for(let i=0;i<r.length;i++)if(e.indexOf(r[i])>-1)return si.Word;return si.Other}}class xt{constructor(e,i,s,n,l,u){this.config=e,this.doc=i,this.selection=s,this.values=n,this.status=e.statusTemplate.slice(),this.computeSlot=l,u&&(u._state=this);for(let c=0;c<this.config.dynamicSlots.length;c++)Uc(this,c<<1);this.computeSlot=null}field(e,i=!0){let s=this.config.address[e.id];if(s==null){if(i)throw new RangeError("Field is not present in this state");return}return Uc(this,s),j0(this,s)}update(...e){return G4(this,e,!0)}applyTransaction(e){let i=this.config,{base:s,compartments:n}=i;for(let u of e.effects)u.is(ep.reconfigure)?(i&&(n=new Map,i.compartments.forEach((c,h)=>n.set(h,c)),i=null),n.set(u.value.compartment,u.value.extension)):u.is(ct.reconfigure)?(i=null,s=u.value):u.is(ct.appendConfig)&&(i=null,s=Xa(s).concat(u.value));let l;i?l=e.startState.values.slice():(i=X0.resolve(s,n,this),l=new xt(i,this.doc,this.selection,i.dynamicSlots.map(()=>null),(c,h)=>h.reconfigure(c,this),null).values),new xt(i,e.newDoc,e.newSelection,l,(u,c)=>c.update(u,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:e},range:he.cursor(i.from+e.length)}))}changeByRange(e){let i=this.selection,s=e(i.ranges[0]),n=this.changes(s.changes),l=[s.range],u=Xa(s.effects);for(let c=1;c<i.ranges.length;c++){let h=e(i.ranges[c]),f=this.changes(h.changes),p=f.map(n);for(let T=0;T<c;T++)l[T]=l[T].map(p);let g=n.mapDesc(f,!0);l.push(h.range.map(g)),n=n.compose(p),u=ct.mapEffects(u,p).concat(ct.mapEffects(Xa(h.effects),g))}return{changes:n,selection:he.create(l,i.mainIndex),effects:u}}changes(e=[]){return e instanceof Hi?e:Hi.of(e,this.doc.length,this.facet(xt.lineSeparator))}toText(e){return Bt.of(e.split(this.facet(xt.lineSeparator)||g_))}sliceDoc(e=0,i=this.doc.length){return this.doc.sliceString(e,i,this.lineBreak)}facet(e){let i=this.config.address[e.id];return i==null?e.default:(Uc(this,i),j0(this,i))}toJSON(e){let i={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let s in e){let n=e[s];n instanceof sr&&this.config.address[n.id]!=null&&(i[s]=n.spec.toJSON(this.field(e[s]),this))}return i}static fromJSON(e,i={},s){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(s){for(let l in s)if(Object.prototype.hasOwnProperty.call(e,l)){let u=s[l],c=e[l];n.push(u.init(h=>u.spec.fromJSON(c,h)))}}return xt.create({doc:e.doc,selection:he.fromJSON(e.selection),extensions:i.extensions?n.concat([i.extensions]):n})}static create(e={}){let i=X0.resolve(e.extensions||[],new Map),s=e.doc instanceof Bt?e.doc:Bt.of((e.doc||"").split(i.staticFacet(xt.lineSeparator)||g_)),n=e.selection?e.selection instanceof he?e.selection:he.single(e.selection.anchor,e.selection.head):he.single(0);return N4(n,s.length),i.staticFacet(L4)||(n=n.asSingle()),new xt(i,s,n,i.dynamicSlots.map(()=>null),(l,u)=>u.create(l),null)}get tabSize(){return this.facet(xt.tabSize)}get lineBreak(){return this.facet(xt.lineSeparator)||`
`}get readOnly(){return this.facet(U4)}phrase(e,...i){for(let s of this.facet(xt.phrases))if(Object.prototype.hasOwnProperty.call(s,e)){e=s[e];break}return i.length&&(e=e.replace(/\$(\$|\d*)/g,(s,n)=>{if(n=="$")return"$";let l=+(n||1);return!l||l>i.length?s:i[l-1]})),e}languageDataAt(e,i,s=-1){let n=[];for(let l of this.facet(D4))for(let u of l(this,i,s))Object.prototype.hasOwnProperty.call(u,e)&&n.push(u[e]);return n}charCategorizer(e){return RP(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:i,from:s,length:n}=this.doc.lineAt(e),l=this.charCategorizer(e),u=e-s,c=e-s;for(;u>0;){let h=vr(i,u,!1);if(l(i.slice(h,u))!=si.Word)break;u=h}for(;c<n;){let h=vr(i,c);if(l(i.slice(c,h))!=si.Word)break;c=h}return u==c?null:he.range(u+s,c+s)}}xt.allowMultipleSelections=L4;xt.tabSize=Pe.define({combine:r=>r.length?r[0]:4});xt.lineSeparator=M4;xt.readOnly=U4;xt.phrases=Pe.define({compare(r,e){let i=Object.keys(r),s=Object.keys(e);return i.length==s.length&&i.every(n=>r[n]==e[n])}});xt.languageData=D4;xt.changeFilter=B4;xt.transactionFilter=P4;xt.transactionExtender=F4;ep.reconfigure=ct.define();function xn(r,e,i={}){let s={};for(let n of r)for(let l of Object.keys(n)){let u=n[l],c=s[l];if(c===void 0)s[l]=u;else if(!(c===u||u===void 0))if(Object.hasOwnProperty.call(i,l))s[l]=i[l](c,u);else throw new Error("Config merge conflict for field "+l)}for(let n in e)s[n]===void 0&&(s[n]=e[n]);return s}class Hl{eq(e){return this==e}range(e,i=e){return y_.create(e,i,this)}}Hl.prototype.startSide=Hl.prototype.endSide=0;Hl.prototype.point=!1;Hl.prototype.mapMode=Er.TrackDel;let y_=class V4{constructor(e,i,s){this.from=e,this.to=i,this.value=s}static create(e,i,s){return new V4(e,i,s)}};function S_(r,e){return r.from-e.from||r.value.startSide-e.value.startSide}class lT{constructor(e,i,s,n){this.from=e,this.to=i,this.value=s,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(e,i,s,n=0){let l=s?this.to:this.from;for(let u=n,c=l.length;;){if(u==c)return u;let h=u+c>>1,f=l[h]-e||(s?this.value[h].endSide:this.value[h].startSide)-i;if(h==u)return f>=0?u:c;f>=0?c=h:u=h+1}}between(e,i,s,n){for(let l=this.findIndex(i,-1e9,!0),u=this.findIndex(s,1e9,!1,l);l<u;l++)if(n(this.from[l]+e,this.to[l]+e,this.value[l])===!1)return!1}map(e,i){let s=[],n=[],l=[],u=-1,c=-1;for(let h=0;h<this.value.length;h++){let f=this.value[h],p=this.from[h]+e,g=this.to[h]+e,T,$;if(p==g){let y=i.mapPos(p,f.startSide,f.mapMode);if(y==null||(T=$=y,f.startSide!=f.endSide&&($=i.mapPos(p,f.endSide),$<T)))continue}else if(T=i.mapPos(p,f.startSide),$=i.mapPos(g,f.endSide),T>$||T==$&&f.startSide>0&&f.endSide<=0)continue;($-T||f.endSide-f.startSide)<0||(u<0&&(u=T),f.point&&(c=Math.max(c,$-T)),s.push(f),n.push(T-u),l.push($-u))}return{mapped:s.length?new lT(n,l,s,c):null,pos:u}}}class Ht{constructor(e,i,s,n){this.chunkPos=e,this.chunk=i,this.nextLayer=s,this.maxPoint=n}static create(e,i,s,n){return new Ht(e,i,s,n)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let i of this.chunk)e+=i.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:i=[],sort:s=!1,filterFrom:n=0,filterTo:l=this.length}=e,u=e.filter;if(i.length==0&&!u)return this;if(s&&(i=i.slice().sort(S_)),this.isEmpty)return i.length?Ht.of(i):this;let c=new W4(this,null,-1).goto(0),h=0,f=[],p=new jo;for(;c.value||h<i.length;)if(h<i.length&&(c.from-i[h].from||c.startSide-i[h].value.startSide)>=0){let g=i[h++];p.addInner(g.from,g.to,g.value)||f.push(g)}else c.rangeIndex==1&&c.chunkIndex<this.chunk.length&&(h==i.length||this.chunkEnd(c.chunkIndex)<i[h].from)&&(!u||n>this.chunkEnd(c.chunkIndex)||l<this.chunkPos[c.chunkIndex])&&p.addChunk(this.chunkPos[c.chunkIndex],this.chunk[c.chunkIndex])?c.nextChunk():((!u||n>c.to||l<c.from||u(c.from,c.to,c.value))&&(p.addInner(c.from,c.to,c.value)||f.push(y_.create(c.from,c.to,c.value))),c.next());return p.finishInner(this.nextLayer.isEmpty&&!f.length?Ht.empty:this.nextLayer.update({add:f,filter:u,filterFrom:n,filterTo:l}))}map(e){if(e.empty||this.isEmpty)return this;let i=[],s=[],n=-1;for(let u=0;u<this.chunk.length;u++){let c=this.chunkPos[u],h=this.chunk[u],f=e.touchesRange(c,c+h.length);if(f===!1)n=Math.max(n,h.maxPoint),i.push(h),s.push(e.mapPos(c));else if(f===!0){let{mapped:p,pos:g}=h.map(c,e);p&&(n=Math.max(n,p.maxPoint),i.push(p),s.push(g))}}let l=this.nextLayer.map(e);return i.length==0?l:new Ht(s,i,l||Ht.empty,n)}between(e,i,s){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let l=this.chunkPos[n],u=this.chunk[n];if(i>=l&&e<=l+u.length&&u.between(l,e-l,i-l,s)===!1)return}this.nextLayer.between(e,i,s)}}iter(e=0){return qc.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,i=0){return qc.from(e).goto(i)}static compare(e,i,s,n,l=-1){let u=e.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=l),c=i.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=l),h=QS(u,c,s),f=new Tc(u,h,l),p=new Tc(c,h,l);s.iterGaps((g,T,$)=>ZS(f,g,p,T,$,n)),s.empty&&s.length==0&&ZS(f,0,p,0,0,n)}static eq(e,i,s=0,n){n==null&&(n=1e9-1);let l=e.filter(p=>!p.isEmpty&&i.indexOf(p)<0),u=i.filter(p=>!p.isEmpty&&e.indexOf(p)<0);if(l.length!=u.length)return!1;if(!l.length)return!0;let c=QS(l,u),h=new Tc(l,c,0).goto(s),f=new Tc(u,c,0).goto(s);for(;;){if(h.to!=f.to||!I_(h.active,f.active)||h.point&&(!f.point||!h.point.eq(f.point)))return!1;if(h.to>n)return!0;h.next(),f.next()}}static spans(e,i,s,n,l=-1){let u=new Tc(e,null,l).goto(i),c=i,h=u.openStart;for(;;){let f=Math.min(u.to,s);if(u.point){let p=u.activeForPoint(u.to),g=u.pointFrom<i?p.length+1:Math.min(p.length,h);n.point(c,f,u.point,p,g,u.pointRank),h=Math.min(u.openEnd(f),p.length)}else f>c&&(n.span(c,f,u.active,h),h=u.openEnd(f));if(u.to>s)return h+(u.point&&u.to>s?1:0);c=u.to,u.next()}}static of(e,i=!1){let s=new jo;for(let n of e instanceof y_?[e]:i?NP(e):e)s.add(n.from,n.to,n.value);return s.finish()}}Ht.empty=new Ht([],[],null,-1);function NP(r){if(r.length>1)for(let e=r[0],i=1;i<r.length;i++){let s=r[i];if(S_(e,s)>0)return r.slice().sort(S_);e=s}return r}Ht.empty.nextLayer=Ht.empty;class jo{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new lT(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,i,s){this.addInner(e,i,s)||(this.nextLayer||(this.nextLayer=new jo)).add(e,i,s)}addInner(e,i,s){let n=e-this.lastTo||s.startSide-this.last.endSide;if(n<=0&&(e-this.lastFrom||s.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(i-this.chunkStart),this.last=s,this.lastFrom=e,this.lastTo=i,this.value.push(s),s.point&&(this.maxPoint=Math.max(this.maxPoint,i-e)),!0)}addChunk(e,i){if((e-this.lastTo||i.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,i.maxPoint),this.chunks.push(i),this.chunkPos.push(e);let s=i.value.length-1;return this.last=i.value[s],this.lastFrom=i.from[s]+e,this.lastTo=i.to[s]+e,!0}finish(){return this.finishInner(Ht.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let i=Ht.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,i}}function QS(r,e,i){let s=new Map;for(let l of r)for(let u=0;u<l.chunk.length;u++)l.chunk[u].maxPoint<=0&&s.set(l.chunk[u],l.chunkPos[u]);let n=new Set;for(let l of e)for(let u=0;u<l.chunk.length;u++){let c=s.get(l.chunk[u]);c!=null&&(i?i.mapPos(c):c)==l.chunkPos[u]&&!(i!=null&&i.touchesRange(c,c+l.chunk[u].length))&&n.add(l.chunk[u])}return n}class W4{constructor(e,i,s,n=0){this.layer=e,this.skip=i,this.minPoint=s,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,i=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,i,!1),this}gotoInner(e,i,s){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<e||n.maxPoint<this.minPoint))break;this.chunkIndex++,s=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],i,!0);(!s||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(e,i){(this.to-e||this.endSide-i)<0&&this.gotoInner(e,i,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],i=this.layer.chunk[this.chunkIndex],s=e+i.from[this.rangeIndex];if(this.from=s,this.to=e+i.to[this.rangeIndex],this.value=i.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class qc{constructor(e){this.heap=e}static from(e,i=null,s=-1){let n=[];for(let l=0;l<e.length;l++)for(let u=e[l];!u.isEmpty;u=u.nextLayer)u.maxPoint>=s&&n.push(new W4(u,i,s,l));return n.length==1?n[0]:new qc(n)}get startSide(){return this.value?this.value.startSide:0}goto(e,i=-1e9){for(let s of this.heap)s.goto(e,i);for(let s=this.heap.length>>1;s>=0;s--)E1(this.heap,s);return this.next(),this}forward(e,i){for(let s of this.heap)s.forward(e,i);for(let s=this.heap.length>>1;s>=0;s--)E1(this.heap,s);(this.to-e||this.value.endSide-i)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),E1(this.heap,0)}}}function E1(r,e){for(let i=r[e];;){let s=(e<<1)+1;if(s>=r.length)break;let n=r[s];if(s+1<r.length&&n.compare(r[s+1])>=0&&(n=r[s+1],s++),i.compare(n)<0)break;r[s]=i,r[e]=n,e=s}}class Tc{constructor(e,i,s){this.minPoint=s,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=qc.from(e,i,s)}goto(e,i=-1e9){return this.cursor.goto(e,i),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=i,this.openStart=-1,this.next(),this}forward(e,i){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-i)<0;)this.removeActive(this.minActive);this.cursor.forward(e,i)}removeActive(e){qd(this.active,e),qd(this.activeTo,e),qd(this.activeRank,e),this.minActive=eI(this.active,this.activeTo)}addActive(e){let i=0,{value:s,to:n,rank:l}=this.cursor;for(;i<this.activeRank.length&&this.activeRank[i]<=l;)i++;Jd(this.active,i,s),Jd(this.activeTo,i,n),Jd(this.activeRank,i,l),e&&Jd(e,i,this.cursor.from),this.minActive=eI(this.active,this.activeTo)}next(){let e=this.to,i=this.point;this.point=null;let s=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>e){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),s&&qd(s,n)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let l=this.cursor.value;if(!l.point)this.addActive(s),this.cursor.next();else if(i&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=l,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=l.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(s){this.openStart=0;for(let n=s.length-1;n>=0&&s[n]<e;n--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let i=[];for(let s=this.active.length-1;s>=0&&!(this.activeRank[s]<this.pointRank);s--)(this.activeTo[s]>e||this.activeTo[s]==e&&this.active[s].endSide>=this.point.endSide)&&i.push(this.active[s]);return i.reverse()}openEnd(e){let i=0;for(let s=this.activeTo.length-1;s>=0&&this.activeTo[s]>e;s--)i++;return i}}function ZS(r,e,i,s,n,l){r.goto(e),i.goto(s);let u=s+n,c=s,h=s-e;for(;;){let f=r.to+h-i.to||r.endSide-i.endSide,p=f<0?r.to+h:i.to,g=Math.min(p,u);if(r.point||i.point?r.point&&i.point&&(r.point==i.point||r.point.eq(i.point))&&I_(r.activeForPoint(r.to+h),i.activeForPoint(i.to))||l.comparePoint(c,g,r.point,i.point):g>c&&!I_(r.active,i.active)&&l.compareRange(c,g,r.active,i.active),p>u)break;c=p,f<=0&&r.next(),f>=0&&i.next()}}function I_(r,e){if(r.length!=e.length)return!1;for(let i=0;i<r.length;i++)if(r[i]!=e[i]&&!r[i].eq(e[i]))return!1;return!0}function qd(r,e){for(let i=e,s=r.length-1;i<s;i++)r[i]=r[i+1];r.pop()}function Jd(r,e,i){for(let s=r.length-1;s>=e;s--)r[s+1]=r[s];r[e]=i}function eI(r,e){let i=-1,s=1e9;for(let n=0;n<e.length;n++)(e[n]-s||r[n].endSide-r[i].endSide)<0&&(i=n,s=e[n]);return i}function mh(r,e,i=r.length){let s=0;for(let n=0;n<i;)r.charCodeAt(n)==9?(s+=e-s%e,n++):(s++,n=vr(r,n));return s}function k_(r,e,i,s){for(let n=0,l=0;;){if(l>=e)return n;if(n==r.length)break;l+=r.charCodeAt(n)==9?i-l%i:1,n=vr(r,n)}return s===!0?-1:r.length}const A_="ͼ",tI=typeof Symbol>"u"?"__"+A_:Symbol.for(A_),C_=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),iI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Ko{constructor(e,i){this.rules=[];let{finish:s}=i||{};function n(u){return/^@/.test(u)?[u]:u.split(/,\s*/)}function l(u,c,h,f){let p=[],g=/^@(\w+)\b/.exec(u[0]),T=g&&g[1]=="keyframes";if(g&&c==null)return h.push(u[0]+";");for(let $ in c){let y=c[$];if(/&/.test($))l($.split(/,\s*/).map(R=>u.map(C=>R.replace(/&/,C))).reduce((R,C)=>R.concat(C)),y,h);else if(y&&typeof y=="object"){if(!g)throw new RangeError("The value of a property ("+$+") should be a primitive value.");l(n($),y,p,T)}else y!=null&&p.push($.replace(/_.*/,"").replace(/[A-Z]/g,R=>"-"+R.toLowerCase())+": "+y+";")}(p.length||T)&&h.push((s&&!g&&!f?u.map(s):u).join(", ")+" {"+p.join(" ")+"}")}for(let u in e)l(n(u),e[u],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=iI[tI]||1;return iI[tI]=e+1,A_+e.toString(36)}static mount(e,i){(e[C_]||new xP(e)).mount(Array.isArray(i)?i:[i])}}let Qd=null;class xP{constructor(e){if(!e.head&&e.adoptedStyleSheets&&typeof CSSStyleSheet<"u"){if(Qd)return e.adoptedStyleSheets=[Qd.sheet].concat(e.adoptedStyleSheets),e[C_]=Qd;this.sheet=new CSSStyleSheet,e.adoptedStyleSheets=[this.sheet].concat(e.adoptedStyleSheets),Qd=this}else{this.styleTag=(e.ownerDocument||e).createElement("style");let i=e.head||e;i.insertBefore(this.styleTag,i.firstChild)}this.modules=[],e[C_]=this}mount(e){let i=this.sheet,s=0,n=0;for(let l=0;l<e.length;l++){let u=e[l],c=this.modules.indexOf(u);if(c<n&&c>-1&&(this.modules.splice(c,1),n--,c=-1),c==-1){if(this.modules.splice(n++,0,u),i)for(let h=0;h<u.rules.length;h++)i.insertRule(u.rules[h],s++)}else{for(;n<c;)s+=this.modules[n++].rules.length;s+=u.rules.length,n++}}if(!i){let l="";for(let u=0;u<this.modules.length;u++)l+=this.modules[u].getRules()+`
`;this.styleTag.textContent=l}}}var qo={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Jc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},rI=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),DP=typeof navigator<"u"&&/Mac/.test(navigator.platform),LP=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),MP=DP||rI&&+rI[1]<57;for(var tr=0;tr<10;tr++)qo[48+tr]=qo[96+tr]=String(tr);for(var tr=1;tr<=24;tr++)qo[tr+111]="F"+tr;for(var tr=65;tr<=90;tr++)qo[tr]=String.fromCharCode(tr+32),Jc[tr]=String.fromCharCode(tr);for(var $1 in qo)Jc.hasOwnProperty($1)||(Jc[$1]=qo[$1]);function BP(r){var e=MP&&(r.ctrlKey||r.altKey||r.metaKey)||LP&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",i=!e&&r.key||(r.shiftKey?Jc:qo)[r.keyCode]||r.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}function K0(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function tu(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function PP(r){let e=r.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function y0(r,e){if(!e.anchorNode)return!1;try{return tu(r,e.anchorNode)}catch{return!1}}function Qc(r){return r.nodeType==3?iu(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function q0(r,e,i,s){return i?sI(r,e,i,s,-1)||sI(r,e,i,s,1):!1}function J0(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function sI(r,e,i,s,n){for(;;){if(r==i&&e==s)return!0;if(e==(n<0?0:Zc(r))){if(r.nodeName=="DIV")return!1;let l=r.parentNode;if(!l||l.nodeType!=1)return!1;e=J0(r)+(n<0?0:1),r=l}else if(r.nodeType==1){if(r=r.childNodes[e+(n<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=n<0?Zc(r):0}else return!1}}function Zc(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}const z4={left:0,right:0,top:0,bottom:0};function aT(r,e){let i=e?r.left:r.right;return{left:i,right:i,top:r.top,bottom:r.bottom}}function FP(r){return{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function UP(r,e,i,s,n,l,u,c){let h=r.ownerDocument,f=h.defaultView||window;for(let p=r;p;)if(p.nodeType==1){let g,T=p==h.body;if(T)g=FP(f);else{if(p.scrollHeight<=p.clientHeight&&p.scrollWidth<=p.clientWidth){p=p.assignedSlot||p.parentNode;continue}let R=p.getBoundingClientRect();g={left:R.left,right:R.left+p.clientWidth,top:R.top,bottom:R.top+p.clientHeight}}let $=0,y=0;if(n=="nearest")e.top<g.top?(y=-(g.top-e.top+u),i>0&&e.bottom>g.bottom+y&&(y=e.bottom-g.bottom+y+u)):e.bottom>g.bottom&&(y=e.bottom-g.bottom+u,i<0&&e.top-y<g.top&&(y=-(g.top+y-e.top+u)));else{let R=e.bottom-e.top,C=g.bottom-g.top;y=(n=="center"&&R<=C?e.top+R/2-C/2:n=="start"||n=="center"&&i<0?e.top-u:e.bottom-C+u)-g.top}if(s=="nearest"?e.left<g.left?($=-(g.left-e.left+l),i>0&&e.right>g.right+$&&($=e.right-g.right+$+l)):e.right>g.right&&($=e.right-g.right+l,i<0&&e.left<g.left+$&&($=-(g.left+$-e.left+l))):$=(s=="center"?e.left+(e.right-e.left)/2-(g.right-g.left)/2:s=="start"==c?e.left-l:e.right-(g.right-g.left)+l)-g.left,$||y)if(T)f.scrollBy($,y);else{let R=0,C=0;if(y){let x=p.scrollTop;p.scrollTop+=y,C=p.scrollTop-x}if($){let x=p.scrollLeft;p.scrollLeft+=$,R=p.scrollLeft-x}e={left:e.left-R,top:e.top-C,right:e.right-R,bottom:e.bottom-C},R&&Math.abs(R-$)<1&&(s="nearest"),C&&Math.abs(C-y)<1&&(n="nearest")}if(T)break;p=p.assignedSlot||p.parentNode}else if(p.nodeType==11)p=p.host;else break}function HP(r){let e=r.ownerDocument;for(let i=r.parentNode;i&&i!=e.body;)if(i.nodeType==1){if(i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)return i;i=i.assignedSlot||i.parentNode}else if(i.nodeType==11)i=i.host;else break;return null}class GP{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,i,s,n){this.anchorNode=e,this.anchorOffset=i,this.focusNode=s,this.focusOffset=n}}let La=null;function Y4(r){if(r.setActive)return r.setActive();if(La)return r.focus(La);let e=[];for(let i=r;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(r.focus(La==null?{get preventScroll(){return La={preventScroll:!0},!0}}:void 0),!La){La=!1;for(let i=0;i<e.length;){let s=e[i++],n=e[i++],l=e[i++];s.scrollTop!=n&&(s.scrollTop=n),s.scrollLeft!=l&&(s.scrollLeft=l)}}}let nI;function iu(r,e,i=e){let s=nI||(nI=document.createRange());return s.setEnd(r,i),s.setStart(r,e),s}function ja(r,e,i){let s={key:e,code:e,keyCode:i,which:i,cancelable:!0},n=new KeyboardEvent("keydown",s);n.synthetic=!0,r.dispatchEvent(n);let l=new KeyboardEvent("keyup",s);return l.synthetic=!0,r.dispatchEvent(l),n.defaultPrevented||l.defaultPrevented}function VP(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function X4(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function WP(r,e){let i=e.focusNode,s=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=s)return!1;for(;;)if(s){if(i.nodeType!=1)return!1;let n=i.childNodes[s-1];n.contentEditable=="false"?s--:(i=n,s=Zc(i))}else{if(i==r)return!0;s=J0(i),i=i.parentNode}}class hr{constructor(e,i,s=!0){this.node=e,this.offset=i,this.precise=s}static before(e,i){return new hr(e.parentNode,J0(e),i)}static after(e,i){return new hr(e.parentNode,J0(e)+1,i)}}const uT=[];class Zt{constructor(){this.parent=null,this.dom=null,this.dirty=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let i=this.posAtStart;for(let s of this.children){if(s==e)return i;i+=s.length+s.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,i){return null}sync(e,i){if(this.dirty&2){let s=this.dom,n=null,l;for(let u of this.children){if(u.dirty){if(!u.dom&&(l=n?n.nextSibling:s.firstChild)){let c=Zt.get(l);(!c||!c.parent&&c.canReuseDOM(u))&&u.reuseDOM(l)}u.sync(e,i),u.dirty=0}if(l=n?n.nextSibling:s.firstChild,i&&!i.written&&i.node==s&&l!=u.dom&&(i.written=!0),u.dom.parentNode==s)for(;l&&l!=u.dom;)l=oI(l);else s.insertBefore(u.dom,l);n=u.dom}for(l=n?n.nextSibling:s.firstChild,l&&i&&i.node==s&&(i.written=!0);l;)l=oI(l)}else if(this.dirty&1)for(let s of this.children)s.dirty&&(s.sync(e,i),s.dirty=0)}reuseDOM(e){}localPosFromDOM(e,i){let s;if(e==this.dom)s=this.dom.childNodes[i];else{let n=Zc(e)==0?0:i==0?-1:1;for(;;){let l=e.parentNode;if(l==this.dom)break;n==0&&l.firstChild!=l.lastChild&&(e==l.firstChild?n=-1:n=1),e=l}n<0?s=e:s=e.nextSibling}if(s==this.dom.firstChild)return 0;for(;s&&!Zt.get(s);)s=s.nextSibling;if(!s)return this.length;for(let n=0,l=0;;n++){let u=this.children[n];if(u.dom==s)return l;l+=u.length+u.breakAfter}}domBoundsAround(e,i,s=0){let n=-1,l=-1,u=-1,c=-1;for(let h=0,f=s,p=s;h<this.children.length;h++){let g=this.children[h],T=f+g.length;if(f<e&&T>i)return g.domBoundsAround(e,i,f);if(T>=e&&n==-1&&(n=h,l=f),f>i&&g.dom.parentNode==this.dom){u=h,c=p;break}p=T,f=T+g.breakAfter}return{from:l,to:c<0?s+this.length:c,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:u<this.children.length&&u>=0?this.children[u].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let i=this.parent;i;i=i.parent){if(e&&(i.dirty|=2),i.dirty&1)return;i.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let i=e.parent;if(!i)return e;e=i}}replaceChildren(e,i,s=uT){this.markDirty();for(let n=e;n<i;n++){let l=this.children[n];l.parent==this&&l.destroy()}this.children.splice(e,i-e,...s);for(let n=0;n<s.length;n++)s[n].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new j4(this.children,e,this.children.length)}childPos(e,i=1){return this.childCursor().findPos(e,i)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}merge(e,i,s,n,l,u){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor}getSide(){return 0}destroy(){this.parent=null}}Zt.prototype.breakAfter=0;function oI(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class j4{constructor(e,i,s){this.children=e,this.pos=i,this.i=s,this.off=0}findPos(e,i=1){for(;;){if(e>this.pos||e==this.pos&&(i>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let s=this.children[--this.i];this.pos-=s.length+s.breakAfter}}}function K4(r,e,i,s,n,l,u,c,h){let{children:f}=r,p=f.length?f[e]:null,g=l.length?l[l.length-1]:null,T=g?g.breakAfter:u;if(!(e==s&&p&&!u&&!T&&l.length<2&&p.merge(i,n,l.length?g:null,i==0,c,h))){if(s<f.length){let $=f[s];$&&n<$.length?(e==s&&($=$.split(n),n=0),!T&&g&&$.merge(0,n,g,!0,0,h)?l[l.length-1]=$:(n&&$.merge(0,n,null,!1,0,h),l.push($))):$!=null&&$.breakAfter&&(g?g.breakAfter=1:u=1),s++}for(p&&(p.breakAfter=u,i>0&&(!u&&l.length&&p.merge(i,p.length,l[0],!1,c,0)?p.breakAfter=l.shift().breakAfter:(i<p.length||p.children.length&&p.children[p.children.length-1].length==0)&&p.merge(i,p.length,null,!1,c,0),e++));e<s&&l.length;)if(f[s-1].become(l[l.length-1]))s--,l.pop(),h=l.length?0:c;else if(f[e].become(l[0]))e++,l.shift(),c=l.length?0:h;else break;!l.length&&e&&s<f.length&&!f[e-1].breakAfter&&f[s].merge(0,0,f[e-1],!1,c,h)&&e--,(e<s||l.length)&&r.replaceChildren(e,s,l)}}function q4(r,e,i,s,n,l){let u=r.childCursor(),{i:c,off:h}=u.findPos(i,1),{i:f,off:p}=u.findPos(e,-1),g=e-i;for(let T of s)g+=T.length;r.length+=g,K4(r,f,p,c,h,s,0,n,l)}let is=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},O_=typeof document<"u"?document:{documentElement:{style:{}}};const w_=/Edge\/(\d+)/.exec(is.userAgent),J4=/MSIE \d/.test(is.userAgent),R_=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(is.userAgent),tp=!!(J4||R_||w_),lI=!tp&&/gecko\/(\d+)/i.test(is.userAgent),v1=!tp&&/Chrome\/(\d+)/.exec(is.userAgent),aI="webkitFontSmoothing"in O_.documentElement.style,Q4=!tp&&/Apple Computer/.test(is.vendor),uI=Q4&&(/Mobile\/\w+/.test(is.userAgent)||is.maxTouchPoints>2);var Be={mac:uI||/Mac/.test(is.platform),windows:/Win/.test(is.platform),linux:/Linux|X11/.test(is.platform),ie:tp,ie_version:J4?O_.documentMode||6:R_?+R_[1]:w_?+w_[1]:0,gecko:lI,gecko_version:lI?+(/Firefox\/(\d+)/.exec(is.userAgent)||[0,0])[1]:0,chrome:!!v1,chrome_version:v1?+v1[1]:0,ios:uI,android:/Android\b/.test(is.userAgent),webkit:aI,safari:Q4,webkit_version:aI?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:O_.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const zP=256;class Jo extends Zt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,i){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(i&&i.node==this.dom&&(i.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,i,s){return s&&(!(s instanceof Jo)||this.length-(i-e)+s.length>zP)?!1:(this.text=this.text.slice(0,e)+(s?s.text:"")+this.text.slice(i),this.markDirty(),!0)}split(e){let i=new Jo(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),i}localPosFromDOM(e,i){return e==this.dom?i:i?this.text.length:0}domAtPos(e){return new hr(this.dom,e)}domBoundsAround(e,i,s){return{from:s,to:s+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,i){return N_(this.dom,e,i)}}class On extends Zt{constructor(e,i=[],s=0){super(),this.mark=e,this.children=i,this.length=s;for(let n of i)n.setParent(this)}setAttrs(e){if(X4(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let i in this.mark.attrs)e.setAttribute(i,this.mark.attrs[i]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e,i){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,i)}merge(e,i,s,n,l,u){return s&&(!(s instanceof On&&s.mark.eq(this.mark))||e&&l<=0||i<this.length&&u<=0)?!1:(q4(this,e,i,s?s.children:[],l-1,u-1),this.markDirty(),!0)}split(e){let i=[],s=0,n=-1,l=0;for(let c of this.children){let h=s+c.length;h>e&&i.push(s<e?c.split(e-s):c),n<0&&s>=e&&(n=l),s=h,l++}let u=this.length-e;return this.length=e,n>-1&&(this.children.length=n,this.markDirty()),new On(this.mark,i,u)}domAtPos(e){return tO(this,e)}coordsAt(e,i){return rO(this,e,i)}}function N_(r,e,i){let s=r.nodeValue.length;e>s&&(e=s);let n=e,l=e,u=0;e==0&&i<0||e==s&&i>=0?Be.chrome||Be.gecko||(e?(n--,u=1):l<s&&(l++,u=-1)):i<0?n--:l<s&&l++;let c=iu(r,n,l).getClientRects();if(!c.length)return z4;let h=c[(u?u<0:i>=0)?0:c.length-1];return Be.safari&&!u&&h.width==0&&(h=Array.prototype.find.call(c,f=>f.width)||h),u?aT(h,u<0):h||null}class Bo extends Zt{constructor(e,i,s){super(),this.widget=e,this.length=i,this.side=s,this.prevWidget=null}static create(e,i,s){return new(e.customView||Bo)(e,i,s)}split(e){let i=Bo.create(this.widget,this.length-e,this.side);return this.length-=e,i}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,i,s,n,l,u){return s&&(!(s instanceof Bo)||!this.widget.compare(s.widget)||e>0&&l<=0||i<this.length&&u<=0)?!1:(this.length=e+(s?s.length:0)+(this.length-i),!0)}become(e){return e.length==this.length&&e instanceof Bo&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.eq(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Bt.empty;let e=this;for(;e.parent;)e=e.parent;let{view:i}=e,s=i&&i.state.doc,n=this.posAtStart;return s?s.slice(n,n+this.length):Bt.empty}domAtPos(e){return e==0?hr.before(this.dom):hr.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,i){let s=this.dom.getClientRects(),n=null;if(!s.length)return z4;for(let l=e>0?s.length-1:0;n=s[l],!(e>0?l==0:l==s.length-1||n.top<n.bottom);l+=e>0?-1:1);return this.length?n:aT(n,this.side>0)}get isEditable(){return!1}get isWidget(){return!0}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Z4 extends Bo{domAtPos(e){let{topView:i,text:s}=this.widget;return i?x_(e,0,i,s,(n,l)=>n.domAtPos(l),n=>new hr(s,Math.min(n,s.nodeValue.length))):new hr(s,Math.min(e,s.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,i){let{topView:s,text:n}=this.widget;return s?eO(e,i,s,n):Math.min(i,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,i){let{topView:s,text:n}=this.widget;return s?x_(e,i,s,n,(l,u,c)=>l.coordsAt(u,c),(l,u)=>N_(n,l,u)):N_(n,e,i)}destroy(){var e;super.destroy(),(e=this.widget.topView)===null||e===void 0||e.destroy()}get isEditable(){return!0}canReuseDOM(){return!0}}function x_(r,e,i,s,n,l){if(i instanceof On){for(let u=i.dom.firstChild;u;u=u.nextSibling){let c=Zt.get(u);if(!c)return l(r,e);let h=tu(u,s),f=c.length+(h?s.nodeValue.length:0);if(r<f||r==f&&c.getSide()<=0)return h?x_(r,e,c,s,n,l):n(c,r,e);r-=f}return n(i,i.length,-1)}else return i.dom==s?l(r,e):n(i,r,e)}function eO(r,e,i,s){if(i instanceof On)for(let n of i.children){let l=0,u=tu(n.dom,s);if(tu(n.dom,r))return l+(u?eO(r,e,n,s):n.localPosFromDOM(r,e));l+=u?s.nodeValue.length:n.length}else if(i.dom==s)return Math.min(e,s.nodeValue.length);return i.localPosFromDOM(r,e)}class ru extends Zt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof ru&&e.side==this.side}split(){return new ru(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return hr.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let i=this.dom.getBoundingClientRect(),s=YP(this,this.side>0?-1:1);return s&&s.top<i.bottom&&s.bottom>i.top?{left:i.left,right:i.right,top:s.top,bottom:s.bottom}:i}get overrideDOMText(){return Bt.empty}}Jo.prototype.children=Bo.prototype.children=ru.prototype.children=uT;function YP(r,e){let i=r.parent,s=i?i.children.indexOf(r):-1;for(;i&&s>=0;)if(e<0?s>0:s<i.children.length){let n=i.children[s+e];if(n instanceof Jo){let l=n.coordsAt(e<0?n.length:0,e);if(l)return l}s+=e}else if(i instanceof On&&i.parent)s=i.parent.children.indexOf(i)+(e<0?0:1),i=i.parent;else{let n=i.dom.lastChild;if(n&&n.nodeName=="BR")return n.getClientRects()[0];break}}function tO(r,e){let i=r.dom,{children:s}=r,n=0;for(let l=0;n<s.length;n++){let u=s[n],c=l+u.length;if(!(c==l&&u.getSide()<=0)){if(e>l&&e<c&&u.dom.parentNode==i)return u.domAtPos(e-l);if(e<=l)break;l=c}}for(let l=n;l>0;l--){let u=s[l-1];if(u.dom.parentNode==i)return u.domAtPos(u.length)}for(let l=n;l<s.length;l++){let u=s[l];if(u.dom.parentNode==i)return u.domAtPos(0)}return new hr(i,0)}function iO(r,e,i){let s,{children:n}=r;i>0&&e instanceof On&&n.length&&(s=n[n.length-1])instanceof On&&s.mark.eq(e.mark)?iO(s,e.children[0],i-1):(n.push(e),e.setParent(r)),r.length+=e.length}function rO(r,e,i){let s=null,n=-1,l=null,u=-1;function c(f,p){for(let g=0,T=0;g<f.children.length&&T<=p;g++){let $=f.children[g],y=T+$.length;y>=p&&($.children.length?c($,p-T):!l&&(y>p||T==y&&$.getSide()>0)?(l=$,u=p-T):(T<p||T==y&&$.getSide()<0)&&(s=$,n=p-T)),T=y}}c(r,e);let h=(i<0?s:l)||s||l;return h?h.coordsAt(Math.max(0,h==s?n:u),i):XP(r)}function XP(r){let e=r.dom.lastChild;if(!e)return r.dom.getBoundingClientRect();let i=Qc(e);return i[i.length-1]||null}function D_(r,e){for(let i in r)i=="class"&&e.class?e.class+=" "+r.class:i=="style"&&e.style?e.style+=";"+r.style:e[i]=r[i];return e}function cT(r,e){if(r==e)return!0;if(!r||!e)return!1;let i=Object.keys(r),s=Object.keys(e);if(i.length!=s.length)return!1;for(let n of i)if(s.indexOf(n)==-1||r[n]!==e[n])return!1;return!0}function L_(r,e,i){let s=null;if(e)for(let n in e)i&&n in i||r.removeAttribute(s=n);if(i)for(let n in i)e&&e[n]==i[n]||r.setAttribute(s=n,i[n]);return!!s}class fo{eq(e){return!1}updateDOM(e,i){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}destroy(e){}}var Wt=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}(Wt||(Wt={}));class Ge extends Hl{constructor(e,i,s,n){super(),this.startSide=e,this.endSide=i,this.widget=s,this.spec=n}get heightRelevant(){return!1}static mark(e){return new ip(e)}static widget(e){let i=e.side||0,s=!!e.block;return i+=s?i>0?3e8:-4e8:i>0?1e8:-1e8,new Gl(e,i,i,s,e.widget||null,!1)}static replace(e){let i=!!e.block,s,n;if(e.isBlockGap)s=-5e8,n=4e8;else{let{start:l,end:u}=sO(e,i);s=(l?i?-3e8:-1:5e8)-1,n=(u?i?2e8:1:-6e8)+1}return new Gl(e,s,n,i,e.widget||null,!0)}static line(e){return new gh(e)}static set(e,i=!1){return Ht.of(e,i)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ge.none=Ht.empty;class ip extends Ge{constructor(e){let{start:i,end:s}=sO(e);super(i?-1:5e8,s?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof ip&&this.tagName==e.tagName&&this.class==e.class&&cT(this.attrs,e.attrs)}range(e,i=e){if(e>=i)throw new RangeError("Mark decorations may not be empty");return super.range(e,i)}}ip.prototype.point=!1;class gh extends Ge{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof gh&&this.spec.class==e.spec.class&&cT(this.spec.attributes,e.spec.attributes)}range(e,i=e){if(i!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,i)}}gh.prototype.mapMode=Er.TrackBefore;gh.prototype.point=!0;class Gl extends Ge{constructor(e,i,s,n,l,u){super(i,s,l,e),this.block=n,this.isReplace=u,this.mapMode=n?i<=0?Er.TrackBefore:Er.TrackAfter:Er.TrackDel}get type(){return this.startSide<this.endSide?Wt.WidgetRange:this.startSide<=0?Wt.WidgetBefore:Wt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof Gl&&jP(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,i=e){if(this.isReplace&&(e>i||e==i&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&i!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,i)}}Gl.prototype.point=!0;function sO(r,e=!1){let{inclusiveStart:i,inclusiveEnd:s}=r;return i==null&&(i=r.inclusive),s==null&&(s=r.inclusive),{start:i??e,end:s??e}}function jP(r,e){return r==e||!!(r&&e&&r.compare(e))}function M_(r,e,i,s=0){let n=i.length-1;n>=0&&i[n]+s>=r?i[n]=Math.max(i[n],e):i.push(r,e)}class yr extends Zt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,i,s,n,l,u){if(s){if(!(s instanceof yr))return!1;this.dom||s.transferDOM(this)}return n&&this.setDeco(s?s.attrs:null),q4(this,e,i,s?s.children:[],l,u),!0}split(e){let i=new yr;if(i.breakAfter=this.breakAfter,this.length==0)return i;let{i:s,off:n}=this.childPos(e);n&&(i.append(this.children[s].split(n),0),this.children[s].merge(n,this.children[s].length,null,!1,0,0),s++);for(let l=s;l<this.children.length;l++)i.append(this.children[l],0);for(;s>0&&this.children[s-1].length==0;)this.children[--s].destroy();return this.children.length=s,this.markDirty(),this.length=e,i}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){cT(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,i){iO(this,e,i)}addLineDeco(e){let i=e.spec.attributes,s=e.spec.class;i&&(this.attrs=D_(i,this.attrs||{})),s&&(this.attrs=D_({class:s},this.attrs||{}))}domAtPos(e){return tO(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e,i){var s;this.dom?this.dirty&4&&(X4(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(L_(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,i);let n=this.dom.lastChild;for(;n&&Zt.get(n)instanceof On;)n=n.lastChild;if(!n||!this.length||n.nodeName!="BR"&&((s=Zt.get(n))===null||s===void 0?void 0:s.isEditable)==!1&&(!Be.ios||!this.children.some(l=>l instanceof Jo))){let l=document.createElement("BR");l.cmIgnore=!0,this.dom.appendChild(l)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0;for(let i of this.children){if(!(i instanceof Jo)||/[^ -~]/.test(i.text))return null;let s=Qc(i.dom);if(s.length!=1)return null;e+=s[0].width}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length}:null}coordsAt(e,i){return rO(this,e,i)}become(e){return!1}get type(){return Wt.Text}static find(e,i){for(let s=0,n=0;s<e.children.length;s++){let l=e.children[s],u=n+l.length;if(u>=i){if(l instanceof yr)return l;if(u>i)break}n=u+l.breakAfter}return null}}class Bl extends Zt{constructor(e,i,s){super(),this.widget=e,this.length=i,this.type=s,this.breakAfter=0,this.prevWidget=null}merge(e,i,s,n,l,u){return s&&(!(s instanceof Bl)||!this.widget.compare(s.widget)||e>0&&l<=0||i<this.length&&u<=0)?!1:(this.length=e+(s?s.length:0)+(this.length-i),!0)}domAtPos(e){return e==0?hr.before(this.dom):hr.after(this.dom,e==this.length)}split(e){let i=this.length-e;this.length=e;let s=new Bl(this.widget,i,this.type);return s.breakAfter=this.breakAfter,s}get children(){return uT}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Bt.empty}domBoundsAround(){return null}become(e){return e instanceof Bl&&e.type==this.type&&e.widget.constructor==this.widget.constructor?(e.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class hT{constructor(e,i,s,n){this.doc=e,this.pos=i,this.end=s,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=i}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof Bl&&e.type==Wt.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new yr),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Zd(new ru(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(e,i,s){for(;e>0;){if(this.textOff==this.text.length){let{value:l,lineBreak:u,done:c}=this.cursor.next(this.skip);if(this.skip=0,c)throw new Error("Ran out of text content when drawing inline views");if(u){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=l,this.textOff=0}let n=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(i.slice(i.length-s)),this.getLine().append(Zd(new Jo(this.text.slice(this.textOff,this.textOff+n)),i),s),this.atCursorPos=!0,this.textOff+=n,e-=n,s=0}}span(e,i,s,n){this.buildText(i-e,s,n),this.pos=i,this.openStart<0&&(this.openStart=n)}point(e,i,s,n,l,u){if(this.disallowBlockEffectsFor[u]&&s instanceof Gl){if(s.block)throw new RangeError("Block decorations may not be specified via plugins");if(i>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let c=i-e;if(s instanceof Gl)if(s.block){let{type:h}=s;h==Wt.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Bl(s.widget||new cI("div"),c,h))}else{let h=Bo.create(s.widget||new cI("span"),c,c?0:s.startSide),f=this.atCursorPos&&!h.isEditable&&l<=n.length&&(e<i||s.startSide>0),p=!h.isEditable&&(e<i||l>n.length||s.startSide<=0),g=this.getLine();this.pendingBuffer==2&&!f&&(this.pendingBuffer=0),this.flushBuffer(n),f&&(g.append(Zd(new ru(1),n),l),l=n.length+Math.max(0,l-n.length)),g.append(Zd(h,n),l),this.atCursorPos=p,this.pendingBuffer=p?e<i||l>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(s);c&&(this.textOff+c<=this.text.length?this.textOff+=c:(this.skip+=c-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=i),this.openStart<0&&(this.openStart=l)}static build(e,i,s,n,l){let u=new hT(e,i,s,l);return u.openEnd=Ht.spans(n,i,s,u),u.openStart<0&&(u.openStart=u.openEnd),u.finish(u.openEnd),u}}function Zd(r,e){for(let i of e)r=new On(i,[r],r.length);return r}class cI extends fo{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}}const nO=Pe.define(),oO=Pe.define(),lO=Pe.define(),aO=Pe.define(),B_=Pe.define(),uO=Pe.define(),cO=Pe.define(),hO=Pe.define({combine:r=>r.some(e=>e)}),dO=Pe.define({combine:r=>r.some(e=>e)});class Q0{constructor(e,i="nearest",s="nearest",n=5,l=5){this.range=e,this.y=i,this.x=s,this.yMargin=n,this.xMargin=l}map(e){return e.empty?this:new Q0(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const hI=ct.define({map:(r,e)=>r.map(e)});function ss(r,e,i){let s=r.facet(aO);s.length?s[0](e):window.onerror?window.onerror(String(e),i,void 0,void 0,e):i?console.error(i+":",e):console.error(e)}const rp=Pe.define({combine:r=>r.length?r[0]:!0});let KP=0;const Ic=Pe.define();class Si{constructor(e,i,s,n){this.id=e,this.create=i,this.domEventHandlers=s,this.extension=n(this)}static define(e,i){const{eventHandlers:s,provide:n,decorations:l}=i||{};return new Si(KP++,e,s,u=>{let c=[Ic.of(u)];return l&&c.push(eh.of(h=>{let f=h.plugin(u);return f?l(f):Ge.none})),n&&c.push(n(u)),c})}static fromClass(e,i){return Si.define(s=>new e(s),i)}}class y1{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let i=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(i)}catch(s){if(ss(i.state,s,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(i){ss(e.state,i,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var i;if(!((i=this.value)===null||i===void 0)&&i.destroy)try{this.value.destroy()}catch(s){ss(e.state,s,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const fO=Pe.define(),dT=Pe.define(),eh=Pe.define(),pO=Pe.define(),mO=Pe.define(),kc=Pe.define();class An{constructor(e,i,s,n){this.fromA=e,this.toA=i,this.fromB=s,this.toB=n}join(e){return new An(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let i=e.length,s=this;for(;i>0;i--){let n=e[i-1];if(!(n.fromA>s.toA)){if(n.toA<s.fromA)break;s=s.join(n),e.splice(i-1,1)}}return e.splice(i,0,s),e}static extendWithRanges(e,i){if(i.length==0)return e;let s=[];for(let n=0,l=0,u=0,c=0;;n++){let h=n==e.length?null:e[n],f=u-c,p=h?h.fromB:1e9;for(;l<i.length&&i[l]<p;){let g=i[l],T=i[l+1],$=Math.max(c,g),y=Math.min(p,T);if($<=y&&new An($+f,y+f,$,y).addToSet(s),T>p)break;l+=2}if(!h)return s;new An(h.fromA,h.toA,h.fromB,h.toB).addToSet(s),u=h.toA,c=h.toB}}}class Z0{constructor(e,i,s){this.view=e,this.state=i,this.transactions=s,this.flags=0,this.startState=e.state,this.changes=Hi.empty(this.startState.doc.length);for(let l of s)this.changes=this.changes.compose(l.changes);let n=[];this.changes.iterChangedRanges((l,u,c,h)=>n.push(new An(l,u,c,h))),this.changedRanges=n}static create(e,i,s){return new Z0(e,i,s)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var hi=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}(hi||(hi={}));const P_=hi.LTR,qP=hi.RTL;function gO(r){let e=[];for(let i=0;i<r.length;i++)e.push(1<<+r[i]);return e}const JP=gO("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),QP=gO("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),F_=Object.create(null),fn=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),i=r.charCodeAt(1);F_[e]=i,F_[i]=-e}function ZP(r){return r<=247?JP[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?QP[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8203?256:64336<=r&&r<=65023?4:r==8204?256:1}const eF=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ka{constructor(e,i,s){this.from=e,this.to=i,this.level=s}get dir(){return this.level%2?qP:P_}side(e,i){return this.dir==i==e?this.to:this.from}static find(e,i,s,n){let l=-1;for(let u=0;u<e.length;u++){let c=e[u];if(c.from<=i&&c.to>=i){if(c.level==s)return u;(l<0||(n!=0?n<0?c.from<i:c.to>i:e[l].level>c.level))&&(l=u)}}if(l<0)throw new RangeError("Index out of range");return l}}const ai=[];function tF(r,e){let i=r.length,s=e==P_?1:2,n=e==P_?2:1;if(!r||s==1&&!eF.test(r))return _O(i);for(let u=0,c=s,h=s;u<i;u++){let f=ZP(r.charCodeAt(u));f==512?f=c:f==8&&h==4&&(f=16),ai[u]=f==4?2:f,f&7&&(h=f),c=f}for(let u=0,c=s,h=s;u<i;u++){let f=ai[u];if(f==128)u<i-1&&c==ai[u+1]&&c&24?f=ai[u]=c:ai[u]=256;else if(f==64){let p=u+1;for(;p<i&&ai[p]==64;)p++;let g=u&&c==8||p<i&&ai[p]==8?h==1?1:8:256;for(let T=u;T<p;T++)ai[T]=g;u=p-1}else f==8&&h==1&&(ai[u]=1);c=f,f&7&&(h=f)}for(let u=0,c=0,h=0,f,p,g;u<i;u++)if(p=F_[f=r.charCodeAt(u)])if(p<0){for(let T=c-3;T>=0;T-=3)if(fn[T+1]==-p){let $=fn[T+2],y=$&2?s:$&4?$&1?n:s:0;y&&(ai[u]=ai[fn[T]]=y),c=T;break}}else{if(fn.length==189)break;fn[c++]=u,fn[c++]=f,fn[c++]=h}else if((g=ai[u])==2||g==1){let T=g==s;h=T?0:1;for(let $=c-3;$>=0;$-=3){let y=fn[$+2];if(y&2)break;if(T)fn[$+2]|=2;else{if(y&4)break;fn[$+2]|=4}}}for(let u=0;u<i;u++)if(ai[u]==256){let c=u+1;for(;c<i&&ai[c]==256;)c++;let h=(u?ai[u-1]:s)==1,f=(c<i?ai[c]:s)==1,p=h==f?h?1:2:s;for(let g=u;g<c;g++)ai[g]=p;u=c-1}let l=[];if(s==1)for(let u=0;u<i;){let c=u,h=ai[u++]!=1;for(;u<i&&h==(ai[u]!=1);)u++;if(h)for(let f=u;f>c;){let p=f,g=ai[--f]!=2;for(;f>c&&g==(ai[f-1]!=2);)f--;l.push(new Ka(f,p,g?2:1))}else l.push(new Ka(c,u,0))}else for(let u=0;u<i;){let c=u,h=ai[u++]==2;for(;u<i&&h==(ai[u]==2);)u++;l.push(new Ka(c,u,h?1:2))}return l}function _O(r){return[new Ka(0,r,0)]}let bO="";function iF(r,e,i,s,n){var l;let u=s.head-r.from,c=-1;if(u==0){if(!n||!r.length)return null;e[0].level!=i&&(u=e[0].side(!1,i),c=0)}else if(u==r.length){if(n)return null;let T=e[e.length-1];T.level!=i&&(u=T.side(!0,i),c=e.length-1)}c<0&&(c=Ka.find(e,u,(l=s.bidiLevel)!==null&&l!==void 0?l:-1,s.assoc));let h=e[c];u==h.side(n,i)&&(h=e[c+=n?1:-1],u=h.side(!n,i));let f=n==(h.dir==i),p=vr(r.text,u,f);if(bO=r.text.slice(Math.min(u,p),Math.max(u,p)),p!=h.side(n,i))return he.cursor(p+r.from,f?-1:1,h.level);let g=c==(n?e.length-1:0)?null:e[c+(n?1:-1)];return!g&&h.level!=i?he.cursor(n?r.to:r.from,n?-1:1,i):g&&g.level<h.level?he.cursor(g.side(!n,i)+r.from,n?1:-1,g.level):he.cursor(p+r.from,n?-1:1,h.level)}const Po="￿";class TO{constructor(e,i){this.points=e,this.text="",this.lineSeparator=i.facet(xt.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Po}readRange(e,i){if(!e)return this;let s=e.parentNode;for(let n=e;;){this.findPointBefore(s,n),this.readNode(n);let l=n.nextSibling;if(l==i)break;let u=Zt.get(n),c=Zt.get(l);(u&&c?u.breakAfter:(u?u.breakAfter:dI(n))||dI(l)&&(n.nodeName!="BR"||n.cmIgnore))&&this.lineBreak(),n=l}return this.findPointBefore(s,i),this}readTextNode(e){let i=e.nodeValue;for(let s of this.points)s.node==e&&(s.pos=this.text.length+Math.min(s.offset,i.length));for(let s=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let l=-1,u=1,c;if(this.lineSeparator?(l=i.indexOf(this.lineSeparator,s),u=this.lineSeparator.length):(c=n.exec(i))&&(l=c.index,u=c[0].length),this.append(i.slice(s,l<0?i.length:l)),l<0)break;if(this.lineBreak(),u>1)for(let h of this.points)h.node==e&&h.pos>this.text.length&&(h.pos-=u-1);s=l+u}}readNode(e){if(e.cmIgnore)return;let i=Zt.get(e),s=i&&i.overrideDOMText;if(s!=null){this.findPointInside(e,s.length);for(let n=s.iter();!n.next().done;)n.lineBreak?this.lineBreak():this.append(n.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,i){for(let s of this.points)s.node==e&&e.childNodes[s.offset]==i&&(s.pos=this.text.length)}findPointInside(e,i){for(let s of this.points)(e.nodeType==3?s.node==e:e.contains(s.node))&&(s.pos=this.text.length+Math.min(i,s.offset))}}function dI(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}class fI{constructor(e,i){this.node=e,this.offset=i,this.pos=-1}}class pI extends Zt{constructor(e){super(),this.view=e,this.compositionDeco=Ge.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new yr],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new An(0,0,0,e.state.doc.length)],0)}get length(){return this.view.state.doc.length}update(e){let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:u,toA:c})=>c<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=Ge.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=sF(this.view,e.changes)),(Be.ie||Be.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let s=this.decorations,n=this.updateDeco(),l=aF(s,n,e.changes);return i=An.extendWithRanges(i,l),this.dirty==0&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,i);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let l=Be.chrome||Be.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,l),this.dirty=0,l&&(l.written||s.selectionRange.focusNode!=l.node)&&(this.forceSelection=!0),this.dom.style.height=""});let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let l of this.children)l instanceof Bl&&l.widget instanceof mI&&n.push(l.dom);s.updateGaps(n)}updateChildren(e,i){let s=this.childCursor(i);for(let n=e.length-1;;n--){let l=n>=0?e[n]:null;if(!l)break;let{fromA:u,toA:c,fromB:h,toB:f}=l,{content:p,breakAtStart:g,openStart:T,openEnd:$}=hT.build(this.view.state.doc,h,f,this.decorations,this.dynamicDecorationMap),{i:y,off:R}=s.findPos(c,1),{i:C,off:x}=s.findPos(u,-1);K4(this,C,x,y,R,p,g,T,$)}}updateSelection(e=!1,i=!1){if((e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange(),!(i||this.mayControlSelection()))return;let s=this.forceSelection;this.forceSelection=!1;let n=this.view.state.selection.main,l=this.domAtPos(n.anchor),u=n.empty?l:this.domAtPos(n.head);if(Be.gecko&&n.empty&&rF(l)){let h=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(h,l.node.childNodes[l.offset]||null)),l=u=new hr(h,0),s=!0}let c=this.view.observer.selectionRange;(s||!c.focusNode||!q0(l.node,l.offset,c.anchorNode,c.anchorOffset)||!q0(u.node,u.offset,c.focusNode,c.focusOffset))&&(this.view.observer.ignore(()=>{Be.android&&Be.chrome&&this.dom.contains(c.focusNode)&&uF(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=K0(this.view.root);if(h)if(n.empty){if(Be.gecko){let f=oF(l.node,l.offset);if(f&&f!=3){let p=$O(l.node,l.offset,f==1?1:-1);p&&(l=new hr(p,f==1?0:p.nodeValue.length))}}h.collapse(l.node,l.offset),n.bidiLevel!=null&&c.cursorBidiLevel!=null&&(c.cursorBidiLevel=n.bidiLevel)}else if(h.extend){h.collapse(l.node,l.offset);try{h.extend(u.node,u.offset)}catch{}}else{let f=document.createRange();n.anchor>n.head&&([l,u]=[u,l]),f.setEnd(u.node,u.offset),f.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(f)}}),this.view.observer.setSelectionRange(l,u)),this.impreciseAnchor=l.precise?null:new hr(c.anchorNode,c.anchorOffset),this.impreciseHead=u.precise?null:new hr(c.focusNode,c.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let{view:e}=this,i=e.state.selection.main,s=K0(e.root),{anchorNode:n,anchorOffset:l}=e.observer.selectionRange;if(!s||!i.empty||!i.assoc||!s.modify)return;let u=yr.find(this,i.head);if(!u)return;let c=u.posAtStart;if(i.head==c||i.head==c+u.length)return;let h=this.coordsAt(i.head,-1),f=this.coordsAt(i.head,1);if(!h||!f||h.bottom>f.top)return;let p=this.domAtPos(i.head+i.assoc);s.collapse(p.node,p.offset),s.modify("move",i.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let g=e.observer.selectionRange;e.docView.posFromDOM(g.anchorNode,g.anchorOffset)!=i.from&&s.collapse(n,l)}mayControlSelection(){let e=this.view.root.activeElement;return e==this.dom||y0(this.dom,this.view.observer.selectionRange)&&!(e&&this.dom.contains(e))}nearest(e){for(let i=e;i;){let s=Zt.get(i);if(s&&s.rootView==this)return s;i=i.parentNode}return null}posFromDOM(e,i){let s=this.nearest(e);if(!s)throw new RangeError("Trying to find position for a DOM position outside of the document");return s.localPosFromDOM(e,i)+s.posAtStart}domAtPos(e){let{i,off:s}=this.childCursor().findPos(e,-1);for(;i<this.children.length-1;){let n=this.children[i];if(s<n.length||n instanceof yr)break;i++,s=0}return this.children[i].domAtPos(s)}coordsAt(e,i){for(let s=this.length,n=this.children.length-1;;n--){let l=this.children[n],u=s-l.breakAfter-l.length;if(e>u||e==u&&l.type!=Wt.WidgetBefore&&l.type!=Wt.WidgetAfter&&(!n||i==2||this.children[n-1].breakAfter||this.children[n-1].type==Wt.WidgetBefore&&i>-2))return l.coordsAt(e-u,i);s=u}}measureVisibleLineHeights(e){let i=[],{from:s,to:n}=e,l=this.view.contentDOM.clientWidth,u=l>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,c=-1,h=this.view.textDirection==hi.LTR;for(let f=0,p=0;p<this.children.length;p++){let g=this.children[p],T=f+g.length;if(T>n)break;if(f>=s){let $=g.dom.getBoundingClientRect();if(i.push($.height),u){let y=g.dom.lastChild,R=y?Qc(y):[];if(R.length){let C=R[R.length-1],x=h?C.right-$.left:$.right-C.left;x>c&&(c=x,this.minWidth=l,this.minWidthFrom=f,this.minWidthTo=T)}}}f=T+g.breakAfter}return i}textDirectionAt(e){let{i}=this.childPos(e,1);return getComputedStyle(this.children[i].dom).direction=="rtl"?hi.RTL:hi.LTR}measureTextSize(){for(let n of this.children)if(n instanceof yr){let l=n.measureTextSize();if(l)return l}let e=document.createElement("div"),i,s;return e.className="cm-line",e.style.width="99999px",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let n=Qc(e.firstChild)[0];i=e.getBoundingClientRect().height,s=n?n.width/27:7,e.remove()}),{lineHeight:i,charWidth:s}}childCursor(e=this.length){let i=this.children.length;return i&&(e-=this.children[--i].length),new j4(this.children,e,i)}computeBlockGapDeco(){let e=[],i=this.view.viewState;for(let s=0,n=0;;n++){let l=n==i.viewports.length?null:i.viewports[n],u=l?l.from-1:this.length;if(u>s){let c=i.lineBlockAt(u).bottom-i.lineBlockAt(s).top;e.push(Ge.replace({widget:new mI(c),block:!0,inclusive:!0,isBlockGap:!0}).range(s,u))}if(!l)break;s=l.to+1}return Ge.set(e)}updateDeco(){let e=this.view.state.facet(eh).map((i,s)=>(this.dynamicDecorationMap[s]=typeof i=="function")?i(this.view):i);for(let i=e.length;i<e.length+3;i++)this.dynamicDecorationMap[i]=!1;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:i}=e,s=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1),n;if(!s)return;!i.empty&&(n=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(s={left:Math.min(s.left,n.left),top:Math.min(s.top,n.top),right:Math.max(s.right,n.right),bottom:Math.max(s.bottom,n.bottom)});let l=0,u=0,c=0,h=0;for(let p of this.view.state.facet(mO).map(g=>g(this.view)))if(p){let{left:g,right:T,top:$,bottom:y}=p;g!=null&&(l=Math.max(l,g)),T!=null&&(u=Math.max(u,T)),$!=null&&(c=Math.max(c,$)),y!=null&&(h=Math.max(h,y))}let f={left:s.left-l,top:s.top-c,right:s.right+u,bottom:s.bottom+h};UP(this.view.scrollDOM,f,i.head<i.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==hi.LTR)}}function rF(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}class mI extends fo{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function EO(r){let e=r.observer.selectionRange,i=e.focusNode&&$O(e.focusNode,e.focusOffset,0);if(!i)return null;let s=r.docView.nearest(i);if(!s)return null;if(s instanceof yr){let n=i;for(;n.parentNode!=s.dom;)n=n.parentNode;let l=n.previousSibling;for(;l&&!Zt.get(l);)l=l.previousSibling;let u=l?Zt.get(l).posAtEnd:s.posAtStart;return{from:u,to:u,node:n,text:i}}else{for(;;){let{parent:l}=s;if(!l)return null;if(l instanceof yr)break;s=l}let n=s.posAtStart;return{from:n,to:n+s.length,node:s.dom,text:i}}}function sF(r,e){let i=EO(r);if(!i)return Ge.none;let{from:s,to:n,node:l,text:u}=i,c=e.mapPos(s,1),h=Math.max(c,e.mapPos(n,-1)),{state:f}=r,p=l.nodeType==3?l.nodeValue:new TO([],f).readRange(l.firstChild,null).text;if(h-c<p.length)if(f.doc.sliceString(c,Math.min(f.doc.length,c+p.length),Po)==p)h=c+p.length;else if(f.doc.sliceString(Math.max(0,h-p.length),h,Po)==p)c=h-p.length;else return Ge.none;else if(f.doc.sliceString(c,h,Po)!=p)return Ge.none;let g=Zt.get(l);return g instanceof Z4?g=g.widget.topView:g&&(g.parent=null),Ge.set(Ge.replace({widget:new nF(l,u,g),inclusive:!0}).range(c,h))}class nF extends fo{constructor(e,i,s){super(),this.top=e,this.text=i,this.topView=s}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return Z4}}function $O(r,e,i){for(;;){if(r.nodeType==3)return r;if(r.nodeType==1&&e>0&&i<=0)r=r.childNodes[e-1],e=Zc(r);else if(r.nodeType==1&&e<r.childNodes.length&&i>=0)r=r.childNodes[e],e=0;else return null}}function oF(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}class lF{constructor(){this.changes=[]}compareRange(e,i){M_(e,i,this.changes)}comparePoint(e,i){M_(e,i,this.changes)}}function aF(r,e,i){let s=new lF;return Ht.compare(r,e,i,s),s.changes}function uF(r,e){for(let i=r;i&&i!=e;i=i.assignedSlot||i.parentNode)if(i.nodeType==1&&i.contentEditable=="false")return!0;return!1}function cF(r,e,i=1){let s=r.charCategorizer(e),n=r.doc.lineAt(e),l=e-n.from;if(n.length==0)return he.cursor(e);l==0?i=1:l==n.length&&(i=-1);let u=l,c=l;i<0?u=vr(n.text,l,!1):c=vr(n.text,l);let h=s(n.text.slice(u,c));for(;u>0;){let f=vr(n.text,u,!1);if(s(n.text.slice(f,u))!=h)break;u=f}for(;c<n.length;){let f=vr(n.text,c);if(s(n.text.slice(c,f))!=h)break;c=f}return he.range(u+n.from,c+n.from)}function hF(r,e){return e.left>r?e.left-r:Math.max(0,r-e.right)}function dF(r,e){return e.top>r?e.top-r:Math.max(0,r-e.bottom)}function S1(r,e){return r.top<e.bottom-1&&r.bottom>e.top+1}function gI(r,e){return e<r.top?{top:e,left:r.left,right:r.right,bottom:r.bottom}:r}function _I(r,e){return e>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:e}:r}function U_(r,e,i){let s,n,l,u,c=!1,h,f,p,g;for(let y=r.firstChild;y;y=y.nextSibling){let R=Qc(y);for(let C=0;C<R.length;C++){let x=R[C];n&&S1(n,x)&&(x=gI(_I(x,n.bottom),n.top));let j=hF(e,x),F=dF(i,x);if(j==0&&F==0)return y.nodeType==3?bI(y,e,i):U_(y,e,i);if(!s||u>F||u==F&&l>j){s=y,n=x,l=j,u=F;let q=F?i<x.top?-1:1:j?e<x.left?-1:1:0;c=!q||(q>0?C<R.length-1:C>0)}j==0?i>x.bottom&&(!p||p.bottom<x.bottom)?(h=y,p=x):i<x.top&&(!g||g.top>x.top)&&(f=y,g=x):p&&S1(p,x)?p=_I(p,x.bottom):g&&S1(g,x)&&(g=gI(g,x.top))}}if(p&&p.bottom>=i?(s=h,n=p):g&&g.top<=i&&(s=f,n=g),!s)return{node:r,offset:0};let T=Math.max(n.left,Math.min(n.right,e));if(s.nodeType==3)return bI(s,T,i);if(c&&s.contentEditable!="false")return U_(s,T,i);let $=Array.prototype.indexOf.call(r.childNodes,s)+(e>=(n.left+n.right)/2?1:0);return{node:r,offset:$}}function bI(r,e,i){let s=r.nodeValue.length,n=-1,l=1e9,u=0;for(let c=0;c<s;c++){let h=iu(r,c,c+1).getClientRects();for(let f=0;f<h.length;f++){let p=h[f];if(p.top==p.bottom)continue;u||(u=e-p.left);let g=(p.top>i?p.top-i:i-p.bottom)-1;if(p.left-1<=e&&p.right+1>=e&&g<l){let T=e>=(p.left+p.right)/2,$=T;if((Be.chrome||Be.gecko)&&iu(r,c).getBoundingClientRect().left==p.right&&($=!T),g<=0)return{node:r,offset:c+($?1:0)};n=c+($?1:0),l=g}}}return{node:r,offset:n>-1?n:u>0?r.nodeValue.length:0}}function vO(r,e,i,s=-1){var n,l;let u=r.contentDOM.getBoundingClientRect(),c=u.top+r.viewState.paddingTop,h,{docHeight:f}=r.viewState,{x:p,y:g}=e,T=g-c;if(T<0)return 0;if(T>f)return r.state.doc.length;for(let q=r.defaultLineHeight/2,W=!1;h=r.elementAtHeight(T),h.type!=Wt.Text;)for(;T=s>0?h.bottom+q:h.top-q,!(T>=0&&T<=f);){if(W)return i?null:0;W=!0,s=-s}g=c+T;let $=h.from;if($<r.viewport.from)return r.viewport.from==0?0:i?null:TI(r,u,h,p,g);if($>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:i?null:TI(r,u,h,p,g);let y=r.dom.ownerDocument,R=r.root.elementFromPoint?r.root:y,C=R.elementFromPoint(p,g);C&&!r.contentDOM.contains(C)&&(C=null),C||(p=Math.max(u.left+1,Math.min(u.right-1,p)),C=R.elementFromPoint(p,g),C&&!r.contentDOM.contains(C)&&(C=null));let x,j=-1;if(C&&((n=r.docView.nearest(C))===null||n===void 0?void 0:n.isEditable)!=!1){if(y.caretPositionFromPoint){let q=y.caretPositionFromPoint(p,g);q&&({offsetNode:x,offset:j}=q)}else if(y.caretRangeFromPoint){let q=y.caretRangeFromPoint(p,g);q&&({startContainer:x,startOffset:j}=q,(!r.contentDOM.contains(x)||Be.safari&&fF(x,j,p)||Be.chrome&&pF(x,j,p))&&(x=void 0))}}if(!x||!r.docView.dom.contains(x)){let q=yr.find(r.docView,$);if(!q)return T>h.top+h.height/2?h.to:h.from;({node:x,offset:j}=U_(q.dom,p,g))}let F=r.docView.nearest(x);if(!F)return null;if(F.isWidget&&((l=F.dom)===null||l===void 0?void 0:l.nodeType)==1){let q=F.dom.getBoundingClientRect();return e.y<q.top||e.y<=q.bottom&&e.x<=(q.left+q.right)/2?F.posAtStart:F.posAtEnd}else return F.localPosFromDOM(x,j)+F.posAtStart}function TI(r,e,i,s,n){let l=Math.round((s-e.left)*r.defaultCharacterWidth);if(r.lineWrapping&&i.height>r.defaultLineHeight*1.5){let c=Math.floor((n-i.top)/r.defaultLineHeight);l+=c*r.viewState.heightOracle.lineLength}let u=r.state.sliceDoc(i.from,i.to);return i.from+k_(u,l,r.state.tabSize)}function fF(r,e,i){let s;if(r.nodeType!=3||e!=(s=r.nodeValue.length))return!1;for(let n=r.nextSibling;n;n=n.nextSibling)if(n.nodeType!=1||n.nodeName!="BR")return!1;return iu(r,s-1,s).getBoundingClientRect().left>i}function pF(r,e,i){if(e!=0)return!1;for(let n=r;;){let l=n.parentNode;if(!l||l.nodeType!=1||l.firstChild!=n)return!1;if(l.classList.contains("cm-line"))break;n=l}let s=r.nodeType==1?r.getBoundingClientRect():iu(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return i-s.left>5}function mF(r,e,i,s){let n=r.state.doc.lineAt(e.head),l=!s||!r.lineWrapping?null:r.coordsAtPos(e.assoc<0&&e.head>n.from?e.head-1:e.head);if(l){let h=r.dom.getBoundingClientRect(),f=r.textDirectionAt(n.from),p=r.posAtCoords({x:i==(f==hi.LTR)?h.right-1:h.left+1,y:(l.top+l.bottom)/2});if(p!=null)return he.cursor(p,i?-1:1)}let u=yr.find(r.docView,e.head),c=u?i?u.posAtEnd:u.posAtStart:i?n.to:n.from;return he.cursor(c,i?-1:1)}function EI(r,e,i,s){let n=r.state.doc.lineAt(e.head),l=r.bidiSpans(n),u=r.textDirectionAt(n.from);for(let c=e,h=null;;){let f=iF(n,l,u,c,i),p=bO;if(!f){if(n.number==(i?r.state.doc.lines:1))return c;p=`
`,n=r.state.doc.line(n.number+(i?1:-1)),l=r.bidiSpans(n),f=he.cursor(i?n.from:n.to)}if(h){if(!h(p))return c}else{if(!s)return f;h=s(p)}c=f}}function gF(r,e,i){let s=r.state.charCategorizer(e),n=s(i);return l=>{let u=s(l);return n==si.Space&&(n=u),n==u}}function _F(r,e,i,s){let n=e.head,l=i?1:-1;if(n==(i?r.state.doc.length:0))return he.cursor(n,e.assoc);let u=e.goalColumn,c,h=r.contentDOM.getBoundingClientRect(),f=r.coordsAtPos(n),p=r.documentTop;if(f)u==null&&(u=f.left-h.left),c=l<0?f.top:f.bottom;else{let $=r.viewState.lineBlockAt(n);u==null&&(u=Math.min(h.right-h.left,r.defaultCharacterWidth*(n-$.from))),c=(l<0?$.top:$.bottom)+p}let g=h.left+u,T=s??r.defaultLineHeight>>1;for(let $=0;;$+=10){let y=c+(T+$)*l,R=vO(r,{x:g,y},!1,l);if(y<h.top||y>h.bottom||(l<0?R<n:R>n))return he.cursor(R,e.assoc,void 0,u)}}function I1(r,e,i){let s=r.state.facet(pO).map(n=>n(r));for(;;){let n=!1;for(let l of s)l.between(i.from-1,i.from+1,(u,c,h)=>{i.from>u&&i.from<c&&(i=e.head>i.from?he.cursor(u,1):he.cursor(c,-1),n=!0)});if(!n)return i}}class bF{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.mouseSelection=null;let i=(s,n)=>{this.ignoreDuringComposition(n)||n.type=="keydown"&&this.keydown(e,n)||(this.mustFlushObserver(n)&&e.observer.forceFlush(),this.runCustomHandlers(n.type,e,n)?n.preventDefault():s(e,n))};for(let s in zi){let n=zi[s];e.contentDOM.addEventListener(s,l=>{$I(e,l)&&i(n,l)},H_[s]),this.registeredEvents.push(s)}e.scrollDOM.addEventListener("mousedown",s=>{s.target==e.scrollDOM&&s.clientY>e.contentDOM.getBoundingClientRect().bottom&&i(zi.mousedown,s)}),Be.chrome&&Be.chrome_version==102&&e.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,Be.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,i){var s;let n;this.customHandlers=[];for(let l of i)if(n=(s=l.update(e).spec)===null||s===void 0?void 0:s.domEventHandlers){this.customHandlers.push({plugin:l.value,handlers:n});for(let u in n)this.registeredEvents.indexOf(u)<0&&u!="scroll"&&(this.registeredEvents.push(u),e.contentDOM.addEventListener(u,c=>{$I(e,c)&&this.runCustomHandlers(u,e,c)&&c.preventDefault()}))}}runCustomHandlers(e,i,s){for(let n of this.customHandlers){let l=n.handlers[e];if(l)try{if(l.call(n.plugin,s,i)||s.defaultPrevented)return!0}catch(u){ss(i.state,u)}}return!1}runScrollHandlers(e,i){this.lastScrollTop=e.scrollDOM.scrollTop,this.lastScrollLeft=e.scrollDOM.scrollLeft;for(let s of this.customHandlers){let n=s.handlers.scroll;if(n)try{n.call(s.plugin,i,e)}catch(l){ss(e.state,l)}}}keydown(e,i){if(this.lastKeyCode=i.keyCode,this.lastKeyTime=Date.now(),i.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(Be.android&&Be.chrome&&!i.synthetic&&(i.keyCode==13||i.keyCode==8))return e.observer.delayAndroidKey(i.key,i.keyCode),!0;let s;return Be.ios&&!i.synthetic&&!i.altKey&&!i.metaKey&&((s=yO.find(n=>n.keyCode==i.keyCode))&&!i.ctrlKey||TF.indexOf(i.key)>-1&&i.ctrlKey&&!i.shiftKey)?(this.pendingIOSKey=s||i,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let i=this.pendingIOSKey;return i?(this.pendingIOSKey=void 0,ja(e.contentDOM,i.key,i.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Be.safari&&!Be.ios&&Date.now()-this.compositionEndedAt<100?(this.compositionEndedAt=0,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const yO=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],TF="dthko",SO=[16,17,18,20,91,92,224,225];function e0(r){return r*.7+8}class EF{constructor(e,i,s,n){this.view=e,this.style=s,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=i,this.scrollParent=HP(e.contentDOM);let l=e.contentDOM.ownerDocument;l.addEventListener("mousemove",this.move=this.move.bind(this)),l.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=i.shiftKey,this.multiple=e.state.facet(xt.allowMultipleSelections)&&$F(e,i),this.dragMove=vF(e,i),this.dragging=yF(e,i)&&CO(i)==1?null:!1}start(e){this.dragging===!1&&(e.preventDefault(),this.select(e))}move(e){var i;if(e.buttons==0)return this.destroy();if(this.dragging!==!1)return;this.select(this.lastEvent=e);let s=0,n=0,l=((i=this.scrollParent)===null||i===void 0?void 0:i.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight};e.clientX<=l.left?s=-e0(l.left-e.clientX):e.clientX>=l.right&&(s=e0(e.clientX-l.right)),e.clientY<=l.top?n=-e0(l.top-e.clientY):e.clientY>=l.bottom&&(n=e0(e.clientY-l.bottom)),this.setScrollSpeed(s,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(e,i){this.scrollSpeed={x:e,y:i},e||i?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}select(e){let i=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!i.eq(this.view.state.selection)||i.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function $F(r,e){let i=r.state.facet(nO);return i.length?i[0](e):Be.mac?e.metaKey:e.ctrlKey}function vF(r,e){let i=r.state.facet(oO);return i.length?i[0](e):Be.mac?!e.altKey:!e.ctrlKey}function yF(r,e){let{main:i}=r.state.selection;if(i.empty)return!1;let s=K0(r.root);if(!s||s.rangeCount==0)return!0;let n=s.getRangeAt(0).getClientRects();for(let l=0;l<n.length;l++){let u=n[l];if(u.left<=e.clientX&&u.right>=e.clientX&&u.top<=e.clientY&&u.bottom>=e.clientY)return!0}return!1}function $I(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i=e.target,s;i!=r.contentDOM;i=i.parentNode)if(!i||i.nodeType==11||(s=Zt.get(i))&&s.ignoreEvent(e))return!1;return!0}const zi=Object.create(null),H_=Object.create(null),IO=Be.ie&&Be.ie_version<15||Be.ios&&Be.webkit_version<604;function SF(r){let e=r.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(()=>{r.focus(),i.remove(),kO(r,i.value)},50)}function kO(r,e){let{state:i}=r,s,n=1,l=i.toText(e),u=l.lines==i.selection.ranges.length;if(G_!=null&&i.selection.ranges.every(h=>h.empty)&&G_==l.toString()){let h=-1;s=i.changeByRange(f=>{let p=i.doc.lineAt(f.from);if(p.from==h)return{range:f};h=p.from;let g=i.toText((u?l.line(n++).text:e)+i.lineBreak);return{changes:{from:p.from,insert:g},range:he.cursor(f.from+g.length)}})}else u?s=i.changeByRange(h=>{let f=l.line(n++);return{changes:{from:h.from,to:h.to,insert:f.text},range:he.cursor(h.from+f.length)}}):s=i.replaceSelection(l);r.dispatch(s,{userEvent:"input.paste",scrollIntoView:!0})}zi.keydown=(r,e)=>{r.inputState.setSelectionOrigin("select"),e.keyCode==27?r.inputState.lastEscPress=Date.now():SO.indexOf(e.keyCode)<0&&(r.inputState.lastEscPress=0)};zi.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};zi.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};H_.touchstart=H_.touchmove={passive:!0};zi.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return;let i=null;for(let s of r.state.facet(lO))if(i=s(r,e),i)break;if(!i&&e.button==0&&(i=AF(r,e)),i){let s=r.root.activeElement!=r.contentDOM;r.inputState.startMouseSelection(new EF(r,e,i,s)),s&&r.observer.ignore(()=>Y4(r.contentDOM)),r.inputState.mouseSelection&&r.inputState.mouseSelection.start(e)}};function vI(r,e,i,s){if(s==1)return he.cursor(e,i);if(s==2)return cF(r.state,e,i);{let n=yr.find(r.docView,e),l=r.state.doc.lineAt(n?n.posAtEnd:e),u=n?n.posAtStart:l.from,c=n?n.posAtEnd:l.to;return c<r.state.doc.length&&c==l.to&&c++,he.range(u,c)}}let AO=(r,e)=>r>=e.top&&r<=e.bottom,yI=(r,e,i)=>AO(e,i)&&r>=i.left&&r<=i.right;function IF(r,e,i,s){let n=yr.find(r.docView,e);if(!n)return 1;let l=e-n.posAtStart;if(l==0)return 1;if(l==n.length)return-1;let u=n.coordsAt(l,-1);if(u&&yI(i,s,u))return-1;let c=n.coordsAt(l,1);return c&&yI(i,s,c)?1:u&&AO(s,u)?-1:1}function SI(r,e){let i=r.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:IF(r,i,e.clientX,e.clientY)}}const kF=Be.ie&&Be.ie_version<=11;let II=null,kI=0,AI=0;function CO(r){if(!kF)return r.detail;let e=II,i=AI;return II=r,AI=Date.now(),kI=!e||i>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(kI+1)%3:1}function AF(r,e){let i=SI(r,e),s=CO(e),n=r.state.selection;return{update(l){l.docChanged&&(i.pos=l.changes.mapPos(i.pos),n=n.map(l.changes))},get(l,u,c){let h=SI(r,l),f=vI(r,h.pos,h.bias,s);if(i.pos!=h.pos&&!u){let p=vI(r,i.pos,i.bias,s),g=Math.min(p.from,f.from),T=Math.max(p.to,f.to);f=g<f.from?he.range(g,T):he.range(T,g)}return u?n.replaceRange(n.main.extend(f.from,f.to)):c&&n.ranges.length>1&&n.ranges.some(p=>p.eq(f))?CF(n,f):c?n.addRange(f):he.create([f])}}}function CF(r,e){for(let i=0;;i++)if(r.ranges[i].eq(e))return he.create(r.ranges.slice(0,i).concat(r.ranges.slice(i+1)),r.mainIndex==i?0:r.mainIndex-(r.mainIndex>i?1:0))}zi.dragstart=(r,e)=>{let{selection:{main:i}}=r.state,{mouseSelection:s}=r.inputState;s&&(s.dragging=i),e.dataTransfer&&(e.dataTransfer.setData("Text",r.state.sliceDoc(i.from,i.to)),e.dataTransfer.effectAllowed="copyMove")};function CI(r,e,i,s){if(!i)return;let n=r.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:l}=r.inputState,u=s&&l&&l.dragging&&l.dragMove?{from:l.dragging.from,to:l.dragging.to}:null,c={from:n,insert:i},h=r.state.changes(u?[u,c]:c);r.focus(),r.dispatch({changes:h,selection:{anchor:h.mapPos(n,-1),head:h.mapPos(n,1)},userEvent:u?"move.drop":"input.drop"})}zi.drop=(r,e)=>{if(!e.dataTransfer)return;if(r.state.readOnly)return e.preventDefault();let i=e.dataTransfer.files;if(i&&i.length){e.preventDefault();let s=Array(i.length),n=0,l=()=>{++n==i.length&&CI(r,e,s.filter(u=>u!=null).join(r.state.lineBreak),!1)};for(let u=0;u<i.length;u++){let c=new FileReader;c.onerror=l,c.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(c.result)||(s[u]=c.result),l()},c.readAsText(i[u])}}else CI(r,e,e.dataTransfer.getData("Text"),!0)};zi.paste=(r,e)=>{if(r.state.readOnly)return e.preventDefault();r.observer.flush();let i=IO?null:e.clipboardData;i?(kO(r,i.getData("text/plain")||i.getData("text/uri-text")),e.preventDefault()):SF(r)};function OF(r,e){let i=r.dom.parentNode;if(!i)return;let s=i.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.value=e,s.focus(),s.selectionEnd=e.length,s.selectionStart=0,setTimeout(()=>{s.remove(),r.focus()},50)}function wF(r){let e=[],i=[],s=!1;for(let n of r.selection.ranges)n.empty||(e.push(r.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let n=-1;for(let{from:l}of r.selection.ranges){let u=r.doc.lineAt(l);u.number>n&&(e.push(u.text),i.push({from:u.from,to:Math.min(r.doc.length,u.to+1)})),n=u.number}s=!0}return{text:e.join(r.lineBreak),ranges:i,linewise:s}}let G_=null;zi.copy=zi.cut=(r,e)=>{let{text:i,ranges:s,linewise:n}=wF(r.state);if(!i&&!n)return;G_=n?i:null;let l=IO?null:e.clipboardData;l?(e.preventDefault(),l.clearData(),l.setData("text/plain",i)):OF(r,i),e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:s,scrollIntoView:!0,userEvent:"delete.cut"})};const OO=ho.define();function wO(r,e){let i=[];for(let s of r.facet(cO)){let n=s(r,e);n&&i.push(n)}return i?r.update({effects:i,annotations:OO.of(!0)}):null}function RO(r){setTimeout(()=>{let e=r.hasFocus;if(e!=r.inputState.notifiedFocused){let i=wO(r.state,e);i?r.dispatch(i):r.update([])}},10)}zi.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),RO(r)};zi.blur=r=>{r.observer.clearSelectionRange(),RO(r)};zi.compositionstart=zi.compositionupdate=r=>{r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0)};zi.compositionend=r=>{r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionFirstChange=null,Be.chrome&&Be.android&&r.observer.flushSoon(),setTimeout(()=>{r.inputState.composing<0&&r.docView.compositionDeco.size&&r.update([])},50)};zi.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};zi.beforeinput=(r,e)=>{var i;let s;if(Be.chrome&&Be.android&&(s=yO.find(n=>n.inputType==e.inputType))&&(r.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let n=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var l;(((l=window.visualViewport)===null||l===void 0?void 0:l.height)||0)>n+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}};const OI=["pre-wrap","normal","pre-line","break-spaces"];class RF{constructor(e){this.lineWrapping=e,this.doc=Bt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(e,i){let s=this.doc.lineAt(i).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(s+=Math.max(0,Math.ceil((i-e-s*this.lineLength*.5)/this.lineLength))),this.lineHeight*s}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return OI.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let i=!1;for(let s=0;s<e.length;s++){let n=e[s];n<0?s++:this.heightSamples[Math.floor(n*10)]||(i=!0,this.heightSamples[Math.floor(n*10)]=!0)}return i}refresh(e,i,s,n,l){let u=OI.indexOf(e)>-1,c=Math.round(i)!=Math.round(this.lineHeight)||this.lineWrapping!=u;if(this.lineWrapping=u,this.lineHeight=i,this.charWidth=s,this.lineLength=n,c){this.heightSamples={};for(let h=0;h<l.length;h++){let f=l[h];f<0?h++:this.heightSamples[Math.floor(f*10)]=!0}}return c}}class NF{constructor(e,i){this.from=e,this.heights=i,this.index=0}get more(){return this.index<this.heights.length}}class eo{constructor(e,i,s,n,l){this.from=e,this.length=i,this.top=s,this.height=n,this.type=l}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let i=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new eo(this.from,this.length+e.length,this.top,this.height+e.height,i)}}var Qt=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(Qt||(Qt={}));const S0=.001;class Sr{constructor(e,i,s=2){this.length=e,this.height=i,this.flags=s}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,i){this.height!=i&&(Math.abs(this.height-i)>S0&&(e.heightChanged=!0),this.height=i)}replace(e,i,s){return Sr.of(s)}decomposeLeft(e,i){i.push(this)}decomposeRight(e,i){i.push(this)}applyChanges(e,i,s,n){let l=this,u=s.doc;for(let c=n.length-1;c>=0;c--){let{fromA:h,toA:f,fromB:p,toB:g}=n[c],T=l.lineAt(h,Qt.ByPosNoHeight,s.setDoc(i),0,0),$=T.to>=f?T:l.lineAt(f,Qt.ByPosNoHeight,s,0,0);for(g+=$.to-f,f=$.to;c>0&&T.from<=n[c-1].toA;)h=n[c-1].fromA,p=n[c-1].fromB,c--,h<T.from&&(T=l.lineAt(h,Qt.ByPosNoHeight,s,0,0));p+=T.from-h,h=T.from;let y=fT.build(s.setDoc(u),e,p,g);l=l.replace(h,f,y)}return l.updateHeight(s,0)}static empty(){return new es(0,0)}static of(e){if(e.length==1)return e[0];let i=0,s=e.length,n=0,l=0;for(;;)if(i==s)if(n>l*2){let c=e[i-1];c.break?e.splice(--i,1,c.left,null,c.right):e.splice(--i,1,c.left,c.right),s+=1+c.break,n-=c.size}else if(l>n*2){let c=e[s];c.break?e.splice(s,1,c.left,null,c.right):e.splice(s,1,c.left,c.right),s+=2+c.break,l-=c.size}else break;else if(n<l){let c=e[i++];c&&(n+=c.size)}else{let c=e[--s];c&&(l+=c.size)}let u=0;return e[i-1]==null?(u=1,i--):e[i]==null&&(u=1,s++),new xF(Sr.of(e.slice(0,i)),u,Sr.of(e.slice(s)))}}Sr.prototype.size=1;class NO extends Sr{constructor(e,i,s){super(e,i),this.type=s}blockAt(e,i,s,n){return new eo(n,this.length,s,this.height,this.type)}lineAt(e,i,s,n,l){return this.blockAt(0,s,n,l)}forEachLine(e,i,s,n,l,u){e<=l+this.length&&i>=l&&u(this.blockAt(0,s,n,l))}updateHeight(e,i=0,s=!1,n){return n&&n.from<=i&&n.more&&this.setHeight(e,n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class es extends NO{constructor(e,i){super(e,i,Wt.Text),this.collapsed=0,this.widgetHeight=0}replace(e,i,s){let n=s[0];return s.length==1&&(n instanceof es||n instanceof Zi&&n.flags&4)&&Math.abs(this.length-n.length)<10?(n instanceof Zi?n=new es(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):Sr.of(s)}updateHeight(e,i=0,s=!1,n){return n&&n.from<=i&&n.more?this.setHeight(e,n.heights[n.index++]):(s||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Zi extends Sr{constructor(e){super(e,0)}heightMetrics(e,i){let s=e.doc.lineAt(i).number,n=e.doc.lineAt(i+this.length).number,l=n-s+1,u,c=0;if(e.lineWrapping){let h=Math.min(this.height,e.lineHeight*l);u=h/l,c=(this.height-h)/(this.length-l-1)}else u=this.height/l;return{firstLine:s,lastLine:n,perLine:u,perChar:c}}blockAt(e,i,s,n){let{firstLine:l,lastLine:u,perLine:c,perChar:h}=this.heightMetrics(i,n);if(i.lineWrapping){let f=n+Math.round(Math.max(0,Math.min(1,(e-s)/this.height))*this.length),p=i.doc.lineAt(f),g=c+p.length*h,T=Math.max(s,e-g/2);return new eo(p.from,p.length,T,g,Wt.Text)}else{let f=Math.max(0,Math.min(u-l,Math.floor((e-s)/c))),{from:p,length:g}=i.doc.line(l+f);return new eo(p,g,s+c*f,c,Wt.Text)}}lineAt(e,i,s,n,l){if(i==Qt.ByHeight)return this.blockAt(e,s,n,l);if(i==Qt.ByPosNoHeight){let{from:$,to:y}=s.doc.lineAt(e);return new eo($,y-$,0,0,Wt.Text)}let{firstLine:u,perLine:c,perChar:h}=this.heightMetrics(s,l),f=s.doc.lineAt(e),p=c+f.length*h,g=f.number-u,T=n+c*g+h*(f.from-l-g);return new eo(f.from,f.length,Math.max(n,Math.min(T,n+this.height-p)),p,Wt.Text)}forEachLine(e,i,s,n,l,u){e=Math.max(e,l),i=Math.min(i,l+this.length);let{firstLine:c,perLine:h,perChar:f}=this.heightMetrics(s,l);for(let p=e,g=n;p<=i;){let T=s.doc.lineAt(p);if(p==e){let y=T.number-c;g+=h*y+f*(e-l-y)}let $=h+f*T.length;u(new eo(T.from,T.length,g,$,Wt.Text)),g+=$,p=T.to+1}}replace(e,i,s){let n=this.length-i;if(n>0){let l=s[s.length-1];l instanceof Zi?s[s.length-1]=new Zi(l.length+n):s.push(null,new Zi(n-1))}if(e>0){let l=s[0];l instanceof Zi?s[0]=new Zi(e+l.length):s.unshift(new Zi(e-1),null)}return Sr.of(s)}decomposeLeft(e,i){i.push(new Zi(e-1),null)}decomposeRight(e,i){i.push(null,new Zi(this.length-e-1))}updateHeight(e,i=0,s=!1,n){let l=i+this.length;if(n&&n.from<=i+this.length&&n.more){let u=[],c=Math.max(i,n.from),h=-1;for(n.from>i&&u.push(new Zi(n.from-i-1).updateHeight(e,i));c<=l&&n.more;){let p=e.doc.lineAt(c).length;u.length&&u.push(null);let g=n.heights[n.index++];h==-1?h=g:Math.abs(g-h)>=S0&&(h=-2);let T=new es(p,g);T.outdated=!1,u.push(T),c+=p+1}c<=l&&u.push(null,new Zi(l-c).updateHeight(e,c));let f=Sr.of(u);return(h<0||Math.abs(f.height-this.height)>=S0||Math.abs(h-this.heightMetrics(e,i).perLine)>=S0)&&(e.heightChanged=!0),f}else(s||this.outdated)&&(this.setHeight(e,e.heightForGap(i,i+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class xF extends Sr{constructor(e,i,s){super(e.length+i+s.length,e.height+s.height,i|(e.outdated||s.outdated?2:0)),this.left=e,this.right=s,this.size=e.size+s.size}get break(){return this.flags&1}blockAt(e,i,s,n){let l=s+this.left.height;return e<l?this.left.blockAt(e,i,s,n):this.right.blockAt(e,i,l,n+this.left.length+this.break)}lineAt(e,i,s,n,l){let u=n+this.left.height,c=l+this.left.length+this.break,h=i==Qt.ByHeight?e<u:e<c,f=h?this.left.lineAt(e,i,s,n,l):this.right.lineAt(e,i,s,u,c);if(this.break||(h?f.to<c:f.from>c))return f;let p=i==Qt.ByPosNoHeight?Qt.ByPosNoHeight:Qt.ByPos;return h?f.join(this.right.lineAt(c,p,s,u,c)):this.left.lineAt(c,p,s,n,l).join(f)}forEachLine(e,i,s,n,l,u){let c=n+this.left.height,h=l+this.left.length+this.break;if(this.break)e<h&&this.left.forEachLine(e,i,s,n,l,u),i>=h&&this.right.forEachLine(e,i,s,c,h,u);else{let f=this.lineAt(h,Qt.ByPos,s,n,l);e<f.from&&this.left.forEachLine(e,f.from-1,s,n,l,u),f.to>=e&&f.from<=i&&u(f),i>f.to&&this.right.forEachLine(f.to+1,i,s,c,h,u)}}replace(e,i,s){let n=this.left.length+this.break;if(i<n)return this.balanced(this.left.replace(e,i,s),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-n,i-n,s));let l=[];e>0&&this.decomposeLeft(e,l);let u=l.length;for(let c of s)l.push(c);if(e>0&&wI(l,u-1),i<this.length){let c=l.length;this.decomposeRight(i,l),wI(l,c)}return Sr.of(l)}decomposeLeft(e,i){let s=this.left.length;if(e<=s)return this.left.decomposeLeft(e,i);i.push(this.left),this.break&&(s++,e>=s&&i.push(null)),e>s&&this.right.decomposeLeft(e-s,i)}decomposeRight(e,i){let s=this.left.length,n=s+this.break;if(e>=n)return this.right.decomposeRight(e-n,i);e<s&&this.left.decomposeRight(e,i),this.break&&e<n&&i.push(null),i.push(this.right)}balanced(e,i){return e.size>2*i.size||i.size>2*e.size?Sr.of(this.break?[e,null,i]:[e,i]):(this.left=e,this.right=i,this.height=e.height+i.height,this.outdated=e.outdated||i.outdated,this.size=e.size+i.size,this.length=e.length+this.break+i.length,this)}updateHeight(e,i=0,s=!1,n){let{left:l,right:u}=this,c=i+l.length+this.break,h=null;return n&&n.from<=i+l.length&&n.more?h=l=l.updateHeight(e,i,s,n):l.updateHeight(e,i,s),n&&n.from<=c+u.length&&n.more?h=u=u.updateHeight(e,c,s,n):u.updateHeight(e,c,s),h?this.balanced(l,u):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function wI(r,e){let i,s;r[e]==null&&(i=r[e-1])instanceof Zi&&(s=r[e+1])instanceof Zi&&r.splice(e-1,3,new Zi(i.length+1+s.length))}const DF=5;class fT{constructor(e,i){this.pos=e,this.oracle=i,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,i){if(this.lineStart>-1){let s=Math.min(i,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof es?n.length+=s-this.pos:(s>this.pos||!this.isCovered)&&this.nodes.push(new es(s-this.pos,-1)),this.writtenTo=s,i>s&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=i}point(e,i,s){if(e<i||s.heightRelevant){let n=s.widget?s.widget.estimatedHeight:0;n<0&&(n=this.oracle.lineHeight);let l=i-e;s.block?this.addBlock(new NO(l,n,s.type)):(l||n>=DF)&&this.addLineDeco(n,l)}else i>e&&this.span(e,i);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:i}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=i,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new es(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,i){let s=new Zi(i-e);return this.oracle.doc.lineAt(e).to==i&&(s.flags|=4),s}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof es)return e;let i=new es(0,-1);return this.nodes.push(i),i}addBlock(e){this.enterLine(),e.type==Wt.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=Wt.WidgetBefore&&(this.covering=e)}addLineDeco(e,i){let s=this.ensureLine();s.length+=i,s.collapsed+=i,s.widgetHeight=Math.max(s.widgetHeight,e),this.writtenTo=this.pos=this.pos+i}finish(e){let i=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(i instanceof es)&&!this.isCovered?this.nodes.push(new es(0,-1)):(this.writtenTo<this.pos||i==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let s=e;for(let n of this.nodes)n instanceof es&&n.updateHeight(this.oracle,s),s+=n?n.length:1;return this.nodes}static build(e,i,s,n){let l=new fT(s,e);return Ht.spans(i,s,n,l,0),l.finish(s)}}function LF(r,e,i){let s=new MF;return Ht.compare(r,e,i,s,0),s.changes}class MF{constructor(){this.changes=[]}compareRange(){}comparePoint(e,i,s,n){(e<i||s&&s.heightRelevant||n&&n.heightRelevant)&&M_(e,i,this.changes,5)}}function BF(r,e){let i=r.getBoundingClientRect(),s=r.ownerDocument,n=s.defaultView||window,l=Math.max(0,i.left),u=Math.min(n.innerWidth,i.right),c=Math.max(0,i.top),h=Math.min(n.innerHeight,i.bottom);for(let f=r.parentNode;f&&f!=s.body;)if(f.nodeType==1){let p=f,g=window.getComputedStyle(p);if((p.scrollHeight>p.clientHeight||p.scrollWidth>p.clientWidth)&&g.overflow!="visible"){let T=p.getBoundingClientRect();l=Math.max(l,T.left),u=Math.min(u,T.right),c=Math.max(c,T.top),h=f==r.parentNode?T.bottom:Math.min(h,T.bottom)}f=g.position=="absolute"||g.position=="fixed"?p.offsetParent:p.parentNode}else if(f.nodeType==11)f=f.host;else break;return{left:l-i.left,right:Math.max(l,u)-i.left,top:c-(i.top+e),bottom:Math.max(c,h)-(i.top+e)}}function PF(r,e){let i=r.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class k1{constructor(e,i,s){this.from=e,this.to=i,this.size=s}static same(e,i){if(e.length!=i.length)return!1;for(let s=0;s<e.length;s++){let n=e[s],l=i[s];if(n.from!=l.from||n.to!=l.to||n.size!=l.size)return!1}return!0}draw(e){return Ge.replace({widget:new FF(this.size,e)}).range(this.from,this.to)}}class FF extends fo{constructor(e,i){super(),this.size=e,this.vertical=i}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class RI{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=NI,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=hi.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let i=e.facet(dT).some(s=>typeof s!="function"&&s.class=="cm-lineWrapping");this.heightOracle=new RF(i),this.stateDeco=e.facet(eh).filter(s=>typeof s!="function"),this.heightMap=Sr.empty().applyChanges(this.stateDeco,Bt.empty,this.heightOracle.setDoc(e.doc),[new An(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ge.set(this.lineGaps.map(s=>s.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:i}=this.state.selection;for(let s=0;s<=1;s++){let n=s?i.head:i.anchor;if(!e.some(({from:l,to:u})=>n>=l&&n<=u)){let{from:l,to:u}=this.lineBlockAt(n);e.push(new t0(l,u))}}this.viewports=e.sort((s,n)=>s.from-n.from),this.scaler=this.heightMap.height<=7e6?NI:new GF(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:Ac(e,this.scaler))})}update(e,i=null){this.state=e.state;let s=this.stateDeco;this.stateDeco=this.state.facet(eh).filter(f=>typeof f!="function");let n=e.changedRanges,l=An.extendWithRanges(n,LF(s,this.stateDeco,e?e.changes:Hi.empty(this.state.doc.length))),u=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),l),this.heightMap.height!=u&&(e.flags|=2);let c=l.length?this.mapViewport(this.viewport,e.changes):this.viewport;(i&&(i.range.head<c.from||i.range.head>c.to)||!this.viewportIsAppropriate(c))&&(c=this.getViewport(0,i));let h=!e.changes.empty||e.flags&2||c.from!=this.viewport.from||c.to!=this.viewport.to;this.viewport=c,this.updateForViewport(),h&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),i&&(this.scrollTarget=i),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(dO)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let i=e.contentDOM,s=window.getComputedStyle(i),n=this.heightOracle,l=s.whiteSpace;this.defaultTextDirection=s.direction=="rtl"?hi.RTL:hi.LTR;let u=this.heightOracle.mustRefreshForWrapping(l),c=i.getBoundingClientRect(),h=u||this.mustMeasureContent||this.contentDOMHeight!=c.height;this.contentDOMHeight=c.height,this.mustMeasureContent=!1;let f=0,p=0,g=parseInt(s.paddingTop)||0,T=parseInt(s.paddingBottom)||0;(this.paddingTop!=g||this.paddingBottom!=T)&&(this.paddingTop=g,this.paddingBottom=T,f|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(n.lineWrapping&&(h=!0),this.editorWidth=e.scrollDOM.clientWidth,f|=8);let $=(this.printing?PF:BF)(i,this.paddingTop),y=$.top-this.pixelViewport.top,R=$.bottom-this.pixelViewport.bottom;this.pixelViewport=$;let C=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(C!=this.inView&&(this.inView=C,C&&(h=!0)),!this.inView&&!this.scrollTarget)return 0;let x=c.width;if((this.contentDOMWidth!=x||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=c.width,this.editorHeight=e.scrollDOM.clientHeight,f|=8),h){let F=e.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(F)&&(u=!0),u||n.lineWrapping&&Math.abs(x-this.contentDOMWidth)>n.charWidth){let{lineHeight:q,charWidth:W}=e.docView.measureTextSize();u=q>0&&n.refresh(l,q,W,x/W,F),u&&(e.docView.minWidth=0,f|=8)}y>0&&R>0?p=Math.max(y,R):y<0&&R<0&&(p=Math.min(y,R)),n.heightChanged=!1;for(let q of this.viewports){let W=q.from==this.viewport.from?F:e.docView.measureVisibleLineHeights(q);this.heightMap=(u?Sr.empty().applyChanges(this.stateDeco,Bt.empty,this.heightOracle,[new An(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(n,0,u,new NF(q.from,W))}n.heightChanged&&(f|=2)}let j=!this.viewportIsAppropriate(this.viewport,p)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return j&&(this.viewport=this.getViewport(p,this.scrollTarget)),this.updateForViewport(),(f&2||j)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(u?[]:this.lineGaps,e)),f|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),f}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,i){let s=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),n=this.heightMap,l=this.heightOracle,{visibleTop:u,visibleBottom:c}=this,h=new t0(n.lineAt(u-s*1e3,Qt.ByHeight,l,0,0).from,n.lineAt(c+(1-s)*1e3,Qt.ByHeight,l,0,0).to);if(i){let{head:f}=i.range;if(f<h.from||f>h.to){let p=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),g=n.lineAt(f,Qt.ByPos,l,0,0),T;i.y=="center"?T=(g.top+g.bottom)/2-p/2:i.y=="start"||i.y=="nearest"&&f<h.from?T=g.top:T=g.bottom-p,h=new t0(n.lineAt(T-1e3/2,Qt.ByHeight,l,0,0).from,n.lineAt(T+p+1e3/2,Qt.ByHeight,l,0,0).to)}}return h}mapViewport(e,i){let s=i.mapPos(e.from,-1),n=i.mapPos(e.to,1);return new t0(this.heightMap.lineAt(s,Qt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,Qt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:i},s=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(e,Qt.ByPos,this.heightOracle,0,0),{bottom:l}=this.heightMap.lineAt(i,Qt.ByPos,this.heightOracle,0,0),{visibleTop:u,visibleBottom:c}=this;return(e==0||n<=u-Math.max(10,Math.min(-s,250)))&&(i==this.state.doc.length||l>=c+Math.max(10,Math.min(s,250)))&&n>u-2*1e3&&l<c+2*1e3}mapLineGaps(e,i){if(!e.length||i.empty)return e;let s=[];for(let n of e)i.touchesRange(n.from,n.to)||s.push(new k1(i.mapPos(n.from),i.mapPos(n.to),n.size));return s}ensureLineGaps(e,i){let s=this.heightOracle.lineWrapping,n=s?1e4:2e3,l=n>>1,u=n<<1;if(this.defaultTextDirection!=hi.LTR&&!s)return[];let c=[],h=(f,p,g,T)=>{if(p-f<l)return;let $=this.state.selection.main,y=[$.from];$.empty||y.push($.to);for(let C of y)if(C>f&&C<p){h(f,C-10,g,T),h(C+10,p,g,T);return}let R=HF(e,C=>C.from>=g.from&&C.to<=g.to&&Math.abs(C.from-f)<l&&Math.abs(C.to-p)<l&&!y.some(x=>C.from<x&&C.to>x));if(!R){if(p<g.to&&i&&s&&i.visibleRanges.some(C=>C.from<=p&&C.to>=p)){let C=i.moveToLineBoundary(he.cursor(p),!1,!0).head;C>f&&(p=C)}R=new k1(f,p,this.gapSize(g,f,p,T))}c.push(R)};for(let f of this.viewportLines){if(f.length<u)continue;let p=UF(f.from,f.to,this.stateDeco);if(p.total<u)continue;let g=this.scrollTarget?this.scrollTarget.range.head:null,T,$;if(s){let y=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,R,C;if(g!=null){let x=r0(p,g),j=((this.visibleBottom-this.visibleTop)/2+y)/f.height;R=x-j,C=x+j}else R=(this.visibleTop-f.top-y)/f.height,C=(this.visibleBottom-f.top+y)/f.height;T=i0(p,R),$=i0(p,C)}else{let y=p.total*this.heightOracle.charWidth,R=n*this.heightOracle.charWidth,C,x;if(g!=null){let j=r0(p,g),F=((this.pixelViewport.right-this.pixelViewport.left)/2+R)/y;C=j-F,x=j+F}else C=(this.pixelViewport.left-R)/y,x=(this.pixelViewport.right+R)/y;T=i0(p,C),$=i0(p,x)}T>f.from&&h(f.from,T,f,p),$<f.to&&h($,f.to,f,p)}return c}gapSize(e,i,s,n){let l=r0(n,s)-r0(n,i);return this.heightOracle.lineWrapping?e.height*l:n.total*this.heightOracle.charWidth*l}updateLineGaps(e){k1.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ge.set(e.map(i=>i.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];Ht.spans(e,this.viewport.from,this.viewport.to,{span(n,l){i.push({from:n,to:l})},point(){}},20);let s=i.length!=this.visibleRanges.length||this.visibleRanges.some((n,l)=>n.from!=i[l].from||n.to!=i[l].to);return this.visibleRanges=i,s?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(i=>i.from<=e&&i.to>=e)||Ac(this.heightMap.lineAt(e,Qt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return Ac(this.heightMap.lineAt(this.scaler.fromDOM(e),Qt.ByHeight,this.heightOracle,0,0),this.scaler)}elementAtHeight(e){return Ac(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class t0{constructor(e,i){this.from=e,this.to=i}}function UF(r,e,i){let s=[],n=r,l=0;return Ht.spans(i,r,e,{span(){},point(u,c){u>n&&(s.push({from:n,to:u}),l+=u-n),n=c}},20),n<e&&(s.push({from:n,to:e}),l+=e-n),{total:l,ranges:s}}function i0({total:r,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let s=Math.floor(r*i);for(let n=0;;n++){let{from:l,to:u}=e[n],c=u-l;if(s<=c)return l+s;s-=c}}function r0(r,e){let i=0;for(let{from:s,to:n}of r.ranges){if(e<=n){i+=e-s;break}i+=n-s}return i/r.total}function HF(r,e){for(let i of r)if(e(i))return i}const NI={toDOM(r){return r},fromDOM(r){return r},scale:1};class GF{constructor(e,i,s){let n=0,l=0,u=0;this.viewports=s.map(({from:c,to:h})=>{let f=i.lineAt(c,Qt.ByPos,e,0,0).top,p=i.lineAt(h,Qt.ByPos,e,0,0).bottom;return n+=p-f,{from:c,to:h,top:f,bottom:p,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(i.height-n);for(let c of this.viewports)c.domTop=u+(c.top-l)*this.scale,u=c.domBottom=c.domTop+(c.bottom-c.top),l=c.bottom}toDOM(e){for(let i=0,s=0,n=0;;i++){let l=i<this.viewports.length?this.viewports[i]:null;if(!l||e<l.top)return n+(e-s)*this.scale;if(e<=l.bottom)return l.domTop+(e-l.top);s=l.bottom,n=l.domBottom}}fromDOM(e){for(let i=0,s=0,n=0;;i++){let l=i<this.viewports.length?this.viewports[i]:null;if(!l||e<l.domTop)return s+(e-n)/this.scale;if(e<=l.domBottom)return l.top+(e-l.domTop);s=l.bottom,n=l.domBottom}}}function Ac(r,e){if(e.scale==1)return r;let i=e.toDOM(r.top),s=e.toDOM(r.bottom);return new eo(r.from,r.length,i,s-i,Array.isArray(r.type)?r.type.map(n=>Ac(n,e)):r.type)}const s0=Pe.define({combine:r=>r.join(" ")}),V_=Pe.define({combine:r=>r.indexOf(!0)>-1}),W_=Ko.newName(),xO=Ko.newName(),DO=Ko.newName(),LO={"&light":"."+xO,"&dark":"."+DO};function z_(r,e,i){return new Ko(e,{finish(s){return/&/.test(s)?s.replace(/&\w*/,n=>{if(n=="&")return r;if(!i||!i[n])throw new RangeError(`Unsupported selector: ${n}`);return i[n]}):r+" "+s}})}const VF=z_("."+W_,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},LO);class WF{constructor(e,i,s,n){this.typeOver=n,this.bounds=null,this.text="";let{impreciseHead:l,impreciseAnchor:u}=e.docView;if(e.state.readOnly&&i>-1)this.newSel=null;else if(i>-1&&(this.bounds=e.docView.domBoundsAround(i,s,0))){let c=l||u?[]:YF(e),h=new TO(c,e.state);h.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=h.text,this.newSel=XF(c,this.bounds.from)}else{let c=e.observer.selectionRange,h=l&&l.node==c.focusNode&&l.offset==c.focusOffset||!tu(e.contentDOM,c.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(c.focusNode,c.focusOffset),f=u&&u.node==c.anchorNode&&u.offset==c.anchorOffset||!tu(e.contentDOM,c.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(c.anchorNode,c.anchorOffset);this.newSel=he.single(f,h)}}}function MO(r,e){let i,{newSel:s}=e,n=r.state.selection.main;if(e.bounds){let{from:l,to:u}=e.bounds,c=n.from,h=null;(r.inputState.lastKeyCode===8&&r.inputState.lastKeyTime>Date.now()-100||Be.android&&e.text.length<u-l)&&(c=n.to,h="end");let f=zF(r.state.doc.sliceString(l,u,Po),e.text,c-l,h);f&&(Be.chrome&&r.inputState.lastKeyCode==13&&f.toB==f.from+2&&e.text.slice(f.from,f.toB)==Po+Po&&f.toB--,i={from:l+f.from,to:l+f.toA,insert:Bt.of(e.text.slice(f.from,f.toB).split(Po))})}else s&&(!r.hasFocus&&r.state.facet(rp)||s.main.eq(n))&&(s=null);if(!i&&!s)return!1;if(!i&&e.typeOver&&!n.empty&&s&&s.main.empty?i={from:n.from,to:n.to,insert:r.state.doc.slice(n.from,n.to)}:i&&i.from>=n.from&&i.to<=n.to&&(i.from!=n.from||i.to!=n.to)&&n.to-n.from-(i.to-i.from)<=4?i={from:n.from,to:n.to,insert:r.state.doc.slice(n.from,i.from).append(i.insert).append(r.state.doc.slice(i.to,n.to))}:(Be.mac||Be.android)&&i&&i.from==i.to&&i.from==n.head-1&&/^\. ?$/.test(i.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(s&&i.insert.length==2&&(s=he.single(s.main.anchor-1,s.main.head-1)),i={from:n.from,to:n.to,insert:Bt.of([" "])}):Be.chrome&&i&&i.from==i.to&&i.from==n.head&&i.insert.toString()==`
 `&&r.lineWrapping&&(s&&(s=he.single(s.main.anchor-1,s.main.head-1)),i={from:n.from,to:n.to,insert:Bt.of([" "])}),i){let l=r.state;if(Be.ios&&r.inputState.flushIOSKey(r)||Be.android&&(i.from==n.from&&i.to==n.to&&i.insert.length==1&&i.insert.lines==2&&ja(r.contentDOM,"Enter",13)||i.from==n.from-1&&i.to==n.to&&i.insert.length==0&&ja(r.contentDOM,"Backspace",8)||i.from==n.from&&i.to==n.to+1&&i.insert.length==0&&ja(r.contentDOM,"Delete",46)))return!0;let u=i.insert.toString();if(r.state.facet(uO).some(f=>f(r,i.from,i.to,u)))return!0;r.inputState.composing>=0&&r.inputState.composing++;let c;if(i.from>=n.from&&i.to<=n.to&&i.to-i.from>=(n.to-n.from)/3&&(!s||s.main.empty&&s.main.from==i.from+i.insert.length)&&r.inputState.composing<0){let f=n.from<i.from?l.sliceDoc(n.from,i.from):"",p=n.to>i.to?l.sliceDoc(i.to,n.to):"";c=l.replaceSelection(r.state.toText(f+i.insert.sliceString(0,void 0,r.state.lineBreak)+p))}else{let f=l.changes(i),p=s&&!l.selection.main.eq(s.main)&&s.main.to<=f.newLength?s.main:void 0;if(l.selection.ranges.length>1&&r.inputState.composing>=0&&i.to<=n.to&&i.to>=n.to-10){let g=r.state.sliceDoc(i.from,i.to),T=EO(r)||r.state.doc.lineAt(n.head),$=n.to-i.to,y=n.to-n.from;c=l.changeByRange(R=>{if(R.from==n.from&&R.to==n.to)return{changes:f,range:p||R.map(f)};let C=R.to-$,x=C-g.length;if(R.to-R.from!=y||r.state.sliceDoc(x,C)!=g||T&&R.to>=T.from&&R.from<=T.to)return{range:R};let j=l.changes({from:x,to:C,insert:i.insert}),F=R.to-n.to;return{changes:j,range:p?he.range(Math.max(0,p.anchor+F),Math.max(0,p.head+F)):R.map(j)}})}else c={changes:f,selection:p&&l.selection.replaceRange(p)}}let h="input.type";return r.composing&&(h+=".compose",r.inputState.compositionFirstChange&&(h+=".start",r.inputState.compositionFirstChange=!1)),r.dispatch(c,{scrollIntoView:!0,userEvent:h}),!0}else if(s&&!s.main.eq(n)){let l=!1,u="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(l=!0),u=r.inputState.lastSelectionOrigin),r.dispatch({selection:s,scrollIntoView:l,userEvent:u}),!0}else return!1}function zF(r,e,i,s){let n=Math.min(r.length,e.length),l=0;for(;l<n&&r.charCodeAt(l)==e.charCodeAt(l);)l++;if(l==n&&r.length==e.length)return null;let u=r.length,c=e.length;for(;u>0&&c>0&&r.charCodeAt(u-1)==e.charCodeAt(c-1);)u--,c--;if(s=="end"){let h=Math.max(0,l-Math.min(u,c));i-=u+h-l}if(u<l&&r.length<e.length){let h=i<=l&&i>=u?l-i:0;l-=h,c=l+(c-u),u=l}else if(c<l){let h=i<=l&&i>=c?l-i:0;l-=h,u=l+(u-c),c=l}return{from:l,toA:u,toB:c}}function YF(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:i,anchorOffset:s,focusNode:n,focusOffset:l}=r.observer.selectionRange;return i&&(e.push(new fI(i,s)),(n!=i||l!=s)&&e.push(new fI(n,l))),e}function XF(r,e){if(r.length==0)return null;let i=r[0].pos,s=r.length==2?r[1].pos:i;return i>-1&&s>-1?he.single(i+e,s+e):null}const jF={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},A1=Be.ie&&Be.ie_version<=11;class KF{constructor(e){this.view=e,this.active=!1,this.selectionRange=new GP,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(i=>{for(let s of i)this.queue.push(s);(Be.ie&&Be.ie_version<=11||Be.ios&&e.composing)&&i.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),A1&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var i;((i=this.view.docView)===null||i===void 0?void 0:i.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM),this.resizeContent=new ResizeObserver(()=>this.view.requestMeasure()),this.resizeContent.observe(e.contentDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(i=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),i.length>0&&i[i.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(i=>{i.length>0&&i[i.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runScrollHandlers(this.view,e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((i,s)=>i!=e[s]))){this.gapIntersection.disconnect();for(let i of e)this.gapIntersection.observe(i);this.gaps=e}}onSelectionChange(e){let i=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:s}=this,n=this.selectionRange;if(s.state.facet(rp)?s.root.activeElement!=this.dom:!y0(s.dom,n))return;let l=n.anchorNode&&s.docView.nearest(n.anchorNode);if(l&&l.ignoreEvent(e)){i||(this.selectionChanged=!1);return}(Be.ie&&Be.ie_version<=11||Be.android&&Be.chrome)&&!s.state.selection.main.empty&&n.focusNode&&q0(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,i=Be.safari&&e.root.nodeType==11&&PP(this.dom.ownerDocument)==this.dom&&qF(this.view)||K0(e.root);if(!i||this.selectionRange.eq(i))return!1;let s=y0(this.dom,i);return s&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&WP(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),s&&(this.selectionChanged=!0),!0)}setSelectionRange(e,i){this.selectionRange.set(e.node,e.offset,i.node,i.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,i=null;for(let s=this.dom;s;)if(s.nodeType==1)!i&&e<this.scrollTargets.length&&this.scrollTargets[e]==s?e++:i||(i=this.scrollTargets.slice(0,e)),i&&i.push(s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;if(e<this.scrollTargets.length&&!i&&(i=this.scrollTargets.slice(0,e)),i){for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);for(let s of this.scrollTargets=i)s.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,jF),A1&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),A1&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,i){var s;if(!this.delayedAndroidKey){let n=()=>{let l=this.delayedAndroidKey;l&&(this.clearDelayedAndroidKey(),!this.flush()&&l.force&&ja(this.dom,l.key,l.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(n)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:i,force:this.lastChange<Date.now()-50||!!(!((s=this.delayedAndroidKey)===null||s===void 0)&&s.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}processRecords(){let e=this.queue;for(let l of this.observer.takeRecords())e.push(l);e.length&&(this.queue=[]);let i=-1,s=-1,n=!1;for(let l of e){let u=this.readMutation(l);u&&(u.typeOver&&(n=!0),i==-1?{from:i,to:s}=u:(i=Math.min(u.from,i),s=Math.max(u.to,s)))}return{from:i,to:s,typeOver:n}}readChange(){let{from:e,to:i,typeOver:s}=this.processRecords(),n=this.selectionChanged&&y0(this.dom,this.selectionRange);return e<0&&!n?null:(e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new WF(this.view,e,i,s))}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let i=this.readChange();if(!i)return!1;let s=this.view.state,n=MO(this.view,i);return this.view.state==s&&this.view.update([]),n}readMutation(e){let i=this.view.docView.nearest(e.target);if(!i||i.ignoreMutation(e))return null;if(i.markDirty(e.type=="attributes"),e.type=="attributes"&&(i.dirty|=4),e.type=="childList"){let s=xI(i,e.previousSibling||e.target.previousSibling,-1),n=xI(i,e.nextSibling||e.target.nextSibling,1);return{from:s?i.posAfter(s):i.posAtStart,to:n?i.posBefore(n):i.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:i.posAtStart,to:i.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,i,s,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(i=this.gapIntersection)===null||i===void 0||i.disconnect(),(s=this.resizeScroll)===null||s===void 0||s.disconnect(),(n=this.resizeContent)===null||n===void 0||n.disconnect();for(let l of this.scrollTargets)l.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function xI(r,e,i){for(;e;){let s=Zt.get(e);if(s&&s.parent==r)return s;let n=e.parentNode;e=n!=r.dom?n:i>0?e.nextSibling:e.previousSibling}return null}function qF(r){let e=null;function i(h){h.preventDefault(),h.stopImmediatePropagation(),e=h.getTargetRanges()[0]}if(r.contentDOM.addEventListener("beforeinput",i,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",i,!0),!e)return null;let s=e.startContainer,n=e.startOffset,l=e.endContainer,u=e.endOffset,c=r.docView.domAtPos(r.state.selection.main.anchor);return q0(c.node,c.offset,l,u)&&([s,n,l,u]=[l,u,s,n]),{anchorNode:s,anchorOffset:n,focusNode:l,focusOffset:u}}class Fe{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(i=>this.update([i])),this.dispatch=this.dispatch.bind(this),this._root=e.root||VP(e.parent)||document,this.viewState=new RI(e.state||xt.create(e)),this.plugins=this.state.facet(Ic).map(i=>new y1(i));for(let i of this.plugins)i.update(this);this.observer=new KF(this),this.inputState=new bF(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new pI(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}dispatch(...e){this._dispatch(e.length==1&&e[0]instanceof Vi?e[0]:this.state.update(...e))}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let i=!1,s=!1,n,l=this.state;for(let T of e){if(T.startState!=l)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");l=T.state}if(this.destroyed){this.viewState.state=l;return}let u=this.hasFocus,c=0,h=null;e.some(T=>T.annotation(OO))?(this.inputState.notifiedFocused=u,c=1):u!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=u,h=wO(l,u),h||(c=1));let f=this.observer.delayedAndroidKey,p=null;if(f?(this.observer.clearDelayedAndroidKey(),p=this.observer.readChange(),(p&&!this.state.doc.eq(l.doc)||!this.state.selection.eq(l.selection))&&(p=null)):this.observer.clear(),l.facet(xt.phrases)!=this.state.facet(xt.phrases))return this.setState(l);n=Z0.create(this,l,e),n.flags|=c;let g=this.viewState.scrollTarget;try{this.updateState=2;for(let T of e){if(g&&(g=g.map(T.changes)),T.scrollIntoView){let{main:$}=T.state.selection;g=new Q0($.empty?$:he.cursor($.head,$.head>$.anchor?-1:1))}for(let $ of T.effects)$.is(hI)&&(g=$.value)}this.viewState.update(n,g),this.bidiCache=ef.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),i=this.docView.update(n),this.state.facet(kc)!=this.styleModules&&this.mountStyles(),s=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(i,e.some(T=>T.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(s0)!=n.state.facet(s0)&&(this.viewState.mustMeasureContent=!0),(i||s||g||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!n.empty)for(let T of this.state.facet(B_))T(n);(h||p)&&Promise.resolve().then(()=>{h&&this.state==h.startState&&this.dispatch(h),p&&!MO(this,p)&&f.force&&ja(this.contentDOM,f.key,f.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let i=this.hasFocus;try{for(let s of this.plugins)s.destroy(this);this.viewState=new RI(e),this.plugins=e.facet(Ic).map(s=>new y1(s)),this.pluginMap.clear();for(let s of this.plugins)s.update(this);this.docView=new pI(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}i&&this.focus(),this.requestMeasure()}updatePlugins(e){let i=e.startState.facet(Ic),s=e.state.facet(Ic);if(i!=s){let n=[];for(let l of s){let u=i.indexOf(l);if(u<0)n.push(new y1(l));else{let c=this.plugins[u];c.mustUpdate=e,n.push(c)}}for(let l of this.plugins)l.mustUpdate!=e&&l.destroy(this);this.plugins=n,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let n of this.plugins)n.mustUpdate=e;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.forceFlush();let i=null,{scrollHeight:s,scrollTop:n,clientHeight:l}=this.scrollDOM,u=n>s-l-4?s:n;try{for(let c=0;;c++){this.updateState=1;let h=this.viewport,f=this.viewState.lineBlockAtHeight(u),p=this.viewState.measure(this);if(!p&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(c>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let g=[];p&4||([this.measureRequests,g]=[g,this.measureRequests]);let T=g.map(C=>{try{return C.read(this)}catch(x){return ss(this.state,x),DI}}),$=Z0.create(this,this.state,[]),y=!1,R=!1;$.flags|=p,i?i.flags|=p:i=$,this.updateState=2,$.empty||(this.updatePlugins($),this.inputState.update($),this.updateAttrs(),y=this.docView.update($));for(let C=0;C<g.length;C++)if(T[C]!=DI)try{let x=g[C];x.write&&x.write(T[C],this)}catch(x){ss(this.state,x)}if(this.viewState.editorHeight)if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,R=!0;else{let C=this.viewState.lineBlockAt(f.from).top-f.top;(C>1||C<-1)&&(this.scrollDOM.scrollTop+=C,R=!0)}if(y&&this.docView.updateSelection(!0),this.viewport.from==h.from&&this.viewport.to==h.to&&!R&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(i&&!i.empty)for(let c of this.state.facet(B_))c(i)}get themeClasses(){return W_+" "+(this.state.facet(V_)?DO:xO)+" "+this.state.facet(s0)}updateAttrs(){let e=LI(this,fO,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),i={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(rp)?"true":"false",class:"cm-content",style:`${Be.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(i["aria-readonly"]="true"),LI(this,dT,i);let s=this.observer.ignore(()=>{let n=L_(this.contentDOM,this.contentAttrs,i),l=L_(this.dom,this.editorAttrs,e);return n||l});return this.editorAttrs=e,this.contentAttrs=i,s}showAnnouncements(e){let i=!0;for(let s of e)for(let n of s.effects)if(n.is(Fe.announce)){i&&(this.announceDOM.textContent=""),i=!1;let l=this.announceDOM.appendChild(document.createElement("div"));l.textContent=n.value}}mountStyles(){this.styleModules=this.state.facet(kc),Ko.mount(this.root,this.styleModules.concat(VF).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let i=0;i<this.measureRequests.length;i++)if(this.measureRequests[i].key===e.key){this.measureRequests[i]=e;return}}this.measureRequests.push(e)}}plugin(e){let i=this.pluginMap.get(e);return(i===void 0||i&&i.spec!=e)&&this.pluginMap.set(e,i=this.plugins.find(s=>s.spec==e)||null),i&&i.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,i,s){return I1(this,e,EI(this,e,i,s))}moveByGroup(e,i){return I1(this,e,EI(this,e,i,s=>gF(this,e.head,s)))}moveToLineBoundary(e,i,s=!0){return mF(this,e,i,s)}moveVertically(e,i,s){return I1(this,e,_F(this,e,i,s))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,i=0){return this.docView.posFromDOM(e,i)}posAtCoords(e,i=!0){return this.readMeasured(),vO(this,e,i)}coordsAtPos(e,i=1){this.readMeasured();let s=this.docView.coordsAt(e,i);if(!s||s.left==s.right)return s;let n=this.state.doc.lineAt(e),l=this.bidiSpans(n),u=l[Ka.find(l,e-n.from,-1,i)];return aT(s,u.dir==hi.LTR==i>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(hO)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>JF)return _O(e.length);let i=this.textDirectionAt(e.from);for(let n of this.bidiCache)if(n.from==e.from&&n.dir==i)return n.order;let s=tF(e.text,i);return this.bidiCache.push(new ef(e.from,e.to,i,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Be.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Y4(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,i={}){return hI.of(new Q0(typeof e=="number"?he.cursor(e):e,i.y,i.x,i.yMargin,i.xMargin))}static domEventHandlers(e){return Si.define(()=>({}),{eventHandlers:e})}static theme(e,i){let s=Ko.newName(),n=[s0.of(s),kc.of(z_(`.${s}`,e))];return i&&i.dark&&n.push(V_.of(!0)),n}static baseTheme(e){return pu.lowest(kc.of(z_("."+W_,e,LO)))}static findFromDOM(e){var i;let s=e.querySelector(".cm-content"),n=s&&Zt.get(s)||Zt.get(e);return((i=n==null?void 0:n.rootView)===null||i===void 0?void 0:i.view)||null}}Fe.styleModule=kc;Fe.inputHandler=uO;Fe.focusChangeEffect=cO;Fe.perLineTextDirection=hO;Fe.exceptionSink=aO;Fe.updateListener=B_;Fe.editable=rp;Fe.mouseSelectionStyle=lO;Fe.dragMovesSelection=oO;Fe.clickAddsSelectionRange=nO;Fe.decorations=eh;Fe.atomicRanges=pO;Fe.scrollMargins=mO;Fe.darkTheme=V_;Fe.contentAttributes=dT;Fe.editorAttributes=fO;Fe.lineWrapping=Fe.contentAttributes.of({class:"cm-lineWrapping"});Fe.announce=ct.define();const JF=4096,DI={};class ef{constructor(e,i,s,n){this.from=e,this.to=i,this.dir=s,this.order=n}static update(e,i){if(i.empty)return e;let s=[],n=e.length?e[e.length-1].dir:hi.LTR;for(let l=Math.max(0,e.length-10);l<e.length;l++){let u=e[l];u.dir==n&&!i.touchesRange(u.from,u.to)&&s.push(new ef(i.mapPos(u.from,1),i.mapPos(u.to,-1),u.dir,u.order))}return s}}function LI(r,e,i){for(let s=r.state.facet(e),n=s.length-1;n>=0;n--){let l=s[n],u=typeof l=="function"?l(r):l;u&&D_(u,i)}return i}const QF=Be.mac?"mac":Be.windows?"win":Be.linux?"linux":"key";function ZF(r,e){const i=r.split(/-(?!$)/);let s=i[i.length-1];s=="Space"&&(s=" ");let n,l,u,c;for(let h=0;h<i.length-1;++h){const f=i[h];if(/^(cmd|meta|m)$/i.test(f))c=!0;else if(/^a(lt)?$/i.test(f))n=!0;else if(/^(c|ctrl|control)$/i.test(f))l=!0;else if(/^s(hift)?$/i.test(f))u=!0;else if(/^mod$/i.test(f))e=="mac"?c=!0:l=!0;else throw new Error("Unrecognized modifier name: "+f)}return n&&(s="Alt-"+s),l&&(s="Ctrl-"+s),c&&(s="Meta-"+s),u&&(s="Shift-"+s),s}function n0(r,e,i){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),i!==!1&&e.shiftKey&&(r="Shift-"+r),r}const eU=pu.default(Fe.domEventHandlers({keydown(r,e){return PO(BO(e.state),r,e,"editor")}})),sp=Pe.define({enables:eU}),MI=new WeakMap;function BO(r){let e=r.facet(sp),i=MI.get(e);return i||MI.set(e,i=rU(e.reduce((s,n)=>s.concat(n),[]))),i}function tU(r,e,i){return PO(BO(r.state),e,r,i)}let Do=null;const iU=4e3;function rU(r,e=QF){let i=Object.create(null),s=Object.create(null),n=(u,c)=>{let h=s[u];if(h==null)s[u]=c;else if(h!=c)throw new Error("Key binding "+u+" is used both as a regular binding and as a multi-stroke prefix")},l=(u,c,h,f)=>{var p,g;let T=i[u]||(i[u]=Object.create(null)),$=c.split(/ (?!$)/).map(C=>ZF(C,e));for(let C=1;C<$.length;C++){let x=$.slice(0,C).join(" ");n(x,!0),T[x]||(T[x]={preventDefault:!0,run:[j=>{let F=Do={view:j,prefix:x,scope:u};return setTimeout(()=>{Do==F&&(Do=null)},iU),!0}]})}let y=$.join(" ");n(y,!1);let R=T[y]||(T[y]={preventDefault:!1,run:((g=(p=T._any)===null||p===void 0?void 0:p.run)===null||g===void 0?void 0:g.slice())||[]});h&&R.run.push(h),f&&(R.preventDefault=!0)};for(let u of r){let c=u.scope?u.scope.split(" "):["editor"];if(u.any)for(let f of c){let p=i[f]||(i[f]=Object.create(null));p._any||(p._any={preventDefault:!1,run:[]});for(let g in p)p[g].run.push(u.any)}let h=u[e]||u.key;if(h)for(let f of c)l(f,h,u.run,u.preventDefault),u.shift&&l(f,"Shift-"+h,u.shift,u.preventDefault)}return i}function PO(r,e,i,s){let n=BP(e),l=er(n,0),u=Ts(l)==n.length&&n!=" ",c="",h=!1;Do&&Do.view==i&&Do.scope==s&&(c=Do.prefix+" ",(h=SO.indexOf(e.keyCode)<0)&&(Do=null));let f=new Set,p=y=>{if(y){for(let R of y.run)if(!f.has(R)&&(f.add(R),R(i,e)))return!0;y.preventDefault&&(h=!0)}return!1},g=r[s],T,$;if(g){if(p(g[c+n0(n,e,!u)]))return!0;if(u&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Be.windows&&e.ctrlKey&&e.altKey)&&(T=qo[e.keyCode])&&T!=n){if(p(g[c+n0(T,e,!0)]))return!0;if(e.shiftKey&&($=Jc[e.keyCode])!=n&&$!=T&&p(g[c+n0($,e,!1)]))return!0}else if(u&&e.shiftKey&&p(g[c+n0(n,e,!0)]))return!0;if(p(g._any))return!0}return h}class _h{constructor(e,i,s,n,l){this.className=e,this.left=i,this.top=s,this.width=n,this.height=l}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,i){return i.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,i,s){if(s.empty){let n=e.coordsAtPos(s.head,s.assoc||1);if(!n)return[];let l=FO(e);return[new _h(i,n.left-l.left,n.top-l.top,null,n.bottom-n.top)]}else return sU(e,i,s)}}function FO(r){let e=r.scrollDOM.getBoundingClientRect();return{left:(r.textDirection==hi.LTR?e.left:e.right-r.scrollDOM.clientWidth)-r.scrollDOM.scrollLeft,top:e.top-r.scrollDOM.scrollTop}}function BI(r,e,i){let s=he.cursor(e);return{from:Math.max(i.from,r.moveToLineBoundary(s,!1,!0).from),to:Math.min(i.to,r.moveToLineBoundary(s,!0,!0).from),type:Wt.Text}}function PI(r,e){let i=r.lineBlockAt(e);if(Array.isArray(i.type)){for(let s of i.type)if(s.to>e||s.to==e&&(s.to==i.to||s.type==Wt.Text))return s}return i}function sU(r,e,i){if(i.to<=r.viewport.from||i.from>=r.viewport.to)return[];let s=Math.max(i.from,r.viewport.from),n=Math.min(i.to,r.viewport.to),l=r.textDirection==hi.LTR,u=r.contentDOM,c=u.getBoundingClientRect(),h=FO(r),f=u.querySelector(".cm-line"),p=f&&window.getComputedStyle(f),g=c.left+(p?parseInt(p.paddingLeft)+Math.min(0,parseInt(p.textIndent)):0),T=c.right-(p?parseInt(p.paddingRight):0),$=PI(r,s),y=PI(r,n),R=$.type==Wt.Text?$:null,C=y.type==Wt.Text?y:null;if(r.lineWrapping&&(R&&(R=BI(r,s,R)),C&&(C=BI(r,n,C))),R&&C&&R.from==C.from)return j(F(i.from,i.to,R));{let W=R?F(i.from,null,R):q($,!1),ne=C?F(null,i.to,C):q(y,!0),P=[];return(R||$).to<(C||y).from-1?P.push(x(g,W.bottom,T,ne.top)):W.bottom<ne.top&&r.elementAtHeight((W.bottom+ne.top)/2).type==Wt.Text&&(W.bottom=ne.top=(W.bottom+ne.top)/2),j(W).concat(P).concat(j(ne))}function x(W,ne,P,Q){return new _h(e,W-h.left,ne-h.top-.01,P-W,Q-ne+.01)}function j({top:W,bottom:ne,horizontal:P}){let Q=[];for(let re=0;re<P.length;re+=2)Q.push(x(P[re],W,P[re+1],ne));return Q}function F(W,ne,P){let Q=1e9,re=-1e9,Y=[];function _e(vt,je,we,xe,St){let It=r.coordsAtPos(vt,vt==P.to?-2:2),bt=r.coordsAtPos(we,we==P.from?2:-2);Q=Math.min(It.top,bt.top,Q),re=Math.max(It.bottom,bt.bottom,re),St==hi.LTR?Y.push(l&&je?g:It.left,l&&xe?T:bt.right):Y.push(!l&&xe?g:bt.left,!l&&je?T:It.right)}let Xe=W??P.from,At=ne??P.to;for(let vt of r.visibleRanges)if(vt.to>Xe&&vt.from<At)for(let je=Math.max(vt.from,Xe),we=Math.min(vt.to,At);;){let xe=r.state.doc.lineAt(je);for(let St of r.bidiSpans(xe)){let It=St.from+xe.from,bt=St.to+xe.from;if(It>=we)break;bt>je&&_e(Math.max(It,je),W==null&&It<=Xe,Math.min(bt,we),ne==null&&bt>=At,St.dir)}if(je=xe.to+1,je>=we)break}return Y.length==0&&_e(Xe,W==null,At,ne==null,r.textDirection),{top:Q,bottom:re,horizontal:Y}}function q(W,ne){let P=c.top+(ne?W.top:W.bottom);return{top:P,bottom:P,horizontal:[]}}}function nU(r,e){return r.constructor==e.constructor&&r.eq(e)}class oU{constructor(e,i){this.view=e,this.layer=i,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),i.above&&this.dom.classList.add("cm-layer-above"),i.class&&this.dom.classList.add(i.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),i.mount&&i.mount(this.dom,e)}update(e){e.startState.facet(I0)!=e.state.facet(I0)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&e.view.requestMeasure(this.measureReq)}setOrder(e){let i=0,s=e.facet(I0);for(;i<s.length&&s[i]!=this.layer;)i++;this.dom.style.zIndex=String((this.layer.above?150:-1)-i)}measure(){return this.layer.markers(this.view)}draw(e){if(e.length!=this.drawn.length||e.some((i,s)=>!nU(i,this.drawn[s]))){let i=this.dom.firstChild,s=0;for(let n of e)n.update&&i&&n.constructor&&this.drawn[s].constructor&&n.update(i,this.drawn[s])?(i=i.nextSibling,s++):this.dom.insertBefore(n.draw(),i);for(;i;){let n=i.nextSibling;i.remove(),i=n}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const I0=Pe.define();function UO(r){return[Si.define(e=>new oU(e,r)),I0.of(r)]}const HO=!Be.ios,th=Pe.define({combine(r){return xn(r,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,i)=>Math.min(e,i),drawRangeCursor:(e,i)=>e||i})}});function lU(r={}){return[th.of(r),aU,uU,cU,dO.of(!0)]}function GO(r){return r.startState.facet(th)!=r.state.facet(th)}const aU=UO({above:!0,markers(r){let{state:e}=r,i=e.facet(th),s=[];for(let n of e.selection.ranges){let l=n==e.selection.main;if(n.empty?!l||HO:i.drawRangeCursor){let u=l?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",c=n.empty?n:he.cursor(n.head,n.head>n.anchor?-1:1);for(let h of _h.forRange(r,u,c))s.push(h)}}return s},update(r,e){r.transactions.some(s=>s.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let i=GO(r);return i&&FI(r.state,e),r.docChanged||r.selectionSet||i},mount(r,e){FI(e.state,r)},class:"cm-cursorLayer"});function FI(r,e){e.style.animationDuration=r.facet(th).cursorBlinkRate+"ms"}const uU=UO({above:!1,markers(r){return r.state.selection.ranges.map(e=>e.empty?[]:_h.forRange(r,"cm-selectionBackground",e)).reduce((e,i)=>e.concat(i))},update(r,e){return r.docChanged||r.selectionSet||r.viewportChanged||GO(r)},class:"cm-selectionLayer"}),VO={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};HO&&(VO[".cm-line"].caretColor="transparent !important");const cU=pu.highest(Fe.theme(VO)),WO=ct.define({map(r,e){return r==null?null:e.mapPos(r)}}),Cc=sr.define({create(){return null},update(r,e){return r!=null&&(r=e.changes.mapPos(r)),e.effects.reduce((i,s)=>s.is(WO)?s.value:i,r)}}),hU=Si.fromClass(class{constructor(r){this.view=r,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(r){var e;let i=r.state.field(Cc);i==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(r.startState.field(Cc)!=i||r.docChanged||r.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let r=this.view.state.field(Cc),e=r!=null&&this.view.coordsAtPos(r);if(!e)return null;let i=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-i.left+this.view.scrollDOM.scrollLeft,top:e.top-i.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(r){this.cursor&&(r?(this.cursor.style.left=r.left+"px",this.cursor.style.top=r.top+"px",this.cursor.style.height=r.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(r){this.view.state.field(Cc)!=r&&this.view.dispatch({effects:WO.of(r)})}},{eventHandlers:{dragover(r){this.setDropPos(this.view.posAtCoords({x:r.clientX,y:r.clientY}))},dragleave(r){(r.target==this.view.contentDOM||!this.view.contentDOM.contains(r.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function dU(){return[Cc,hU]}function UI(r,e,i,s,n){e.lastIndex=0;for(let l=r.iterRange(i,s),u=i,c;!l.next().done;u+=l.value.length)if(!l.lineBreak)for(;c=e.exec(l.value);)n(u+c.index,c)}function fU(r,e){let i=r.visibleRanges;if(i.length==1&&i[0].from==r.viewport.from&&i[0].to==r.viewport.to)return i;let s=[];for(let{from:n,to:l}of i)n=Math.max(r.state.doc.lineAt(n).from,n-e),l=Math.min(r.state.doc.lineAt(l).to,l+e),s.length&&s[s.length-1].to>=n?s[s.length-1].to=l:s.push({from:n,to:l});return s}class pU{constructor(e){const{regexp:i,decoration:s,decorate:n,boundary:l,maxLength:u=1e3}=e;if(!i.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=i,n)this.addMatch=(c,h,f,p)=>n(p,f,f+c[0].length,c,h);else if(typeof s=="function")this.addMatch=(c,h,f,p)=>{let g=s(c,h,f);g&&p(f,f+c[0].length,g)};else if(s)this.addMatch=(c,h,f,p)=>p(f,f+c[0].length,s);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=l,this.maxLength=u}createDeco(e){let i=new jo,s=i.add.bind(i);for(let{from:n,to:l}of fU(e,this.maxLength))UI(e.state.doc,this.regexp,n,l,(u,c)=>this.addMatch(c,e,u,s));return i.finish()}updateDeco(e,i){let s=1e9,n=-1;return e.docChanged&&e.changes.iterChanges((l,u,c,h)=>{h>e.view.viewport.from&&c<e.view.viewport.to&&(s=Math.min(c,s),n=Math.max(h,n))}),e.viewportChanged||n-s>1e3?this.createDeco(e.view):n>-1?this.updateRange(e.view,i.map(e.changes),s,n):i}updateRange(e,i,s,n){for(let l of e.visibleRanges){let u=Math.max(l.from,s),c=Math.min(l.to,n);if(c>u){let h=e.state.doc.lineAt(u),f=h.to<c?e.state.doc.lineAt(c):h,p=Math.max(l.from,h.from),g=Math.min(l.to,f.to);if(this.boundary){for(;u>h.from;u--)if(this.boundary.test(h.text[u-1-h.from])){p=u;break}for(;c<f.to;c++)if(this.boundary.test(f.text[c-f.from])){g=c;break}}let T=[],$,y=(R,C,x)=>T.push(x.range(R,C));if(h==f)for(this.regexp.lastIndex=p-h.from;($=this.regexp.exec(h.text))&&$.index<g-h.from;)this.addMatch($,e,$.index+h.from,y);else UI(e.state.doc,this.regexp,p,g,(R,C)=>this.addMatch(C,e,R,y));i=i.update({filterFrom:p,filterTo:g,filter:(R,C)=>R<p||C>g,add:T})}}return i}}const Y_=/x/.unicode!=null?"gu":"g",mU=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,Y_),gU={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let C1=null;function _U(){var r;if(C1==null&&typeof document<"u"&&document.body){let e=document.body.style;C1=((r=e.tabSize)!==null&&r!==void 0?r:e.MozTabSize)!=null}return C1||!1}const k0=Pe.define({combine(r){let e=xn(r,{render:null,specialChars:mU,addSpecialChars:null});return(e.replaceTabs=!_U())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Y_)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Y_)),e}});function bU(r={}){return[k0.of(r),TU()]}let HI=null;function TU(){return HI||(HI=Si.fromClass(class{constructor(r){this.view=r,this.decorations=Ge.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(r.state.facet(k0)),this.decorations=this.decorator.createDeco(r)}makeDecorator(r){return new pU({regexp:r.specialChars,decoration:(e,i,s)=>{let{doc:n}=i.state,l=er(e[0],0);if(l==9){let u=n.lineAt(s),c=i.state.tabSize,h=mh(u.text,c,s-u.from);return Ge.replace({widget:new yU((c-h%c)*this.view.defaultCharacterWidth)})}return this.decorationCache[l]||(this.decorationCache[l]=Ge.replace({widget:new vU(r,l)}))},boundary:r.replaceTabs?void 0:/[^]/})}update(r){let e=r.state.facet(k0);r.startState.facet(k0)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(r.view)):this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations}))}const EU="•";function $U(r){return r>=32?EU:r==10?"␤":String.fromCharCode(9216+r)}class vU extends fo{constructor(e,i){super(),this.options=e,this.code=i}eq(e){return e.code==this.code}toDOM(e){let i=$U(this.code),s=e.state.phrase("Control character")+" "+(gU[this.code]||"0x"+this.code.toString(16)),n=this.options.render&&this.options.render(this.code,s,i);if(n)return n;let l=document.createElement("span");return l.textContent=i,l.title=s,l.setAttribute("aria-label",s),l.className="cm-specialChar",l}ignoreEvent(){return!1}}class yU extends fo{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function SU(){return kU}const IU=Ge.line({class:"cm-activeLine"}),kU=Si.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.docChanged||r.selectionSet)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=-1,i=[];for(let s of r.state.selection.ranges){let n=r.lineBlockAt(s.head);n.from>e&&(i.push(IU.range(n.from)),e=n.from)}return Ge.set(i)}},{decorations:r=>r.decorations});class AU extends fo{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}ignoreEvent(){return!1}}function CU(r){return Si.fromClass(class{constructor(e){this.view=e,this.placeholder=Ge.set([Ge.widget({widget:new AU(r),side:1}).range(0)])}get decorations(){return this.view.state.doc.length?Ge.none:this.placeholder}},{decorations:e=>e.decorations})}const X_=2e3;function OU(r,e,i){let s=Math.min(e.line,i.line),n=Math.max(e.line,i.line),l=[];if(e.off>X_||i.off>X_||e.col<0||i.col<0){let u=Math.min(e.off,i.off),c=Math.max(e.off,i.off);for(let h=s;h<=n;h++){let f=r.doc.line(h);f.length<=c&&l.push(he.range(f.from+u,f.to+c))}}else{let u=Math.min(e.col,i.col),c=Math.max(e.col,i.col);for(let h=s;h<=n;h++){let f=r.doc.line(h),p=k_(f.text,u,r.tabSize,!0);if(p<0)l.push(he.cursor(f.to));else{let g=k_(f.text,c,r.tabSize);l.push(he.range(f.from+p,f.from+g))}}}return l}function wU(r,e){let i=r.coordsAtPos(r.viewport.from);return i?Math.round(Math.abs((i.left-e)/r.defaultCharacterWidth)):-1}function GI(r,e){let i=r.posAtCoords({x:e.clientX,y:e.clientY},!1),s=r.state.doc.lineAt(i),n=i-s.from,l=n>X_?-1:n==s.length?wU(r,e.clientX):mh(s.text,r.state.tabSize,i-s.from);return{line:s.number,col:l,off:n}}function RU(r,e){let i=GI(r,e),s=r.state.selection;return i?{update(n){if(n.docChanged){let l=n.changes.mapPos(n.startState.doc.line(i.line).from),u=n.state.doc.lineAt(l);i={line:u.number,col:i.col,off:Math.min(i.off,u.length)},s=s.map(n.changes)}},get(n,l,u){let c=GI(r,n);if(!c)return s;let h=OU(r.state,i,c);return h.length?u?he.create(h.concat(s.ranges)):he.create(h):s}}:null}function NU(r){let e=(r==null?void 0:r.eventFilter)||(i=>i.altKey&&i.button==0);return Fe.mouseSelectionStyle.of((i,s)=>e(s)?RU(i,s):null)}const xU={Alt:[18,r=>r.altKey],Control:[17,r=>r.ctrlKey],Shift:[16,r=>r.shiftKey],Meta:[91,r=>r.metaKey]},DU={style:"cursor: crosshair"};function LU(r={}){let[e,i]=xU[r.key||"Alt"],s=Si.fromClass(class{constructor(n){this.view=n,this.isDown=!1}set(n){this.isDown!=n&&(this.isDown=n,this.view.update([]))}},{eventHandlers:{keydown(n){this.set(n.keyCode==e||i(n))},keyup(n){(n.keyCode==e||!i(n))&&this.set(!1)},mousemove(n){this.set(i(n))}}});return[s,Fe.contentAttributes.of(n=>{var l;return!((l=n.plugin(s))===null||l===void 0)&&l.isDown?DU:null})]}const o0="-10000px";class zO{constructor(e,i,s){this.facet=i,this.createTooltipView=s,this.input=e.state.facet(i),this.tooltips=this.input.filter(n=>n),this.tooltipViews=this.tooltips.map(s)}update(e){var i;let s=e.state.facet(this.facet),n=s.filter(u=>u);if(s===this.input){for(let u of this.tooltipViews)u.update&&u.update(e);return!1}let l=[];for(let u=0;u<n.length;u++){let c=n[u],h=-1;if(c){for(let f=0;f<this.tooltips.length;f++){let p=this.tooltips[f];p&&p.create==c.create&&(h=f)}if(h<0)l[u]=this.createTooltipView(c);else{let f=l[u]=this.tooltipViews[h];f.update&&f.update(e)}}}for(let u of this.tooltipViews)l.indexOf(u)<0&&(u.dom.remove(),(i=u.destroy)===null||i===void 0||i.call(u));return this.input=s,this.tooltips=n,this.tooltipViews=l,!0}}function MU(r){let{win:e}=r;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const O1=Pe.define({combine:r=>{var e,i,s;return{position:Be.ios?"absolute":((e=r.find(n=>n.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((i=r.find(n=>n.parent))===null||i===void 0?void 0:i.parent)||null,tooltipSpace:((s=r.find(n=>n.tooltipSpace))===null||s===void 0?void 0:s.tooltipSpace)||MU}}}),VI=new WeakMap,YO=Si.fromClass(class{constructor(r){this.view=r,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let e=r.state.facet(O1);this.position=e.position,this.parent=e.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new zO(r,pT,i=>this.createTooltip(i)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(i=>{Date.now()>this.lastTransaction-50&&i.length>0&&i[i.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(r);e&&this.observeIntersection();let i=e||r.geometryChanged,s=r.state.facet(O1);if(s.position!=this.position){this.position=s.position;for(let n of this.manager.tooltipViews)n.dom.style.position=this.position;i=!0}if(s.parent!=this.parent){this.parent&&this.container.remove(),this.parent=s.parent,this.createContainer();for(let n of this.manager.tooltipViews)this.container.appendChild(n.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(r){let e=r.create(this.view);if(e.dom.classList.add("cm-tooltip"),r.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let i=document.createElement("div");i.className="cm-tooltip-arrow",e.dom.appendChild(i)}return e.dom.style.position=this.position,e.dom.style.top=o0,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var r,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(r=i.destroy)===null||r===void 0||r.call(i);(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=this.view.dom.getBoundingClientRect();return{editor:r,parent:this.parent?this.container.getBoundingClientRect():r,pos:this.manager.tooltips.map((e,i)=>{let s=this.manager.tooltipViews[i];return s.getCoords?s.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(O1).tooltipSpace(this.view)}}writeMeasure(r){var e;let{editor:i,space:s}=r,n=[];for(let l=0;l<this.manager.tooltips.length;l++){let u=this.manager.tooltips[l],c=this.manager.tooltipViews[l],{dom:h}=c,f=r.pos[l],p=r.size[l];if(!f||f.bottom<=Math.max(i.top,s.top)||f.top>=Math.min(i.bottom,s.bottom)||f.right<Math.max(i.left,s.left)-.1||f.left>Math.min(i.right,s.right)+.1){h.style.top=o0;continue}let g=u.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,T=g?7:0,$=p.right-p.left,y=(e=VI.get(c))!==null&&e!==void 0?e:p.bottom-p.top,R=c.offset||PU,C=this.view.textDirection==hi.LTR,x=p.width>s.right-s.left?C?s.left:s.right-p.width:C?Math.min(f.left-(g?14:0)+R.x,s.right-$):Math.max(s.left,f.left-$+(g?14:0)-R.x),j=!!u.above;!u.strictSide&&(j?f.top-(p.bottom-p.top)-R.y<s.top:f.bottom+(p.bottom-p.top)+R.y>s.bottom)&&j==s.bottom-f.bottom>f.top-s.top&&(j=!j);let F=(j?f.top-s.top:s.bottom-f.bottom)-T;if(F<y&&c.resize!==!1){if(F<this.view.defaultLineHeight){h.style.top=o0;continue}VI.set(c,y),h.style.height=(y=F)+"px"}else h.style.height&&(h.style.height="");let q=j?f.top-y-T-R.y:f.bottom+T+R.y,W=x+$;if(c.overlap!==!0)for(let ne of n)ne.left<W&&ne.right>x&&ne.top<q+y&&ne.bottom>q&&(q=j?ne.top-y-2-T:ne.bottom+T+2);this.position=="absolute"?(h.style.top=q-r.parent.top+"px",h.style.left=x-r.parent.left+"px"):(h.style.top=q+"px",h.style.left=x+"px"),g&&(g.style.left=`${f.left+(C?R.x:-R.x)-(x+14-7)}px`),c.overlap!==!0&&n.push({left:x,top:q,right:W,bottom:q+y}),h.classList.toggle("cm-tooltip-above",j),h.classList.toggle("cm-tooltip-below",!j),c.positioned&&c.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=o0}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),BU=Fe.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),PU={x:0,y:0},pT=Pe.define({enables:[YO,BU]}),tf=Pe.define();class mT{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new zO(e,tf,i=>this.createHostedView(i))}static create(e){return new mT(e)}createHostedView(e){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(i.dom),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let i of this.manager.tooltipViews)i.mount&&i.mount(e);this.mounted=!0}positioned(e){for(let i of this.manager.tooltipViews)i.positioned&&i.positioned(e)}update(e){this.manager.update(e)}}const FU=pT.compute([tf],r=>{let e=r.facet(tf).filter(i=>i);return e.length===0?null:{pos:Math.min(...e.map(i=>i.pos)),end:Math.max(...e.filter(i=>i.end!=null).map(i=>i.end)),create:mT.create,above:e[0].above,arrow:e.some(i=>i.arrow)}});class UU{constructor(e,i,s,n,l){this.view=e,this.source=i,this.field=s,this.setHover=n,this.hoverTime=l,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,i=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(i==null)return;let s=this.view.coordsAtPos(i);if(s==null||e.y<s.top||e.y>s.bottom||e.x<s.left-this.view.defaultCharacterWidth||e.x>s.right+this.view.defaultCharacterWidth)return;let n=this.view.bidiSpans(this.view.state.doc.lineAt(i)).find(c=>c.from<=i&&c.to>=i),l=n&&n.dir==hi.RTL?-1:1,u=this.source(this.view,i,e.x<s.left?-l:l);if(u!=null&&u.then){let c=this.pending={pos:i};u.then(h=>{this.pending==c&&(this.pending=null,h&&this.view.dispatch({effects:this.setHover.of(h)}))},h=>ss(this.view.state,h,"hover tooltip"))}else u&&this.view.dispatch({effects:this.setHover.of(u)})}mousemove(e){var i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let s=this.active;if(s&&!WI(this.lastMove.target)||this.pending){let{pos:n}=s||this.pending,l=(i=s==null?void 0:s.end)!==null&&i!==void 0?i:n;(n==l?this.view.posAtCoords(this.lastMove)!=n:!HU(this.view,n,l,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!WI(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function WI(r){for(let e=r;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function HU(r,e,i,s,n,l){let u=document.createRange(),c=r.domAtPos(e),h=r.domAtPos(i);u.setEnd(h.node,h.offset),u.setStart(c.node,c.offset);let f=u.getClientRects();u.detach();for(let p=0;p<f.length;p++){let g=f[p];if(Math.max(g.top-n,n-g.bottom,g.left-s,s-g.right)<=l)return!0}return!1}function GU(r,e={}){let i=ct.define(),s=sr.define({create(){return null},update(n,l){if(n&&(e.hideOnChange&&(l.docChanged||l.selection)||e.hideOn&&e.hideOn(l,n)))return null;if(n&&l.docChanged){let u=l.changes.mapPos(n.pos,-1,Er.TrackDel);if(u==null)return null;let c=Object.assign(Object.create(null),n);c.pos=u,n.end!=null&&(c.end=l.changes.mapPos(n.end)),n=c}for(let u of l.effects)u.is(i)&&(n=u.value),u.is(WU)&&(n=null);return n},provide:n=>tf.from(n)});return[s,Si.define(n=>new UU(n,r,s,i,e.hoverTime||300)),FU]}function VU(r,e){let i=r.plugin(YO);if(!i)return null;let s=i.manager.tooltips.indexOf(e);return s<0?null:i.manager.tooltipViews[s]}const WU=ct.define(),zI=Pe.define({combine(r){let e,i;for(let s of r)e=e||s.topContainer,i=i||s.bottomContainer;return{topContainer:e,bottomContainer:i}}});function ih(r,e){let i=r.plugin(XO),s=i?i.specs.indexOf(e):-1;return s>-1?i.panels[s]:null}const XO=Si.fromClass(class{constructor(r){this.input=r.state.facet(rh),this.specs=this.input.filter(i=>i),this.panels=this.specs.map(i=>i(r));let e=r.state.facet(zI);this.top=new l0(r,!0,e.topContainer),this.bottom=new l0(r,!1,e.bottomContainer),this.top.sync(this.panels.filter(i=>i.top)),this.bottom.sync(this.panels.filter(i=>!i.top));for(let i of this.panels)i.dom.classList.add("cm-panel"),i.mount&&i.mount()}update(r){let e=r.state.facet(zI);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new l0(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new l0(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=r.state.facet(rh);if(i!=this.input){let s=i.filter(h=>h),n=[],l=[],u=[],c=[];for(let h of s){let f=this.specs.indexOf(h),p;f<0?(p=h(r.view),c.push(p)):(p=this.panels[f],p.update&&p.update(r)),n.push(p),(p.top?l:u).push(p)}this.specs=s,this.panels=n,this.top.sync(l),this.bottom.sync(u);for(let h of c)h.dom.classList.add("cm-panel"),h.mount&&h.mount()}else for(let s of this.panels)s.update&&s.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>Fe.scrollMargins.of(e=>{let i=e.plugin(r);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}})});class l0{constructor(e,i,s){this.view=e,this.top=i,this.container=s,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let i of this.panels)i.destroy&&e.indexOf(i)<0&&i.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let i=this.container||this.view.dom;i.insertBefore(this.dom,this.top?i.firstChild:null)}let e=this.dom.firstChild;for(let i of this.panels)if(i.dom.parentNode==this.dom){for(;e!=i.dom;)e=YI(e);e=e.nextSibling}else this.dom.insertBefore(i.dom,e);for(;e;)e=YI(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function YI(r){let e=r.nextSibling;return r.remove(),e}const rh=Pe.define({enables:XO});class uo extends Hl{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}uo.prototype.elementClass="";uo.prototype.toDOM=void 0;uo.prototype.mapMode=Er.TrackBefore;uo.prototype.startSide=uo.prototype.endSide=-1;uo.prototype.point=!0;const A0=Pe.define(),zU={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Ht.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Hc=Pe.define();function YU(r){return[jO(),Hc.of(Object.assign(Object.assign({},zU),r))]}const j_=Pe.define({combine:r=>r.some(e=>e)});function jO(r){let e=[XU];return r&&r.fixed===!1&&e.push(j_.of(!0)),e}const XU=Si.fromClass(class{constructor(r){this.view=r,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=r.state.facet(Hc).map(e=>new jI(r,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!r.state.facet(j_),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}update(r){if(this.updateGutters(r)){let e=this.prevViewport,i=r.view.viewport,s=Math.min(e.to,i.to)-Math.max(e.from,i.from);this.syncGutters(s<(i.to-i.from)*.8)}r.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(j_)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&this.dom.remove();let i=Ht.iter(this.view.state.facet(A0),this.view.viewport.from),s=[],n=this.gutters.map(l=>new jU(l,this.view.viewport,-this.view.documentPadding.top));for(let l of this.view.viewportLineBlocks){let u;if(Array.isArray(l.type)){for(let c of l.type)if(c.type==Wt.Text){u=c;break}}else u=l.type==Wt.Text?l:void 0;if(u){s.length&&(s=[]),KO(i,s,l.from);for(let c of n)c.line(this.view,u,s)}}for(let l of n)l.finish();r&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(r){let e=r.startState.facet(Hc),i=r.state.facet(Hc),s=r.docChanged||r.heightChanged||r.viewportChanged||!Ht.eq(r.startState.facet(A0),r.state.facet(A0),r.view.viewport.from,r.view.viewport.to);if(e==i)for(let n of this.gutters)n.update(r)&&(s=!0);else{s=!0;let n=[];for(let l of i){let u=e.indexOf(l);u<0?n.push(new jI(this.view,l)):(this.gutters[u].update(r),n.push(this.gutters[u]))}for(let l of this.gutters)l.dom.remove(),n.indexOf(l)<0&&l.destroy();for(let l of n)this.dom.appendChild(l.dom);this.gutters=n}return s}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove()}},{provide:r=>Fe.scrollMargins.of(e=>{let i=e.plugin(r);return!i||i.gutters.length==0||!i.fixed?null:e.textDirection==hi.LTR?{left:i.dom.offsetWidth}:{right:i.dom.offsetWidth}})});function XI(r){return Array.isArray(r)?r:[r]}function KO(r,e,i){for(;r.value&&r.from<=i;)r.from==i&&e.push(r.value),r.next()}class jU{constructor(e,i,s){this.gutter=e,this.height=s,this.i=0,this.cursor=Ht.iter(e.markers,i.from)}line(e,i,s){let n=[];KO(this.cursor,n,i.from),s.length&&(n=n.concat(s));let l=this.gutter.config.lineMarker(e,i,n);l&&n.unshift(l);let u=this.gutter;if(n.length==0&&!u.config.renderEmptyElements)return;let c=i.top-this.height;if(this.i==u.elements.length){let h=new qO(e,i.height,c,n);u.elements.push(h),u.dom.appendChild(h.dom)}else u.elements[this.i].update(e,i.height,c,n);this.height=i.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let i=e.elements.pop();e.dom.removeChild(i.dom),i.destroy()}}}class jI{constructor(e,i){this.view=e,this.config=i,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let s in i.domEventHandlers)this.dom.addEventListener(s,n=>{let l=n.target,u;if(l!=this.dom&&this.dom.contains(l)){for(;l.parentNode!=this.dom;)l=l.parentNode;let h=l.getBoundingClientRect();u=(h.top+h.bottom)/2}else u=n.clientY;let c=e.lineBlockAtHeight(u-e.documentTop);i.domEventHandlers[s](e,c,n)&&n.preventDefault()});this.markers=XI(i.markers(e)),i.initialSpacer&&(this.spacer=new qO(e,0,0,[i.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let i=this.markers;if(this.markers=XI(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let n=this.config.updateSpacer(this.spacer.markers[0],e);n!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[n])}let s=e.view.viewport;return!Ht.eq(this.markers,i,s.from,s.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class qO{constructor(e,i,s,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,i,s,n)}update(e,i,s,n){this.height!=i&&(this.dom.style.height=(this.height=i)+"px"),this.above!=s&&(this.dom.style.marginTop=(this.above=s)?s+"px":""),KU(this.markers,n)||this.setMarkers(e,n)}setMarkers(e,i){let s="cm-gutterElement",n=this.dom.firstChild;for(let l=0,u=0;;){let c=u,h=l<i.length?i[l++]:null,f=!1;if(h){let p=h.elementClass;p&&(s+=" "+p);for(let g=u;g<this.markers.length;g++)if(this.markers[g].compare(h)){c=g,f=!0;break}}else c=this.markers.length;for(;u<c;){let p=this.markers[u++];if(p.toDOM){p.destroy(n);let g=n.nextSibling;n.remove(),n=g}}if(!h)break;h.toDOM&&(f?n=n.nextSibling:this.dom.insertBefore(h.toDOM(e),n)),f&&u++}this.dom.className=s,this.markers=i}destroy(){this.setMarkers(null,[])}}function KU(r,e){if(r.length!=e.length)return!1;for(let i=0;i<r.length;i++)if(!r[i].compare(e[i]))return!1;return!0}const qU=Pe.define(),Fa=Pe.define({combine(r){return xn(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,i){let s=Object.assign({},e);for(let n in i){let l=s[n],u=i[n];s[n]=l?(c,h,f)=>l(c,h,f)||u(c,h,f):u}return s}})}});class w1 extends uo{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function R1(r,e){return r.state.facet(Fa).formatNumber(e,r.state)}const JU=Hc.compute([Fa],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(qU)},lineMarker(e,i,s){return s.some(n=>n.toDOM)?null:new w1(R1(e,e.state.doc.lineAt(i.from).number))},lineMarkerChange:e=>e.startState.facet(Fa)!=e.state.facet(Fa),initialSpacer(e){return new w1(R1(e,KI(e.state.doc.lines)))},updateSpacer(e,i){let s=R1(i.view,KI(i.view.state.doc.lines));return s==e.number?e:new w1(s)},domEventHandlers:r.facet(Fa).domEventHandlers}));function QU(r={}){return[Fa.of(r),jO(),JU]}function KI(r){let e=9;for(;e<r;)e=e*10+9;return e}const ZU=new class extends uo{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},eH=A0.compute(["selection"],r=>{let e=[],i=-1;for(let s of r.selection.ranges){let n=r.doc.lineAt(s.head).from;n>i&&(i=n,e.push(ZU.range(n)))}return Ht.of(e)});function tH(){return eH}const JO=1024;let iH=0;class N1{constructor(e,i){this.from=e,this.to=i}}class _t{constructor(e={}){this.id=iH++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Gr.match(e)),i=>{let s=e(i);return s===void 0?null:[this,s]}}}_t.closedBy=new _t({deserialize:r=>r.split(" ")});_t.openedBy=new _t({deserialize:r=>r.split(" ")});_t.group=new _t({deserialize:r=>r.split(" ")});_t.contextHash=new _t({perNode:!0});_t.lookAhead=new _t({perNode:!0});_t.mounted=new _t({perNode:!0});const rH=Object.create(null);class Gr{constructor(e,i,s,n=0){this.name=e,this.props=i,this.id=s,this.flags=n}static define(e){let i=e.props&&e.props.length?Object.create(null):rH,s=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),n=new Gr(e.name||"",i,e.id,s);if(e.props){for(let l of e.props)if(Array.isArray(l)||(l=l(n)),l){if(l[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");i[l[0].id]=l[1]}}return n}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let i=this.prop(_t.group);return i?i.indexOf(e)>-1:!1}return this.id==e}static match(e){let i=Object.create(null);for(let s in e)for(let n of s.split(" "))i[n]=e[s];return s=>{for(let n=s.prop(_t.group),l=-1;l<(n?n.length:0);l++){let u=i[l<0?s.name:n[l]];if(u)return u}}}}Gr.none=new Gr("",Object.create(null),0,8);class gT{constructor(e){this.types=e;for(let i=0;i<e.length;i++)if(e[i].id!=i)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let i=[];for(let s of this.types){let n=null;for(let l of e){let u=l(s);u&&(n||(n=Object.assign({},s.props)),n[u[0].id]=u[1])}i.push(n?new Gr(s.name,n,s.id,s.flags):s)}return new gT(i)}}const a0=new WeakMap,qI=new WeakMap;var ir;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(ir||(ir={}));class Ni{constructor(e,i,s,n,l){if(this.type=e,this.children=i,this.positions=s,this.length=n,this.props=null,l&&l.length){this.props=Object.create(null);for(let[u,c]of l)this.props[typeof u=="number"?u:u.id]=c}}toString(){let e=this.prop(_t.mounted);if(e&&!e.overlay)return e.tree.toString();let i="";for(let s of this.children){let n=s.toString();n&&(i&&(i+=","),i+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(i.length?"("+i+")":""):i}cursor(e=0){return new nf(this.topNode,e)}cursorAt(e,i=0,s=0){let n=a0.get(this)||this.topNode,l=new nf(n);return l.moveTo(e,i),a0.set(this,l._tree),l}get topNode(){return new so(this,0,0,null)}resolve(e,i=0){let s=su(a0.get(this)||this.topNode,e,i,!1);return a0.set(this,s),s}resolveInner(e,i=0){let s=su(qI.get(this)||this.topNode,e,i,!0);return qI.set(this,s),s}iterate(e){let{enter:i,leave:s,from:n=0,to:l=this.length}=e;for(let u=this.cursor((e.mode||0)|ir.IncludeAnonymous);;){let c=!1;if(u.from<=l&&u.to>=n&&(u.type.isAnonymous||i(u)!==!1)){if(u.firstChild())continue;c=!0}for(;c&&s&&!u.type.isAnonymous&&s(u),!u.nextSibling();){if(!u.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let i in this.props)e.push([+i,this.props[i]]);return e}balance(e={}){return this.children.length<=8?this:TT(Gr.none,this.children,this.positions,0,this.children.length,0,this.length,(i,s,n)=>new Ni(this.type,i,s,n,this.propValues),e.makeTree||((i,s,n)=>new Ni(Gr.none,i,s,n)))}static build(e){return nH(e)}}Ni.empty=new Ni(Gr.none,[],[],0);class _T{constructor(e,i){this.buffer=e,this.index=i}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new _T(this.buffer,this.index)}}class jl{constructor(e,i,s){this.buffer=e,this.length=i,this.set=s}get type(){return Gr.none}toString(){let e=[];for(let i=0;i<this.buffer.length;)e.push(this.childString(i)),i=this.buffer[i+3];return e.join(",")}childString(e){let i=this.buffer[e],s=this.buffer[e+3],n=this.set.types[i],l=n.name;if(/\W/.test(l)&&!n.isError&&(l=JSON.stringify(l)),e+=4,s==e)return l;let u=[];for(;e<s;)u.push(this.childString(e)),e=this.buffer[e+3];return l+"("+u.join(",")+")"}findChild(e,i,s,n,l){let{buffer:u}=this,c=-1;for(let h=e;h!=i&&!(QO(l,n,u[h+1],u[h+2])&&(c=h,s>0));h=u[h+3]);return c}slice(e,i,s){let n=this.buffer,l=new Uint16Array(i-e),u=0;for(let c=e,h=0;c<i;){l[h++]=n[c++],l[h++]=n[c++]-s;let f=l[h++]=n[c++]-s;l[h++]=n[c++]-e,u=Math.max(u,f)}return new jl(l,u,this.set)}}function QO(r,e,i,s){switch(r){case-2:return i<e;case-1:return s>=e&&i<e;case 0:return i<e&&s>e;case 1:return i<=e&&s>e;case 2:return s>e;case 4:return!0}}function ZO(r,e){let i=r.childBefore(e);for(;i;){let s=i.lastChild;if(!s||s.to!=i.to)break;s.type.isError&&s.from==s.to?(r=i,i=s.prevSibling):i=s}return r}function su(r,e,i,s){for(var n;r.from==r.to||(i<1?r.from>=e:r.from>e)||(i>-1?r.to<=e:r.to<e);){let u=!s&&r instanceof so&&r.index<0?null:r.parent;if(!u)return r;r=u}let l=s?0:ir.IgnoreOverlays;if(s)for(let u=r,c=u.parent;c;u=c,c=u.parent)u instanceof so&&u.index<0&&((n=c.enter(e,i,l))===null||n===void 0?void 0:n.from)!=u.from&&(r=c);for(;;){let u=r.enter(e,i,l);if(!u)return r;r=u}}class so{constructor(e,i,s,n){this._tree=e,this.from=i,this.index=s,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,i,s,n,l=0){for(let u=this;;){for(let{children:c,positions:h}=u._tree,f=i>0?c.length:-1;e!=f;e+=i){let p=c[e],g=h[e]+u.from;if(QO(n,s,g,g+p.length)){if(p instanceof jl){if(l&ir.ExcludeBuffers)continue;let T=p.findChild(0,p.buffer.length,i,s-g,n);if(T>-1)return new Fo(new sH(u,p,e,g),null,T)}else if(l&ir.IncludeAnonymous||!p.type.isAnonymous||bT(p)){let T;if(!(l&ir.IgnoreMounts)&&p.props&&(T=p.prop(_t.mounted))&&!T.overlay)return new so(T.tree,g,e,u);let $=new so(p,g,e,u);return l&ir.IncludeAnonymous||!$.type.isAnonymous?$:$.nextChild(i<0?p.children.length-1:0,i,s,n)}}}if(l&ir.IncludeAnonymous||!u.type.isAnonymous||(u.index>=0?e=u.index+i:e=i<0?-1:u._parent._tree.children.length,u=u._parent,!u))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,i,s=0){let n;if(!(s&ir.IgnoreOverlays)&&(n=this._tree.prop(_t.mounted))&&n.overlay){let l=e-this.from;for(let{from:u,to:c}of n.overlay)if((i>0?u<=l:u<l)&&(i<0?c>=l:c>l))return new so(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,i,s)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new nf(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,i=0){return su(this,e,i,!1)}resolveInner(e,i=0){return su(this,e,i,!0)}enterUnfinishedNodesBefore(e){return ZO(this,e)}getChild(e,i=null,s=null){let n=rf(this,e,i,s);return n.length?n[0]:null}getChildren(e,i=null,s=null){return rf(this,e,i,s)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return sf(this,e)}}function rf(r,e,i,s){let n=r.cursor(),l=[];if(!n.firstChild())return l;if(i!=null){for(;!n.type.is(i);)if(!n.nextSibling())return l}for(;;){if(s!=null&&n.type.is(s))return l;if(n.type.is(e)&&l.push(n.node),!n.nextSibling())return s==null?l:[]}}function sf(r,e,i=e.length-1){for(let s=r.parent;i>=0;s=s.parent){if(!s)return!1;if(!s.type.isAnonymous){if(e[i]&&e[i]!=s.name)return!1;i--}}return!0}class sH{constructor(e,i,s,n){this.parent=e,this.buffer=i,this.index=s,this.start=n}}class Fo{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,i,s){this.context=e,this._parent=i,this.index=s,this.type=e.buffer.set.types[e.buffer.buffer[s]]}child(e,i,s){let{buffer:n}=this.context,l=n.findChild(this.index+4,n.buffer[this.index+3],e,i-this.context.start,s);return l<0?null:new Fo(this.context,this,l)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,i,s=0){if(s&ir.ExcludeBuffers)return null;let{buffer:n}=this.context,l=n.findChild(this.index+4,n.buffer[this.index+3],i>0?1:-1,e-this.context.start,i);return l<0?null:new Fo(this.context,this,l)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,i=e.buffer[this.index+3];return i<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Fo(this.context,this._parent,i):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,i=this._parent?this._parent.index+4:0;return this.index==i?this.externalSibling(-1):new Fo(this.context,this._parent,e.findChild(i,this.index,-1,0,4))}cursor(e=0){return new nf(this,e)}get tree(){return null}toTree(){let e=[],i=[],{buffer:s}=this.context,n=this.index+4,l=s.buffer[this.index+3];if(l>n){let u=s.buffer[this.index+1];e.push(s.slice(n,l,u)),i.push(0)}return new Ni(this.type,e,i,this.to-this.from)}resolve(e,i=0){return su(this,e,i,!1)}resolveInner(e,i=0){return su(this,e,i,!0)}enterUnfinishedNodesBefore(e){return ZO(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,i=null,s=null){let n=rf(this,e,i,s);return n.length?n[0]:null}getChildren(e,i=null,s=null){return rf(this,e,i,s)}get node(){return this}matchContext(e){return sf(this,e)}}class nf{get name(){return this.type.name}constructor(e,i=0){if(this.mode=i,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof so)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let s=e._parent;s;s=s._parent)this.stack.unshift(s.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,i){this.index=e;let{start:s,buffer:n}=this.buffer;return this.type=i||n.set.types[n.buffer[e]],this.from=s+n.buffer[e+1],this.to=s+n.buffer[e+2],!0}yield(e){return e?e instanceof so?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,i,s){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,i,s,this.mode));let{buffer:n}=this.buffer,l=n.findChild(this.index+4,n.buffer[this.index+3],e,i-this.buffer.start,s);return l<0?!1:(this.stack.push(this.index),this.yieldBuf(l))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,i,s=this.mode){return this.buffer?s&ir.ExcludeBuffers?!1:this.enterChild(1,e,i):this.yield(this._tree.enter(e,i,s))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ir.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&ir.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:i}=this.buffer,s=this.stack.length-1;if(e<0){let n=s<0?0:this.stack[s]+4;if(this.index!=n)return this.yieldBuf(i.findChild(n,this.index,-1,0,4))}else{let n=i.buffer[this.index+3];if(n<(s<0?i.buffer.length:i.buffer[this.stack[s]+3]))return this.yieldBuf(n)}return s<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let i,s,{buffer:n}=this;if(n){if(e>0){if(this.index<n.buffer.buffer.length)return!1}else for(let l=0;l<this.index;l++)if(n.buffer.buffer[l+3]<this.index)return!1;({index:i,parent:s}=n)}else({index:i,_parent:s}=this._tree);for(;s;{index:i,_parent:s}=s)if(i>-1)for(let l=i+e,u=e<0?-1:s._tree.children.length;l!=u;l+=e){let c=s._tree.children[l];if(this.mode&ir.IncludeAnonymous||c instanceof jl||!c.type.isAnonymous||bT(c))return!1}return!0}move(e,i){if(i&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,i=0){for(;(this.from==this.to||(i<1?this.from>=e:this.from>e)||(i>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,i););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,i=null,s=0;if(e&&e.context==this.buffer){e:for(let n=this.index,l=this.stack.length;l>=0;){for(let u=e;u;u=u._parent)if(u.index==n){if(n==this.index)return u;i=u,s=l+1;break e}n=this.stack[--l]}}for(let n=s;n<this.stack.length;n++)i=new Fo(this.buffer,i,this.stack[n]);return this.bufferNode=new Fo(this.buffer,i,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,i){for(let s=0;;){let n=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){s++;continue}this.type.isAnonymous||(n=!0)}for(;n&&i&&i(this),n=this.type.isAnonymous,!this.nextSibling();){if(!s)return;this.parent(),s--,n=!0}}}matchContext(e){if(!this.buffer)return sf(this.node,e);let{buffer:i}=this.buffer,{types:s}=i.set;for(let n=e.length-1,l=this.stack.length-1;n>=0;l--){if(l<0)return sf(this.node,e,n);let u=s[i.buffer[this.stack[l]]];if(!u.isAnonymous){if(e[n]&&e[n]!=u.name)return!1;n--}}return!0}}function bT(r){return r.children.some(e=>e instanceof jl||!e.type.isAnonymous||bT(e))}function nH(r){var e;let{buffer:i,nodeSet:s,maxBufferLength:n=JO,reused:l=[],minRepeatType:u=s.types.length}=r,c=Array.isArray(i)?new _T(i,i.length):i,h=s.types,f=0,p=0;function g(q,W,ne,P,Q){let{id:re,start:Y,end:_e,size:Xe}=c,At=p;for(;Xe<0;)if(c.next(),Xe==-1){let St=l[re];ne.push(St),P.push(Y-q);return}else if(Xe==-3){f=re;return}else if(Xe==-4){p=re;return}else throw new RangeError(`Unrecognized record size: ${Xe}`);let vt=h[re],je,we,xe=Y-q;if(_e-Y<=n&&(we=R(c.pos-W,Q))){let St=new Uint16Array(we.size-we.skip),It=c.pos-we.size,bt=St.length;for(;c.pos>It;)bt=C(we.start,St,bt);je=new jl(St,_e-we.start,s),xe=we.start-q}else{let St=c.pos-Xe;c.next();let It=[],bt=[],ei=re>=u?re:-1,z=0,Ce=_e;for(;c.pos>St;)ei>=0&&c.id==ei&&c.size>=0?(c.end<=Ce-n&&($(It,bt,Y,z,c.end,Ce,ei,At),z=It.length,Ce=c.end),c.next()):g(Y,St,It,bt,ei);if(ei>=0&&z>0&&z<It.length&&$(It,bt,Y,z,Y,Ce,ei,At),It.reverse(),bt.reverse(),ei>-1&&z>0){let pr=T(vt);je=TT(vt,It,bt,0,It.length,0,_e-Y,pr,pr)}else je=y(vt,It,bt,_e-Y,At-_e)}ne.push(je),P.push(xe)}function T(q){return(W,ne,P)=>{let Q=0,re=W.length-1,Y,_e;if(re>=0&&(Y=W[re])instanceof Ni){if(!re&&Y.type==q&&Y.length==P)return Y;(_e=Y.prop(_t.lookAhead))&&(Q=ne[re]+Y.length+_e)}return y(q,W,ne,P,Q)}}function $(q,W,ne,P,Q,re,Y,_e){let Xe=[],At=[];for(;q.length>P;)Xe.push(q.pop()),At.push(W.pop()+ne-Q);q.push(y(s.types[Y],Xe,At,re-Q,_e-re)),W.push(Q-ne)}function y(q,W,ne,P,Q=0,re){if(f){let Y=[_t.contextHash,f];re=re?[Y].concat(re):[Y]}if(Q>25){let Y=[_t.lookAhead,Q];re=re?[Y].concat(re):[Y]}return new Ni(q,W,ne,P,re)}function R(q,W){let ne=c.fork(),P=0,Q=0,re=0,Y=ne.end-n,_e={size:0,start:0,skip:0};e:for(let Xe=ne.pos-q;ne.pos>Xe;){let At=ne.size;if(ne.id==W&&At>=0){_e.size=P,_e.start=Q,_e.skip=re,re+=4,P+=4,ne.next();continue}let vt=ne.pos-At;if(At<0||vt<Xe||ne.start<Y)break;let je=ne.id>=u?4:0,we=ne.start;for(ne.next();ne.pos>vt;){if(ne.size<0)if(ne.size==-3)je+=4;else break e;else ne.id>=u&&(je+=4);ne.next()}Q=we,P+=At,re+=je}return(W<0||P==q)&&(_e.size=P,_e.start=Q,_e.skip=re),_e.size>4?_e:void 0}function C(q,W,ne){let{id:P,start:Q,end:re,size:Y}=c;if(c.next(),Y>=0&&P<u){let _e=ne;if(Y>4){let Xe=c.pos-(Y-4);for(;c.pos>Xe;)ne=C(q,W,ne)}W[--ne]=_e,W[--ne]=re-q,W[--ne]=Q-q,W[--ne]=P}else Y==-3?f=P:Y==-4&&(p=P);return ne}let x=[],j=[];for(;c.pos>0;)g(r.start||0,r.bufferStart||0,x,j,-1);let F=(e=r.length)!==null&&e!==void 0?e:x.length?j[0]+x[0].length:0;return new Ni(h[r.topID],x.reverse(),j.reverse(),F)}const JI=new WeakMap;function C0(r,e){if(!r.isAnonymous||e instanceof jl||e.type!=r)return 1;let i=JI.get(e);if(i==null){i=1;for(let s of e.children){if(s.type!=r||!(s instanceof Ni)){i=1;break}i+=C0(r,s)}JI.set(e,i)}return i}function TT(r,e,i,s,n,l,u,c,h){let f=0;for(let y=s;y<n;y++)f+=C0(r,e[y]);let p=Math.ceil(f*1.5/8),g=[],T=[];function $(y,R,C,x,j){for(let F=C;F<x;){let q=F,W=R[F],ne=C0(r,y[F]);for(F++;F<x;F++){let P=C0(r,y[F]);if(ne+P>=p)break;ne+=P}if(F==q+1){if(ne>p){let P=y[q];$(P.children,P.positions,0,P.children.length,R[q]+j);continue}g.push(y[q])}else{let P=R[F-1]+y[F-1].length-W;g.push(TT(r,y,R,q,F,W,P,null,h))}T.push(W+j-l)}}return $(e,i,s,n,0),(c||h)(g,T,u)}class Pl{constructor(e,i,s,n,l=!1,u=!1){this.from=e,this.to=i,this.tree=s,this.offset=n,this.open=(l?1:0)|(u?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,i=[],s=!1){let n=[new Pl(0,e.length,e,0,!1,s)];for(let l of i)l.to>e.length&&n.push(l);return n}static applyChanges(e,i,s=128){if(!i.length)return e;let n=[],l=1,u=e.length?e[0]:null;for(let c=0,h=0,f=0;;c++){let p=c<i.length?i[c]:null,g=p?p.fromA:1e9;if(g-h>=s)for(;u&&u.from<g;){let T=u;if(h>=T.from||g<=T.to||f){let $=Math.max(T.from,h)-f,y=Math.min(T.to,g)-f;T=$>=y?null:new Pl($,y,T.tree,T.offset+f,c>0,!!p)}if(T&&n.push(T),u.to>g)break;u=l<e.length?e[l++]:null}if(!p)break;h=p.toA,f=p.toA-p.toB}return n}}class ew{startParse(e,i,s){return typeof e=="string"&&(e=new oH(e)),s=s?s.length?s.map(n=>new N1(n.from,n.to)):[new N1(0,0)]:[new N1(0,e.length)],this.createParse(e,i||[],s)}parse(e,i,s){let n=this.startParse(e,i,s);for(;;){let l=n.advance();if(l)return l}}}class oH{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,i){return this.string.slice(e,i)}}new _t({perNode:!0});let lH=0;class bn{constructor(e,i,s){this.set=e,this.base=i,this.modified=s,this.id=lH++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let i=new bn([],null,[]);if(i.set.push(i),e)for(let s of e.set)i.set.push(s);return i}static defineModifier(){let e=new of;return i=>i.modified.indexOf(e)>-1?i:of.get(i.base||i,i.modified.concat(e).sort((s,n)=>s.id-n.id))}}let aH=0;class of{constructor(){this.instances=[],this.id=aH++}static get(e,i){if(!i.length)return e;let s=i[0].instances.find(c=>c.base==e&&uH(i,c.modified));if(s)return s;let n=[],l=new bn(n,e,i);for(let c of i)c.instances.push(l);let u=cH(i);for(let c of e.set)if(!c.modified.length)for(let h of u)n.push(of.get(c,h));return l}}function uH(r,e){return r.length==e.length&&r.every((i,s)=>i==e[s])}function cH(r){let e=[[]];for(let i=0;i<r.length;i++)for(let s=0,n=e.length;s<n;s++)e.push(e[s].concat(r[i]));return e.sort((i,s)=>s.length-i.length)}function tw(r){let e=Object.create(null);for(let i in r){let s=r[i];Array.isArray(s)||(s=[s]);for(let n of i.split(" "))if(n){let l=[],u=2,c=n;for(let g=0;;){if(c=="..."&&g>0&&g+3==n.length){u=1;break}let T=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(c);if(!T)throw new RangeError("Invalid path: "+n);if(l.push(T[0]=="*"?"":T[0][0]=='"'?JSON.parse(T[0]):T[0]),g+=T[0].length,g==n.length)break;let $=n[g++];if(g==n.length&&$=="!"){u=0;break}if($!="/")throw new RangeError("Invalid path: "+n);c=n.slice(g)}let h=l.length-1,f=l[h];if(!f)throw new RangeError("Invalid path: "+n);let p=new lf(s,u,h>0?l.slice(0,h):null);e[f]=p.sort(e[f])}}return iw.add(e)}const iw=new _t;class lf{constructor(e,i,s,n){this.tags=e,this.mode=i,this.context=s,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}lf.empty=new lf([],2,null);function rw(r,e){let i=Object.create(null);for(let l of r)if(!Array.isArray(l.tag))i[l.tag.id]=l.class;else for(let u of l.tag)i[u.id]=l.class;let{scope:s,all:n=null}=e||{};return{style:l=>{let u=n;for(let c of l)for(let h of c.set){let f=i[h.id];if(f){u=u?u+" "+f:f;break}}return u},scope:s}}function hH(r,e){let i=null;for(let s of r){let n=s.style(e);n&&(i=i?i+" "+n:n)}return i}function dH(r,e,i,s=0,n=r.length){let l=new fH(s,Array.isArray(e)?e:[e],i);l.highlightRange(r.cursor(),s,n,"",l.highlighters),l.flush(n)}class fH{constructor(e,i,s){this.at=e,this.highlighters=i,this.span=s,this.class=""}startSpan(e,i){i!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=i)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,i,s,n,l){let{type:u,from:c,to:h}=e;if(c>=s||h<=i)return;u.isTop&&(l=this.highlighters.filter($=>!$.scope||$.scope(u)));let f=n,p=pH(e)||lf.empty,g=hH(l,p.tags);if(g&&(f&&(f+=" "),f+=g,p.mode==1&&(n+=(n?" ":"")+g)),this.startSpan(e.from,f),p.opaque)return;let T=e.tree&&e.tree.prop(_t.mounted);if(T&&T.overlay){let $=e.node.enter(T.overlay[0].from+c,1),y=this.highlighters.filter(C=>!C.scope||C.scope(T.tree.type)),R=e.firstChild();for(let C=0,x=c;;C++){let j=C<T.overlay.length?T.overlay[C]:null,F=j?j.from+c:h,q=Math.max(i,x),W=Math.min(s,F);if(q<W&&R)for(;e.from<W&&(this.highlightRange(e,q,W,n,l),this.startSpan(Math.min(W,e.to),f),!(e.to>=F||!e.nextSibling())););if(!j||F>s)break;x=j.to+c,x>i&&(this.highlightRange($.cursor(),Math.max(i,j.from+c),Math.min(s,x),n,y),this.startSpan(x,f))}R&&e.parent()}else if(e.firstChild()){do if(!(e.to<=i)){if(e.from>=s)break;this.highlightRange(e,i,s,n,l),this.startSpan(Math.min(s,e.to),f)}while(e.nextSibling());e.parent()}}}function pH(r){let e=r.type.prop(iw);for(;e&&e.context&&!r.matchContext(e.context);)e=e.next;return e||null}const Se=bn.define,u0=Se(),No=Se(),QI=Se(No),ZI=Se(No),xo=Se(),c0=Se(xo),x1=Se(xo),gn=Se(),Ol=Se(gn),pn=Se(),mn=Se(),K_=Se(),Ec=Se(K_),h0=Se(),Te={comment:u0,lineComment:Se(u0),blockComment:Se(u0),docComment:Se(u0),name:No,variableName:Se(No),typeName:QI,tagName:Se(QI),propertyName:ZI,attributeName:Se(ZI),className:Se(No),labelName:Se(No),namespace:Se(No),macroName:Se(No),literal:xo,string:c0,docString:Se(c0),character:Se(c0),attributeValue:Se(c0),number:x1,integer:Se(x1),float:Se(x1),bool:Se(xo),regexp:Se(xo),escape:Se(xo),color:Se(xo),url:Se(xo),keyword:pn,self:Se(pn),null:Se(pn),atom:Se(pn),unit:Se(pn),modifier:Se(pn),operatorKeyword:Se(pn),controlKeyword:Se(pn),definitionKeyword:Se(pn),moduleKeyword:Se(pn),operator:mn,derefOperator:Se(mn),arithmeticOperator:Se(mn),logicOperator:Se(mn),bitwiseOperator:Se(mn),compareOperator:Se(mn),updateOperator:Se(mn),definitionOperator:Se(mn),typeOperator:Se(mn),controlOperator:Se(mn),punctuation:K_,separator:Se(K_),bracket:Ec,angleBracket:Se(Ec),squareBracket:Se(Ec),paren:Se(Ec),brace:Se(Ec),content:gn,heading:Ol,heading1:Se(Ol),heading2:Se(Ol),heading3:Se(Ol),heading4:Se(Ol),heading5:Se(Ol),heading6:Se(Ol),contentSeparator:Se(gn),list:Se(gn),quote:Se(gn),emphasis:Se(gn),strong:Se(gn),link:Se(gn),monospace:Se(gn),strikethrough:Se(gn),inserted:Se(),deleted:Se(),changed:Se(),invalid:Se(),meta:h0,documentMeta:Se(h0),annotation:Se(h0),processingInstruction:Se(h0),definition:bn.defineModifier(),constant:bn.defineModifier(),function:bn.defineModifier(),standard:bn.defineModifier(),local:bn.defineModifier(),special:bn.defineModifier()};rw([{tag:Te.link,class:"tok-link"},{tag:Te.heading,class:"tok-heading"},{tag:Te.emphasis,class:"tok-emphasis"},{tag:Te.strong,class:"tok-strong"},{tag:Te.keyword,class:"tok-keyword"},{tag:Te.atom,class:"tok-atom"},{tag:Te.bool,class:"tok-bool"},{tag:Te.url,class:"tok-url"},{tag:Te.labelName,class:"tok-labelName"},{tag:Te.inserted,class:"tok-inserted"},{tag:Te.deleted,class:"tok-deleted"},{tag:Te.literal,class:"tok-literal"},{tag:Te.string,class:"tok-string"},{tag:Te.number,class:"tok-number"},{tag:[Te.regexp,Te.escape,Te.special(Te.string)],class:"tok-string2"},{tag:Te.variableName,class:"tok-variableName"},{tag:Te.local(Te.variableName),class:"tok-variableName tok-local"},{tag:Te.definition(Te.variableName),class:"tok-variableName tok-definition"},{tag:Te.special(Te.variableName),class:"tok-variableName2"},{tag:Te.definition(Te.propertyName),class:"tok-propertyName tok-definition"},{tag:Te.typeName,class:"tok-typeName"},{tag:Te.namespace,class:"tok-namespace"},{tag:Te.className,class:"tok-className"},{tag:Te.macroName,class:"tok-macroName"},{tag:Te.propertyName,class:"tok-propertyName"},{tag:Te.operator,class:"tok-operator"},{tag:Te.comment,class:"tok-comment"},{tag:Te.meta,class:"tok-meta"},{tag:Te.invalid,class:"tok-invalid"},{tag:Te.punctuation,class:"tok-punctuation"}]);var D1;const Ua=new _t;function mH(r){return Pe.define({combine:r?e=>e.concat(r):void 0})}const gH=new _t;class qs{constructor(e,i,s=[],n=""){this.data=e,this.name=n,xt.prototype.hasOwnProperty("tree")||Object.defineProperty(xt.prototype,"tree",{get(){return rr(this)}}),this.parser=i,this.extension=[Qo.of(this),xt.languageData.of((l,u,c)=>{let h=ek(l,u,c),f=h.type.prop(Ua);if(!f)return[];let p=l.facet(f),g=h.type.prop(gH);if(g){let T=h.resolve(u-h.from,c);for(let $ of g)if($.test(T,l)){let y=l.facet($.facet);return $.type=="replace"?y:y.concat(p)}}return p})].concat(s)}isActiveAt(e,i,s=-1){return ek(e,i,s).type.prop(Ua)==this.data}findRegions(e){let i=e.facet(Qo);if((i==null?void 0:i.data)==this.data)return[{from:0,to:e.doc.length}];if(!i||!i.allowsNesting)return[];let s=[],n=(l,u)=>{if(l.prop(Ua)==this.data){s.push({from:u,to:u+l.length});return}let c=l.prop(_t.mounted);if(c){if(c.tree.prop(Ua)==this.data){if(c.overlay)for(let h of c.overlay)s.push({from:h.from+u,to:h.to+u});else s.push({from:u,to:u+l.length});return}else if(c.overlay){let h=s.length;if(n(c.tree,c.overlay[0].from+u),s.length>h)return}}for(let h=0;h<l.children.length;h++){let f=l.children[h];f instanceof Ni&&n(f,l.positions[h]+u)}};return n(rr(e),0),s}get allowsNesting(){return!0}}qs.setState=ct.define();function ek(r,e,i){let s=r.facet(Qo),n=rr(r).topNode;if(!s||s.allowsNesting)for(let l=n;l;l=l.enter(e,i,ir.ExcludeBuffers))l.type.isTop&&(n=l);return n}class af extends qs{constructor(e,i,s){super(e,i,[],s),this.parser=i}static define(e){let i=mH(e.languageData);return new af(i,e.parser.configure({props:[Ua.add(s=>s.isTop?i:void 0)]}),e.name)}configure(e,i){return new af(this.data,this.parser.configure(e),i||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function rr(r){let e=r.field(qs.state,!1);return e?e.tree:Ni.empty}class _H{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,i){let s=this.cursorPos-this.string.length;return e<s||i>=this.cursorPos?this.doc.sliceString(e,i):this.string.slice(e-s,i-s)}}let $c=null;class uf{constructor(e,i,s=[],n,l,u,c,h){this.parser=e,this.state=i,this.fragments=s,this.tree=n,this.treeLen=l,this.viewport=u,this.skipped=c,this.scheduleOn=h,this.parse=null,this.tempSkipped=[]}static create(e,i,s){return new uf(e,i,[],Ni.empty,0,s,[],null)}startParse(){return this.parser.startParse(new _H(this.state.doc),this.fragments)}work(e,i){return i!=null&&i>=this.state.doc.length&&(i=void 0),this.tree!=Ni.empty&&this.isDone(i??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var s;if(typeof e=="number"){let n=Date.now()+e;e=()=>Date.now()>n}for(this.parse||(this.parse=this.startParse()),i!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>i)&&i<this.state.doc.length&&this.parse.stopAt(i);;){let n=this.parse.advance();if(n)if(this.fragments=this.withoutTempSkipped(Pl.addTree(n,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(s=this.parse.stoppedAt)!==null&&s!==void 0?s:this.state.doc.length,this.tree=n,this.parse=null,this.treeLen<(i??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,i;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(i=this.parse.advance()););}),this.treeLen=e,this.tree=i,this.fragments=this.withoutTempSkipped(Pl.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let i=$c;$c=this;try{return e()}finally{$c=i}}withoutTempSkipped(e){for(let i;i=this.tempSkipped.pop();)e=tk(e,i.from,i.to);return e}changes(e,i){let{fragments:s,tree:n,treeLen:l,viewport:u,skipped:c}=this;if(this.takeTree(),!e.empty){let h=[];if(e.iterChangedRanges((f,p,g,T)=>h.push({fromA:f,toA:p,fromB:g,toB:T})),s=Pl.applyChanges(s,h),n=Ni.empty,l=0,u={from:e.mapPos(u.from,-1),to:e.mapPos(u.to,1)},this.skipped.length){c=[];for(let f of this.skipped){let p=e.mapPos(f.from,1),g=e.mapPos(f.to,-1);p<g&&c.push({from:p,to:g})}}}return new uf(this.parser,i,s,n,l,u,c,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let i=this.skipped.length;for(let s=0;s<this.skipped.length;s++){let{from:n,to:l}=this.skipped[s];n<e.to&&l>e.from&&(this.fragments=tk(this.fragments,n,l),this.skipped.splice(s--,1))}return this.skipped.length>=i?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,i){this.skipped.push({from:e,to:i})}static getSkippingParser(e){return new class extends ew{createParse(i,s,n){let l=n[0].from,u=n[n.length-1].to;return{parsedPos:l,advance(){let h=$c;if(h){for(let f of n)h.tempSkipped.push(f);e&&(h.scheduleOn=h.scheduleOn?Promise.all([h.scheduleOn,e]):e)}return this.parsedPos=u,new Ni(Gr.none,[],[],u-l)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let i=this.fragments;return this.treeLen>=e&&i.length&&i[0].from==0&&i[0].to>=e}static get(){return $c}}function tk(r,e,i){return Pl.applyChanges(r,[{fromA:e,toA:i,fromB:e,toB:i}])}class nu{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let i=this.context.changes(e.changes,e.state),s=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),i.viewport.to);return i.work(20,s)||i.takeTree(),new nu(i)}static init(e){let i=Math.min(3e3,e.doc.length),s=uf.create(e.facet(Qo).parser,e,{from:0,to:i});return s.work(20,i)||s.takeTree(),new nu(s)}}qs.state=sr.define({create:nu.init,update(r,e){for(let i of e.effects)if(i.is(qs.setState))return i.value;return e.startState.facet(Qo)!=e.state.facet(Qo)?nu.init(e.state):r.apply(e)}});let sw=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(sw=r=>{let e=-1,i=setTimeout(()=>{e=requestIdleCallback(r,{timeout:500-100})},100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const L1=typeof navigator<"u"&&(!((D1=navigator.scheduling)===null||D1===void 0)&&D1.isInputPending)?()=>navigator.scheduling.isInputPending():null,bH=Si.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let i=this.view.state.field(qs.state).context;(i.updateViewport(e.view.viewport)||this.view.viewport.to>i.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(i)}scheduleWork(){if(this.working)return;let{state:e}=this.view,i=e.field(qs.state);(i.tree!=i.context.tree||!i.context.isDone(e.doc.length))&&(this.working=sw(this.work))}work(e){this.working=null;let i=Date.now();if(this.chunkEnd<i&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=i+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:s,viewport:{to:n}}=this.view,l=s.field(qs.state);if(l.tree==l.context.tree&&l.context.isDone(n+1e5))return;let u=Date.now()+Math.min(this.chunkBudget,100,e&&!L1?Math.max(25,e.timeRemaining()-5):1e9),c=l.context.treeLen<n&&s.doc.length>n+1e3,h=l.context.work(()=>L1&&L1()||Date.now()>u,n+(c?0:1e5));this.chunkBudget-=Date.now()-i,(h||this.chunkBudget<=0)&&(l.context.takeTree(),this.view.dispatch({effects:qs.setState.of(new nu(l.context))})),this.chunkBudget>0&&!(h&&!c)&&this.scheduleWork(),this.checkAsyncSchedule(l.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(i=>ss(this.view.state,i)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Qo=Pe.define({combine(r){return r.length?r[0]:null},enables:r=>[qs.state,bH,Fe.contentAttributes.compute([r],e=>{let i=e.facet(r);return i&&i.name?{"data-language":i.name}:{}})]});class TH{constructor(e,i=[]){this.language=e,this.support=i,this.extension=[e,i]}}const EH=Pe.define(),np=Pe.define({combine:r=>{if(!r.length)return"  ";let e=r[0];if(!e||/\S/.test(e)||Array.from(e).some(i=>i!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return e}});function cf(r){let e=r.facet(np);return e.charCodeAt(0)==9?r.tabSize*e.length:e.length}function sh(r,e){let i="",s=r.tabSize,n=r.facet(np)[0];if(n=="	"){for(;e>=s;)i+="	",e-=s;n=" "}for(let l=0;l<e;l++)i+=n;return i}function ET(r,e){r instanceof xt&&(r=new op(r));for(let s of r.state.facet(EH)){let n=s(r,e);if(n!==void 0)return n}let i=rr(r.state);return i?$H(r,i,e):null}class op{constructor(e,i={}){this.state=e,this.options=i,this.unit=cf(e)}lineAt(e,i=1){let s=this.state.doc.lineAt(e),{simulateBreak:n,simulateDoubleBreak:l}=this.options;return n!=null&&n>=s.from&&n<=s.to?l&&n==e?{text:"",from:e}:(i<0?n<e:n<=e)?{text:s.text.slice(n-s.from),from:n}:{text:s.text.slice(0,n-s.from),from:s.from}:s}textAfterPos(e,i=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:s,from:n}=this.lineAt(e,i);return s.slice(e-n,Math.min(s.length,e+100-n))}column(e,i=1){let{text:s,from:n}=this.lineAt(e,i),l=this.countColumn(s,e-n),u=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return u>-1&&(l+=u-this.countColumn(s,s.search(/\S|$/))),l}countColumn(e,i=e.length){return mh(e,this.state.tabSize,i)}lineIndent(e,i=1){let{text:s,from:n}=this.lineAt(e,i),l=this.options.overrideIndentation;if(l){let u=l(n);if(u>-1)return u}return this.countColumn(s,s.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const nw=new _t;function $H(r,e,i){return ow(e.resolveInner(i).enterUnfinishedNodesBefore(i),i,r)}function vH(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function yH(r){let e=r.type.prop(nw);if(e)return e;let i=r.firstChild,s;if(i&&(s=i.type.prop(_t.closedBy))){let n=r.lastChild,l=n&&s.indexOf(n.name)>-1;return u=>AH(u,!0,1,void 0,l&&!vH(u)?n.from:void 0)}return r.parent==null?SH:null}function ow(r,e,i){for(;r;r=r.parent){let s=yH(r);if(s)return s($T.create(i,e,r))}return null}function SH(){return 0}class $T extends op{constructor(e,i,s){super(e.state,e.options),this.base=e,this.pos=i,this.node=s}static create(e,i,s){return new $T(e,i,s)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let i=this.node.resolve(e.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(IH(i,this.node))break;e=this.state.doc.lineAt(i.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?ow(e,this.pos,this.base):0}}function IH(r,e){for(let i=e;i;i=i.parent)if(r==i)return!0;return!1}function kH(r){let e=r.node,i=e.childAfter(e.from),s=e.lastChild;if(!i)return null;let n=r.options.simulateBreak,l=r.state.doc.lineAt(i.from),u=n==null||n<=l.from?l.to:Math.min(l.to,n);for(let c=i.to;;){let h=e.childAfter(c);if(!h||h==s)return null;if(!h.type.isSkipped)return h.from<u?i:null;c=h.to}}function AH(r,e,i,s,n){let l=r.textAfter,u=l.match(/^\s*/)[0].length,c=s&&l.slice(u,u+s.length)==s||n==r.pos+u,h=e?kH(r):null;return h?c?r.column(h.from):r.column(h.to):r.baseIndent+(c?0:r.unit*i)}const CH=200;function OH(){return xt.transactionFilter.of(r=>{if(!r.docChanged||!r.isUserEvent("input.type")&&!r.isUserEvent("input.complete"))return r;let e=r.startState.languageDataAt("indentOnInput",r.startState.selection.main.head);if(!e.length)return r;let i=r.newDoc,{head:s}=r.newSelection.main,n=i.lineAt(s);if(s>n.from+CH)return r;let l=i.sliceString(n.from,s);if(!e.some(f=>f.test(l)))return r;let{state:u}=r,c=-1,h=[];for(let{head:f}of u.selection.ranges){let p=u.doc.lineAt(f);if(p.from==c)continue;c=p.from;let g=ET(u,p.from);if(g==null)continue;let T=/^\s*/.exec(p.text)[0],$=sh(u,g);T!=$&&h.push({from:p.from,to:p.from+T.length,insert:$})}return h.length?[r,{changes:h,sequential:!0}]:r})}const wH=Pe.define(),lw=new _t;function RH(r,e,i){let s=rr(r);if(s.length<i)return null;let n=s.resolveInner(i,1),l=null;for(let u=n;u;u=u.parent){if(u.to<=i||u.from>i)continue;if(l&&u.from<e)break;let c=u.type.prop(lw);if(c&&(u.to<s.length-50||s.length==r.doc.length||!NH(u))){let h=c(u,r);h&&h.from<=i&&h.from>=e&&h.to>i&&(l=h)}}return l}function NH(r){let e=r.lastChild;return e&&e.to==r.to&&e.type.isError}function hf(r,e,i){for(let s of r.facet(wH)){let n=s(r,e,i);if(n)return n}return RH(r,e,i)}function aw(r,e){let i=e.mapPos(r.from,1),s=e.mapPos(r.to,-1);return i>=s?void 0:{from:i,to:s}}const lp=ct.define({map:aw}),bh=ct.define({map:aw});function uw(r){let e=[];for(let{head:i}of r.state.selection.ranges)e.some(s=>s.from<=i&&s.to>=i)||e.push(r.lineBlockAt(i));return e}const Vl=sr.define({create(){return Ge.none},update(r,e){r=r.map(e.changes);for(let i of e.effects)i.is(lp)&&!xH(r,i.value.from,i.value.to)?r=r.update({add:[ik.range(i.value.from,i.value.to)]}):i.is(bh)&&(r=r.update({filter:(s,n)=>i.value.from!=s||i.value.to!=n,filterFrom:i.value.from,filterTo:i.value.to}));if(e.selection){let i=!1,{head:s}=e.selection.main;r.between(s,s,(n,l)=>{n<s&&l>s&&(i=!0)}),i&&(r=r.update({filterFrom:s,filterTo:s,filter:(n,l)=>l<=s||n>=s}))}return r},provide:r=>Fe.decorations.from(r),toJSON(r,e){let i=[];return r.between(0,e.doc.length,(s,n)=>{i.push(s,n)}),i},fromJSON(r){if(!Array.isArray(r)||r.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let i=0;i<r.length;){let s=r[i++],n=r[i++];if(typeof s!="number"||typeof n!="number")throw new RangeError("Invalid JSON for fold state");e.push(ik.range(s,n))}return Ge.set(e,!0)}});function df(r,e,i){var s;let n=null;return(s=r.field(Vl,!1))===null||s===void 0||s.between(e,i,(l,u)=>{(!n||n.from>l)&&(n={from:l,to:u})}),n}function xH(r,e,i){let s=!1;return r.between(e,e,(n,l)=>{n==e&&l==i&&(s=!0)}),s}function cw(r,e){return r.field(Vl,!1)?e:e.concat(ct.appendConfig.of(fw()))}const DH=r=>{for(let e of uw(r)){let i=hf(r.state,e.from,e.to);if(i)return r.dispatch({effects:cw(r.state,[lp.of(i),hw(r,i)])}),!0}return!1},LH=r=>{if(!r.state.field(Vl,!1))return!1;let e=[];for(let i of uw(r)){let s=df(r.state,i.from,i.to);s&&e.push(bh.of(s),hw(r,s,!1))}return e.length&&r.dispatch({effects:e}),e.length>0};function hw(r,e,i=!0){let s=r.state.doc.lineAt(e.from).number,n=r.state.doc.lineAt(e.to).number;return Fe.announce.of(`${r.state.phrase(i?"Folded lines":"Unfolded lines")} ${s} ${r.state.phrase("to")} ${n}.`)}const MH=r=>{let{state:e}=r,i=[];for(let s=0;s<e.doc.length;){let n=r.lineBlockAt(s),l=hf(e,n.from,n.to);l&&i.push(lp.of(l)),s=(l?r.lineBlockAt(l.to):n).to+1}return i.length&&r.dispatch({effects:cw(r.state,i)}),!!i.length},BH=r=>{let e=r.state.field(Vl,!1);if(!e||!e.size)return!1;let i=[];return e.between(0,r.state.doc.length,(s,n)=>{i.push(bh.of({from:s,to:n}))}),r.dispatch({effects:i}),!0},PH=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:DH},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:LH},{key:"Ctrl-Alt-[",run:MH},{key:"Ctrl-Alt-]",run:BH}],FH={placeholderDOM:null,placeholderText:"…"},dw=Pe.define({combine(r){return xn(r,FH)}});function fw(r){let e=[Vl,GH];return r&&e.push(dw.of(r)),e}const ik=Ge.replace({widget:new class extends fo{toDOM(r){let{state:e}=r,i=e.facet(dw),s=l=>{let u=r.lineBlockAt(r.posAtDOM(l.target)),c=df(r.state,u.from,u.to);c&&r.dispatch({effects:bh.of(c)}),l.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(r,s);let n=document.createElement("span");return n.textContent=i.placeholderText,n.setAttribute("aria-label",e.phrase("folded code")),n.title=e.phrase("unfold"),n.className="cm-foldPlaceholder",n.onclick=s,n}}}),UH={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class M1 extends uo{constructor(e,i){super(),this.config=e,this.open=i}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let i=document.createElement("span");return i.textContent=this.open?this.config.openText:this.config.closedText,i.title=e.state.phrase(this.open?"Fold line":"Unfold line"),i}}function HH(r={}){let e=Object.assign(Object.assign({},UH),r),i=new M1(e,!0),s=new M1(e,!1),n=Si.fromClass(class{constructor(u){this.from=u.viewport.from,this.markers=this.buildMarkers(u)}update(u){(u.docChanged||u.viewportChanged||u.startState.facet(Qo)!=u.state.facet(Qo)||u.startState.field(Vl,!1)!=u.state.field(Vl,!1)||rr(u.startState)!=rr(u.state)||e.foldingChanged(u))&&(this.markers=this.buildMarkers(u.view))}buildMarkers(u){let c=new jo;for(let h of u.viewportLineBlocks){let f=df(u.state,h.from,h.to)?s:hf(u.state,h.from,h.to)?i:null;f&&c.add(h.from,h.from,f)}return c.finish()}}),{domEventHandlers:l}=e;return[n,YU({class:"cm-foldGutter",markers(u){var c;return((c=u.plugin(n))===null||c===void 0?void 0:c.markers)||Ht.empty},initialSpacer(){return new M1(e,!1)},domEventHandlers:Object.assign(Object.assign({},l),{click:(u,c,h)=>{if(l.click&&l.click(u,c,h))return!0;let f=df(u.state,c.from,c.to);if(f)return u.dispatch({effects:bh.of(f)}),!0;let p=hf(u.state,c.from,c.to);return p?(u.dispatch({effects:lp.of(p)}),!0):!1}})}),fw()]}const GH=Fe.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class ap{constructor(e,i){this.specs=e;let s;function n(c){let h=Ko.newName();return(s||(s=Object.create(null)))["."+h]=c,h}const l=typeof i.all=="string"?i.all:i.all?n(i.all):void 0,u=i.scope;this.scope=u instanceof qs?c=>c.prop(Ua)==u.data:u?c=>c==u:void 0,this.style=rw(e.map(c=>({tag:c.tag,class:c.class||n(Object.assign({},c,{tag:null}))})),{all:l}).style,this.module=s?new Ko(s):null,this.themeType=i.themeType}static define(e,i){return new ap(e,i||{})}}const q_=Pe.define(),pw=Pe.define({combine(r){return r.length?[r[0]]:null}});function B1(r){let e=r.facet(q_);return e.length?e:r.facet(pw)}function VH(r,e){let i=[zH],s;return r instanceof ap&&(r.module&&i.push(Fe.styleModule.of(r.module)),s=r.themeType),e!=null&&e.fallback?i.push(pw.of(r)):s?i.push(q_.computeN([Fe.darkTheme],n=>n.facet(Fe.darkTheme)==(s=="dark")?[r]:[])):i.push(q_.of(r)),i}class WH{constructor(e){this.markCache=Object.create(null),this.tree=rr(e.state),this.decorations=this.buildDeco(e,B1(e.state))}update(e){let i=rr(e.state),s=B1(e.state),n=s!=B1(e.startState);i.length<e.view.viewport.to&&!n&&i.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(i!=this.tree||e.viewportChanged||n)&&(this.tree=i,this.decorations=this.buildDeco(e.view,s))}buildDeco(e,i){if(!i||!this.tree.length)return Ge.none;let s=new jo;for(let{from:n,to:l}of e.visibleRanges)dH(this.tree,i,(u,c,h)=>{s.add(u,c,this.markCache[h]||(this.markCache[h]=Ge.mark({class:h})))},n,l);return s.finish()}}const zH=pu.high(Si.fromClass(WH,{decorations:r=>r.decorations})),YH=ap.define([{tag:Te.meta,color:"#404740"},{tag:Te.link,textDecoration:"underline"},{tag:Te.heading,textDecoration:"underline",fontWeight:"bold"},{tag:Te.emphasis,fontStyle:"italic"},{tag:Te.strong,fontWeight:"bold"},{tag:Te.strikethrough,textDecoration:"line-through"},{tag:Te.keyword,color:"#708"},{tag:[Te.atom,Te.bool,Te.url,Te.contentSeparator,Te.labelName],color:"#219"},{tag:[Te.literal,Te.inserted],color:"#164"},{tag:[Te.string,Te.deleted],color:"#a11"},{tag:[Te.regexp,Te.escape,Te.special(Te.string)],color:"#e40"},{tag:Te.definition(Te.variableName),color:"#00f"},{tag:Te.local(Te.variableName),color:"#30a"},{tag:[Te.typeName,Te.namespace],color:"#085"},{tag:Te.className,color:"#167"},{tag:[Te.special(Te.variableName),Te.macroName],color:"#256"},{tag:Te.definition(Te.propertyName),color:"#00c"},{tag:Te.comment,color:"#940"},{tag:Te.invalid,color:"#f00"}]),XH=Fe.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),mw=1e4,gw="()[]{}",_w=Pe.define({combine(r){return xn(r,{afterCursor:!0,brackets:gw,maxScanDistance:mw,renderMatch:qH})}}),jH=Ge.mark({class:"cm-matchingBracket"}),KH=Ge.mark({class:"cm-nonmatchingBracket"});function qH(r){let e=[],i=r.matched?jH:KH;return e.push(i.range(r.start.from,r.start.to)),r.end&&e.push(i.range(r.end.from,r.end.to)),e}const JH=sr.define({create(){return Ge.none},update(r,e){if(!e.docChanged&&!e.selection)return r;let i=[],s=e.state.facet(_w);for(let n of e.state.selection.ranges){if(!n.empty)continue;let l=vn(e.state,n.head,-1,s)||n.head>0&&vn(e.state,n.head-1,1,s)||s.afterCursor&&(vn(e.state,n.head,1,s)||n.head<e.state.doc.length&&vn(e.state,n.head+1,-1,s));l&&(i=i.concat(s.renderMatch(l,e.state)))}return Ge.set(i,!0)},provide:r=>Fe.decorations.from(r)}),QH=[JH,XH];function ZH(r={}){return[_w.of(r),QH]}const bw=new _t;function J_(r,e,i){let s=r.prop(e<0?_t.openedBy:_t.closedBy);if(s)return s;if(r.name.length==1){let n=i.indexOf(r.name);if(n>-1&&n%2==(e<0?1:0))return[i[n+e]]}return null}function Q_(r){let e=r.type.prop(bw);return e?e(r.node):r}function vn(r,e,i,s={}){let n=s.maxScanDistance||mw,l=s.brackets||gw,u=rr(r),c=u.resolveInner(e,i);for(let h=c;h;h=h.parent){let f=J_(h.type,i,l);if(f&&h.from<h.to){let p=Q_(h);if(p&&(i>0?e>=p.from&&e<p.to:e>p.from&&e<=p.to))return eG(r,e,i,h,p,f,l)}}return tG(r,e,i,u,c.type,n,l)}function eG(r,e,i,s,n,l,u){let c=s.parent,h={from:n.from,to:n.to},f=0,p=c==null?void 0:c.cursor();if(p&&(i<0?p.childBefore(s.from):p.childAfter(s.to)))do if(i<0?p.to<=s.from:p.from>=s.to){if(f==0&&l.indexOf(p.type.name)>-1&&p.from<p.to){let g=Q_(p);return{start:h,end:g?{from:g.from,to:g.to}:void 0,matched:!0}}else if(J_(p.type,i,u))f++;else if(J_(p.type,-i,u)){if(f==0){let g=Q_(p);return{start:h,end:g&&g.from<g.to?{from:g.from,to:g.to}:void 0,matched:!1}}f--}}while(i<0?p.prevSibling():p.nextSibling());return{start:h,matched:!1}}function tG(r,e,i,s,n,l,u){let c=i<0?r.sliceDoc(e-1,e):r.sliceDoc(e,e+1),h=u.indexOf(c);if(h<0||h%2==0!=i>0)return null;let f={from:i<0?e-1:e,to:i>0?e+1:e},p=r.doc.iterRange(e,i>0?r.doc.length:0),g=0;for(let T=0;!p.next().done&&T<=l;){let $=p.value;i<0&&(T+=$.length);let y=e+T*i;for(let R=i>0?0:$.length-1,C=i>0?$.length:-1;R!=C;R+=i){let x=u.indexOf($[R]);if(!(x<0||s.resolveInner(y+R,1).type!=n))if(x%2==0==i>0)g++;else{if(g==1)return{start:f,end:{from:y+R,to:y+R+1},matched:x>>1==h>>1};g--}}i>0&&(T+=$.length)}return p.done?{start:f,matched:!1}:null}const iG=Object.create(null),rk=[Gr.none],sk=[],rG=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])rG[r]=sG(iG,e);function P1(r,e){sk.indexOf(r)>-1||(sk.push(r),console.warn(e))}function sG(r,e){let i=null;for(let l of e.split(".")){let u=r[l]||Te[l];u?typeof u=="function"?i?i=u(i):P1(l,`Modifier ${l} used at start of tag`):i?P1(l,`Tag ${l} used as modifier`):i=u:P1(l,`Unknown highlighting tag ${l}`)}if(!i)return 0;let s=e.replace(/ /g,"_"),n=Gr.define({id:rk.length,name:s,props:[tw({[s]:i})]});return rk.push(n),n.id}const nG=r=>{let{state:e}=r,i=e.doc.lineAt(e.selection.main.from),s=yT(r.state,i.from);return s.line?oG(r):s.block?aG(r):!1};function vT(r,e){return({state:i,dispatch:s})=>{if(i.readOnly)return!1;let n=r(e,i);return n?(s(i.update(n)),!0):!1}}const oG=vT(hG,0),lG=vT(Tw,0),aG=vT((r,e)=>Tw(r,e,cG(e)),0);function yT(r,e){let i=r.languageDataAt("commentTokens",e);return i.length?i[0]:{}}const vc=50;function uG(r,{open:e,close:i},s,n){let l=r.sliceDoc(s-vc,s),u=r.sliceDoc(n,n+vc),c=/\s*$/.exec(l)[0].length,h=/^\s*/.exec(u)[0].length,f=l.length-c;if(l.slice(f-e.length,f)==e&&u.slice(h,h+i.length)==i)return{open:{pos:s-c,margin:c&&1},close:{pos:n+h,margin:h&&1}};let p,g;n-s<=2*vc?p=g=r.sliceDoc(s,n):(p=r.sliceDoc(s,s+vc),g=r.sliceDoc(n-vc,n));let T=/^\s*/.exec(p)[0].length,$=/\s*$/.exec(g)[0].length,y=g.length-$-i.length;return p.slice(T,T+e.length)==e&&g.slice(y,y+i.length)==i?{open:{pos:s+T+e.length,margin:/\s/.test(p.charAt(T+e.length))?1:0},close:{pos:n-$-i.length,margin:/\s/.test(g.charAt(y-1))?1:0}}:null}function cG(r){let e=[];for(let i of r.selection.ranges){let s=r.doc.lineAt(i.from),n=i.to<=s.to?s:r.doc.lineAt(i.to),l=e.length-1;l>=0&&e[l].to>s.from?e[l].to=n.to:e.push({from:s.from,to:n.to})}return e}function Tw(r,e,i=e.selection.ranges){let s=i.map(l=>yT(e,l.from).block);if(!s.every(l=>l))return null;let n=i.map((l,u)=>uG(e,s[u],l.from,l.to));if(r!=2&&!n.every(l=>l))return{changes:e.changes(i.map((l,u)=>n[u]?[]:[{from:l.from,insert:s[u].open+" "},{from:l.to,insert:" "+s[u].close}]))};if(r!=1&&n.some(l=>l)){let l=[];for(let u=0,c;u<n.length;u++)if(c=n[u]){let h=s[u],{open:f,close:p}=c;l.push({from:f.pos-h.open.length,to:f.pos+f.margin},{from:p.pos-p.margin,to:p.pos+h.close.length})}return{changes:l}}return null}function hG(r,e,i=e.selection.ranges){let s=[],n=-1;for(let{from:l,to:u}of i){let c=s.length,h=1e9,f=yT(e,l).line;if(f){for(let p=l;p<=u;){let g=e.doc.lineAt(p);if(g.from>n&&(l==u||u>g.from)){n=g.from;let T=/^\s*/.exec(g.text)[0].length,$=T==g.length,y=g.text.slice(T,T+f.length)==f?T:-1;T<g.text.length&&T<h&&(h=T),s.push({line:g,comment:y,token:f,indent:T,empty:$,single:!1})}p=g.to+1}if(h<1e9)for(let p=c;p<s.length;p++)s[p].indent<s[p].line.text.length&&(s[p].indent=h);s.length==c+1&&(s[c].single=!0)}}if(r!=2&&s.some(l=>l.comment<0&&(!l.empty||l.single))){let l=[];for(let{line:c,token:h,indent:f,empty:p,single:g}of s)(g||!p)&&l.push({from:c.from+f,insert:h+" "});let u=e.changes(l);return{changes:u,selection:e.selection.map(u,1)}}else if(r!=1&&s.some(l=>l.comment>=0)){let l=[];for(let{line:u,comment:c,token:h}of s)if(c>=0){let f=u.from+c,p=f+h.length;u.text[p-u.from]==" "&&p++,l.push({from:f,to:p})}return{changes:l}}return null}const Z_=ho.define(),dG=ho.define(),fG=Pe.define(),Ew=Pe.define({combine(r){return xn(r,{minDepth:100,newGroupDelay:500,joinToEvent:(e,i)=>i},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,i)=>(s,n)=>e(s,n)||i(s,n)})}});function pG(r){let e=0;return r.iterChangedRanges((i,s)=>e=s),e}const $w=sr.define({create(){return yn.empty},update(r,e){let i=e.state.facet(Ew),s=e.annotation(Z_);if(s){let h=e.docChanged?he.single(pG(e.changes)):void 0,f=Ur.fromTransaction(e,h),p=s.side,g=p==0?r.undone:r.done;return f?g=ff(g,g.length,i.minDepth,f):g=Sw(g,e.startState.selection),new yn(p==0?s.rest:g,p==0?g:s.rest)}let n=e.annotation(dG);if((n=="full"||n=="before")&&(r=r.isolate()),e.annotation(Vi.addToHistory)===!1)return e.changes.empty?r:r.addMapping(e.changes.desc);let l=Ur.fromTransaction(e),u=e.annotation(Vi.time),c=e.annotation(Vi.userEvent);return l?r=r.addChanges(l,u,c,i,e):e.selection&&(r=r.addSelection(e.startState.selection,u,c,i.newGroupDelay)),(n=="full"||n=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(e=>e.toJSON()),undone:r.undone.map(e=>e.toJSON())}},fromJSON(r){return new yn(r.done.map(Ur.fromJSON),r.undone.map(Ur.fromJSON))}});function mG(r={}){return[$w,Ew.of(r),Fe.domEventHandlers({beforeinput(e,i){let s=e.inputType=="historyUndo"?vw:e.inputType=="historyRedo"?eb:null;return s?(e.preventDefault(),s(i)):!1}})]}function up(r,e){return function({state:i,dispatch:s}){if(!e&&i.readOnly)return!1;let n=i.field($w,!1);if(!n)return!1;let l=n.pop(r,i,e);return l?(s(l),!0):!1}}const vw=up(0,!1),eb=up(1,!1),gG=up(0,!0),_G=up(1,!0);class Ur{constructor(e,i,s,n,l){this.changes=e,this.effects=i,this.mapped=s,this.startSelection=n,this.selectionsAfter=l}setSelAfter(e){return new Ur(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,i,s;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(i=this.mapped)===null||i===void 0?void 0:i.toJSON(),startSelection:(s=this.startSelection)===null||s===void 0?void 0:s.toJSON(),selectionsAfter:this.selectionsAfter.map(n=>n.toJSON())}}static fromJSON(e){return new Ur(e.changes&&Hi.fromJSON(e.changes),[],e.mapped&&kn.fromJSON(e.mapped),e.startSelection&&he.fromJSON(e.startSelection),e.selectionsAfter.map(he.fromJSON))}static fromTransaction(e,i){let s=vs;for(let n of e.startState.facet(fG)){let l=n(e);l.length&&(s=s.concat(l))}return!s.length&&e.changes.empty?null:new Ur(e.changes.invert(e.startState.doc),s,void 0,i||e.startState.selection,vs)}static selection(e){return new Ur(void 0,vs,void 0,void 0,e)}}function ff(r,e,i,s){let n=e+1>i+20?e-i-1:0,l=r.slice(n,e);return l.push(s),l}function bG(r,e){let i=[],s=!1;return r.iterChangedRanges((n,l)=>i.push(n,l)),e.iterChangedRanges((n,l,u,c)=>{for(let h=0;h<i.length;){let f=i[h++],p=i[h++];c>=f&&u<=p&&(s=!0)}}),s}function TG(r,e){return r.ranges.length==e.ranges.length&&r.ranges.filter((i,s)=>i.empty!=e.ranges[s].empty).length===0}function yw(r,e){return r.length?e.length?r.concat(e):r:e}const vs=[],EG=200;function Sw(r,e){if(r.length){let i=r[r.length-1],s=i.selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-EG));return s.length&&s[s.length-1].eq(e)?r:(s.push(e),ff(r,r.length-1,1e9,i.setSelAfter(s)))}else return[Ur.selection([e])]}function $G(r){let e=r[r.length-1],i=r.slice();return i[r.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),i}function F1(r,e){if(!r.length)return r;let i=r.length,s=vs;for(;i;){let n=vG(r[i-1],e,s);if(n.changes&&!n.changes.empty||n.effects.length){let l=r.slice(0,i);return l[i-1]=n,l}else e=n.mapped,i--,s=n.selectionsAfter}return s.length?[Ur.selection(s)]:vs}function vG(r,e,i){let s=yw(r.selectionsAfter.length?r.selectionsAfter.map(c=>c.map(e)):vs,i);if(!r.changes)return Ur.selection(s);let n=r.changes.map(e),l=e.mapDesc(r.changes,!0),u=r.mapped?r.mapped.composeDesc(l):l;return new Ur(n,ct.mapEffects(r.effects,e),u,r.startSelection.map(l),s)}const yG=/^(input\.type|delete)($|\.)/;class yn{constructor(e,i,s=0,n=void 0){this.done=e,this.undone=i,this.prevTime=s,this.prevUserEvent=n}isolate(){return this.prevTime?new yn(this.done,this.undone):this}addChanges(e,i,s,n,l){let u=this.done,c=u[u.length-1];return c&&c.changes&&!c.changes.empty&&e.changes&&(!s||yG.test(s))&&(!c.selectionsAfter.length&&i-this.prevTime<n.newGroupDelay&&n.joinToEvent(l,bG(c.changes,e.changes))||s=="input.type.compose")?u=ff(u,u.length-1,n.minDepth,new Ur(e.changes.compose(c.changes),yw(e.effects,c.effects),c.mapped,c.startSelection,vs)):u=ff(u,u.length,n.minDepth,e),new yn(u,vs,i,s)}addSelection(e,i,s,n){let l=this.done.length?this.done[this.done.length-1].selectionsAfter:vs;return l.length>0&&i-this.prevTime<n&&s==this.prevUserEvent&&s&&/^select($|\.)/.test(s)&&TG(l[l.length-1],e)?this:new yn(Sw(this.done,e),this.undone,i,s)}addMapping(e){return new yn(F1(this.done,e),F1(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,i,s){let n=e==0?this.done:this.undone;if(n.length==0)return null;let l=n[n.length-1];if(s&&l.selectionsAfter.length)return i.update({selection:l.selectionsAfter[l.selectionsAfter.length-1],annotations:Z_.of({side:e,rest:$G(n)}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(l.changes){let u=n.length==1?vs:n.slice(0,n.length-1);return l.mapped&&(u=F1(u,l.mapped)),i.update({changes:l.changes,selection:l.startSelection,effects:l.effects,annotations:Z_.of({side:e,rest:u}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}yn.empty=new yn(vs,vs);const SG=[{key:"Mod-z",run:vw,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:eb,preventDefault:!0},{linux:"Ctrl-Shift-z",run:eb,preventDefault:!0},{key:"Mod-u",run:gG,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:_G,preventDefault:!0}];function mu(r,e){return he.create(r.ranges.map(e),r.mainIndex)}function Dn(r,e){return r.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Qs({state:r,dispatch:e},i){let s=mu(r.selection,i);return s.eq(r.selection)?!1:(e(Dn(r,s)),!0)}function cp(r,e){return he.cursor(e?r.to:r.from)}function Iw(r,e){return Qs(r,i=>i.empty?r.moveByChar(i,e):cp(i,e))}function fr(r){return r.textDirectionAt(r.state.selection.main.head)==hi.LTR}const kw=r=>Iw(r,!fr(r)),Aw=r=>Iw(r,fr(r));function Cw(r,e){return Qs(r,i=>i.empty?r.moveByGroup(i,e):cp(i,e))}const IG=r=>Cw(r,!fr(r)),kG=r=>Cw(r,fr(r));function AG(r,e,i){if(e.type.prop(i))return!0;let s=e.to-e.from;return s&&(s>2||/[^\s,.;:]/.test(r.sliceDoc(e.from,e.to)))||e.firstChild}function hp(r,e,i){let s=rr(r).resolveInner(e.head),n=i?_t.closedBy:_t.openedBy;for(let h=e.head;;){let f=i?s.childAfter(h):s.childBefore(h);if(!f)break;AG(r,f,n)?s=f:h=i?f.to:f.from}let l=s.type.prop(n),u,c;return l&&(u=i?vn(r,s.from,1):vn(r,s.to,-1))&&u.matched?c=i?u.end.to:u.end.from:c=i?s.to:s.from,he.cursor(c,i?-1:1)}const CG=r=>Qs(r,e=>hp(r.state,e,!fr(r))),OG=r=>Qs(r,e=>hp(r.state,e,fr(r)));function Ow(r,e){return Qs(r,i=>{if(!i.empty)return cp(i,e);let s=r.moveVertically(i,e);return s.head!=i.head?s:r.moveToLineBoundary(i,e)})}const ww=r=>Ow(r,!1),Rw=r=>Ow(r,!0);function Nw(r){let e=r.scrollDOM.clientHeight<r.scrollDOM.scrollHeight-2,i=0,s=0,n;if(e){for(let l of r.state.facet(Fe.scrollMargins)){let u=l(r);u!=null&&u.top&&(i=Math.max(u==null?void 0:u.top,i)),u!=null&&u.bottom&&(s=Math.max(u==null?void 0:u.bottom,s))}n=r.scrollDOM.clientHeight-i-s}else n=(r.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:i,marginBottom:s,selfScroll:e,height:Math.max(r.defaultLineHeight,n-5)}}function xw(r,e){let i=Nw(r),{state:s}=r,n=mu(s.selection,u=>u.empty?r.moveVertically(u,e,i.height):cp(u,e));if(n.eq(s.selection))return!1;let l;if(i.selfScroll){let u=r.coordsAtPos(s.selection.main.head),c=r.scrollDOM.getBoundingClientRect(),h=c.top+i.marginTop,f=c.bottom-i.marginBottom;u&&u.top>h&&u.bottom<f&&(l=Fe.scrollIntoView(n.main.head,{y:"start",yMargin:u.top-h}))}return r.dispatch(Dn(s,n),{effects:l}),!0}const nk=r=>xw(r,!1),tb=r=>xw(r,!0);function il(r,e,i){let s=r.lineBlockAt(e.head),n=r.moveToLineBoundary(e,i);if(n.head==e.head&&n.head!=(i?s.to:s.from)&&(n=r.moveToLineBoundary(e,i,!1)),!i&&n.head==s.from&&s.length){let l=/^\s*/.exec(r.state.sliceDoc(s.from,Math.min(s.from+100,s.to)))[0].length;l&&e.head!=s.from+l&&(n=he.cursor(s.from+l))}return n}const wG=r=>Qs(r,e=>il(r,e,!0)),RG=r=>Qs(r,e=>il(r,e,!1)),NG=r=>Qs(r,e=>il(r,e,!fr(r))),xG=r=>Qs(r,e=>il(r,e,fr(r))),DG=r=>Qs(r,e=>he.cursor(r.lineBlockAt(e.head).from,1)),LG=r=>Qs(r,e=>he.cursor(r.lineBlockAt(e.head).to,-1));function MG(r,e,i){let s=!1,n=mu(r.selection,l=>{let u=vn(r,l.head,-1)||vn(r,l.head,1)||l.head>0&&vn(r,l.head-1,1)||l.head<r.doc.length&&vn(r,l.head+1,-1);if(!u||!u.end)return l;s=!0;let c=u.start.from==l.head?u.end.to:u.end.from;return i?he.range(l.anchor,c):he.cursor(c)});return s?(e(Dn(r,n)),!0):!1}const BG=({state:r,dispatch:e})=>MG(r,e,!1);function As(r,e){let i=mu(r.state.selection,s=>{let n=e(s);return he.range(s.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return i.eq(r.state.selection)?!1:(r.dispatch(Dn(r.state,i)),!0)}function Dw(r,e){return As(r,i=>r.moveByChar(i,e))}const Lw=r=>Dw(r,!fr(r)),Mw=r=>Dw(r,fr(r));function Bw(r,e){return As(r,i=>r.moveByGroup(i,e))}const PG=r=>Bw(r,!fr(r)),FG=r=>Bw(r,fr(r)),UG=r=>As(r,e=>hp(r.state,e,!fr(r))),HG=r=>As(r,e=>hp(r.state,e,fr(r)));function Pw(r,e){return As(r,i=>r.moveVertically(i,e))}const Fw=r=>Pw(r,!1),Uw=r=>Pw(r,!0);function Hw(r,e){return As(r,i=>r.moveVertically(i,e,Nw(r).height))}const ok=r=>Hw(r,!1),lk=r=>Hw(r,!0),GG=r=>As(r,e=>il(r,e,!0)),VG=r=>As(r,e=>il(r,e,!1)),WG=r=>As(r,e=>il(r,e,!fr(r))),zG=r=>As(r,e=>il(r,e,fr(r))),YG=r=>As(r,e=>he.cursor(r.lineBlockAt(e.head).from)),XG=r=>As(r,e=>he.cursor(r.lineBlockAt(e.head).to)),ak=({state:r,dispatch:e})=>(e(Dn(r,{anchor:0})),!0),uk=({state:r,dispatch:e})=>(e(Dn(r,{anchor:r.doc.length})),!0),ck=({state:r,dispatch:e})=>(e(Dn(r,{anchor:r.selection.main.anchor,head:0})),!0),hk=({state:r,dispatch:e})=>(e(Dn(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),jG=({state:r,dispatch:e})=>(e(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),KG=({state:r,dispatch:e})=>{let i=fp(r).map(({from:s,to:n})=>he.range(s,Math.min(n+1,r.doc.length)));return e(r.update({selection:he.create(i),userEvent:"select"})),!0},qG=({state:r,dispatch:e})=>{let i=mu(r.selection,s=>{var n;let l=rr(r).resolveInner(s.head,1);for(;!(l.from<s.from&&l.to>=s.to||l.to>s.to&&l.from<=s.from||!(!((n=l.parent)===null||n===void 0)&&n.parent));)l=l.parent;return he.range(l.to,l.from)});return e(Dn(r,i)),!0},JG=({state:r,dispatch:e})=>{let i=r.selection,s=null;return i.ranges.length>1?s=he.create([i.main]):i.main.empty||(s=he.create([he.cursor(i.main.head)])),s?(e(Dn(r,s)),!0):!1};function dp(r,e){if(r.state.readOnly)return!1;let i="delete.selection",{state:s}=r,n=s.changeByRange(l=>{let{from:u,to:c}=l;if(u==c){let h=e(u);h<u?(i="delete.backward",h=d0(r,h,!1)):h>u&&(i="delete.forward",h=d0(r,h,!0)),u=Math.min(u,h),c=Math.max(c,h)}else u=d0(r,u,!1),c=d0(r,c,!0);return u==c?{range:l}:{changes:{from:u,to:c},range:he.cursor(u)}});return n.changes.empty?!1:(r.dispatch(s.update(n,{scrollIntoView:!0,userEvent:i,effects:i=="delete.selection"?Fe.announce.of(s.phrase("Selection deleted")):void 0})),!0)}function d0(r,e,i){if(r instanceof Fe)for(let s of r.state.facet(Fe.atomicRanges).map(n=>n(r)))s.between(e,e,(n,l)=>{n<e&&l>e&&(e=i?l:n)});return e}const Gw=(r,e)=>dp(r,i=>{let{state:s}=r,n=s.doc.lineAt(i),l,u;if(!e&&i>n.from&&i<n.from+200&&!/[^ \t]/.test(l=n.text.slice(0,i-n.from))){if(l[l.length-1]=="	")return i-1;let c=mh(l,s.tabSize),h=c%cf(s)||cf(s);for(let f=0;f<h&&l[l.length-1-f]==" ";f++)i--;u=i}else u=vr(n.text,i-n.from,e,e)+n.from,u==i&&n.number!=(e?s.doc.lines:1)&&(u+=e?1:-1);return u}),ib=r=>Gw(r,!1),Vw=r=>Gw(r,!0),Ww=(r,e)=>dp(r,i=>{let s=i,{state:n}=r,l=n.doc.lineAt(s),u=n.charCategorizer(s);for(let c=null;;){if(s==(e?l.to:l.from)){s==i&&l.number!=(e?n.doc.lines:1)&&(s+=e?1:-1);break}let h=vr(l.text,s-l.from,e)+l.from,f=l.text.slice(Math.min(s,h)-l.from,Math.max(s,h)-l.from),p=u(f);if(c!=null&&p!=c)break;(f!=" "||s!=i)&&(c=p),s=h}return s}),zw=r=>Ww(r,!1),QG=r=>Ww(r,!0),Yw=r=>dp(r,e=>{let i=r.lineBlockAt(e).to;return e<i?i:Math.min(r.state.doc.length,e+1)}),ZG=r=>dp(r,e=>{let i=r.lineBlockAt(e).from;return e>i?i:Math.max(0,e-1)}),eV=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let i=r.changeByRange(s=>({changes:{from:s.from,to:s.to,insert:Bt.of(["",""])},range:he.cursor(s.from)}));return e(r.update(i,{scrollIntoView:!0,userEvent:"input"})),!0},tV=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let i=r.changeByRange(s=>{if(!s.empty||s.from==0||s.from==r.doc.length)return{range:s};let n=s.from,l=r.doc.lineAt(n),u=n==l.from?n-1:vr(l.text,n-l.from,!1)+l.from,c=n==l.to?n+1:vr(l.text,n-l.from,!0)+l.from;return{changes:{from:u,to:c,insert:r.doc.slice(n,c).append(r.doc.slice(u,n))},range:he.cursor(c)}});return i.changes.empty?!1:(e(r.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function fp(r){let e=[],i=-1;for(let s of r.selection.ranges){let n=r.doc.lineAt(s.from),l=r.doc.lineAt(s.to);if(!s.empty&&s.to==l.from&&(l=r.doc.lineAt(s.to-1)),i>=n.number){let u=e[e.length-1];u.to=l.to,u.ranges.push(s)}else e.push({from:n.from,to:l.to,ranges:[s]});i=l.number+1}return e}function Xw(r,e,i){if(r.readOnly)return!1;let s=[],n=[];for(let l of fp(r)){if(i?l.to==r.doc.length:l.from==0)continue;let u=r.doc.lineAt(i?l.to+1:l.from-1),c=u.length+1;if(i){s.push({from:l.to,to:u.to},{from:l.from,insert:u.text+r.lineBreak});for(let h of l.ranges)n.push(he.range(Math.min(r.doc.length,h.anchor+c),Math.min(r.doc.length,h.head+c)))}else{s.push({from:u.from,to:l.from},{from:l.to,insert:r.lineBreak+u.text});for(let h of l.ranges)n.push(he.range(h.anchor-c,h.head-c))}}return s.length?(e(r.update({changes:s,scrollIntoView:!0,selection:he.create(n,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}const iV=({state:r,dispatch:e})=>Xw(r,e,!1),rV=({state:r,dispatch:e})=>Xw(r,e,!0);function jw(r,e,i){if(r.readOnly)return!1;let s=[];for(let n of fp(r))i?s.push({from:n.from,insert:r.doc.slice(n.from,n.to)+r.lineBreak}):s.push({from:n.to,insert:r.lineBreak+r.doc.slice(n.from,n.to)});return e(r.update({changes:s,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const sV=({state:r,dispatch:e})=>jw(r,e,!1),nV=({state:r,dispatch:e})=>jw(r,e,!0),oV=r=>{if(r.state.readOnly)return!1;let{state:e}=r,i=e.changes(fp(e).map(({from:n,to:l})=>(n>0?n--:l<e.doc.length&&l++,{from:n,to:l}))),s=mu(e.selection,n=>r.moveVertically(n,!0)).map(i);return r.dispatch({changes:i,selection:s,scrollIntoView:!0,userEvent:"delete.line"}),!0};function lV(r,e){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(e-1,e+1)))return{from:e,to:e};let i=rr(r).resolveInner(e),s=i.childBefore(e),n=i.childAfter(e),l;return s&&n&&s.to<=e&&n.from>=e&&(l=s.type.prop(_t.closedBy))&&l.indexOf(n.name)>-1&&r.doc.lineAt(s.to).from==r.doc.lineAt(n.from).from?{from:s.to,to:n.from}:null}const aV=Kw(!1),uV=Kw(!0);function Kw(r){return({state:e,dispatch:i})=>{if(e.readOnly)return!1;let s=e.changeByRange(n=>{let{from:l,to:u}=n,c=e.doc.lineAt(l),h=!r&&l==u&&lV(e,l);r&&(l=u=(u<=c.to?c:e.doc.lineAt(u)).to);let f=new op(e,{simulateBreak:l,simulateDoubleBreak:!!h}),p=ET(f,l);for(p==null&&(p=/^\s*/.exec(e.doc.lineAt(l).text)[0].length);u<c.to&&/\s/.test(c.text[u-c.from]);)u++;h?{from:l,to:u}=h:l>c.from&&l<c.from+100&&!/\S/.test(c.text.slice(0,l))&&(l=c.from);let g=["",sh(e,p)];return h&&g.push(sh(e,f.lineIndent(c.from,-1))),{changes:{from:l,to:u,insert:Bt.of(g)},range:he.cursor(l+1+g[1].length)}});return i(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0}}function ST(r,e){let i=-1;return r.changeByRange(s=>{let n=[];for(let u=s.from;u<=s.to;){let c=r.doc.lineAt(u);c.number>i&&(s.empty||s.to>c.from)&&(e(c,n,s),i=c.number),u=c.to+1}let l=r.changes(n);return{changes:n,range:he.range(l.mapPos(s.anchor,1),l.mapPos(s.head,1))}})}const cV=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let i=Object.create(null),s=new op(r,{overrideIndentation:l=>{let u=i[l];return u??-1}}),n=ST(r,(l,u,c)=>{let h=ET(s,l.from);if(h==null)return;/\S/.test(l.text)||(h=0);let f=/^\s*/.exec(l.text)[0],p=sh(r,h);(f!=p||c.from<l.from+f.length)&&(i[l.from]=h,u.push({from:l.from,to:l.from+f.length,insert:p}))});return n.changes.empty||e(r.update(n,{userEvent:"indent"})),!0},qw=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(ST(r,(i,s)=>{s.push({from:i.from,insert:r.facet(np)})}),{userEvent:"input.indent"})),!0),Jw=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(ST(r,(i,s)=>{let n=/^\s*/.exec(i.text)[0];if(!n)return;let l=mh(n,r.tabSize),u=0,c=sh(r,Math.max(0,l-cf(r)));for(;u<n.length&&u<c.length&&n.charCodeAt(u)==c.charCodeAt(u);)u++;s.push({from:i.from+u,to:i.from+n.length,insert:c.slice(u)})}),{userEvent:"delete.dedent"})),!0),hV=[{key:"Ctrl-b",run:kw,shift:Lw,preventDefault:!0},{key:"Ctrl-f",run:Aw,shift:Mw},{key:"Ctrl-p",run:ww,shift:Fw},{key:"Ctrl-n",run:Rw,shift:Uw},{key:"Ctrl-a",run:DG,shift:YG},{key:"Ctrl-e",run:LG,shift:XG},{key:"Ctrl-d",run:Vw},{key:"Ctrl-h",run:ib},{key:"Ctrl-k",run:Yw},{key:"Ctrl-Alt-h",run:zw},{key:"Ctrl-o",run:eV},{key:"Ctrl-t",run:tV},{key:"Ctrl-v",run:tb}],dV=[{key:"ArrowLeft",run:kw,shift:Lw,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:IG,shift:PG,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:NG,shift:WG,preventDefault:!0},{key:"ArrowRight",run:Aw,shift:Mw,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:kG,shift:FG,preventDefault:!0},{mac:"Cmd-ArrowRight",run:xG,shift:zG,preventDefault:!0},{key:"ArrowUp",run:ww,shift:Fw,preventDefault:!0},{mac:"Cmd-ArrowUp",run:ak,shift:ck},{mac:"Ctrl-ArrowUp",run:nk,shift:ok},{key:"ArrowDown",run:Rw,shift:Uw,preventDefault:!0},{mac:"Cmd-ArrowDown",run:uk,shift:hk},{mac:"Ctrl-ArrowDown",run:tb,shift:lk},{key:"PageUp",run:nk,shift:ok},{key:"PageDown",run:tb,shift:lk},{key:"Home",run:RG,shift:VG,preventDefault:!0},{key:"Mod-Home",run:ak,shift:ck},{key:"End",run:wG,shift:GG,preventDefault:!0},{key:"Mod-End",run:uk,shift:hk},{key:"Enter",run:aV},{key:"Mod-a",run:jG},{key:"Backspace",run:ib,shift:ib},{key:"Delete",run:Vw},{key:"Mod-Backspace",mac:"Alt-Backspace",run:zw},{key:"Mod-Delete",mac:"Alt-Delete",run:QG},{mac:"Mod-Backspace",run:ZG},{mac:"Mod-Delete",run:Yw}].concat(hV.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),fV=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:CG,shift:UG},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:OG,shift:HG},{key:"Alt-ArrowUp",run:iV},{key:"Shift-Alt-ArrowUp",run:sV},{key:"Alt-ArrowDown",run:rV},{key:"Shift-Alt-ArrowDown",run:nV},{key:"Escape",run:JG},{key:"Mod-Enter",run:uV},{key:"Alt-l",mac:"Ctrl-l",run:KG},{key:"Mod-i",run:qG,preventDefault:!0},{key:"Mod-[",run:Jw},{key:"Mod-]",run:qw},{key:"Mod-Alt-\\",run:cV},{key:"Shift-Mod-k",run:oV},{key:"Shift-Mod-\\",run:BG},{key:"Mod-/",run:nG},{key:"Alt-A",run:lG}].concat(dV),pV={key:"Tab",run:qw,shift:Jw};function Xt(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var e=1,i=arguments[1];if(i&&typeof i=="object"&&i.nodeType==null&&!Array.isArray(i)){for(var s in i)if(Object.prototype.hasOwnProperty.call(i,s)){var n=i[s];typeof n=="string"?r.setAttribute(s,n):n!=null&&(r[s]=n)}e++}for(;e<arguments.length;e++)Qw(r,arguments[e]);return r}function Qw(r,e){if(typeof e=="string")r.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)r.appendChild(e);else if(Array.isArray(e))for(var i=0;i<e.length;i++)Qw(r,e[i]);else throw new RangeError("Unsupported child node: "+e)}const dk=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class ou{constructor(e,i,s=0,n=e.length,l,u){this.test=u,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(s,n),this.bufferStart=s,this.normalize=l?c=>l(dk(c)):dk,this.query=this.normalize(i)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return er(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let i=sT(e),s=this.bufferStart+this.bufferPos;this.bufferPos+=Ts(e);let n=this.normalize(i);for(let l=0,u=s;;l++){let c=n.charCodeAt(l),h=this.match(c,u);if(h)return this.value=h,this;if(l==n.length-1)break;u==s&&l<i.length&&i.charCodeAt(l)==c&&u++}}}match(e,i){let s=null;for(let n=0;n<this.matches.length;n+=2){let l=this.matches[n],u=!1;this.query.charCodeAt(l)==e&&(l==this.query.length-1?s={from:this.matches[n+1],to:i+1}:(this.matches[n]++,u=!0)),u||(this.matches.splice(n,2),n-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?s={from:i,to:i+1}:this.matches.push(1,i)),s&&this.test&&!this.test(s.from,s.to,this.buffer,this.bufferPos)&&(s=null),s}}typeof Symbol<"u"&&(ou.prototype[Symbol.iterator]=function(){return this});const Zw={from:-1,to:-1,match:/.*/.exec("")},IT="gm"+(/x/.unicode==null?"":"u");class eR{constructor(e,i,s,n=0,l=e.length){if(this.text=e,this.to=l,this.curLine="",this.done=!1,this.value=Zw,/\\[sWDnr]|\n|\r|\[\^/.test(i))return new tR(e,i,s,n,l);this.re=new RegExp(i,IT+(s!=null&&s.ignoreCase?"i":"")),this.test=s==null?void 0:s.test,this.iter=e.iter();let u=e.lineAt(n);this.curLineStart=u.from,this.matchPos=pf(e,n),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let i=this.matchPos<=this.to&&this.re.exec(this.curLine);if(i){let s=this.curLineStart+i.index,n=s+i[0].length;if(this.matchPos=pf(this.text,n+(s==n?1:0)),s==this.curLineStart+this.curLine.length&&this.nextLine(),(s<n||s>this.value.to)&&(!this.test||this.test(s,n,i)))return this.value={from:s,to:n,match:i},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const U1=new WeakMap;class qa{constructor(e,i){this.from=e,this.text=i}get to(){return this.from+this.text.length}static get(e,i,s){let n=U1.get(e);if(!n||n.from>=s||n.to<=i){let c=new qa(i,e.sliceString(i,s));return U1.set(e,c),c}if(n.from==i&&n.to==s)return n;let{text:l,from:u}=n;return u>i&&(l=e.sliceString(i,u)+l,u=i),n.to<s&&(l+=e.sliceString(n.to,s)),U1.set(e,new qa(u,l)),new qa(i,l.slice(i-u,s-u))}}class tR{constructor(e,i,s,n,l){this.text=e,this.to=l,this.done=!1,this.value=Zw,this.matchPos=pf(e,n),this.re=new RegExp(i,IT+(s!=null&&s.ignoreCase?"i":"")),this.test=s==null?void 0:s.test,this.flat=qa.get(e,n,this.chunkEnd(n+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,i=this.re.exec(this.flat.text);if(i&&!i[0]&&i.index==e&&(this.re.lastIndex=e+1,i=this.re.exec(this.flat.text)),i){let s=this.flat.from+i.index,n=s+i[0].length;if((this.flat.to>=this.to||i.index+i[0].length<=this.flat.text.length-10)&&(!this.test||this.test(s,n,i)))return this.value={from:s,to:n,match:i},this.matchPos=pf(this.text,n+(s==n?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=qa.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(eR.prototype[Symbol.iterator]=tR.prototype[Symbol.iterator]=function(){return this});function mV(r){try{return new RegExp(r,IT),!0}catch{return!1}}function pf(r,e){if(e>=r.length)return e;let i=r.lineAt(e),s;for(;e<i.to&&(s=i.text.charCodeAt(e-i.from))>=56320&&s<57344;)e++;return e}function rb(r){let e=Xt("input",{class:"cm-textfield",name:"line"}),i=Xt("form",{class:"cm-gotoLine",onkeydown:n=>{n.keyCode==27?(n.preventDefault(),r.dispatch({effects:mf.of(!1)}),r.focus()):n.keyCode==13&&(n.preventDefault(),s())},onsubmit:n=>{n.preventDefault(),s()}},Xt("label",r.state.phrase("Go to line"),": ",e)," ",Xt("button",{class:"cm-button",type:"submit"},r.state.phrase("go")));function s(){let n=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!n)return;let{state:l}=r,u=l.doc.lineAt(l.selection.main.head),[,c,h,f,p]=n,g=f?+f.slice(1):0,T=h?+h:u.number;if(h&&p){let y=T/100;c&&(y=y*(c=="-"?-1:1)+u.number/l.doc.lines),T=Math.round(l.doc.lines*y)}else h&&c&&(T=T*(c=="-"?-1:1)+u.number);let $=l.doc.line(Math.max(1,Math.min(l.doc.lines,T)));r.dispatch({effects:mf.of(!1),selection:he.cursor($.from+Math.max(0,Math.min(g,$.length))),scrollIntoView:!0}),r.focus()}return{dom:i}}const mf=ct.define(),fk=sr.define({create(){return!0},update(r,e){for(let i of e.effects)i.is(mf)&&(r=i.value);return r},provide:r=>rh.from(r,e=>e?rb:null)}),gV=r=>{let e=ih(r,rb);if(!e){let i=[mf.of(!0)];r.state.field(fk,!1)==null&&i.push(ct.appendConfig.of([fk,_V])),r.dispatch({effects:i}),e=ih(r,rb)}return e&&e.dom.querySelector("input").focus(),!0},_V=Fe.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),bV={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},iR=Pe.define({combine(r){return xn(r,bV,{highlightWordAroundCursor:(e,i)=>e||i,minSelectionLength:Math.min,maxMatches:Math.min})}});function TV(r){let e=[SV,yV];return r&&e.push(iR.of(r)),e}const EV=Ge.mark({class:"cm-selectionMatch"}),$V=Ge.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function pk(r,e,i,s){return(i==0||r(e.sliceDoc(i-1,i))!=si.Word)&&(s==e.doc.length||r(e.sliceDoc(s,s+1))!=si.Word)}function vV(r,e,i,s){return r(e.sliceDoc(i,i+1))==si.Word&&r(e.sliceDoc(s-1,s))==si.Word}const yV=Si.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=r.state.facet(iR),{state:i}=r,s=i.selection;if(s.ranges.length>1)return Ge.none;let n=s.main,l,u=null;if(n.empty){if(!e.highlightWordAroundCursor)return Ge.none;let h=i.wordAt(n.head);if(!h)return Ge.none;u=i.charCategorizer(n.head),l=i.sliceDoc(h.from,h.to)}else{let h=n.to-n.from;if(h<e.minSelectionLength||h>200)return Ge.none;if(e.wholeWords){if(l=i.sliceDoc(n.from,n.to),u=i.charCategorizer(n.head),!(pk(u,i,n.from,n.to)&&vV(u,i,n.from,n.to)))return Ge.none}else if(l=i.sliceDoc(n.from,n.to).trim(),!l)return Ge.none}let c=[];for(let h of r.visibleRanges){let f=new ou(i.doc,l,h.from,h.to);for(;!f.next().done;){let{from:p,to:g}=f.value;if((!u||pk(u,i,p,g))&&(n.empty&&p<=n.from&&g>=n.to?c.push($V.range(p,g)):(p>=n.to||g<=n.from)&&c.push(EV.range(p,g)),c.length>e.maxMatches))return Ge.none}}return Ge.set(c)}},{decorations:r=>r.decorations}),SV=Fe.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),IV=({state:r,dispatch:e})=>{let{selection:i}=r,s=he.create(i.ranges.map(n=>r.wordAt(n.head)||he.cursor(n.head)),i.mainIndex);return s.eq(i)?!1:(e(r.update({selection:s})),!0)};function kV(r,e){let{main:i,ranges:s}=r.selection,n=r.wordAt(i.head),l=n&&n.from==i.from&&n.to==i.to;for(let u=!1,c=new ou(r.doc,e,s[s.length-1].to);;)if(c.next(),c.done){if(u)return null;c=new ou(r.doc,e,0,Math.max(0,s[s.length-1].from-1)),u=!0}else{if(u&&s.some(h=>h.from==c.value.from))continue;if(l){let h=r.wordAt(c.value.from);if(!h||h.from!=c.value.from||h.to!=c.value.to)continue}return c.value}}const AV=({state:r,dispatch:e})=>{let{ranges:i}=r.selection;if(i.some(l=>l.from===l.to))return IV({state:r,dispatch:e});let s=r.sliceDoc(i[0].from,i[0].to);if(r.selection.ranges.some(l=>r.sliceDoc(l.from,l.to)!=s))return!1;let n=kV(r,s);return n?(e(r.update({selection:r.selection.addRange(he.range(n.from,n.to),!1),effects:Fe.scrollIntoView(n.to)})),!0):!1},kT=Pe.define({combine(r){return xn(r,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:e=>new FV(e)})}});class rR{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||mV(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(i,s)=>s=="n"?`
`:s=="r"?"\r":s=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new RV(this):new OV(this)}getCursor(e,i=0,s){let n=e.doc?e:xt.create({doc:e});return s==null&&(s=n.doc.length),this.regexp?Ba(this,n,i,s):Ma(this,n,i,s)}}class sR{constructor(e){this.spec=e}}function Ma(r,e,i,s){return new ou(e.doc,r.unquoted,i,s,r.caseSensitive?void 0:n=>n.toLowerCase(),r.wholeWord?CV(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function CV(r,e){return(i,s,n,l)=>((l>i||l+n.length<s)&&(l=Math.max(0,i-2),n=r.sliceString(l,Math.min(r.length,s+2))),(e(gf(n,i-l))!=si.Word||e(_f(n,i-l))!=si.Word)&&(e(_f(n,s-l))!=si.Word||e(gf(n,s-l))!=si.Word))}class OV extends sR{constructor(e){super(e)}nextMatch(e,i,s){let n=Ma(this.spec,e,s,e.doc.length).nextOverlapping();return n.done&&(n=Ma(this.spec,e,0,i).nextOverlapping()),n.done?null:n.value}prevMatchInRange(e,i,s){for(let n=s;;){let l=Math.max(i,n-1e4-this.spec.unquoted.length),u=Ma(this.spec,e,l,n),c=null;for(;!u.nextOverlapping().done;)c=u.value;if(c)return c;if(l==i)return null;n-=1e4}}prevMatch(e,i,s){return this.prevMatchInRange(e,0,i)||this.prevMatchInRange(e,s,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,i){let s=Ma(this.spec,e,0,e.doc.length),n=[];for(;!s.next().done;){if(n.length>=i)return null;n.push(s.value)}return n}highlight(e,i,s,n){let l=Ma(this.spec,e,Math.max(0,i-this.spec.unquoted.length),Math.min(s+this.spec.unquoted.length,e.doc.length));for(;!l.next().done;)n(l.value.from,l.value.to)}}function Ba(r,e,i,s){return new eR(e.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?wV(e.charCategorizer(e.selection.main.head)):void 0},i,s)}function gf(r,e){return r.slice(vr(r,e,!1),e)}function _f(r,e){return r.slice(e,vr(r,e))}function wV(r){return(e,i,s)=>!s[0].length||(r(gf(s.input,s.index))!=si.Word||r(_f(s.input,s.index))!=si.Word)&&(r(_f(s.input,s.index+s[0].length))!=si.Word||r(gf(s.input,s.index+s[0].length))!=si.Word)}class RV extends sR{nextMatch(e,i,s){let n=Ba(this.spec,e,s,e.doc.length).next();return n.done&&(n=Ba(this.spec,e,0,i).next()),n.done?null:n.value}prevMatchInRange(e,i,s){for(let n=1;;n++){let l=Math.max(i,s-n*1e4),u=Ba(this.spec,e,l,s),c=null;for(;!u.next().done;)c=u.value;if(c&&(l==i||c.from>l+10))return c;if(l==i)return null}}prevMatch(e,i,s){return this.prevMatchInRange(e,0,i)||this.prevMatchInRange(e,s,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(i,s)=>s=="$"?"$":s=="&"?e.match[0]:s!="0"&&+s<e.match.length?e.match[s]:i))}matchAll(e,i){let s=Ba(this.spec,e,0,e.doc.length),n=[];for(;!s.next().done;){if(n.length>=i)return null;n.push(s.value)}return n}highlight(e,i,s,n){let l=Ba(this.spec,e,Math.max(0,i-250),Math.min(s+250,e.doc.length));for(;!l.next().done;)n(l.value.from,l.value.to)}}const nh=ct.define(),AT=ct.define(),Ho=sr.define({create(r){return new H1(sb(r).create(),null)},update(r,e){for(let i of e.effects)i.is(nh)?r=new H1(i.value.create(),r.panel):i.is(AT)&&(r=new H1(r.query,i.value?CT:null));return r},provide:r=>rh.from(r,e=>e.panel)});class H1{constructor(e,i){this.query=e,this.panel=i}}const NV=Ge.mark({class:"cm-searchMatch"}),xV=Ge.mark({class:"cm-searchMatch cm-searchMatch-selected"}),DV=Si.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(Ho))}update(r){let e=r.state.field(Ho);(e!=r.startState.field(Ho)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:r,panel:e}){if(!e||!r.spec.valid)return Ge.none;let{view:i}=this,s=new jo;for(let n=0,l=i.visibleRanges,u=l.length;n<u;n++){let{from:c,to:h}=l[n];for(;n<u-1&&h>l[n+1].from-2*250;)h=l[++n].to;r.highlight(i.state,c,h,(f,p)=>{let g=i.state.selection.ranges.some(T=>T.from==f&&T.to==p);s.add(f,p,g?xV:NV)})}return s.finish()}},{decorations:r=>r.decorations});function Th(r){return e=>{let i=e.state.field(Ho,!1);return i&&i.query.spec.valid?r(e,i):nR(e)}}const bf=Th((r,{query:e})=>{let{to:i}=r.state.selection.main,s=e.nextMatch(r.state,i,i);return s?(r.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:OT(r,s),userEvent:"select.search"}),!0):!1}),Tf=Th((r,{query:e})=>{let{state:i}=r,{from:s}=i.selection.main,n=e.prevMatch(i,s,s);return n?(r.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:OT(r,n),userEvent:"select.search"}),!0):!1}),LV=Th((r,{query:e})=>{let i=e.matchAll(r.state,1e3);return!i||!i.length?!1:(r.dispatch({selection:he.create(i.map(s=>he.range(s.from,s.to))),userEvent:"select.search.matches"}),!0)}),MV=({state:r,dispatch:e})=>{let i=r.selection;if(i.ranges.length>1||i.main.empty)return!1;let{from:s,to:n}=i.main,l=[],u=0;for(let c=new ou(r.doc,r.sliceDoc(s,n));!c.next().done;){if(l.length>1e3)return!1;c.value.from==s&&(u=l.length),l.push(he.range(c.value.from,c.value.to))}return e(r.update({selection:he.create(l,u),userEvent:"select.search.matches"})),!0},mk=Th((r,{query:e})=>{let{state:i}=r,{from:s,to:n}=i.selection.main;if(i.readOnly)return!1;let l=e.nextMatch(i,s,s);if(!l)return!1;let u=[],c,h,f=[];if(l.from==s&&l.to==n&&(h=i.toText(e.getReplacement(l)),u.push({from:l.from,to:l.to,insert:h}),l=e.nextMatch(i,l.from,l.to),f.push(Fe.announce.of(i.phrase("replaced match on line $",i.doc.lineAt(s).number)+"."))),l){let p=u.length==0||u[0].from>=l.to?0:l.to-l.from-h.length;c={anchor:l.from-p,head:l.to-p},f.push(OT(r,l))}return r.dispatch({changes:u,selection:c,scrollIntoView:!!c,effects:f,userEvent:"input.replace"}),!0}),BV=Th((r,{query:e})=>{if(r.state.readOnly)return!1;let i=e.matchAll(r.state,1e9).map(n=>{let{from:l,to:u}=n;return{from:l,to:u,insert:e.getReplacement(n)}});if(!i.length)return!1;let s=r.state.phrase("replaced $ matches",i.length)+".";return r.dispatch({changes:i,effects:Fe.announce.of(s),userEvent:"input.replace.all"}),!0});function CT(r){return r.state.facet(kT).createPanel(r)}function sb(r,e){var i,s,n,l;let u=r.selection.main,c=u.empty||u.to>u.from+100?"":r.sliceDoc(u.from,u.to);if(e&&!c)return e;let h=r.facet(kT);return new rR({search:((i=e==null?void 0:e.literal)!==null&&i!==void 0?i:h.literal)?c:c.replace(/\n/g,"\\n"),caseSensitive:(s=e==null?void 0:e.caseSensitive)!==null&&s!==void 0?s:h.caseSensitive,literal:(n=e==null?void 0:e.literal)!==null&&n!==void 0?n:h.literal,wholeWord:(l=e==null?void 0:e.wholeWord)!==null&&l!==void 0?l:h.wholeWord})}const nR=r=>{let e=r.state.field(Ho,!1);if(e&&e.panel){let i=ih(r,CT);if(!i)return!1;let s=i.dom.querySelector("[main-field]");if(s&&s!=r.root.activeElement){let n=sb(r.state,e.query.spec);n.valid&&r.dispatch({effects:nh.of(n)}),s.focus(),s.select()}}else r.dispatch({effects:[AT.of(!0),e?nh.of(sb(r.state,e.query.spec)):ct.appendConfig.of(HV)]});return!0},oR=r=>{let e=r.state.field(Ho,!1);if(!e||!e.panel)return!1;let i=ih(r,CT);return i&&i.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:AT.of(!1)}),!0},PV=[{key:"Mod-f",run:nR,scope:"editor search-panel"},{key:"F3",run:bf,shift:Tf,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:bf,shift:Tf,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:oR,scope:"editor search-panel"},{key:"Mod-Shift-l",run:MV},{key:"Alt-g",run:gV},{key:"Mod-d",run:AV,preventDefault:!0}];class FV{constructor(e){this.view=e;let i=this.query=e.state.field(Ho).query.spec;this.commit=this.commit.bind(this),this.searchField=Xt("input",{value:i.search,placeholder:Zr(e,"Find"),"aria-label":Zr(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Xt("input",{value:i.replace,placeholder:Zr(e,"Replace"),"aria-label":Zr(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Xt("input",{type:"checkbox",name:"case",form:"",checked:i.caseSensitive,onchange:this.commit}),this.reField=Xt("input",{type:"checkbox",name:"re",form:"",checked:i.regexp,onchange:this.commit}),this.wordField=Xt("input",{type:"checkbox",name:"word",form:"",checked:i.wholeWord,onchange:this.commit});function s(n,l,u){return Xt("button",{class:"cm-button",name:n,onclick:l,type:"button"},u)}this.dom=Xt("div",{onkeydown:n=>this.keydown(n),class:"cm-search"},[this.searchField,s("next",()=>bf(e),[Zr(e,"next")]),s("prev",()=>Tf(e),[Zr(e,"previous")]),s("select",()=>LV(e),[Zr(e,"all")]),Xt("label",null,[this.caseField,Zr(e,"match case")]),Xt("label",null,[this.reField,Zr(e,"regexp")]),Xt("label",null,[this.wordField,Zr(e,"by word")]),...e.state.readOnly?[]:[Xt("br"),this.replaceField,s("replace",()=>mk(e),[Zr(e,"replace")]),s("replaceAll",()=>BV(e),[Zr(e,"replace all")])],Xt("button",{name:"close",onclick:()=>oR(e),"aria-label":Zr(e,"close"),type:"button"},["×"])])}commit(){let e=new rR({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:nh.of(e)}))}keydown(e){tU(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Tf:bf)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),mk(this.view))}update(e){for(let i of e.transactions)for(let s of i.effects)s.is(nh)&&!s.value.eq(this.query)&&this.setQuery(s.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(kT).top}}function Zr(r,e){return r.state.phrase(e)}const f0=30,p0=/[\s\.,:;?!]/;function OT(r,{from:e,to:i}){let s=r.state.doc.lineAt(e),n=r.state.doc.lineAt(i).to,l=Math.max(s.from,e-f0),u=Math.min(n,i+f0),c=r.state.sliceDoc(l,u);if(l!=s.from){for(let h=0;h<f0;h++)if(!p0.test(c[h+1])&&p0.test(c[h])){c=c.slice(h);break}}if(u!=n){for(let h=c.length-1;h>c.length-f0;h--)if(!p0.test(c[h-1])&&p0.test(c[h])){c=c.slice(0,h);break}}return Fe.announce.of(`${r.state.phrase("current match")}. ${c} ${r.state.phrase("on line")} ${s.number}.`)}const UV=Fe.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),HV=[Ho,pu.lowest(DV),UV];class lR{constructor(e,i,s){this.state=e,this.pos=i,this.explicit=s,this.abortListeners=[]}tokenBefore(e){let i=rr(this.state).resolveInner(this.pos,-1);for(;i&&e.indexOf(i.name)<0;)i=i.parent;return i?{from:i.from,to:this.pos,text:this.state.sliceDoc(i.from,this.pos),type:i.type}:null}matchBefore(e){let i=this.state.doc.lineAt(this.pos),s=Math.max(i.from,this.pos-250),n=i.text.slice(s-i.from,this.pos-i.from),l=n.search(aR(e,!1));return l<0?null:{from:s+l,to:this.pos,text:n.slice(l)}}get aborted(){return this.abortListeners==null}addEventListener(e,i){e=="abort"&&this.abortListeners&&this.abortListeners.push(i)}}function gk(r){let e=Object.keys(r).join(""),i=/\w/.test(e);return i&&(e=e.replace(/\w/g,"")),`[${i?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function GV(r){let e=Object.create(null),i=Object.create(null);for(let{label:n}of r){e[n[0]]=!0;for(let l=1;l<n.length;l++)i[n[l]]=!0}let s=gk(e)+gk(i)+"*$";return[new RegExp("^"+s),new RegExp(s)]}function VV(r){let e=r.map(n=>typeof n=="string"?{label:n}:n),[i,s]=e.every(n=>/^\w+$/.test(n.label))?[/\w*$/,/\w+$/]:GV(e);return n=>{let l=n.matchBefore(s);return l||n.explicit?{from:l?l.from:n.pos,options:e,validFor:i}:null}}class _k{constructor(e,i,s){this.completion=e,this.source=i,this.match=s}}function Go(r){return r.selection.main.head}function aR(r,e){var i;let{source:s}=r,n=e&&s[0]!="^",l=s[s.length-1]!="$";return!n&&!l?r:new RegExp(`${n?"^":""}(?:${s})${l?"$":""}`,(i=r.flags)!==null&&i!==void 0?i:r.ignoreCase?"i":"")}const WV=ho.define();function zV(r,e,i,s){return Object.assign(Object.assign({},r.changeByRange(n=>{if(n==r.selection.main)return{changes:{from:i,to:s,insert:e},range:he.cursor(i+e.length)};let l=s-i;return!n.empty||l&&r.sliceDoc(n.from-l,n.from)!=r.sliceDoc(i,s)?{range:n}:{changes:{from:n.from-l,to:n.from,insert:e},range:he.cursor(n.from-l+e.length)}})),{userEvent:"input.complete"})}function uR(r,e){const i=e.completion.apply||e.completion.label;let s=e.source;typeof i=="string"?r.dispatch(Object.assign(Object.assign({},zV(r.state,i,s.from,s.to)),{annotations:WV.of(e.completion)})):i(r,e.completion,s.from,s.to)}const bk=new WeakMap;function YV(r){if(!Array.isArray(r))return r;let e=bk.get(r);return e||bk.set(r,e=VV(r)),e}class XV{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let i=0;i<e.length;){let s=er(e,i),n=Ts(s);this.chars.push(s);let l=e.slice(i,i+n),u=l.toUpperCase();this.folded.push(er(u==l?l.toLowerCase():u,0)),i+=n}this.astral=e.length!=this.chars.length}match(e){if(this.pattern.length==0)return[0];if(e.length<this.pattern.length)return null;let{chars:i,folded:s,any:n,precise:l,byWord:u}=this;if(i.length==1){let j=er(e,0),F=Ts(j),q=F==e.length?0:-100;if(j!=i[0])if(j==s[0])q+=-200;else return null;return[q,0,F]}let c=e.indexOf(this.pattern);if(c==0)return[e.length==this.pattern.length?0:-100,0,this.pattern.length];let h=i.length,f=0;if(c<0){for(let j=0,F=Math.min(e.length,200);j<F&&f<h;){let q=er(e,j);(q==i[f]||q==s[f])&&(n[f++]=j),j+=Ts(q)}if(f<h)return null}let p=0,g=0,T=!1,$=0,y=-1,R=-1,C=/[a-z]/.test(e),x=!0;for(let j=0,F=Math.min(e.length,200),q=0;j<F&&g<h;){let W=er(e,j);c<0&&(p<h&&W==i[p]&&(l[p++]=j),$<h&&(W==i[$]||W==s[$]?($==0&&(y=j),R=j+1,$++):$=0));let ne,P=W<255?W>=48&&W<=57||W>=97&&W<=122?2:W>=65&&W<=90?1:0:(ne=sT(W))!=ne.toLowerCase()?1:ne!=ne.toUpperCase()?2:0;(!j||P==1&&C||q==0&&P!=0)&&(i[g]==W||s[g]==W&&(T=!0)?u[g++]=j:u.length&&(x=!1)),q=P,j+=Ts(W)}return g==h&&u[0]==0&&x?this.result(-100+(T?-200:0),u,e):$==h&&y==0?[-200-e.length+(R==e.length?0:-100),0,R]:c>-1?[-700-e.length,c,c+this.pattern.length]:$==h?[-200+-700-e.length,y,R]:g==h?this.result(-100+(T?-200:0)+-700+(x?0:-1100),u,e):i.length==2?null:this.result((n[0]?-700:0)+-200+-1100,n,e)}result(e,i,s){let n=[e-s.length],l=1;for(let u of i){let c=u+(this.astral?Ts(er(s,u)):1);l>1&&n[l-1]==u?n[l-1]=c:(n[l++]=u,n[l++]=c)}return n}}const ks=Pe.define({combine(r){return xn(r,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],compareCompletions:(e,i)=>e.label.localeCompare(i.label),interactionDelay:75},{defaultKeymap:(e,i)=>e&&i,closeOnBlur:(e,i)=>e&&i,icons:(e,i)=>e&&i,tooltipClass:(e,i)=>s=>Tk(e(s),i(s)),optionClass:(e,i)=>s=>Tk(e(s),i(s)),addToOptions:(e,i)=>e.concat(i)})}});function Tk(r,e){return r?e?r+" "+e:r:e}function jV(r){let e=r.addToOptions.slice();return r.icons&&e.push({render(i){let s=document.createElement("div");return s.classList.add("cm-completionIcon"),i.type&&s.classList.add(...i.type.split(/\s+/g).map(n=>"cm-completionIcon-"+n)),s.setAttribute("aria-hidden","true"),s},position:20}),e.push({render(i,s,n){let l=document.createElement("span");l.className="cm-completionLabel";let{label:u}=i,c=0;for(let h=1;h<n.length;){let f=n[h++],p=n[h++];f>c&&l.appendChild(document.createTextNode(u.slice(c,f)));let g=l.appendChild(document.createElement("span"));g.appendChild(document.createTextNode(u.slice(f,p))),g.className="cm-completionMatchedText",c=p}return c<u.length&&l.appendChild(document.createTextNode(u.slice(c))),l},position:50},{render(i){if(!i.detail)return null;let s=document.createElement("span");return s.className="cm-completionDetail",s.textContent=i.detail,s},position:80}),e.sort((i,s)=>i.position-s.position).map(i=>i.render)}function Ek(r,e,i){if(r<=i)return{from:0,to:r};if(e<0&&(e=0),e<=r>>1){let n=Math.floor(e/i);return{from:n*i,to:(n+1)*i}}let s=Math.floor((r-e)/i);return{from:r-(s+1)*i,to:r-s*i}}class KV{constructor(e,i){this.view=e,this.stateField=i,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:c=>this.positionInfo(c),key:this},this.space=null,this.currentClass="";let s=e.state.field(i),{options:n,selected:l}=s.open,u=e.state.facet(ks);this.optionContent=jV(u),this.optionClass=u.optionClass,this.tooltipClass=u.tooltipClass,this.range=Ek(n.length,l,u.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",c=>{for(let h=c.target,f;h&&h!=this.dom;h=h.parentNode)if(h.nodeName=="LI"&&(f=/-(\d+)$/.exec(h.id))&&+f[1]<n.length){uR(e,n[+f[1]]),c.preventDefault();return}}),this.list=this.dom.appendChild(this.createListBox(n,s.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})}mount(){this.updateSel()}update(e){var i,s,n;let l=e.state.field(this.stateField),u=e.startState.field(this.stateField);this.updateTooltipClass(e.state),l!=u&&(this.updateSel(),((i=l.open)===null||i===void 0?void 0:i.disabled)!=((s=u.open)===null||s===void 0?void 0:s.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!(!((n=l.open)===null||n===void 0)&&n.disabled)))}updateTooltipClass(e){let i=this.tooltipClass(e);if(i!=this.currentClass){for(let s of this.currentClass.split(" "))s&&this.dom.classList.remove(s);for(let s of i.split(" "))s&&this.dom.classList.add(s);this.currentClass=i}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let e=this.view.state.field(this.stateField),i=e.open;if((i.selected>-1&&i.selected<this.range.from||i.selected>=this.range.to)&&(this.range=Ek(i.options.length,i.selected,this.view.state.facet(ks).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(i.options,e.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})),this.updateSelectedOption(i.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:s}=i.options[i.selected],{info:n}=s;if(!n)return;let l=typeof n=="string"?document.createTextNode(n):n(s);if(!l)return;"then"in l?l.then(u=>{u&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(u)}).catch(u=>ss(this.view.state,u,"completion info")):this.addInfoPane(l)}}addInfoPane(e){let i=this.info=document.createElement("div");i.className="cm-tooltip cm-completionInfo",i.appendChild(e),this.dom.appendChild(i),this.view.requestMeasure(this.placeInfo)}updateSelectedOption(e){let i=null;for(let s=this.list.firstChild,n=this.range.from;s;s=s.nextSibling,n++)n==e?s.hasAttribute("aria-selected")||(s.setAttribute("aria-selected","true"),i=s):s.hasAttribute("aria-selected")&&s.removeAttribute("aria-selected");return i&&JV(this.list,i),i}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let i=this.dom.getBoundingClientRect(),s=this.info.getBoundingClientRect(),n=e.getBoundingClientRect(),l=this.space;if(!l){let y=this.dom.ownerDocument.defaultView||window;l={left:0,top:0,right:y.innerWidth,bottom:y.innerHeight}}if(n.top>Math.min(l.bottom,i.bottom)-10||n.bottom<Math.max(l.top,i.top)+10)return null;let u=this.view.textDirection==hi.RTL,c=u,h=!1,f,p="",g="",T=i.left-l.left,$=l.right-i.right;if(c&&T<Math.min(s.width,$)?c=!1:!c&&$<Math.min(s.width,T)&&(c=!0),s.width<=(c?T:$))p=Math.max(l.top,Math.min(n.top,l.bottom-s.height))-i.top+"px",f=Math.min(400,c?T:$)+"px";else{h=!0,f=Math.min(400,(u?i.right:l.right-i.left)-30)+"px";let y=l.bottom-i.bottom;y>=s.height||y>i.top?p=n.bottom-i.top+"px":g=i.bottom-n.top+"px"}return{top:p,bottom:g,maxWidth:f,class:h?u?"left-narrow":"right-narrow":c?"left":"right"}}positionInfo(e){this.info&&(e?(this.info.style.top=e.top,this.info.style.bottom=e.bottom,this.info.style.maxWidth=e.maxWidth,this.info.className="cm-tooltip cm-completionInfo cm-completionInfo-"+e.class):this.info.style.top="-1e6px")}createListBox(e,i,s){const n=document.createElement("ul");n.id=i,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions"));for(let l=s.from;l<s.to;l++){let{completion:u,match:c}=e[l];const h=n.appendChild(document.createElement("li"));h.id=i+"-"+l,h.setAttribute("role","option");let f=this.optionClass(u);f&&(h.className=f);for(let p of this.optionContent){let g=p(u,this.view.state,c);g&&h.appendChild(g)}}return s.from&&n.classList.add("cm-completionListIncompleteTop"),s.to<e.length&&n.classList.add("cm-completionListIncompleteBottom"),n}}function qV(r){return e=>new KV(e,r)}function JV(r,e){let i=r.getBoundingClientRect(),s=e.getBoundingClientRect();s.top<i.top?r.scrollTop-=i.top-s.top:s.bottom>i.bottom&&(r.scrollTop+=s.bottom-i.bottom)}function $k(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function QV(r,e){let i=[],s=0;for(let c of r)if(c.hasResult())if(c.result.filter===!1){let h=c.result.getMatch;for(let f of c.result.options){let p=[1e9-s++];if(h)for(let g of h(f))p.push(g);i.push(new _k(f,c,p))}}else{let h=new XV(e.sliceDoc(c.from,c.to)),f;for(let p of c.result.options)(f=h.match(p.label))&&(p.boost!=null&&(f[0]+=p.boost),i.push(new _k(p,c,f)))}let n=[],l=null,u=e.facet(ks).compareCompletions;for(let c of i.sort((h,f)=>f.match[0]-h.match[0]||u(h.completion,f.completion)))!l||l.label!=c.completion.label||l.detail!=c.completion.detail||l.type!=null&&c.completion.type!=null&&l.type!=c.completion.type||l.apply!=c.completion.apply?n.push(c):$k(c.completion)>$k(l)&&(n[n.length-1]=c),l=c.completion;return n}class Ha{constructor(e,i,s,n,l,u){this.options=e,this.attrs=i,this.tooltip=s,this.timestamp=n,this.selected=l,this.disabled=u}setSelected(e,i){return e==this.selected||e>=this.options.length?this:new Ha(this.options,vk(i,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,i,s,n,l){let u=QV(e,i);if(!u.length)return n&&e.some(h=>h.state==1)?new Ha(n.options,n.attrs,n.tooltip,n.timestamp,n.selected,!0):null;let c=i.facet(ks).selectOnOpen?0:-1;if(n&&n.selected!=c&&n.selected!=-1){let h=n.options[n.selected].completion;for(let f=0;f<u.length;f++)if(u[f].completion==h){c=f;break}}return new Ha(u,vk(s,c),{pos:e.reduce((h,f)=>f.hasResult()?Math.min(h,f.from):h,1e8),create:qV(_s),above:l.aboveCursor},n?n.timestamp:Date.now(),c,!1)}map(e){return new Ha(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Ef{constructor(e,i,s){this.active=e,this.id=i,this.open=s}static start(){return new Ef(tW,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:i}=e,s=i.facet(ks),l=(s.override||i.languageDataAt("autocomplete",Go(i)).map(YV)).map(c=>(this.active.find(f=>f.source==c)||new Pr(c,this.active.some(f=>f.state!=0)?1:0)).update(e,s));l.length==this.active.length&&l.every((c,h)=>c==this.active[h])&&(l=this.active);let u=this.open;u&&e.docChanged&&(u=u.map(e.changes)),e.selection||l.some(c=>c.hasResult()&&e.changes.touchesRange(c.from,c.to))||!ZV(l,this.active)?u=Ha.build(l,i,this.id,u,s):u&&u.disabled&&!l.some(c=>c.state==1)&&(u=null),!u&&l.every(c=>c.state!=1)&&l.some(c=>c.hasResult())&&(l=l.map(c=>c.hasResult()?new Pr(c.source,0):c));for(let c of e.effects)c.is(hR)&&(u=u&&u.setSelected(c.value,this.id));return l==this.active&&u==this.open?this:new Ef(l,this.id,u)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:eW}}function ZV(r,e){if(r==e)return!0;for(let i=0,s=0;;){for(;i<r.length&&!r[i].hasResult;)i++;for(;s<e.length&&!e[s].hasResult;)s++;let n=i==r.length,l=s==e.length;if(n||l)return n==l;if(r[i++].result!=e[s++].result)return!1}}const eW={"aria-autocomplete":"list"};function vk(r,e){let i={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return e>-1&&(i["aria-activedescendant"]=r+"-"+e),i}const tW=[];function nb(r){return r.isUserEvent("input.type")?"input":r.isUserEvent("delete.backward")?"delete":null}class Pr{constructor(e,i,s=-1){this.source=e,this.state=i,this.explicitPos=s}hasResult(){return!1}update(e,i){let s=nb(e),n=this;s?n=n.handleUserEvent(e,s,i):e.docChanged?n=n.handleChange(e):e.selection&&n.state!=0&&(n=new Pr(n.source,0));for(let l of e.effects)if(l.is(wT))n=new Pr(n.source,1,l.value?Go(e.state):-1);else if(l.is($f))n=new Pr(n.source,0);else if(l.is(cR))for(let u of l.value)u.source==n.source&&(n=u);return n}handleUserEvent(e,i,s){return i=="delete"||!s.activateOnTyping?this.map(e.changes):new Pr(this.source,1)}handleChange(e){return e.changes.touchesRange(Go(e.startState))?new Pr(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new Pr(this.source,this.state,e.mapPos(this.explicitPos))}}class Gc extends Pr{constructor(e,i,s,n,l){super(e,2,i),this.result=s,this.from=n,this.to=l}hasResult(){return!0}handleUserEvent(e,i,s){var n;let l=e.changes.mapPos(this.from),u=e.changes.mapPos(this.to,1),c=Go(e.state);if((this.explicitPos<0?c<=l:c<this.from)||c>u||i=="delete"&&Go(e.startState)==this.from)return new Pr(this.source,i=="input"&&s.activateOnTyping?1:0);let h=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),f;return iW(this.result.validFor,e.state,l,u)?new Gc(this.source,h,this.result,l,u):this.result.update&&(f=this.result.update(this.result,l,u,new lR(e.state,c,h>=0)))?new Gc(this.source,h,f,f.from,(n=f.to)!==null&&n!==void 0?n:Go(e.state)):new Pr(this.source,1,h)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new Pr(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new Gc(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}function iW(r,e,i,s){if(!r)return!1;let n=e.sliceDoc(i,s);return typeof r=="function"?r(n,i,s,e):aR(r,!0).test(n)}const wT=ct.define(),$f=ct.define(),cR=ct.define({map(r,e){return r.map(i=>i.map(e))}}),hR=ct.define(),_s=sr.define({create(){return Ef.start()},update(r,e){return r.update(e)},provide:r=>[pT.from(r,e=>e.tooltip),Fe.contentAttributes.from(r,e=>e.attrs)]});function m0(r,e="option"){return i=>{let s=i.state.field(_s,!1);if(!s||!s.open||s.open.disabled||Date.now()-s.open.timestamp<i.state.facet(ks).interactionDelay)return!1;let n=1,l;e=="page"&&(l=VU(i,s.open.tooltip))&&(n=Math.max(2,Math.floor(l.dom.offsetHeight/l.dom.querySelector("li").offsetHeight)-1));let{length:u}=s.open.options,c=s.open.selected>-1?s.open.selected+n*(r?1:-1):r?0:u-1;return c<0?c=e=="page"?0:u-1:c>=u&&(c=e=="page"?u-1:0),i.dispatch({effects:hR.of(c)}),!0}}const rW=r=>{let e=r.state.field(_s,!1);return r.state.readOnly||!e||!e.open||e.open.selected<0||Date.now()-e.open.timestamp<r.state.facet(ks).interactionDelay?!1:(e.open.disabled||uR(r,e.open.options[e.open.selected]),!0)},sW=r=>r.state.field(_s,!1)?(r.dispatch({effects:wT.of(!0)}),!0):!1,nW=r=>{let e=r.state.field(_s,!1);return!e||!e.active.some(i=>i.state!=0)?!1:(r.dispatch({effects:$f.of(null)}),!0)};class oW{constructor(e,i){this.active=e,this.context=i,this.time=Date.now(),this.updates=[],this.done=void 0}}const yk=50,lW=50,aW=1e3,uW=Si.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of r.state.field(_s).active)e.state==1&&this.startQuery(e)}update(r){let e=r.state.field(_s);if(!r.selectionSet&&!r.docChanged&&r.startState.field(_s)==e)return;let i=r.transactions.some(s=>(s.selection||s.docChanged)&&!nb(s));for(let s=0;s<this.running.length;s++){let n=this.running[s];if(i||n.updates.length+r.transactions.length>lW&&Date.now()-n.time>aW){for(let l of n.context.abortListeners)try{l()}catch(u){ss(this.view.state,u)}n.context.abortListeners=null,this.running.splice(s--,1)}else n.updates.push(...r.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some(s=>s.state==1&&!this.running.some(n=>n.active.source==s.source))?setTimeout(()=>this.startUpdate(),yk):-1,this.composing!=0)for(let s of r.transactions)nb(s)=="input"?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:r}=this.view,e=r.field(_s);for(let i of e.active)i.state==1&&!this.running.some(s=>s.active.source==i.source)&&this.startQuery(i)}startQuery(r){let{state:e}=this.view,i=Go(e),s=new lR(e,i,r.explicitPos==i),n=new oW(r,s);this.running.push(n),Promise.resolve(r.source(s)).then(l=>{n.context.aborted||(n.done=l||null,this.scheduleAccept())},l=>{this.view.dispatch({effects:$f.of(null)}),ss(this.view.state,l)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),yk))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],i=this.view.state.facet(ks);for(let s=0;s<this.running.length;s++){let n=this.running[s];if(n.done===void 0)continue;if(this.running.splice(s--,1),n.done){let u=new Gc(n.active.source,n.active.explicitPos,n.done,n.done.from,(r=n.done.to)!==null&&r!==void 0?r:Go(n.updates.length?n.updates[0].startState:this.view.state));for(let c of n.updates)u=u.update(c,i);if(u.hasResult()){e.push(u);continue}}let l=this.view.state.field(_s).active.find(u=>u.source==n.active.source);if(l&&l.state==1)if(n.done==null){let u=new Pr(n.active.source,0);for(let c of n.updates)u=u.update(c,i);u.state!=1&&e.push(u)}else this.startQuery(l)}e.length&&this.view.dispatch({effects:cR.of(e)})}},{eventHandlers:{blur(){let r=this.view.state.field(_s,!1);r&&r.tooltip&&this.view.state.facet(ks).closeOnBlur&&this.view.dispatch({effects:$f.of(null)})},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:wT.of(!1)}),20),this.composing=0}}}),cW=Fe.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:`${400}px`,boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:`${30}px`},".cm-completionInfo.cm-completionInfo-right-narrow":{left:`${30}px`},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),oh={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Ml=ct.define({map(r,e){let i=e.mapPos(r,-1,Er.TrackAfter);return i??void 0}}),RT=ct.define({map(r,e){return e.mapPos(r)}}),NT=new class extends Hl{};NT.startSide=1;NT.endSide=-1;const dR=sr.define({create(){return Ht.empty},update(r,e){if(e.selection){let i=e.state.doc.lineAt(e.selection.main.head).from,s=e.startState.doc.lineAt(e.startState.selection.main.head).from;i!=e.changes.mapPos(s,-1)&&(r=Ht.empty)}r=r.map(e.changes);for(let i of e.effects)i.is(Ml)?r=r.update({add:[NT.range(i.value,i.value+1)]}):i.is(RT)&&(r=r.update({filter:s=>s!=i.value}));return r}});function hW(){return[fW,dR]}const G1="()[]{}<>";function fR(r){for(let e=0;e<G1.length;e+=2)if(G1.charCodeAt(e)==r)return G1.charAt(e+1);return sT(r<128?r:r+1)}function pR(r,e){return r.languageDataAt("closeBrackets",e)[0]||oh}const dW=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),fW=Fe.inputHandler.of((r,e,i,s)=>{if((dW?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let n=r.state.selection.main;if(s.length>2||s.length==2&&Ts(er(s,0))==1||e!=n.from||i!=n.to)return!1;let l=gW(r.state,s);return l?(r.dispatch(l),!0):!1}),pW=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let s=pR(r,r.selection.main.head).brackets||oh.brackets,n=null,l=r.changeByRange(u=>{if(u.empty){let c=_W(r.doc,u.head);for(let h of s)if(h==c&&pp(r.doc,u.head)==fR(er(h,0)))return{changes:{from:u.head-h.length,to:u.head+h.length},range:he.cursor(u.head-h.length)}}return{range:n=u}});return n||e(r.update(l,{scrollIntoView:!0,userEvent:"delete.backward"})),!n},mW=[{key:"Backspace",run:pW}];function gW(r,e){let i=pR(r,r.selection.main.head),s=i.brackets||oh.brackets;for(let n of s){let l=fR(er(n,0));if(e==n)return l==n?EW(r,n,s.indexOf(n+n+n)>-1,i):bW(r,n,l,i.before||oh.before);if(e==l&&mR(r,r.selection.main.from))return TW(r,n,l)}return null}function mR(r,e){let i=!1;return r.field(dR).between(0,r.doc.length,s=>{s==e&&(i=!0)}),i}function pp(r,e){let i=r.sliceString(e,e+2);return i.slice(0,Ts(er(i,0)))}function _W(r,e){let i=r.sliceString(e-2,e);return Ts(er(i,0))==i.length?i:i.slice(1)}function bW(r,e,i,s){let n=null,l=r.changeByRange(u=>{if(!u.empty)return{changes:[{insert:e,from:u.from},{insert:i,from:u.to}],effects:Ml.of(u.to+e.length),range:he.range(u.anchor+e.length,u.head+e.length)};let c=pp(r.doc,u.head);return!c||/\s/.test(c)||s.indexOf(c)>-1?{changes:{insert:e+i,from:u.head},effects:Ml.of(u.head+e.length),range:he.cursor(u.head+e.length)}:{range:n=u}});return n?null:r.update(l,{scrollIntoView:!0,userEvent:"input.type"})}function TW(r,e,i){let s=null,n=r.selection.ranges.map(l=>l.empty&&pp(r.doc,l.head)==i?he.cursor(l.head+i.length):s=l);return s?null:r.update({selection:he.create(n,r.selection.mainIndex),scrollIntoView:!0,effects:r.selection.ranges.map(({from:l})=>RT.of(l))})}function EW(r,e,i,s){let n=s.stringPrefixes||oh.stringPrefixes,l=null,u=r.changeByRange(c=>{if(!c.empty)return{changes:[{insert:e,from:c.from},{insert:e,from:c.to}],effects:Ml.of(c.to+e.length),range:he.range(c.anchor+e.length,c.head+e.length)};let h=c.head,f=pp(r.doc,h),p;if(f==e){if(Sk(r,h))return{changes:{insert:e+e,from:h},effects:Ml.of(h+e.length),range:he.cursor(h+e.length)};if(mR(r,h)){let g=i&&r.sliceDoc(h,h+e.length*3)==e+e+e;return{range:he.cursor(h+e.length*(g?3:1)),effects:RT.of(h)}}}else{if(i&&r.sliceDoc(h-2*e.length,h)==e+e&&(p=Ik(r,h-2*e.length,n))>-1&&Sk(r,p))return{changes:{insert:e+e+e+e,from:h},effects:Ml.of(h+e.length),range:he.cursor(h+e.length)};if(r.charCategorizer(h)(f)!=si.Word&&Ik(r,h,n)>-1&&!$W(r,h,e,n))return{changes:{insert:e+e,from:h},effects:Ml.of(h+e.length),range:he.cursor(h+e.length)}}return{range:l=c}});return l?null:r.update(u,{scrollIntoView:!0,userEvent:"input.type"})}function Sk(r,e){let i=rr(r).resolveInner(e+1);return i.parent&&i.from==e}function $W(r,e,i,s){let n=rr(r).resolveInner(e,-1),l=s.reduce((u,c)=>Math.max(u,c.length),0);for(let u=0;u<5;u++){let c=r.sliceDoc(n.from,Math.min(n.to,n.from+i.length+l)),h=c.indexOf(i);if(!h||h>-1&&s.indexOf(c.slice(0,h))>-1){let p=n.firstChild;for(;p&&p.from==n.from&&p.to-p.from>i.length+h;){if(r.sliceDoc(p.to-i.length,p.to)==i)return!1;p=p.firstChild}return!0}let f=n.to==e&&n.parent;if(!f)break;n=f}return!1}function Ik(r,e,i){let s=r.charCategorizer(e);if(s(r.sliceDoc(e-1,e))!=si.Word)return e;for(let n of i){let l=e-n.length;if(r.sliceDoc(l,e)==n&&s(r.sliceDoc(l-1,l))!=si.Word)return l}return-1}function vW(r={}){return[_s,ks.of(r),uW,yW,cW]}const gR=[{key:"Ctrl-Space",run:sW},{key:"Escape",run:nW},{key:"ArrowDown",run:m0(!0)},{key:"ArrowUp",run:m0(!1)},{key:"PageDown",run:m0(!0,"page")},{key:"PageUp",run:m0(!1,"page")},{key:"Enter",run:rW}],yW=pu.highest(sp.computeN([ks],r=>r.facet(ks).defaultKeymap?[gR]:[]));class SW{constructor(e,i,s){this.from=e,this.to=i,this.diagnostic=s}}class xl{constructor(e,i,s){this.diagnostics=e,this.panel=i,this.selected=s}static init(e,i,s){let n=e,l=s.facet(Ga).markerFilter;l&&(n=l(n));let u=Ge.set(n.map(c=>c.from==c.to||c.from==c.to-1&&s.doc.lineAt(c.from).to==c.from?Ge.widget({widget:new DW(c),diagnostic:c}).range(c.from):Ge.mark({attributes:{class:"cm-lintRange cm-lintRange-"+c.severity},diagnostic:c}).range(c.from,c.to)),!0);return new xl(u,i,lu(u))}}function lu(r,e=null,i=0){let s=null;return r.between(i,1e9,(n,l,{spec:u})=>{if(!(e&&u.diagnostic!=e))return s=new SW(n,l,u.diagnostic),!1}),s}function IW(r,e){return!!(r.effects.some(i=>i.is(xT))||r.changes.touchesRange(e.pos))}function _R(r,e){return r.field(rs,!1)?e:e.concat(ct.appendConfig.of([rs,Fe.decorations.compute([rs],i=>{let{selected:s,panel:n}=i.field(rs);return!s||!n||s.from==s.to?Ge.none:Ge.set([AW.range(s.from,s.to)])}),GU(CW,{hideOn:IW}),MW]))}function kW(r,e){return{effects:_R(r,[xT.of(e)])}}const xT=ct.define(),DT=ct.define(),bR=ct.define(),rs=sr.define({create(){return new xl(Ge.none,null,null)},update(r,e){if(e.docChanged){let i=r.diagnostics.map(e.changes),s=null;if(r.selected){let n=e.changes.mapPos(r.selected.from,1);s=lu(i,r.selected.diagnostic,n)||lu(i,null,n)}r=new xl(i,r.panel,s)}for(let i of e.effects)i.is(xT)?r=xl.init(i.value,r.panel,e.state):i.is(DT)?r=new xl(r.diagnostics,i.value?mp.open:null,r.selected):i.is(bR)&&(r=new xl(r.diagnostics,r.panel,i.value));return r},provide:r=>[rh.from(r,e=>e.panel),Fe.decorations.from(r,e=>e.diagnostics)]}),AW=Ge.mark({class:"cm-lintRange cm-lintRange-active"});function CW(r,e,i){let{diagnostics:s}=r.state.field(rs),n=[],l=2e8,u=0;s.between(e-(i<0?1:0),e+(i>0?1:0),(h,f,{spec:p})=>{e>=h&&e<=f&&(h==f||(e>h||i>0)&&(e<f||i<0))&&(n.push(p.diagnostic),l=Math.min(h,l),u=Math.max(f,u))});let c=r.state.facet(Ga).tooltipFilter;return c&&(n=c(n)),n.length?{pos:l,end:u,above:r.state.doc.lineAt(l).to<u,create(){return{dom:OW(r,n)}}}:null}function OW(r,e){return Xt("ul",{class:"cm-tooltip-lint"},e.map(i=>ER(r,i,!1)))}const wW=r=>{let e=r.state.field(rs,!1);(!e||!e.panel)&&r.dispatch({effects:_R(r.state,[DT.of(!0)])});let i=ih(r,mp.open);return i&&i.dom.querySelector(".cm-panel-lint ul").focus(),!0},kk=r=>{let e=r.state.field(rs,!1);return!e||!e.panel?!1:(r.dispatch({effects:DT.of(!1)}),!0)},RW=r=>{let e=r.state.field(rs,!1);if(!e)return!1;let i=r.state.selection.main,s=e.diagnostics.iter(i.to+1);return!s.value&&(s=e.diagnostics.iter(0),!s.value||s.from==i.from&&s.to==i.to)?!1:(r.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0}),!0)},NW=[{key:"Mod-Shift-m",run:wW,preventDefault:!0},{key:"F8",run:RW}],xW=Si.fromClass(class{constructor(r){this.view=r,this.timeout=-1,this.set=!0;let{delay:e}=r.state.facet(Ga);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){let r=Date.now();if(r<this.lintTime-10)setTimeout(this.run,this.lintTime-r);else{this.set=!1;let{state:e}=this.view,{sources:i}=e.facet(Ga);Promise.all(i.map(s=>Promise.resolve(s(this.view)))).then(s=>{let n=s.reduce((l,u)=>l.concat(u));this.view.state.doc==e.doc&&this.view.dispatch(kW(this.view.state,n))},s=>{ss(this.view.state,s)})}}update(r){let e=r.state.facet(Ga);(r.docChanged||e!=r.startState.facet(Ga)||e.needsRefresh&&e.needsRefresh(r))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),Ga=Pe.define({combine(r){return Object.assign({sources:r.map(e=>e.source)},xn(r.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(e,i)=>e?i?s=>e(s)||i(s):e:i}))},enables:xW});function TR(r){let e=[];if(r)e:for(let{name:i}of r){for(let s=0;s<i.length;s++){let n=i[s];if(/[a-zA-Z]/.test(n)&&!e.some(l=>l.toLowerCase()==n.toLowerCase())){e.push(n);continue e}}e.push("")}return e}function ER(r,e,i){var s;let n=i?TR(e.actions):[];return Xt("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Xt("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),(s=e.actions)===null||s===void 0?void 0:s.map((l,u)=>{let c=!1,h=T=>{if(T.preventDefault(),c)return;c=!0;let $=lu(r.state.field(rs).diagnostics,e);$&&l.apply(r,$.from,$.to)},{name:f}=l,p=n[u]?f.indexOf(n[u]):-1,g=p<0?f:[f.slice(0,p),Xt("u",f.slice(p,p+1)),f.slice(p+1)];return Xt("button",{type:"button",class:"cm-diagnosticAction",onclick:h,onmousedown:h,"aria-label":` Action: ${f}${p<0?"":` (access key "${n[u]})"`}.`},g)}),e.source&&Xt("div",{class:"cm-diagnosticSource"},e.source))}class DW extends fo{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return Xt("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Ak{constructor(e,i){this.diagnostic=i,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=ER(e,i,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class mp{constructor(e){this.view=e,this.items=[];let i=n=>{if(n.keyCode==27)kk(this.view),this.view.focus();else if(n.keyCode==38||n.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(n.keyCode==40||n.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(n.keyCode==36)this.moveSelection(0);else if(n.keyCode==35)this.moveSelection(this.items.length-1);else if(n.keyCode==13)this.view.focus();else if(n.keyCode>=65&&n.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:l}=this.items[this.selectedIndex],u=TR(l.actions);for(let c=0;c<u.length;c++)if(u[c].toUpperCase().charCodeAt(0)==n.keyCode){let h=lu(this.view.state.field(rs).diagnostics,l);h&&l.actions[c].apply(e,h.from,h.to)}}else return;n.preventDefault()},s=n=>{for(let l=0;l<this.items.length;l++)this.items[l].dom.contains(n.target)&&this.moveSelection(l)};this.list=Xt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:i,onclick:s}),this.dom=Xt("div",{class:"cm-panel-lint"},this.list,Xt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>kk(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(rs).selected;if(!e)return-1;for(let i=0;i<this.items.length;i++)if(this.items[i].diagnostic==e.diagnostic)return i;return-1}update(){let{diagnostics:e,selected:i}=this.view.state.field(rs),s=0,n=!1,l=null;for(e.between(0,this.view.state.doc.length,(u,c,{spec:h})=>{let f=-1,p;for(let g=s;g<this.items.length;g++)if(this.items[g].diagnostic==h.diagnostic){f=g;break}f<0?(p=new Ak(this.view,h.diagnostic),this.items.splice(s,0,p),n=!0):(p=this.items[f],f>s&&(this.items.splice(s,f-s),n=!0)),i&&p.diagnostic==i.diagnostic?p.dom.hasAttribute("aria-selected")||(p.dom.setAttribute("aria-selected","true"),l=p):p.dom.hasAttribute("aria-selected")&&p.dom.removeAttribute("aria-selected"),s++});s<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();this.items.length==0&&(this.items.push(new Ak(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),l?(this.list.setAttribute("aria-activedescendant",l.id),this.view.requestMeasure({key:this,read:()=>({sel:l.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:u,panel:c})=>{u.top<c.top?this.list.scrollTop-=c.top-u.top:u.bottom>c.bottom&&(this.list.scrollTop+=u.bottom-c.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let e=this.list.firstChild;function i(){let s=e;e=s.nextSibling,s.remove()}for(let s of this.items)if(s.dom.parentNode==this.list){for(;e!=s.dom;)i();e=s.dom.nextSibling}else this.list.insertBefore(s.dom,e);for(;e;)i()}moveSelection(e){if(this.selectedIndex<0)return;let i=this.view.state.field(rs),s=lu(i.diagnostics,this.items[e].diagnostic);s&&this.view.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:bR.of(s)})}static open(e){return new mp(e)}}function LW(r,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(r)}</svg>')`}function V1(r){return LW(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const MW=Fe.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:V1("#d11")},".cm-lintRange-warning":{backgroundImage:V1("orange")},".cm-lintRange-info":{backgroundImage:V1("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),BW=(()=>[QU(),tH(),bU(),mG(),HH(),lU(),dU(),xt.allowMultipleSelections.of(!0),OH(),VH(YH,{fallback:!0}),ZH(),hW(),vW(),NU(),LU(),SU(),TV(),sp.of([...mW,...fV,...PV,...SG,...PH,...gR,...NW])])();function PW(r,e,i=!1){let s;return function(...l){const u=this;s?clearTimeout(s):i&&r.apply(u,l),s=setTimeout(c,e||100);function c(){i||r.apply(u,l),s=null}}}function FW(r){let e,i,s,n,l,u,c,h,f,p;return{c(){e=Ft("div"),i=Ft("div"),s=Ft("div"),n=xi(),l=Ft("p"),u=Et("Loading editor..."),c=xi(),h=Ft("pre"),f=Et(r[0]),this.h()},l(g){e=Ut(g,"DIV",{class:!0});var T=Vt(e);i=Ut(T,"DIV",{class:!0});var $=Vt(i);s=Ut($,"DIV",{class:!0}),Vt(s).forEach(ue),n=Di($),l=Ut($,"P",{class:!0});var y=Vt(l);u=$t(y,"Loading editor..."),y.forEach(ue),$.forEach(ue),c=Di(T),h=Ut(T,"PRE",{class:!0});var R=Vt(h);f=$t(R,r[0]),R.forEach(ue),T.forEach(ue),this.h()},h(){Ki(s,"class","scm-loading__spinner svelte-kcx0g9"),Ki(l,"class","scm-loading__text svelte-kcx0g9"),Ki(i,"class","scm-waiting__loading scm-loading svelte-kcx0g9"),Ki(h,"class","scm-pre cm-editor svelte-kcx0g9"),Ki(e,"class",p="scm-waiting "+r[1]+" svelte-kcx0g9")},m(g,T){Ee(g,e,T),vi(e,i),vi(i,s),vi(i,n),vi(i,l),vi(l,u),vi(e,c),vi(e,h),vi(h,f)},p(g,T){T&1&&Li(f,g[0]),T&2&&p!==(p="scm-waiting "+g[1]+" svelte-kcx0g9")&&Ki(e,"class",p)},d(g){g&&ue(e)}}}function UW(r){let e,i;return{c(){e=Ft("div"),this.h()},l(s){e=Ut(s,"DIV",{class:!0}),Vt(e).forEach(ue),this.h()},h(){Ki(e,"class",i="codemirror-wrapper "+r[1]+" svelte-kcx0g9")},m(s,n){Ee(s,e,n),r[17](e)},p(s,n){n&2&&i!==(i="codemirror-wrapper "+s[1]+" svelte-kcx0g9")&&Ki(e,"class",i)},d(s){s&&ue(e),r[17](null)}}}function HW(r){let e;function i(l,u){return l[3]?UW:FW}let n=i(r)(r);return{c(){n.c(),e=dt()},l(l){n.l(l),e=dt()},m(l,u){n.m(l,u),Ee(l,e,u)},p(l,[u]){n.p(l,u)},i:Wi,o:Wi,d(l){n.d(l),l&&ue(e)}}}function GW(r,e,i){let s,{class:n=""}=e,{value:l=""}=e,{basic:u=!0}=e,{lang:c=void 0}=e,{theme:h=void 0}=e,{extensions:f=[]}=e,{useTab:p=!0}=e,{tabSize:g=2}=e,{styles:T=void 0}=e,{lineWrapping:$=!1}=e,{editable:y=!0}=e,{readonly:R=!1}=e,{placeholder:C=void 0}=e;const x=typeof window<"u",j=nx();let F,q,W=!1,ne=!1,P=!0,Q=!0;ub(()=>i(15,q=re())),ox(()=>q==null?void 0:q.destroy());function re(){const xe=PW(Xe,300);return new Fe({parent:F,state:At(l),dispatch(St){q.update([St]),!W&&St.docChanged&&xe()}})}function Y(){if(P){P=!1;return}q.dispatch({effects:ct.reconfigure.of(s)})}function _e(xe){if(Q){Q=!1;return}if(ne){ne=!1;return}W=!0,q.setState(At(xe)),W=!1}function Xe(){const xe=q.state.doc.toString();xe!==l&&(ne=!0,i(0,l=xe),j("change",l))}function At(xe){return xt.create({doc:xe??void 0,extensions:s})}function vt(xe,St,It,bt,ei,z,Ce,pr){const qe=[np.of(" ".repeat(It)),Fe.editable.of(z),xt.readOnly.of(Ce)];return xe&&qe.push(BW),St&&qe.push(sp.of([pV])),ei&&qe.push(CU(ei)),pr&&qe.push(pr),bt&&qe.push(Fe.lineWrapping),qe}function je(xe,St){const It=[];return St&&It.push(Fe.theme(St)),xe&&It.push(xe),It}function we(xe){cb[xe?"unshift":"push"](()=>{F=xe,i(2,F)})}return r.$$set=xe=>{"class"in xe&&i(1,n=xe.class),"value"in xe&&i(0,l=xe.value),"basic"in xe&&i(4,u=xe.basic),"lang"in xe&&i(5,c=xe.lang),"theme"in xe&&i(6,h=xe.theme),"extensions"in xe&&i(7,f=xe.extensions),"useTab"in xe&&i(8,p=xe.useTab),"tabSize"in xe&&i(9,g=xe.tabSize),"styles"in xe&&i(10,T=xe.styles),"lineWrapping"in xe&&i(11,$=xe.lineWrapping),"editable"in xe&&i(12,y=xe.editable),"readonly"in xe&&i(13,R=xe.readonly),"placeholder"in xe&&i(14,C=xe.placeholder)},r.$$.update=()=>{r.$$.dirty&32752&&i(16,s=[...vt(u,p,g,$,C,y,R,c),...je(h,T),...f]),r.$$.dirty&32769&&q&&_e(l),r.$$.dirty&98304&&q&&s&&Y()},[l,n,F,x,u,c,h,f,p,g,T,$,y,R,C,q,s,we]}class Ck extends Ii{constructor(e){super(),ki(this,e,GW,HW,Ai,{class:1,value:0,basic:4,lang:5,theme:6,extensions:7,useTab:8,tabSize:9,styles:10,lineWrapping:11,editable:12,readonly:13,placeholder:14})}}class vf{constructor(e,i,s,n,l,u,c,h,f,p=0,g){this.p=e,this.stack=i,this.state=s,this.reducePos=n,this.pos=l,this.score=u,this.buffer=c,this.bufferBase=h,this.curContext=f,this.lookAhead=p,this.parent=g}toString(){return`[${this.stack.filter((e,i)=>i%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,i,s=0){let n=e.parser.context;return new vf(e,[],i,s,s,0,[],0,n?new Ok(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,i){this.stack.push(this.state,i,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var i;let s=e>>19,n=e&65535,{parser:l}=this.p,u=l.dynamicPrecedence(n);if(u&&(this.score+=u),s==0){this.pushState(l.getGoto(this.state,n,!0),this.reducePos),n<l.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,4,!0),this.reduceContext(n,this.reducePos);return}let c=this.stack.length-(s-1)*3-(e&262144?6:0),h=c?this.stack[c-2]:this.p.ranges[0].from,f=this.reducePos-h;f>=2e3&&!(!((i=this.p.parser.nodeSet.types[n])===null||i===void 0)&&i.isAnonymous)&&(h==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=f):this.p.lastBigReductionSize<f&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=h,this.p.lastBigReductionSize=f));let p=c?this.stack[c-1]:0,g=this.bufferBase+this.buffer.length-p;if(n<l.minRepeatTerm||e&131072){let T=l.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,h,T,g+4,!0)}if(e&262144)this.state=this.stack[c];else{let T=this.stack[c-3];this.state=l.getGoto(T,n,!0)}for(;this.stack.length>c;)this.stack.pop();this.reduceContext(n,h)}storeNode(e,i,s,n=4,l=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let u=this,c=this.buffer.length;if(c==0&&u.parent&&(c=u.bufferBase-u.parent.bufferBase,u=u.parent),c>0&&u.buffer[c-4]==0&&u.buffer[c-1]>-1){if(i==s)return;if(u.buffer[c-2]>=i){u.buffer[c-2]=s;return}}}if(!l||this.pos==s)this.buffer.push(e,i,s,n);else{let u=this.buffer.length;if(u>0&&this.buffer[u-4]!=0)for(;u>0&&this.buffer[u-2]>s;)this.buffer[u]=this.buffer[u-4],this.buffer[u+1]=this.buffer[u-3],this.buffer[u+2]=this.buffer[u-2],this.buffer[u+3]=this.buffer[u-1],u-=4,n>4&&(n-=4);this.buffer[u]=e,this.buffer[u+1]=i,this.buffer[u+2]=s,this.buffer[u+3]=n}}shift(e,i,s){let n=this.pos;if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=s,this.shiftContext(i,n),i<=this.p.parser.maxNode&&this.buffer.push(i,n,s,4);else{let l=e,{parser:u}=this.p;(s>this.pos||i<=u.maxNode)&&(this.pos=s,u.stateFlag(l,1)||(this.reducePos=s)),this.pushState(l,n),this.shiftContext(i,n),i<=u.maxNode&&this.buffer.push(i,n,s,4)}}apply(e,i,s){e&65536?this.reduce(e):this.shift(e,i,s)}useNode(e,i){let s=this.p.reused.length-1;(s<0||this.p.reused[s]!=e)&&(this.p.reused.push(e),s++);let n=this.pos;this.reducePos=this.pos=n+e.length,this.pushState(i,n),this.buffer.push(s,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,i=e.buffer.length;for(;i>0&&e.buffer[i-2]>e.reducePos;)i-=4;let s=e.buffer.slice(i),n=e.bufferBase+i;for(;e&&n==e.bufferBase;)e=e.parent;return new vf(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,s,n,this.curContext,this.lookAhead,e)}recoverByDelete(e,i){let s=e<=this.p.parser.maxNode;s&&this.storeNode(e,this.pos,i,4),this.storeNode(0,this.pos,i,s?8:4),this.pos=this.reducePos=i,this.score-=190}canShift(e){for(let i=new VW(this);;){let s=this.p.parser.stateSlot(i.state,4)||this.p.parser.hasAction(i.state,e);if(s==0)return!1;if(!(s&65536))return!0;i.reduce(s)}}recoverByInsert(e){if(this.stack.length>=300)return[];let i=this.p.parser.nextStates(this.state);if(i.length>4<<1||this.stack.length>=120){let n=[];for(let l=0,u;l<i.length;l+=2)(u=i[l+1])!=this.state&&this.p.parser.hasAction(u,e)&&n.push(i[l],u);if(this.stack.length<120)for(let l=0;n.length<4<<1&&l<i.length;l+=2){let u=i[l+1];n.some((c,h)=>h&1&&c==u)||n.push(i[l],u)}i=n}let s=[];for(let n=0;n<i.length&&s.length<4;n+=2){let l=i[n+1];if(l==this.state)continue;let u=this.split();u.pushState(l,this.pos),u.storeNode(0,u.pos,u.pos,4,!0),u.shiftContext(i[n],this.pos),u.score-=200,s.push(u)}return s}forceReduce(){let e=this.p.parser.stateSlot(this.state,5);if(!(e&65536))return!1;let{parser:i}=this.p;if(!i.validAction(this.state,e)){let s=e>>19,n=e&65535,l=this.stack.length-s*3;if(l<0||i.getGoto(this.stack[l],n,!1)<0)return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let i=0;i<this.stack.length;i+=3)if(this.stack[i]!=e.stack[i])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,i){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(i)))}reduceContext(e,i){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(i)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.reducePos,this.reducePos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.reducePos,this.reducePos,-4)}updateContext(e){if(e!=this.curContext.context){let i=new Ok(this.curContext.tracker,e);i.hash!=this.curContext.hash&&this.emitContext(),this.curContext=i}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Ok{constructor(e,i){this.tracker=e,this.context=i,this.hash=e.strict?e.hash(i):0}}var wk;(function(r){r[r.Insert=200]="Insert",r[r.Delete=190]="Delete",r[r.Reduce=100]="Reduce",r[r.MaxNext=4]="MaxNext",r[r.MaxInsertStackDepth=300]="MaxInsertStackDepth",r[r.DampenInsertStackDepth=120]="DampenInsertStackDepth",r[r.MinBigReduction=2e3]="MinBigReduction"})(wk||(wk={}));class VW{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let i=e&65535,s=e>>19;s==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(s-1)*3;let n=this.start.p.parser.getGoto(this.stack[this.base-3],i,!0);this.state=n}}class yf{constructor(e,i,s){this.stack=e,this.pos=i,this.index=s,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,i=e.bufferBase+e.buffer.length){return new yf(e,i,i-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new yf(this.stack,this.pos,this.index)}}function g0(r,e=Uint16Array){if(typeof r!="string")return r;let i=null;for(let s=0,n=0;s<r.length;){let l=0;for(;;){let u=r.charCodeAt(s++),c=!1;if(u==126){l=65535;break}u>=92&&u--,u>=34&&u--;let h=u-32;if(h>=46&&(h-=46,c=!0),l+=h,c)break;l*=46}i?i[n++]=l:i=new e(l)}return i}class O0{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const Rk=new O0;class WW{constructor(e,i){this.input=e,this.ranges=i,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Rk,this.rangeIndex=0,this.pos=this.chunkPos=i[0].from,this.range=i[0],this.end=i[i.length-1].to,this.readNext()}resolveOffset(e,i){let s=this.range,n=this.rangeIndex,l=this.pos+e;for(;l<s.from;){if(!n)return null;let u=this.ranges[--n];l-=s.from-u.to,s=u}for(;i<0?l>s.to:l>=s.to;){if(n==this.ranges.length-1)return null;let u=this.ranges[++n];l+=u.from-s.to,s=u}return l}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let i of this.ranges)if(i.to>e)return Math.max(e,i.from);return this.end}peek(e){let i=this.chunkOff+e,s,n;if(i>=0&&i<this.chunk.length)s=this.pos+e,n=this.chunk.charCodeAt(i);else{let l=this.resolveOffset(e,1);if(l==null)return-1;if(s=l,s>=this.chunk2Pos&&s<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(s-this.chunk2Pos);else{let u=this.rangeIndex,c=this.range;for(;c.to<=s;)c=this.ranges[++u];this.chunk2=this.input.chunk(this.chunk2Pos=s),s+this.chunk2.length>c.to&&(this.chunk2=this.chunk2.slice(0,c.to-s)),n=this.chunk2.charCodeAt(0)}}return s>=this.token.lookAhead&&(this.token.lookAhead=s+1),n}acceptToken(e,i=0){let s=i?this.resolveOffset(i,-1):this.pos;if(s==null||s<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=s}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:i}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=i,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),i=this.pos+e.length;this.chunk=i>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,i){if(i?(this.token=i,i.start=e,i.lookAhead=e+1,i.value=i.extended=-1):this.token=Rk,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,i){if(e>=this.chunkPos&&i<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,i-this.chunkPos);if(e>=this.chunk2Pos&&i<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,i-this.chunk2Pos);if(e>=this.range.from&&i<=this.range.to)return this.input.read(e,i);let s="";for(let n of this.ranges){if(n.from>=i)break;n.to>e&&(s+=this.input.read(Math.max(n.from,e),Math.min(n.to,i)))}return s}}class Ja{constructor(e,i){this.data=e,this.id=i}token(e,i){let{parser:s}=i.p;zW(this.data,e,i,this.id,s.data,s.tokenPrecTable)}}Ja.prototype.contextual=Ja.prototype.fallback=Ja.prototype.extend=!1;Ja.prototype.fallback=Ja.prototype.extend=!1;class $R{constructor(e,i={}){this.token=e,this.contextual=!!i.contextual,this.fallback=!!i.fallback,this.extend=!!i.extend}}function zW(r,e,i,s,n,l){let u=0,c=1<<s,{dialect:h}=i.p.parser;e:for(;c&r[u];){let f=r[u+1];for(let $=u+3;$<f;$+=2)if((r[$+1]&c)>0){let y=r[$];if(h.allows(y)&&(e.token.value==-1||e.token.value==y||YW(y,e.token.value,n,l))){e.acceptToken(y);break}}let p=e.next,g=0,T=r[u+2];if(e.next<0&&T>g&&r[f+T*3-3]==65535&&r[f+T*3-3]==65535){u=r[f+T*3-1];continue e}for(;g<T;){let $=g+T>>1,y=f+$+($<<1),R=r[y],C=r[y+1]||65536;if(p<R)T=$;else if(p>=C)g=$+1;else{u=r[y+2],e.advance();continue e}}break}}function Nk(r,e,i){for(let s=e,n;(n=r[s])!=65535;s++)if(n==i)return s-e;return-1}function YW(r,e,i,s){let n=Nk(i,s,e);return n<0||Nk(i,s,r)<n}const Xs=typeof process<"u"&&process.env&&/\bparse\b/.test({}.LOG);let W1=null;var xk;(function(r){r[r.Margin=25]="Margin"})(xk||(xk={}));function Dk(r,e,i){let s=r.cursor(ir.IncludeAnonymous);for(s.moveTo(e);;)if(!(i<0?s.childBefore(e):s.childAfter(e)))for(;;){if((i<0?s.to<e:s.from>e)&&!s.type.isError)return i<0?Math.max(0,Math.min(s.to-1,e-25)):Math.min(r.length,Math.max(s.from+1,e+25));if(i<0?s.prevSibling():s.nextSibling())break;if(!s.parent())return i<0?0:r.length}}class XW{constructor(e,i){this.fragments=e,this.nodeSet=i,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?Dk(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?Dk(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let i=this.trees.length-1;if(i<0)return this.nextFragment(),null;let s=this.trees[i],n=this.index[i];if(n==s.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let l=s.children[n],u=this.start[i]+s.positions[n];if(u>e)return this.nextStart=u,null;if(l instanceof Ni){if(u==e){if(u<this.safeFrom)return null;let c=u+l.length;if(c<=this.safeTo){let h=l.prop(_t.lookAhead);if(!h||c+h<this.fragment.to)return l}}this.index[i]++,u+l.length>=Math.max(this.safeFrom,e)&&(this.trees.push(l),this.start.push(u),this.index.push(0))}else this.index[i]++,this.nextStart=u+l.length}}}class jW{constructor(e,i){this.stream=i,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(s=>new O0)}getActions(e){let i=0,s=null,{parser:n}=e.p,{tokenizers:l}=n,u=n.stateSlot(e.state,3),c=e.curContext?e.curContext.hash:0,h=0;for(let f=0;f<l.length;f++){if(!(1<<f&u))continue;let p=l[f],g=this.tokens[f];if(!(s&&!p.fallback)&&((p.contextual||g.start!=e.pos||g.mask!=u||g.context!=c)&&(this.updateCachedToken(g,p,e),g.mask=u,g.context=c),g.lookAhead>g.end+25&&(h=Math.max(g.lookAhead,h)),g.value!=0)){let T=i;if(g.extended>-1&&(i=this.addActions(e,g.extended,g.end,i)),i=this.addActions(e,g.value,g.end,i),!p.extend&&(s=g,i>T))break}}for(;this.actions.length>i;)this.actions.pop();return h&&e.setLookAhead(h),!s&&e.pos==this.stream.end&&(s=new O0,s.value=e.p.parser.eofTerm,s.start=s.end=e.pos,i=this.addActions(e,s.value,s.end,i)),this.mainToken=s,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let i=new O0,{pos:s,p:n}=e;return i.start=s,i.end=Math.min(s+1,n.stream.end),i.value=s==n.stream.end?n.parser.eofTerm:0,i}updateCachedToken(e,i,s){let n=this.stream.clipPos(s.pos);if(i.token(this.stream.reset(n,e),s),e.value>-1){let{parser:l}=s.p;for(let u=0;u<l.specialized.length;u++)if(l.specialized[u]==e.value){let c=l.specializers[u](this.stream.read(e.start,e.end),s);if(c>=0&&s.p.parser.dialect.allows(c>>1)){c&1?e.extended=c>>1:e.value=c>>1;break}}}else e.value=0,e.end=this.stream.clipPos(n+1)}putAction(e,i,s,n){for(let l=0;l<n;l+=3)if(this.actions[l]==e)return n;return this.actions[n++]=e,this.actions[n++]=i,this.actions[n++]=s,n}addActions(e,i,s,n){let{state:l}=e,{parser:u}=e.p,{data:c}=u;for(let h=0;h<2;h++)for(let f=u.stateSlot(l,h?2:1);;f+=3){if(c[f]==65535)if(c[f+1]==1)f=Zn(c,f+2);else{n==0&&c[f+1]==2&&(n=this.putAction(Zn(c,f+2),i,s,n));break}c[f]==i&&(n=this.putAction(Zn(c,f+1),i,s,n))}return n}}var Lk;(function(r){r[r.Distance=5]="Distance",r[r.MaxRemainingPerStep=3]="MaxRemainingPerStep",r[r.MinBufferLengthPrune=500]="MinBufferLengthPrune",r[r.ForceReduceLimit=10]="ForceReduceLimit",r[r.CutDepth=15e3]="CutDepth",r[r.CutTo=9e3]="CutTo",r[r.MaxLeftAssociativeReductionCount=300]="MaxLeftAssociativeReductionCount",r[r.MaxStackCount=12]="MaxStackCount"})(Lk||(Lk={}));class KW{constructor(e,i,s,n){this.parser=e,this.input=i,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new WW(i,n),this.tokens=new jW(e,this.stream),this.topTerm=e.top[1];let{from:l}=n[0];this.stacks=[vf.start(this,e.top[0],l)],this.fragments=s.length&&this.stream.end-l>e.bufferLength*4?new XW(s,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,i=this.minStackPos,s=this.stacks=[],n,l;if(this.bigReductionCount>300&&e.length==1){let[u]=e;for(;u.forceReduce()&&u.stack.length&&u.stack[u.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let u=0;u<e.length;u++){let c=e[u];for(;;){if(this.tokens.mainToken=null,c.pos>i)s.push(c);else{if(this.advanceStack(c,s,e))continue;{n||(n=[],l=[]),n.push(c);let h=this.tokens.getMainToken(c);l.push(h.value,h.end)}}break}}if(!s.length){let u=n&&QW(n);if(u)return this.stackToTree(u);if(this.parser.strict)throw Xs&&n&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+i);this.recovering||(this.recovering=5)}if(this.recovering&&n){let u=this.stoppedAt!=null&&n[0].pos>this.stoppedAt?n[0]:this.runRecovery(n,l,s);if(u)return this.stackToTree(u.forceAll())}if(this.recovering){let u=this.recovering==1?1:this.recovering*3;if(s.length>u)for(s.sort((c,h)=>h.score-c.score);s.length>u;)s.pop();s.some(c=>c.reducePos>i)&&this.recovering--}else if(s.length>1){e:for(let u=0;u<s.length-1;u++){let c=s[u];for(let h=u+1;h<s.length;h++){let f=s[h];if(c.sameState(f)||c.buffer.length>500&&f.buffer.length>500)if((c.score-f.score||c.buffer.length-f.buffer.length)>0)s.splice(h--,1);else{s.splice(u--,1);continue e}}}s.length>12&&s.splice(12,s.length-12)}this.minStackPos=s[0].pos;for(let u=1;u<s.length;u++)s[u].pos<this.minStackPos&&(this.minStackPos=s[u].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,i,s){let n=e.pos,{parser:l}=this,u=Xs?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&n>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let f=e.curContext&&e.curContext.tracker.strict,p=f?e.curContext.hash:0;for(let g=this.fragments.nodeAt(n);g;){let T=this.parser.nodeSet.types[g.type.id]==g.type?l.getGoto(e.state,g.type.id):-1;if(T>-1&&g.length&&(!f||(g.prop(_t.contextHash)||0)==p))return e.useNode(g,T),Xs&&console.log(u+this.stackID(e)+` (via reuse of ${l.getName(g.type.id)})`),!0;if(!(g instanceof Ni)||g.children.length==0||g.positions[0]>0)break;let $=g.children[0];if($ instanceof Ni&&g.positions[0]==0)g=$;else break}}let c=l.stateSlot(e.state,4);if(c>0)return e.reduce(c),Xs&&console.log(u+this.stackID(e)+` (via always-reduce ${l.getName(c&65535)})`),!0;if(e.stack.length>=15e3)for(;e.stack.length>9e3&&e.forceReduce(););let h=this.tokens.getActions(e);for(let f=0;f<h.length;){let p=h[f++],g=h[f++],T=h[f++],$=f==h.length||!s,y=$?e:e.split();if(y.apply(p,g,T),Xs&&console.log(u+this.stackID(y)+` (via ${p&65536?`reduce of ${l.getName(p&65535)}`:"shift"} for ${l.getName(g)} @ ${n}${y==e?"":", split"})`),$)return!0;y.pos>n?i.push(y):s.push(y)}return!1}advanceFully(e,i){let s=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>s)return Mk(e,i),!0}}runRecovery(e,i,s){let n=null,l=!1;for(let u=0;u<e.length;u++){let c=e[u],h=i[u<<1],f=i[(u<<1)+1],p=Xs?this.stackID(c)+" -> ":"";if(c.deadEnd&&(l||(l=!0,c.restart(),Xs&&console.log(p+this.stackID(c)+" (restarted)"),this.advanceFully(c,s))))continue;let g=c.split(),T=p;for(let $=0;g.forceReduce()&&$<10&&(Xs&&console.log(T+this.stackID(g)+" (via force-reduce)"),!this.advanceFully(g,s));$++)Xs&&(T=this.stackID(g)+" -> ");for(let $ of c.recoverByInsert(h))Xs&&console.log(p+this.stackID($)+" (via recover-insert)"),this.advanceFully($,s);this.stream.end>c.pos?(f==c.pos&&(f++,h=0),c.recoverByDelete(h,f),Xs&&console.log(p+this.stackID(c)+` (via recover-delete ${this.parser.getName(h)})`),Mk(c,s)):(!n||n.score<c.score)&&(n=c)}return n}stackToTree(e){return e.close(),Ni.build({buffer:yf.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let i=(W1||(W1=new WeakMap)).get(e);return i||W1.set(e,i=String.fromCodePoint(this.nextStackID++)),i+e}}function Mk(r,e){for(let i=0;i<e.length;i++){let s=e[i];if(s.pos==r.pos&&s.sameState(r)){e[i].score<r.score&&(e[i]=r);return}}e.push(r)}class qW{constructor(e,i,s){this.source=e,this.flags=i,this.disabled=s}allows(e){return!this.disabled||this.disabled[e]==0}}const z1=r=>r;class JW{constructor(e){this.start=e.start,this.shift=e.shift||z1,this.reduce=e.reduce||z1,this.reuse=e.reuse||z1,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class Sf extends ew{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (${14})`);let i=e.nodeNames.split(" ");this.minRepeatTerm=i.length;for(let c=0;c<e.repeatNodeCount;c++)i.push("");let s=Object.keys(e.topRules).map(c=>e.topRules[c][1]),n=[];for(let c=0;c<i.length;c++)n.push([]);function l(c,h,f){n[c].push([h,h.deserialize(String(f))])}if(e.nodeProps)for(let c of e.nodeProps){let h=c[0];typeof h=="string"&&(h=_t[h]);for(let f=1;f<c.length;){let p=c[f++];if(p>=0)l(p,h,c[f++]);else{let g=c[f+-p];for(let T=-p;T>0;T--)l(c[f++],h,g);f++}}}this.nodeSet=new gT(i.map((c,h)=>Gr.define({name:h>=this.minRepeatTerm?void 0:c,id:h,props:n[h],top:s.indexOf(h)>-1,error:h==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(h)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=JO;let u=g0(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let c=0;c<this.specializerSpecs.length;c++)this.specialized[c]=this.specializerSpecs[c].term;this.specializers=this.specializerSpecs.map(Bk),this.states=g0(e.states,Uint32Array),this.data=g0(e.stateData),this.goto=g0(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(c=>typeof c=="number"?new Ja(u,c):c),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,i,s){let n=new KW(this,e,i,s);for(let l of this.wrappers)n=l(n,e,i,s);return n}getGoto(e,i,s=!1){let n=this.goto;if(i>=n[0])return-1;for(let l=n[i+1];;){let u=n[l++],c=u&1,h=n[l++];if(c&&s)return h;for(let f=l+(u>>1);l<f;l++)if(n[l]==e)return h;if(c)return-1}}hasAction(e,i){let s=this.data;for(let n=0;n<2;n++)for(let l=this.stateSlot(e,n?2:1),u;;l+=3){if((u=s[l])==65535)if(s[l+1]==1)u=s[l=Zn(s,l+2)];else{if(s[l+1]==2)return Zn(s,l+2);break}if(u==i||u==0)return Zn(s,l+1)}return 0}stateSlot(e,i){return this.states[e*6+i]}stateFlag(e,i){return(this.stateSlot(e,0)&i)>0}validAction(e,i){if(i==this.stateSlot(e,4))return!0;for(let s=this.stateSlot(e,1);;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=Zn(this.data,s+2);else return!1;if(i==Zn(this.data,s+1))return!0}}nextStates(e){let i=[];for(let s=this.stateSlot(e,1);;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=Zn(this.data,s+2);else break;if(!(this.data[s+2]&1)){let n=this.data[s+1];i.some((l,u)=>u&1&&l==n)||i.push(this.data[s],n)}}return i}configure(e){let i=Object.assign(Object.create(Sf.prototype),this);if(e.props&&(i.nodeSet=this.nodeSet.extend(...e.props)),e.top){let s=this.topRules[e.top];if(!s)throw new RangeError(`Invalid top rule name ${e.top}`);i.top=s}return e.tokenizers&&(i.tokenizers=this.tokenizers.map(s=>{let n=e.tokenizers.find(l=>l.from==s);return n?n.to:s})),e.specializers&&(i.specializers=this.specializers.slice(),i.specializerSpecs=this.specializerSpecs.map((s,n)=>{let l=e.specializers.find(c=>c.from==s.external);if(!l)return s;let u=Object.assign(Object.assign({},s),{external:l.to});return i.specializers[n]=Bk(u),u})),e.contextTracker&&(i.context=e.contextTracker),e.dialect&&(i.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(i.strict=e.strict),e.wrap&&(i.wrappers=i.wrappers.concat(e.wrap)),e.bufferLength!=null&&(i.bufferLength=e.bufferLength),i}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let i=this.dynamicPrecedences;return i==null?0:i[e]||0}parseDialect(e){let i=Object.keys(this.dialects),s=i.map(()=>!1);if(e)for(let l of e.split(" ")){let u=i.indexOf(l);u>=0&&(s[u]=!0)}let n=null;for(let l=0;l<i.length;l++)if(!s[l])for(let u=this.dialects[i[l]],c;(c=this.data[u++])!=65535;)(n||(n=new Uint8Array(this.maxTerm+1)))[c]=1;return new qW(e,s,n)}static deserialize(e){return new Sf(e)}}function Zn(r,e){return r[e]|r[e+1]<<16}function QW(r){let e=null;for(let i of r){let s=i.p.stoppedAt;(i.pos==i.p.stream.end||s!=null&&i.pos>s)&&i.p.parser.stateFlag(i.state,2)&&(!e||e.score<i.score)&&(e=i)}return e}function Bk(r){if(r.external){let e=r.extend?1:0;return(i,s)=>r.external(i,s)<<1|e}return r.get}const ob=1,ZW=2,ez=3,tz=4,iz=5,rz=35,sz=36,nz=37,oz=11,lz=13;function az(r){return r==45||r==46||r==58||r>=65&&r<=90||r==95||r>=97&&r<=122||r>=161}function uz(r){return r==9||r==10||r==13||r==32}let Pk=null,Fk=null,Uk=0;function lb(r,e){let i=r.pos+e;if(Fk==r&&Uk==i)return Pk;for(;uz(r.peek(e));)e++;let s="";for(;;){let n=r.peek(e);if(!az(n))break;s+=String.fromCharCode(n),e++}return Fk=r,Uk=i,Pk=s||null}function Hk(r,e){this.name=r,this.parent=e,this.hash=e?e.hash:0;for(let i=0;i<r.length;i++)this.hash+=(this.hash<<4)+r.charCodeAt(i)+(r.charCodeAt(i)<<8)}const cz=new JW({start:null,shift(r,e,i,s){return e==ob?new Hk(lb(s,1)||"",r):r},reduce(r,e){return e==oz&&r?r.parent:r},reuse(r,e,i,s){let n=e.type.id;return n==ob||n==lz?new Hk(lb(s,1)||"",r):r},hash(r){return r?r.hash:0},strict:!1}),hz=new $R((r,e)=>{if(r.next==60){if(r.advance(),r.next==47){r.advance();let i=lb(r,0);if(!i)return r.acceptToken(iz);if(e.context&&i==e.context.name)return r.acceptToken(ZW);for(let s=e.context;s;s=s.parent)if(s.name==i)return r.acceptToken(ez,-2);r.acceptToken(tz)}else if(r.next!=33&&r.next!=63)return r.acceptToken(ob)}},{contextual:!0});function LT(r,e){return new $R(i=>{for(let s=0,n=0;;n++){if(i.next<0){n&&i.acceptToken(r);break}if(i.next==e.charCodeAt(s)){if(s++,s==e.length){n>=e.length&&i.acceptToken(r,1-e.length);break}}else s=i.next==e.charCodeAt(0)?1:0;i.advance()}})}const dz=LT(rz,"-->"),fz=LT(sz,"?>"),pz=LT(nz,"]]>"),mz=tw({Text:Te.content,"StartTag StartCloseTag EndTag SelfCloseEndTag":Te.angleBracket,TagName:Te.tagName,"MismatchedCloseTag/Tagname":[Te.tagName,Te.invalid],AttributeName:Te.attributeName,AttributeValue:Te.attributeValue,Is:Te.definitionOperator,"EntityReference CharacterReference":Te.character,Comment:Te.blockComment,ProcessingInst:Te.processingInstruction,DoctypeDecl:Te.documentMeta,Cdata:Te.special(Te.string)}),gz=Sf.deserialize({version:14,states:",SOQOaOOOrOxO'#CfOzOpO'#CiO!tOaO'#CgOOOP'#Cg'#CgO!{OrO'#CrO#TOtO'#CsO#]OpO'#CtOOOP'#DS'#DSOOOP'#Cv'#CvQQOaOOOOOW'#Cw'#CwO#eOxO,59QOOOP,59Q,59QOOOO'#Cx'#CxO#mOpO,59TO#uO!bO,59TOOOP'#C{'#C{O$TOaO,59RO$[OpO'#CoOOOP,59R,59ROOOQ'#C|'#C|O$dOrO,59^OOOP,59^,59^OOOS'#C}'#C}O$lOtO,59_OOOP,59_,59_O$tOpO,59`O$|OpO,59`OOOP-E6t-E6tOOOW-E6u-E6uOOOP1G.l1G.lOOOO-E6v-E6vO%UO!bO1G.oO%UO!bO1G.oO%dOpO'#CkO%lO!bO'#CyO%zO!bO1G.oOOOP1G.o1G.oOOOP1G.w1G.wOOOP-E6y-E6yOOOP1G.m1G.mO&VOpO,59ZO&_OpO,59ZOOOQ-E6z-E6zOOOP1G.x1G.xOOOS-E6{-E6{OOOP1G.y1G.yO&gOpO1G.zO&gOpO1G.zOOOP1G.z1G.zO&oO!bO7+$ZO&}O!bO7+$ZOOOP7+$Z7+$ZOOOP7+$c7+$cO'YOpO,59VO'bOpO,59VO'jO!bO,59eOOOO-E6w-E6wO'xOpO1G.uO'xOpO1G.uOOOP1G.u1G.uO(QOpO7+$fOOOP7+$f7+$fO(YO!bO<<GuOOOP<<Gu<<GuOOOP<<G}<<G}O'bOpO1G.qO'bOpO1G.qO(eO#tO'#CnOOOO1G.q1G.qO(sOpO7+$aOOOP7+$a7+$aOOOP<<HQ<<HQOOOPAN=aAN=aOOOPAN=iAN=iO'bOpO7+$]OOOO7+$]7+$]OOOO'#Cz'#CzO({O#tO,59YOOOO,59Y,59YOOOP<<G{<<G{OOOO<<Gw<<GwOOOO-E6x-E6xOOOO1G.t1G.t",stateData:")Z~OPQOSVOTWOVWOWWOXWOiXOxPO}TO!PUO~OuZOw]O~O^`Oy^O~OPQOQcOSVOTWOVWOWWOXWOxPO}TO!PUO~ORdO~P!SOseO|gO~OthO!OjO~O^lOy^O~OuZOwoO~O^qOy^O~O[vO`sOdwOy^O~ORyO~P!SO^{Oy^O~OseO|}O~OthO!O!PO~O^!QOy^O~O[!SOy^O~O[!VO`sOd!WOy^O~Oa!YOy^O~Oy^O[mX`mXdmX~O[!VO`sOd!WO~O^!]Oy^O~O[!_Oy^O~O[!aOy^O~O[!cO`sOd!dOy^O~O[!cO`sOd!dO~Oa!eOy^O~Oy^Oz!gO~Oy^O[ma`madma~O[!jOy^O~O[!kOy^O~O[!lO`sOd!mO~OW!pOX!pOz!rO{!pO~O[!sOy^O~OW!pOX!pOz!vO{!pO~O",goto:"%[wPPPPPPPPPPxxP!OP!UPP!_!iP!oxxxP!u!{#R$Z$j$p$v$|PPPP%SXWORYbXRORYb_t`qru!T!U!bQ!h!YS!o!e!fR!t!nQdRRybXSORYbQYORmYQ[PRn[Q_QQkVjp_krz!R!T!X!Z!^!`!f!i!nQr`QzcQ!RlQ!TqQ!XsQ!ZtQ!^{Q!`!QQ!f!YQ!i!]R!n!eQu`S!UqrU![u!U!bR!b!TQ!q!gR!u!qQbRRxbQfTR|fQiUR!OiSXOYTaRb",nodeNames:"⚠ StartTag StartCloseTag MissingCloseTag StartCloseTag StartCloseTag Document Text EntityReference CharacterReference Cdata Element EndTag OpenTag TagName Attribute AttributeName Is AttributeValue CloseTag SelfCloseEndTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag DoctypeDecl",maxTerm:47,context:cz,nodeProps:[["closedBy",1,"SelfCloseEndTag EndTag",13,"CloseTag MissingCloseTag"],["openedBy",12,"StartTag StartCloseTag",19,"OpenTag",20,"StartTag"]],propSources:[mz],skippedNodes:[0],repeatNodeCount:8,tokenData:"IX~R!XOX$nXY&kYZ&kZ]$n]^&k^p$npq&kqr$nrs'ssv$nvw(Zw}$n}!O*l!O!P$n!P!Q,{!Q![$n![!].e!]!^$n!^!_1v!_!`Cz!`!aDm!a!bE`!b!c$n!c!}.e!}#P$n#P#QFx#Q#R$n#R#S.e#S#T$n#T#o.e#o%W$n%W%o.e%o%p$n%p&a.e&a&b$n&b1p.e1p4U$n4U4d.e4d4e$n4e$IS.e$IS$I`$n$I`$Ib.e$Ib$Kh$n$Kh%#t.e%#t&/x$n&/x&Et.e&Et&FV$n&FV;'S.e;'S;:j1p;:j;=`&e<%l?&r$n?&r?Ah.e?Ah?BY$n?BY?Mn.e?MnO$nX$uWVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$nP%dTVPOv%_w!^%_!_;'S%_;'S;=`%s<%lO%_P%vP;=`<%l%_W&OT{WOr%ysv%yw;'S%y;'S;=`&_<%lO%yW&bP;=`<%l%yX&hP;=`<%l$n_&t_VP{WyUOX$nXY&kYZ&kZ]$n]^&k^p$npq&kqr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$nZ'zTzYVPOv%_w!^%_!_;'S%_;'S;=`%s<%lO%_~(^VOp(sqs(sst)ht!](s!^;'S(s;'S;=`)b<%lO(s~(vVOp(sqs(st!](s!]!^)]!^;'S(s;'S;=`)b<%lO(s~)bOW~~)eP;=`<%l(s~)kTOp)zq!])z!^;'S)z;'S;=`*f<%lO)z~)}UOp)zq!])z!]!^*a!^;'S)z;'S;=`*f<%lO)z~*fOX~~*iP;=`<%l)zZ*sYVP{WOr$nrs%_sv$nw}$n}!O+c!O!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$nZ+jYVP{WOr$nrs%_sv$nw!^$n!^!_%y!_!`$n!`!a,Y!a;'S$n;'S;=`&e<%lO$nZ,cW|QVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$n]-SYVP{WOr$nrs%_sv$nw!^$n!^!_%y!_!`$n!`!a-r!a;'S$n;'S;=`&e<%lO$n]-{WdSVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$n_.p!O`S^QVP{WOr$nrs%_sv$nw}$n}!O.e!O!P.e!P!Q$n!Q![.e![!].e!]!^$n!^!_%y!_!c$n!c!}.e!}#R$n#R#S.e#S#T$n#T#o.e#o$}$n$}%O.e%O%W$n%W%o.e%o%p$n%p&a.e&a&b$n&b1p.e1p4U.e4U4d.e4d4e$n4e$IS.e$IS$I`$n$I`$Ib.e$Ib$Je$n$Je$Jg.e$Jg$Kh$n$Kh%#t.e%#t&/x$n&/x&Et.e&Et&FV$n&FV;'S.e;'S;:j1p;:j;=`&e<%l?&r$n?&r?Ah.e?Ah?BY$n?BY?Mn.e?MnO$n_1sP;=`<%l.eX1{W{WOq%yqr2esv%yw!a%y!a!bCd!b;'S%y;'S;=`&_<%lO%yX2j]{WOr%ysv%yw}%y}!O3c!O!f%y!f!g4e!g!}%y!}#O9t#O#W%y#W#X@Q#X;'S%y;'S;=`&_<%lO%yX3hV{WOr%ysv%yw}%y}!O3}!O;'S%y;'S;=`&_<%lO%yX4UT}P{WOr%ysv%yw;'S%y;'S;=`&_<%lO%yX4jV{WOr%ysv%yw!q%y!q!r5P!r;'S%y;'S;=`&_<%lO%yX5UV{WOr%ysv%yw!e%y!e!f5k!f;'S%y;'S;=`&_<%lO%yX5pV{WOr%ysv%yw!v%y!v!w6V!w;'S%y;'S;=`&_<%lO%yX6[V{WOr%ysv%yw!{%y!{!|6q!|;'S%y;'S;=`&_<%lO%yX6vV{WOr%ysv%yw!r%y!r!s7]!s;'S%y;'S;=`&_<%lO%yX7bV{WOr%ysv%yw!g%y!g!h7w!h;'S%y;'S;=`&_<%lO%yX7|X{WOr7wrs8isv7wvw8iw!`7w!`!a9W!a;'S7w;'S;=`9n<%lO7wP8lTO!`8i!`!a8{!a;'S8i;'S;=`9Q<%lO8iP9QOiPP9TP;=`<%l8iX9_TiP{WOr%ysv%yw;'S%y;'S;=`&_<%lO%yX9qP;=`<%l7wX9yX{WOr%ysv%yw!e%y!e!f:f!f#V%y#V#W=t#W;'S%y;'S;=`&_<%lO%yX:kV{WOr%ysv%yw!f%y!f!g;Q!g;'S%y;'S;=`&_<%lO%yX;VV{WOr%ysv%yw!c%y!c!d;l!d;'S%y;'S;=`&_<%lO%yX;qV{WOr%ysv%yw!v%y!v!w<W!w;'S%y;'S;=`&_<%lO%yX<]V{WOr%ysv%yw!c%y!c!d<r!d;'S%y;'S;=`&_<%lO%yX<wV{WOr%ysv%yw!}%y!}#O=^#O;'S%y;'S;=`&_<%lO%yX=eT{WxPOr%ysv%yw;'S%y;'S;=`&_<%lO%yX=yV{WOr%ysv%yw#W%y#W#X>`#X;'S%y;'S;=`&_<%lO%yX>eV{WOr%ysv%yw#T%y#T#U>z#U;'S%y;'S;=`&_<%lO%yX?PV{WOr%ysv%yw#h%y#h#i?f#i;'S%y;'S;=`&_<%lO%yX?kV{WOr%ysv%yw#T%y#T#U<r#U;'S%y;'S;=`&_<%lO%yX@VV{WOr%ysv%yw#c%y#c#d@l#d;'S%y;'S;=`&_<%lO%yX@qV{WOr%ysv%yw#V%y#V#WAW#W;'S%y;'S;=`&_<%lO%yXA]V{WOr%ysv%yw#h%y#h#iAr#i;'S%y;'S;=`&_<%lO%yXAwV{WOr%ysv%yw#m%y#m#nB^#n;'S%y;'S;=`&_<%lO%yXBcV{WOr%ysv%yw#d%y#d#eBx#e;'S%y;'S;=`&_<%lO%yXB}V{WOr%ysv%yw#X%y#X#Y7w#Y;'S%y;'S;=`&_<%lO%yXCkT!PP{WOr%ysv%yw;'S%y;'S;=`&_<%lO%yZDTWaQVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$n_DvW[UVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$nZEgYVP{WOr$nrs%_sv$nw!^$n!^!_%y!_!`$n!`!aFV!a;'S$n;'S;=`&e<%lO$nZF`W!OQVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$nZGPYVP{WOr$nrs%_sv$nw!^$n!^!_%y!_#P$n#P#QGo#Q;'S$n;'S;=`&e<%lO$nZGvYVP{WOr$nrs%_sv$nw!^$n!^!_%y!_!`$n!`!aHf!a;'S$n;'S;=`&e<%lO$nZHoWwQVP{WOr$nrs%_sv$nw!^$n!^!_%y!_;'S$n;'S;=`&e<%lO$n",tokenizers:[hz,dz,fz,pz,0,1,2,3],topRules:{Document:[0,6]},tokenPrec:0});function w0(r,e){let i=e&&e.getChild("TagName");return i?r.sliceString(i.from,i.to):""}function Y1(r,e){let i=e&&e.firstChild;return!i||i.name!="OpenTag"?"":w0(r,i)}function _z(r,e,i){let s=e&&e.getChildren("Attribute").find(l=>l.from<=i&&l.to>=i),n=s&&s.getChild("AttributeName");return n?r.sliceString(n.from,n.to):""}function X1(r){for(let e=r&&r.parent;e;e=e.parent)if(e.name=="Element")return e;return null}function bz(r,e){var i;let s=rr(r).resolveInner(e,-1),n=null;for(let l=s;!n&&l.parent;l=l.parent)(l.name=="OpenTag"||l.name=="CloseTag"||l.name=="SelfClosingTag"||l.name=="MismatchedCloseTag")&&(n=l);if(n&&(n.to>e||n.lastChild.type.isError)){let l=n.parent;if(s.name=="TagName")return n.name=="CloseTag"||n.name=="MismatchedCloseTag"?{type:"closeTag",from:s.from,context:l}:{type:"openTag",from:s.from,context:X1(l)};if(s.name=="AttributeName")return{type:"attrName",from:s.from,context:n};if(s.name=="AttributeValue")return{type:"attrValue",from:s.from,context:n};let u=s==n||s.name=="Attribute"?s.childBefore(e):s;return(u==null?void 0:u.name)=="StartTag"?{type:"openTag",from:e,context:X1(l)}:(u==null?void 0:u.name)=="StartCloseTag"&&u.to<=e?{type:"closeTag",from:e,context:l}:(u==null?void 0:u.name)=="Is"?{type:"attrValue",from:e,context:n}:u?{type:"attrName",from:e,context:n}:null}else if(s.name=="StartCloseTag")return{type:"closeTag",from:e,context:s.parent};for(;s.parent&&s.to==e&&!(!((i=s.lastChild)===null||i===void 0)&&i.type.isError);)s=s.parent;return s.name=="Element"||s.name=="Text"||s.name=="Document"?{type:"tag",from:e,context:s.name=="Element"?s:X1(s)}:null}let Tz=class{constructor(e,i,s){this.attrs=i,this.attrValues=s,this.children=[],this.name=e.name,this.completion=Object.assign(Object.assign({type:"type"},e.completion||{}),{label:this.name}),this.openCompletion=Object.assign(Object.assign({},this.completion),{label:"<"+this.name}),this.closeCompletion=Object.assign(Object.assign({},this.completion),{label:"</"+this.name+">",boost:2}),this.closeNameCompletion=Object.assign(Object.assign({},this.completion),{label:this.name+">"}),this.text=e.textContent?e.textContent.map(n=>({label:n,type:"text"})):[]}};const j1=/^[:\-\.\w\u00b7-\uffff]*$/;function Gk(r){return Object.assign(Object.assign({type:"property"},r.completion||{}),{label:r.name})}function Vk(r){return typeof r=="string"?{label:`"${r}"`,type:"constant"}:/^"/.test(r.label)?r:Object.assign(Object.assign({},r),{label:`"${r.label}"`})}function Ez(r,e){let i=[],s=[],n=Object.create(null);for(let h of e){let f=Gk(h);i.push(f),h.global&&s.push(f),h.values&&(n[h.name]=h.values.map(Vk))}let l=[],u=[],c=Object.create(null);for(let h of r){let f=s,p=n;h.attributes&&(f=f.concat(h.attributes.map(T=>typeof T=="string"?i.find($=>$.label==T)||{label:T,type:"property"}:(T.values&&(p==n&&(p=Object.create(p)),p[T.name]=T.values.map(Vk)),Gk(T)))));let g=new Tz(h,f,p);c[g.name]=g,l.push(g),h.top&&u.push(g)}u.length||(u=l);for(let h=0;h<l.length;h++){let f=r[h],p=l[h];if(f.children)for(let g of f.children)c[g]&&p.children.push(c[g]);else p.children=l}return h=>{var f;let{doc:p}=h.state,g=bz(h.state,h.pos);if(!g||g.type=="tag"&&!h.explicit)return null;let{type:T,from:$,context:y}=g;if(T=="openTag"){let R=u,C=Y1(p,y);if(C){let x=c[C];R=(x==null?void 0:x.children)||l}return{from:$,options:R.map(x=>x.completion),validFor:j1}}else if(T=="closeTag"){let R=Y1(p,y);return R?{from:$,to:h.pos+(p.sliceString(h.pos,h.pos+1)==">"?1:0),options:[((f=c[R])===null||f===void 0?void 0:f.closeNameCompletion)||{label:R+">",type:"type"}],validFor:j1}:null}else if(T=="attrName"){let R=c[w0(p,y)];return{from:$,options:(R==null?void 0:R.attrs)||s,validFor:j1}}else if(T=="attrValue"){let R=_z(p,y,$);if(!R)return null;let C=c[w0(p,y)],x=((C==null?void 0:C.attrValues)||n)[R];return!x||!x.length?null:{from:$,to:h.pos+(p.sliceString(h.pos,h.pos+1)=='"'?1:0),options:x,validFor:/^"[^"]*"?$/}}else if(T=="tag"){let R=Y1(p,y),C=c[R],x=[],j=y&&y.lastChild;R&&(!j||j.name!="CloseTag"||w0(p,j)!=R)&&x.push(C?C.closeCompletion:{label:"</"+R+">",type:"type",boost:2});let F=x.concat(((C==null?void 0:C.children)||(y?l:u)).map(q=>q.openCompletion));if(y&&(C!=null&&C.text.length)){let q=y.firstChild;q.to>h.pos-20&&!/\S/.test(h.state.sliceDoc(q.to,h.pos))&&(F=F.concat(C.text))}return{from:$,options:F,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}else return null}}const Wk=af.define({name:"xml",parser:gz.configure({props:[nw.add({Element(r){let e=/^\s*<\//.test(r.textAfter);return r.lineIndent(r.node.from)+(e?0:r.unit)},"OpenTag CloseTag SelfClosingTag"(r){return r.column(r.node.from)+r.unit}}),lw.add({Element(r){let e=r.firstChild,i=r.lastChild;return!e||e.name!="OpenTag"?null:{from:e.to,to:i.name=="CloseTag"?i.from:r.to}}}),bw.add({"OpenTag CloseTag":r=>r.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/$/}});function zk(r={}){return new TH(Wk,Wk.data.of({autocomplete:Ez(r.elements||[],r.attributes||[])}))}var au={},$z={get exports(){return au},set exports(r){au=r}},If={},vz={get exports(){return If},set exports(r){If=r}},kf={},yz={get exports(){return kf},set exports(r){kf=r}},Af={},Sz={get exports(){return Af},set exports(r){Af=r}},Cf={},Iz={get exports(){return Cf},set exports(r){Cf=r}},Yk;function MT(){return Yk||(Yk=1,function(r,e){(function(i,s){r.exports=s()})(ys,function(){var i={},s=function(t,o,a,d){t=t+" was deprecated in "+o+" and will be deleted in "+a+".",d&&(t+=`
Use `+d+" instead."),console.warn(t)},n=function(t,o){l(),Jh=setTimeout(function(){o&&o.handleRightClick(t)},lN)},l=function(){Jh&&(clearTimeout(Jh),Jh=0)},u=function(){qh=null},c=function(t){return!t.type.startsWith("pointer")||t instanceof PointerEvent&&f(t)},h=function(t){return`${t.pointerId}`},f=function(t){const o=h(t);return qh?qh===o:t.type==="pointerdown"?(qh=o,!0):!1},p=function(t){if(s("setClientFromTouch()","version 9","version 10"),t.type.startsWith("touch")&&t.changedTouches){const o=t.changedTouches[0];t.clientX=o.clientX,t.clientY=o.clientY}},g=function(t){return s("isMouseOrTouchEvent()","version 9","version 10"),t.type.startsWith("touch")||t.type.startsWith("mouse")||t.type.startsWith("pointer")},T=function(t){return s("isTouchEvent()","version 9","version 10"),t.type.startsWith("touch")||t.type.startsWith("pointer")},$=function(t){s("splitEventByTouches()","version 9","version 10");const o=[];if(t.changedTouches)for(let a=0;a<t.changedTouches.length;a++)o[a]={type:t.type,changedTouches:[t.changedTouches[a]],target:t.target,stopPropagation(){t.stopPropagation()},preventDefault(){t.preventDefault()}};else o.push(t);return o},y=function(t,o,a,d,m,b){function I(L){(m||c(L))&&(a?d.call(a,L):d(L))}if(b!==void 0&&s("The opt_noPreventDefault argument of conditionalBind","version 9","version 10"),b=[],o in ul)for(let L=0;L<ul[o].length;L++){const oe=ul[o][L];t.addEventListener(oe,I,!1),b.push([t,oe,I])}else t.addEventListener(o,I,!1),b.push([t,o,I]);return b},R=function(t,o,a,d){function m(I){a?d.call(a,I):d(I)}const b=[];if(o in ul)for(let I=0;I<ul[o].length;I++){const L=ul[o][I];t.addEventListener(L,m,!1),b.push([t,L,m])}else t.addEventListener(o,m,!1),b.push([t,o,m]);return b},C=function(t){const o=t[t.length-1][2];for(;t.length;){const a=t.pop();a[0].removeEventListener(a[1],a[2],!1)}return o},x=function(t){if(t.target instanceof HTMLElement){if(t.target.isContentEditable||t.target.getAttribute("data-is-text-input")==="true")return!0;if(t.target instanceof HTMLInputElement)return t=t.target,t.type==="text"||t.type==="number"||t.type==="email"||t.type==="password"||t.type==="search"||t.type==="tel"||t.type==="url";if(t.target instanceof HTMLTextAreaElement)return!0}return!1},j=function(t){return t.ctrlKey&&hm?!0:t.button===2},F=function(t,o,a){const d=o.createSVGPoint();return d.x=t.clientX,d.y=t.clientY,a||(a=o.getScreenCTM().inverse()),d.matrixTransform(a)},q=function(t){switch(t.deltaMode){default:return{x:t.deltaX,y:t.deltaY};case 1:return{x:t.deltaX*D$,y:t.deltaY*D$};case 2:return{x:t.deltaX*L$,y:t.deltaY*L$}}},W=function(t){return oa[t]||null},ne=function(){const t=[];for(const o in oa)t.push(oa[o]);return t},P=function(t){oa[t.id]=t},Q=function(t){delete oa[t.id]},re=function(){return M$},Y=function(t){M$=t},_e=function(){return fm},Xe=function(t){fm=t},At=function(){return B$},vt=function(t){B$=t},je=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;const o=t.getParentSvg(),a=t.getCachedParentSvgSize();var d=o.parentElement;if(d instanceof HTMLElement){var m=d.offsetWidth;d=d.offsetHeight,a.width!==m&&(o.setAttribute("width",m+"px"),t.setCachedParentSvgSize(m,null)),a.height!==d&&(o.setAttribute("height",d+"px"),t.setCachedParentSvgSize(null,d)),t.resize()}},we=function(t,o){const a=Object.create(null),d=t.getDescendants(!0);o&&(t=t.getNextBlock())&&(t=d.indexOf(t),d.splice(t,d.length-t));for(let m=0,b;b=d[m];m++)a[b.type]?a[b.type]++:a[b.type]=1;return a},xe=function(t){return function(){this.jsonInit(t)}},St=function(t){pm.defineBlocksWithJsonArrayInternal(t)},It=function(t){ei(bt(t))},bt=function(t){const o={};for(let a=0;a<t.length;a++){const d=t[a];if(!d){console.warn(`Block definition #${a} in JSON array is ${d}. Skipping`);continue}const m=d.type;m?o[m]={init:xe(d)}:console.warn(`Block definition #${a} in JSON array is missing a type attribute. Skipping.`)}return o},ei=function(t){for(const o of Object.keys(t)){const a=t[o];o in Cr&&console.warn(`Block definiton "${o}" overwrites previous definition.`),Cr[o]=a}},z=function(t,o,a){t=document.createElementNS(la,String(t));for(const d in o)t.setAttribute(d,`${o[d]}`);return a&&a.appendChild(t),t},Ce=function(t,o){return o=o.split(" "),o.every(a=>t.classList.contains(a))?!1:(t.classList.add(...o),!0)},pr=function(t,o){t.classList.remove(...o.split(" "))},qe=function(t,o){return o=o.split(" "),o.every(a=>!t.classList.contains(a))?!1:(t.classList.remove(...o),!0)},Kl=function(t,o){return t.classList.contains(o)},ft=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},pi=function(t,o){const a=o.nextSibling;if(o=o.parentNode,!o)throw Error("Reference node has no parent.");a?o.insertBefore(t,a):o.appendChild(t)},ls=function(t,o){return!!(t.compareDocumentPosition(o)&sn.DOCUMENT_POSITION_CONTAINED_BY)},Wr=function(t,o){t.style.transform=o,t.style["-webkit-transform"]=o},Cs=function(){mm++,Bs||(Bs=Object.create(null))},Os=function(){mm--,mm||(Bs=null)},gu=function(t){const o=t.textContent+`
`+t.className.baseVal;let a;if(Bs&&(a=Bs[o]))return a;try{a=t.getComputedTextLength()}catch{return 8*t.textContent.length}return Bs&&(Bs[o]=a),a},as=function(t,o,a,d){return po(t,o+"pt",a,d)},po=function(t,o,a,d){const m=t.textContent;t=m+`
`+t.className.baseVal;var b;return Bs&&(b=Bs[t])||(td||(b=document.createElement("canvas"),b.className="blocklyComputeCanvas",document.body.appendChild(b),td=b.getContext("2d")),td.font=a+" "+o+" "+d,b=m?td.measureText(m).width:0,Bs&&(Bs[t]=b)),b},ws=function(t,o,a,d){const m=document.createElement("span");m.style.font=a+" "+o+" "+d,m.textContent=t,t=document.createElement("div"),t.style.width="1px",t.style.height="0",o=document.createElement("div"),o.setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),o.appendChild(m),o.appendChild(t),document.body.appendChild(o),a={height:0,baseline:0};try{o.style.alignItems="baseline",a.baseline=t.offsetTop-m.offsetTop,o.style.alignItems="flex-end",a.height=t.offsetTop-m.offsetTop}finally{document.body.removeChild(o)}return a},Bi=function(t){return t*Math.PI/180},Ln=function(t){return 180*t/Math.PI},us=function(t,o,a){if(a<t){const d=a;a=t,t=d}return Math.max(t,Math.min(o,a))},ql=function(t){return P$.getSizeInternal(t)},gp=function(t){if(Rs(t,"display")!=="none")return Eh(t);const o=t.style,a=o.display,d=o.visibility,m=o.position;o.visibility="hidden",o.position="absolute",o.display="inline";const b=t.offsetWidth;return t=t.offsetHeight,o.display=a,o.position=m,o.visibility=d,new Xi(b,t)},Eh=function(t){return new Xi(t.offsetWidth,t.offsetHeight)},Rs=function(t,o){return t=window.getComputedStyle(t),t[o]||t.getPropertyValue(o)},_p=function(t,o){return s("Blockly.utils.style.getCascadedStyle","version 9","version 10"),t.currentStyle?t.currentStyle[o]:""},Mn=function(t){const o=new ve(0,0);t=t.getBoundingClientRect();var a=document.documentElement;return a=new ve(window.pageXOffset||a.scrollLeft,window.pageYOffset||a.scrollTop),o.x=t.left+a.x,o.y=t.top+a.y,o},nr=function(){const t=document.body,o=document.documentElement;return new ve(t.scrollLeft||o.scrollLeft,t.scrollTop||o.scrollTop)},Zs=function(t){const o=parseFloat(Rs(t,"borderLeftWidth")),a=parseFloat(Rs(t,"borderRightWidth")),d=parseFloat(Rs(t,"borderTopWidth"));return t=parseFloat(Rs(t,"borderBottomWidth")),new li(d,t,o,a)},be=function(t,o,a){t=$h(t,o,a),o.scrollLeft=t.x,o.scrollTop=t.y},$h=function(t,o,a){var d=Mn(t),m=Mn(o),b=Zs(o);const I=d.x-m.x-b.left;return d=d.y-m.y-b.top,m=Eh(t),t=o.clientWidth-m.width,m=o.clientHeight-m.height,b=o.scrollLeft,o=o.scrollTop,a?(b+=I-t/2,o+=d-m/2):(b+=Math.min(I,Math.max(I-t,0)),o+=Math.min(d,Math.max(d-m,0))),new ve(b,o)},vh=function(){Ct||(Ct=document.createElement("div"),Ct.className="blocklyDropDownDiv",(At()||document.body).appendChild(Ct),ca=document.createElement("div"),ca.className="blocklyDropDownContent",Ct.appendChild(ca),dl=document.createElement("div"),dl.className="blocklyDropDownArrow",Ct.appendChild(dl),Ct.style.opacity="0",Ct.style.transition="transform "+rd+"s, opacity "+rd+"s",Ct.addEventListener("focusin",function(){Ce(Ct,"blocklyFocused")}),Ct.addEventListener("focusout",function(){qe(Ct,"blocklyFocused")}))},rl=function(t){Tm=t},yh=function(){return bo},Jl=function(){return ca},or=function(){ca.textContent="",ca.style.width=""},S=function(t,o){Ct.style.backgroundColor=t,Ct.style.borderColor=o},w=function(t,o,a,d){return kt(Z(o),t,a,d)},H=function(t,o,a){return U$=!0,kt(ie(t),t,o,a)},Z=function(t){var o=t.getSvgRoot();const a=t.workspace.scale,d=t.height*a;return t=t.width*a,o=Mn(o),new li(o.y,o.y+d,o.x,o.x+t)},ie=function(t){return t=t.getScaledBBox(),new li(t.top,t.bottom,t.left,t.right)},kt=function(t,o,a,d){const m=t.left+(t.right-t.left)/2,b=t.bottom;t=t.top,d&&(t+=d),d=o.getSourceBlock();let I=d.workspace;for(;I.options.parentWorkspace;)I=I.options.parentWorkspace;return rl(I.getParentSvg().parentNode),sl(o,d.RTL,m,b,m,t,a)},sl=function(t,o,a,d,m,b,I){return bo=t,hl=I||null,Ct.style.direction=o?"rtl":"ltr",t=re(),aa=t.getRenderer().getClassName(),ua=t.getTheme().getClassName(),aa&&Ce(Ct,aa),ua&&Ce(Ct,ua),UT(a,d,m,b)},BT=function(t,o,a,d){return t=Sh(t,a.left,a.right,d.width),{initialX:t.divX,initialY:o,finalX:t.divX,finalY:o+_m,arrowX:t.arrowX,arrowY:-(ku/2+gm),arrowAtTop:!0,arrowVisible:!0}},PT=function(t,o,a,d){return t=Sh(t,a.left,a.right,d.width),{initialX:t.divX,initialY:o-d.height,finalX:t.divX,finalY:o-d.height-_m,arrowX:t.arrowX,arrowY:d.height-2*gm-ku/2,arrowAtTop:!1,arrowVisible:!0}},yR=function(t,o,a){return t=Sh(t,o.left,o.right,a.width),{initialX:t.divX,initialY:0,finalX:t.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},Sh=function(t,o,a,d){return o=us(o,t-d/2,a-d),t=t-ku/2-o,a=F$,t=us(a,t,d-a-ku),{arrowX:t,divX:o}},FT=function(){return!!bo},_u=function(t,o){return bo===t?(o?en():bp(),!0):!1},bp=function(){Ct.style.transform="translate(0, 0)",Ct.style.opacity="0",bm=setTimeout(function(){en()},1e3*rd),hl&&(hl(),hl=null)},en=function(){FT()&&(bm&&clearTimeout(bm),Ct.style.transform="",Ct.style.left="",Ct.style.top="",Ct.style.opacity="0",Ct.style.display="none",Ct.style.backgroundColor="",Ct.style.borderColor="",hl&&(hl(),hl=null),or(),bo=null,aa&&(qe(Ct,aa),aa=""),ua&&(qe(Ct,ua),ua=""),re().markFocused())},UT=function(t,o,a,d){t=Em.getPositionMetrics(t,o,a,d),t.arrowVisible?(dl.style.display="",dl.style.transform="translate("+t.arrowX+"px,"+t.arrowY+"px) rotate(45deg)",dl.setAttribute("class",t.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):dl.style.display="none",o=Math.floor(t.initialX),a=Math.floor(t.initialY),d=Math.floor(t.finalX);const m=Math.floor(t.finalY);return Ct.style.left=o+"px",Ct.style.top=a+"px",Ct.style.display="block",Ct.style.opacity="1",Ct.style.transform="translate("+(d-o)+"px,"+(m-a)+"px)",!!t.arrowAtTop},SR=function(){if(bo){var t=bo.getSourceBlock();t=U$?ie(bo):Z(t);const o=t.left+(t.right-t.left)/2;UT(o,t.bottom,o,t.top)}else bp()},tt=function(t,o,a,d){if(!(t instanceof fe)&&typeof t!="string"||String(t).trim()==="")throw Error('Invalid type "'+t+'". The type must be a non-empty string or a Blockly.registry.Type.');if(t=String(t).toLowerCase(),typeof o!="string"||o.trim()==="")throw Error('Invalid name "'+o+'". The name must be a non-empty string.');const m=o.toLowerCase();if(!a)throw Error("Can not register a null value");let b=To[t],I=sd[t];if(b||(b=To[t]=Object.create(null),I=sd[t]=Object.create(null)),IR(t,a),!d&&b[m])throw Error('Name "'+m+'" with type "'+t+'" already registered.');b[m]=a,I[m]=o},IR=function(t,o){switch(t){case String(fe.FIELD):if(typeof o.fromJson!="function")throw Error('Type "'+t+'" must have a fromJson function')}},Ih=function(t,o){t=String(t).toLowerCase(),o=o.toLowerCase();const a=To[t];a&&a[o]?(delete To[t][o],delete sd[t][o]):console.warn("Unable to unregister ["+o+"]["+t+"] from the registry.")},HT=function(t,o,a){t=String(t).toLowerCase(),o=o.toLowerCase();const d=To[t];if(!d||!d[o]){if(o="Unable to find ["+o+"]["+t+"] in the registry.",a)throw Error(o+" You must require or register a "+t+" plugin.");return console.warn(o),null}return d[o]},GT=function(t,o){return t=String(t).toLowerCase(),o=o.toLowerCase(),(t=To[t])?!!t[o]:!1},Ql=function(t,o,a){return HT(t,o,a)},kh=function(t,o,a){return HT(t,o,a)},Tp=function(t,o,a){t=String(t).toLowerCase();var d=To[t];if(!d){if(d=`Unable to find [${t}] in the registry.`,a)throw Error(`${d} You must require or register a ${t} plugin.`);return console.warn(d),null}if(!o)return d;t=sd[t],a=Object.create(null),o=Object.keys(d);for(let m=0;m<o.length;m++){const b=o[m];a[t[b]]=d[b]}return a},cs=function(t,o,a){return o=o.plugins[t.toString()]||Hn,typeof o=="function"?o:Ql(t,o,a)},bu=function(){return"blockly-"+(cN++).toString(36)},Ns=function(){return G$.genUid()},zr=function(t){Au=t},xs=function(){return Au},De=function(t){ym.fireInternal(t)},kR=function(t){Pi()&&(ma.length||setTimeout(VT,0),ma.push(t))},VT=function(){const t=Ah(ma,!0);ma.length=0;for(let o=0,a;a=t[o];o++){if(!a.workspaceId)continue;const d=W(a.workspaceId);d&&d.fireChangeListener(a)}},Ah=function(t,o){t=t.slice(),o||t.reverse();const a=[],d=Object.create(null);for(let I=0,L;L=t[I];I++)if(!L.isNull()){var m=[L.isUiEvent?Ou:L.type,L.blockId,L.workspaceId].join(" "),b=d[m];const oe=b?b.event:null;b?L.type===gr&&b.index===I-1?(m=L,oe.newParentId=m.newParentId,oe.newInputName=m.newInputName,oe.newCoordinate=m.newCoordinate,b.index=I):L.type===Ui&&L.element===oe.element&&L.name===oe.name?oe.newValue=L.newValue:L.type===pl?(b=L,oe.viewTop=b.viewTop,oe.viewLeft=b.viewLeft,oe.scale=b.scale,oe.oldScale=b.oldScale):(L.type!==$o||oe.type!==Gn)&&(d[m]={event:L,index:I},a.push(L)):(d[m]={event:L,index:I},a.push(L))}t=a.filter(function(I){return!I.isNull()}),o||t.reverse();for(let I=1,L;L=t[I];I++)L.type===Ui&&L.element==="mutation"&&t.unshift(t.splice(I,1)[0]);return t},Ep=function(){for(let t=0,o;o=ma[t];t++)o.recordUndo=!1},Ci=function(){$m++},Oi=function(){$m--},Pi=function(){return $m===0},Kt=function(){return V$},He=function(t){ym.setGroupInternal(t)},AR=function(t){V$=typeof t=="boolean"?t?Ns():"":t},Ch=function(t){const o=[];t=t.getDescendants(!1);for(let a=0,d;d=t[a];a++)o[a]=d.id;return o},WT=function(t,o){var a=Le(t.type);if(!a)throw Error("Unknown event type.");return CR(a)?a.fromJson(t,o):(a=new a,a.fromJson(t),a.workspaceId=o.id,a)},CR=function(t){return Object.getOwnPropertyDescriptors(t).fromJson&&typeof t.fromJson=="function"},Le=function(t){const o=Ql(fe.EVENT,t);if(!o)throw Error(`Event type ${t} not found in registry.`);return o},$p=function(t){if((t.type===gr||t.type===Ji)&&t.workspaceId){var o=W(t.workspaceId);if(!t.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(t=o.getBlockById(t.blockId)){const a=Au;try{Au=!1;const d=t.getParent();if(d&&d.isEnabled()){const m=t.getDescendants(!1);for(let b=0,I;I=m[b];b++)I.setEnabled(!0)}else if((t.outputConnection||t.previousConnection)&&!o.isDragging())do t.setEnabled(!1),t=t.getNextBlock();while(t)}finally{Au=a}}}},OR=function(t){({document:gl=gl,DOMParser:fd=fd,XMLSerializer:pd=pd}=t)},wR=function(){return s("Blockly.utils.xml.getDocument","version 9","version 10"),gl},RR=function(t){s("Blockly.utils.xml.setDocument","version 9","version 10"),gl=t},Dt=function(t){return gl.createElementNS(Sm,t)},mo=function(t){return gl.createTextNode(t)},zT=function(t){return new fd().parseFromString(t,"text/xml")},YT=function(t){return new pd().serializeToString(t)},Oh=function(t,o){W$(t,o)},NR=function(t){W$=t},vp=function(t,o){X$.confirmInternal(t,o)},xR=function(t,o){z$(t,o)},DR=function(t){z$=t},yp=function(t,o,a){Y$(t,o,a)},LR=function(t){Y$=t},Sp=function(t){t=t.getAllBlocks(!1);const o=new Set;for(let a=0;a<t.length;a++){const d=t[a].getVarModels();if(d)for(let m=0;m<d.length;m++){const b=d[m];b.getId()&&o.add(b)}}return Array.from(o.values())},MR=function(t){t=t.getAllBlocks(!1);const o=new Set;for(let d=0,m;m=t[d];d++){var a=m.getDeveloperVariables;if(a){a=a();for(let b=0;b<a.length;b++)o.add(a[b])}}return Array.from(o.values())},Ip=function(t){let o=[];const a=document.createElement("button");return a.setAttribute("text","%{BKY_NEW_VARIABLE}"),a.setAttribute("callbackKey","CREATE_VARIABLE"),t.registerButtonCallback("CREATE_VARIABLE",function(d){Tu(d.getTargetWorkspace())}),o.push(a),t=XT(t),o=o.concat(t)},XT=function(t){t=t.getVariablesOfType("");const o=[];if(0<t.length){var a=t[t.length-1];if(Cr.variables_set){var d=Dt("block");d.setAttribute("type","variables_set"),d.setAttribute("gap",Cr.math_change?"8":"24"),d.appendChild(Zl(a)),o.push(d)}if(Cr.math_change&&(d=Dt("block"),d.setAttribute("type","math_change"),d.setAttribute("gap",Cr.variables_get?"20":"8"),d.appendChild(Zl(a)),a=mr('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),d.appendChild(a),o.push(d)),Cr.variables_get){t.sort(Bu.compareByName);for(let m=0,b;b=t[m];m++)a=Dt("block"),a.setAttribute("type","variables_get"),a.setAttribute("gap","8"),a.appendChild(Zl(b)),o.push(a)}}return o},jT=function(t){return Am.generateUniqueNameInternal(t)},BR=function(t){return kp(gd.charAt(0),t.getAllVariableNames())},kp=function(t,o){if(!o.length)return t;const a=gd;let d="",m=a.indexOf(t);for(;;){let b=!1;for(let I=0;I<o.length;I++)if(o[I].toLowerCase()===t){b=!0;break}if(!b)break;m++,m===a.length&&(m=0,d=`${Number(d)+1}`),t=a.charAt(m)+d}return t},Tu=function(t,o,a){function d(b){Ap(Ve.NEW_VARIABLE_TITLE,b,function(I){if(I){const L=qT(I,t);if(L){let oe;L.type===m?oe=Ve.VARIABLE_ALREADY_EXISTS.replace("%1",L.name):(oe=Ve.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,oe=oe.replace("%1",L.name).replace("%2",L.type)),Oh(oe,function(){d(I)})}else t.createVariable(I,m),o&&o(I)}else o&&o(null)})}const m=a||"";d("")},KT=function(t,o,a){function d(m){const b=Ve.RENAME_VARIABLE_TITLE.replace("%1",o.name);Ap(b,m,function(I){if(I){var L=PR(I,o.type,t);L?(L=Ve.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",L.name).replace("%2",L.type),Oh(L,function(){d(I)})):(t.renameVariableById(o.getId(),I),a&&a(I))}else a&&a(null)})}d("")},Ap=function(t,o,a){yp(t,o,function(d){d&&(d=d.replace(/[\s\xa0]+/g," ").trim(),d===Ve.RENAME_VARIABLE||d===Ve.NEW_VARIABLE)&&(d=null),a(d)})},PR=function(t,o,a){a=a.getVariableMap().getAllVariables(),t=t.toLowerCase();for(let d=0,m;m=a[d];d++)if(m.name.toLowerCase()===t&&m.type!==o)return m;return null},qT=function(t,o){o=o.getVariableMap().getAllVariables(),t=t.toLowerCase();for(let a=0,d;d=o[a];a++)if(d.name.toLowerCase()===t)return d;return null},Zl=function(t){const o=Dt("field");return o.setAttribute("name","VAR"),o.setAttribute("id",t.getId()),o.setAttribute("variabletype",t.type),t=mo(t.name),o.appendChild(t),o},wh=function(t,o,a,d){let m=Rh(t,o,a,d);return m||(m=FR(t,o,a,d)),m},Rh=function(t,o,a,d){const m=t.getPotentialVariableMap();let b=null;if(o&&(b=t.getVariableById(o),!b&&m&&(b=m.getVariableById(o)),b))return b;if(a){if(d===void 0)throw Error("Tried to look up a variable by name without a type");b=t.getVariable(a,d),!b&&m&&(b=m.getVariable(a,d))}return b},FR=function(t,o,a,d){const m=t.getPotentialVariableMap();return a||(a=jT(t.isFlyout?t.targetWorkspace:t)),m?m.createVariable(a,d,o):t.createVariable(a,d,o)},Cp=function(t,o){t=t.getAllVariables();const a=[];if(o.length!==t.length)for(let d=0;d<t.length;d++){const m=t[d];o.indexOf(m)===-1&&a.push(m)}return a},Ds=function(t){if(Om)throw Error("CSS already injected");wm+=`
`+t},JT=function(t,o){Om||(Om=!0,t&&(t=o.replace(/[\\/]$/,""),o=wm.replace(/<<<PATH>>>/g,t),wm="",t=document.createElement("style"),t.id="blockly-common-style",o=document.createTextNode(o),t.appendChild(o),document.head.insertBefore(t,document.head.firstChild)))},Ls=function(t){const o=new ve(0,0);var a=t.x&&t.getAttribute("x");const d=t.y&&t.getAttribute("y");return a&&(o.x=parseInt(a)),d&&(o.y=parseInt(d)),(a=(a=t.getAttribute("transform"))&&a.match(j$))&&(o.x+=Number(a[1]),a[3]&&(o.y+=Number(a[3]))),(t=t.getAttribute("style"))&&-1<t.indexOf("translate")&&(t=t.match(K$))&&(o.x+=Number(t[1]),t[3]&&(o.y+=Number(t[3]))),o},Nh=function(t){let o=0,a=0;for(;t;){const d=Ls(t);if(o+=d.x,a+=d.y,(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1)break;t=t.parentNode}return new ve(o,a)},QT=function(){return s("Blockly.utils.svgMath.is3dSupported","version 9","version 10"),!0},Op=function(){const t=nr();return new li(t.y,document.documentElement.clientHeight+t.y,t.x,document.documentElement.clientWidth+t.x)},wp=function(){const t=document.documentElement,o=window;return new ve(o.pageXOffset||t.scrollLeft,o.pageYOffset||t.scrollTop)},ZT=function(t,o){var a=o.x;o=o.y;const d=t.getInjectionDiv().getBoundingClientRect();return a=new ve(a-d.left,o-d.top),o=t.getOriginOffsetInPixels(),ve.difference(a,o).scale(1/t.scale)},UR=function(t,o){const a=Dt("xml");var d=eE(Sp(t));d.hasChildNodes()&&a.appendChild(d),d=t.getTopComments(!0);for(let m=0;m<d.length;m++)a.appendChild(d[m].toXmlWithXY(o));for(t=t.getTopBlocks(!0),d=0;d<t.length;d++)a.appendChild(xh(t[d],o));return a},eE=function(t){const o=Dt("variables");for(let a=0;a<t.length;a++){const d=t[a],m=Dt("variable");m.appendChild(mo(d.name)),d.type&&m.setAttribute("type",d.type),m.id=d.getId(),o.appendChild(m)}return o},xh=function(t,o){if(t.isInsertionMarker()&&(t=t.getChildren(!1)[0],!t))return new DocumentFragment;let a=0;t.workspace.RTL&&(a=t.workspace.getWidth()),o=nl(t,o);const d=t.getRelativeToSurfaceXY();return o.setAttribute("x",Math.round(t.workspace.RTL?a-d.x:d.x)),o.setAttribute("y",Math.round(d.y)),o},HR=function(t){if(t.isSerializable()){const o=Dt("field");return o.setAttribute("name",t.name||""),t.toXml(o)}return null},GR=function(t,o){for(let a=0;a<t.inputList.length;a++){const d=t.inputList[a];for(let m=0;m<d.fieldRow.length;m++){const b=HR(d.fieldRow[m]);b&&o.appendChild(b)}}},nl=function(t,o){if(t.isInsertionMarker())return(o=t.getChildren(!1)[0])?nl(o):new DocumentFragment;const a=Dt(t.isShadow()?"shadow":"block");if(a.setAttribute("type",t.type),o||a.setAttribute("id",t.id),t.mutationToDom){var d=t.mutationToDom();d&&(d.hasChildNodes()||d.hasAttributes())&&a.appendChild(d)}if(GR(t,a),d=t.getCommentText()){var m=t.commentModel.size,b=t.commentModel.pinned,I=Dt("comment");I.appendChild(mo(d)),I.setAttribute("pinned",b),I.setAttribute("h",m.height),I.setAttribute("w",m.width),a.appendChild(I)}for(t.data&&(d=Dt("data"),d.appendChild(mo(t.data)),a.appendChild(d)),d=0;d<t.inputList.length;d++){m=t.inputList[d];var L=void 0;if(b=!0,m.type!==it.DUMMY){I=m.connection.targetBlock(),m.type===it.VALUE?L=Dt("value"):m.type===it.STATEMENT&&(L=Dt("statement"));const ye=m.connection.getShadowDom();!ye||I&&I.isShadow()||L.appendChild(tE(ye,o)),I&&(I=nl(I,o),I.nodeType===sn.ELEMENT_NODE&&(L.appendChild(I),b=!1)),L.setAttribute("name",m.name),b||a.appendChild(L)}}t.inputsInline!==void 0&&t.inputsInline!==t.inputsInlineDefault&&a.setAttribute("inline",t.inputsInline.toString()),t.isCollapsed()&&a.setAttribute("collapsed","true"),t.isEnabled()||a.setAttribute("disabled","true"),t.isDeletable()||t.isShadow()||a.setAttribute("deletable","false"),t.isMovable()||t.isShadow()||a.setAttribute("movable","false"),t.isEditable()||a.setAttribute("editable","false"),L=t.getNextBlock();let oe;return L&&(d=nl(L,o),d.nodeType===sn.ELEMENT_NODE&&(oe=Dt("next"),oe.appendChild(d),a.appendChild(oe))),t=t.nextConnection&&t.nextConnection.getShadowDom(),!t||L&&L.isShadow()||oe.appendChild(tE(t,o)),a},tE=function(t,o){let a=t=t.cloneNode(!0),d;for(;a;)if(o&&a.nodeName==="shadow"&&a.removeAttribute("id"),a.firstChild)a=a.firstChild;else{for(;a&&!a.nextSibling;){d=a,a=a.parentNode;let m;d.nodeType===sn.TEXT_NODE&&d.data.trim()===""&&((m=a)==null?void 0:m.firstChild)!==d&&ft(d)}a&&(d=a,a=a.nextSibling,d.nodeType===sn.TEXT_NODE&&d.data.trim()===""&&ft(d))}return t},hs=function(t){return YT(t).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},VR=function(t){t=hs(t).split("<");let o="";for(let a=1;a<t.length;a++){const d=t[a];d[0]==="/"&&(o=o.substring(2)),t[a]=o+"<"+d,d[0]!=="/"&&d.slice(-2)!=="/>"&&(o+="  ")}return t=t.join(`
`),t=t.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>"),t.replace(/^\n/,"")},mr=function(t){const o=zT(t);if(!o||!o.documentElement||o.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+t);return o.documentElement},WR=function(t,o){return o.setResizesEnabled(!1),o.clear(),t=Eu(t,o),o.setResizesEnabled(!0),t},Eu=function(t,o){let a=0;o.RTL&&(a=o.getWidth());const d=[];Cs();const m=Kt();m||He(!0),o.setResizesEnabled&&o.setResizesEnabled(!1);let b=!0;try{for(let I=0,L;L=t.childNodes[I];I++){const oe=L.nodeName.toLowerCase(),ye=L;if(oe==="block"||oe==="shadow"&&!xs()){const yt=ea(ye,o);d.push(yt.id);const Jt=ye.hasAttribute("x")?parseInt(ye.getAttribute("x")):10,Qr=ye.hasAttribute("y")?parseInt(ye.getAttribute("y")):10;isNaN(Jt)||isNaN(Qr)||yt.moveBy(o.RTL?a-Jt:Jt,Qr),b=!1}else{if(oe==="shadow")throw TypeError("Shadow block cannot be a top-level block.");if(oe==="comment")o.rendered?ar.fromXmlRendered(ye,o,a):ln.fromXml(ye,o);else if(oe==="variables"){if(b)iE(ye,o);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");b=!1}}}}finally{m||He(!1),Os()}return o.setResizesEnabled&&o.setResizesEnabled(!0),De(new(Le(pa))(o)),d},zR=function(t,o){if(!o.getBlocksBoundingBox)return Eu(t,o);var a=o.getBlocksBoundingBox();if(t=Eu(t,o),a&&a.top!==a.bottom){var d=a.bottom;a=o.RTL?a.right:a.left;var m=1/0;let b=-1/0,I=1/0;for(let L=0;L<t.length;L++){const oe=o.getBlockById(t[L]).getRelativeToSurfaceXY();oe.y<I&&(I=oe.y),oe.x<m&&(m=oe.x),oe.x>b&&(b=oe.x)}for(d=d-I+10,a=o.RTL?a-b:a-m,m=0;m<t.length;m++)o.getBlockById(t[m]).moveBy(a,d)}return t},ea=function(t,o){Ci();var a=o.getAllVariables();let d;try{if(d=Rp(t,o),o.rendered){const m=d,b=d.getDescendants(!1);m.setConnectionTracking(!1);for(let I=b.length-1;0<=I;I--)b[I].initSvg();for(let I=b.length-1;0<=I;I--)b[I].render(!1);setTimeout(function(){m.disposed||m.setConnectionTracking(!0)},1),m.updateDisabled(),o.resizeContents()}else{const m=d.getDescendants(!1);for(let b=m.length-1;0<=b;b--)m[b].initModel()}}finally{Oi()}if(Pi()){for(t=Cp(o,a),o=0;o<t.length;o++)a=t[o],De(new(Le(fl))(a));De(new(Le(Ji))(d))}return d},iE=function(t,o){for(let a=0;a<t.children.length;a++){const d=t.children[a],m=d.getAttribute("type"),b=d.getAttribute("id");o.createVariable(d.textContent,m,b)}},YR=function(t){const o={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let a=0;a<t.children.length;a++){const d=t.children[a];if(d.nodeType!==sn.TEXT_NODE)switch(d.nodeName.toLowerCase()){case"mutation":o.mutation.push(d);break;case"comment":o.comment.push(d);break;case"data":o.data.push(d);break;case"title":case"field":o.field.push(d);break;case"value":case"statement":o.input.push(d);break;case"next":o.next.push(d);break;default:console.warn("Ignoring unknown tag: "+d.nodeName)}}return o},XR=function(t,o){let a=!1;for(let d=0;d<t.length;d++){const m=t[d];o.domToMutation&&(o.domToMutation(m),o.initSvg&&(a=!0))}return a},jR=function(t,o){for(let d=0;d<t.length;d++){var a=t[d];const m=a.textContent,b=a.getAttribute("pinned")==="true",I=parseInt(a.getAttribute("w"));if(a=parseInt(a.getAttribute("h")),o.setCommentText(m),o.commentModel.pinned=b,isNaN(I)||isNaN(a)||(o.commentModel.size=new Xi(I,a)),b&&o.getCommentIcon&&!o.isInFlyout){const L=o;setTimeout(function(){L.getCommentIcon().setVisible(!0)},1)}}},KR=function(t,o){for(let a=0;a<t.length;a++)o.data=t[a].textContent},qR=function(t,o){for(let a=0;a<t.length;a++){const d=t[a],m=d.getAttribute("name");ZR(o,m,d)}},rE=function(t){const o={childBlockElement:null,childShadowElement:null};for(let a=0;a<t.childNodes.length;a++){const d=t.childNodes[a];d.nodeType===sn.ELEMENT_NODE&&(d.nodeName.toLowerCase()==="block"?o.childBlockElement=d:d.nodeName.toLowerCase()==="shadow"&&(o.childShadowElement=d))}return o},JR=function(t,o,a,d){for(let b=0;b<t.length;b++){var m=t[b];const I=m.getAttribute("name"),L=a.getInput(I);if(!L){console.warn("Ignoring non-existent input "+I+" in block "+d);break}if(m=rE(m),m.childBlockElement){if(!L.connection)throw TypeError("Input connection does not exist.");Rp(m.childBlockElement,o,L.connection,!1)}if(m.childShadowElement){let oe;(oe=L.connection)==null||oe.setShadowDom(m.childShadowElement)}}},QR=function(t,o,a){for(let d=0;d<t.length;d++){const m=rE(t[d]);if(m.childBlockElement){if(!a.nextConnection)throw TypeError("Next statement does not exist.");if(a.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Rp(m.childBlockElement,o,a.nextConnection,!0)}m.childShadowElement&&a.nextConnection&&a.nextConnection.setShadowDom(m.childShadowElement)}},Rp=function(t,o,a,d){const m=t.getAttribute("type");if(!m)throw TypeError("Block type unspecified: "+t.outerHTML);var b=t.getAttribute("id");b=o.newBlock(m,b);const I=YR(t),L=XR(I.mutation,b);if(jR(I.comment,b),KR(I.data,b),a)if(d)if(b.previousConnection)a.connect(b.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(b.outputConnection)a.connect(b.outputConnection);else if(b.previousConnection)a.connect(b.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(qR(I.field,b),JR(I.input,o,b,m),QR(I.next,o,b),L&&b.initSvg(),(o=t.getAttribute("inline"))&&b.setInputsInline(o==="true"),(o=t.getAttribute("disabled"))&&b.setEnabled(o!=="true"&&o!=="disabled"),(o=t.getAttribute("deletable"))&&b.setDeletable(o==="true"),(o=t.getAttribute("movable"))&&b.setMovable(o==="true"),(o=t.getAttribute("editable"))&&b.setEditable(o==="true"),(o=t.getAttribute("collapsed"))&&b.setCollapsed(o==="true"),t.nodeName.toLowerCase()==="shadow"){for(t=b.getChildren(!1),o=0;o<t.length;o++)if(!t[o].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(b.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");b.setShadow(!0)}return b},ZR=function(t,o,a){const d=t.getField(o);d?d.fromXml(a):console.warn("Ignoring non-existent field "+o+" in block "+t.type)},e3=function(t){for(let o=0;o<t.childNodes.length;o++){const a=t.childNodes[o];if(a.nodeName.toLowerCase()==="next"){t.removeChild(a);break}}},t3=function(t,o){return s("Blockly.utils.string.startsWith()","April 2022","April 2023","Use built-in string.startsWith"),t.startsWith(o)},Dh=function(t){return t.length?t.reduce(function(o,a){return o.length<a.length?o:a}).length:0},sE=function(t,o){if(!t.length)return 0;if(t.length===1)return t[0].length;let a=0;o=o||Dh(t);let d;for(d=0;d<o;d++){for(var m=t[0][d],b=1;b<t.length;b++)if(m!==t[b][d])return a;m===" "&&(a=d+1)}for(m=1;m<t.length;m++)if((b=t[m][d])&&b!==" ")return a;return o},nE=function(t,o){if(!t.length)return 0;if(t.length===1)return t[0].length;let a=0;o=o||Dh(t);let d;for(d=0;d<o;d++){for(var m=t[0].substr(-d-1,1),b=1;b<t.length;b++)if(m!==t[b].substr(-d-1,1))return a;m===" "&&(a=d+1)}for(m=1;m<t.length;m++)if((b=t[m].charAt(t[m].length-d-1))&&b!==" ")return a;return o},oE=function(t,o){t=t.split(`
`);for(let a=0;a<t.length;a++)t[a]=i3(t[a],o);return t.join(`
`)},i3=function(t,o){if(t.length<=o)return t;const a=t.trim().split(/\s+/);for(var d=0;d<a.length;d++)a[d].length>o&&(o=a[d].length);var m=-1/0;let b,I=1;do{d=m,b=t,t=[],m=a.length/I;let L=1;for(let oe=0;oe<a.length-1;oe++)L<(oe+1.5)/m?(L++,t[oe]=!0):t[oe]=!1;t=lE(a,t,o),m=Np(a,t,o),t=r3(a,t),I++}while(m>d);return b},Np=function(t,o,a){const d=[0],m=[];for(var b=0;b<t.length;b++)d[d.length-1]+=t[b].length,o[b]===!0?(d.push(0),m.push(t[b].charAt(t[b].length-1))):o[b]===!1&&d[d.length-1]++;for(t=Math.max(...d),o=0,b=0;b<d.length;b++)o-=2*Math.pow(Math.abs(a-d[b]),1.5),o-=Math.pow(t-d[b],1.5),".?!".indexOf(m[b])!==-1?o+=a/3:",;)]}".indexOf(m[b])!==-1&&(o+=a/4);return 1<d.length&&d[d.length-1]<=d[d.length-2]&&(o+=.5),o},lE=function(t,o,a){let d=Np(t,o,a),m;for(let b=0;b<o.length-1;b++){if(o[b]===o[b+1])continue;const I=[].concat(o);I[b]=!I[b],I[b+1]=!I[b+1];const L=Np(t,I,a);L>d&&(d=L,m=I)}return m?lE(t,m,a):o},r3=function(t,o){const a=[];for(let d=0;d<t.length;d++)a.push(t[d]),o[d]!==void 0&&a.push(o[d]?`
`:" ");return a.join("")},aE=function(t){return/^\s*-?\d+(\.\d+)?\s*$/.test(t)},s3=function(t){bd=t},n3=function(){return bd},o3=function(){return Fu},l3=function(){return Ti},$u=function(t){if(t=uE(t)){for(t=t.tooltip;typeof t=="function";)t=t();if(typeof t!="string")throw Error("Tooltip function must return a string.");return t}return""},uE=function(t){for(;t&&t.tooltip;){if(typeof t.tooltip=="string"||typeof t.tooltip=="function")return t;t=t.tooltip}return null},cE=function(){Ti||(Ti=document.createElement("div"),Ti.className="blocklyTooltipDiv",(At()||document.body).appendChild(Ti))},Lh=function(t){t.mouseOverWrapper_=R(t,"pointerover",null,a3),t.mouseOutWrapper_=R(t,"pointerout",null,u3),t.addEventListener("pointermove",hE,!1)},Mh=function(t){t&&(C(t.mouseOverWrapper_),C(t.mouseOutWrapper_),t.removeEventListener("pointermove",hE))},a3=function(t){_a||(t=uE(t.currentTarget),fs!==t&&(ol(),Hu=null,fs=t),clearTimeout(J$))},u3=function(t){_a||(J$=setTimeout(function(){Hu=fs=null,ol()},1),clearTimeout(Uu))},hE=function(t){if(fs&&fs.tooltip&&!_a)if(Fu){const o=Nm-t.pageX;t=xm-t.pageY,Math.sqrt(o*o+t*t)>Q$&&ol()}else Hu!==fs&&(clearTimeout(Uu),Nm=t.pageX,xm=t.pageY,Uu=setTimeout(f3,Z$))},dE=function(){Hu=fs=null,ol()},ol=function(){Fu&&(Fu=!1,Ti&&(Ti.style.display="none")),Uu&&clearTimeout(Uu)},fE=function(){ol(),_a=!0},pE=function(){_a=!1},c3=function(){Ti&&fs&&(typeof bd=="function"?bd(Ti,fs):h3())},h3=function(){var t=$u(fs);t=oE(t,q$),t=t.split(`
`);for(let o=0;o<t.length;o++){const a=document.createElement("div");a.appendChild(document.createTextNode(t[o])),Ti.appendChild(a)}},d3=function(t){const o=document.documentElement.clientWidth,a=document.documentElement.clientHeight;let d=Nm;d=t?d-(Dm+Ti.offsetWidth):d+Dm;let m=xm+Lm;return m+Ti.offsetHeight>a+window.scrollY&&(m-=Ti.offsetHeight+2*Lm),t?d=Math.max(Td-window.scrollX,d):d+Ti.offsetWidth>o+window.scrollX-2*Td&&(d=o-Ti.offsetWidth-2*Td),{x:d,y:m}},f3=function(){if(!_a&&(Hu=fs,Ti)){Ti.textContent="",c3();var t=fs.RTL;Ti.style.direction=t?"rtl":"ltr",Ti.style.display="block",Fu=!0;var{x:o,y:a}=d3(t);Ti.style.left=o+"px",Ti.style.top=a+"px"}},mE=function(){return Mm},p3=function(t){Mm=t},gE=function(){return Bm},m3=function(t){Bm=t},ll=function(t){t=String(t).toLowerCase().trim();var o=ev[t];if(o||(o=t.substring(0,2)==="0x"?"#"+t.substring(2):t,o=o[0]==="#"?o:"#"+o,/^#[0-9a-f]{6}$/.test(o)))return o;if(/^#[0-9a-f]{3}$/.test(o))return["#",o[1],o[1],o[2],o[2],o[3],o[3]].join("");var a=t.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return a&&(t=Number(a[1]),o=Number(a[2]),a=Number(a[3]),0<=t&&256>t&&0<=o&&256>o&&0<=a&&256>a)?Bh(t,o,a):null},Bh=function(t,o,a){return o=t<<16|o<<8|a,16>t?"#"+(16777216|o).toString(16).substr(1):"#"+o.toString(16)},xp=function(t){return t=ll(t),t?(t=parseInt(t.substr(1),16),[t>>16,t>>8&255,t&255]):[0,0,0]},Dp=function(t,o,a){let d=0,m=0,b=0;if(o===0)b=m=d=a;else{const I=Math.floor(t/60),L=t/60-I;t=a*(1-o);const oe=a*(1-o*L);switch(o=a*(1-o*(1-L)),I){case 1:d=oe,m=a,b=t;break;case 2:d=t,m=a,b=o;break;case 3:d=t,m=oe,b=a;break;case 4:d=o,m=t,b=a;break;case 5:d=a,m=t,b=oe;break;case 6:case 0:d=a,m=o,b=t}}return Bh(Math.floor(d),Math.floor(m),Math.floor(b))},ta=function(t,o,a){return t=ll(t),!t||(o=ll(o),!o)?null:(t=xp(t),o=xp(o),Bh(Math.round(o[0]+a*(t[0]-o[0])),Math.round(o[1]+a*(t[1]-o[1])),Math.round(o[2]+a*(t[2]-o[2]))))},Lp=function(t){return Dp(t,Mm,255*Bm)},Mp=function(t,o){const a=[];var d=t.split("");d.push("");var m=0;t=[];let b=null;for(let oe=0;oe<d.length;oe++){var I=d[oe];if(m===0)I==="%"?((m=t.join(""))&&a.push(m),t.length=0,m=1):t.push(I);else if(m===1)I==="%"?(t.push(I),m=0):o&&"0"<=I&&"9">=I?(m=2,b=I,(I=t.join(""))&&a.push(I),t.length=0):I==="{"?m=3:(t.push("%",I),m=0);else if(m===2)if("0"<=I&&"9">=I)b+=I;else{var L=void 0;a.push(parseInt((L=b)!=null?L:"",10)),oe--,m=0}else m===3&&(I===""?(t.splice(0,0,"%{"),oe--,m=0):I!=="}"?t.push(I):(m=t.join(""),/[A-Z]\w*/i.test(m)?(I=m.toUpperCase(),(I=I.startsWith("BKY_")?I.substring(4):null)&&I in Ve?(m=Ve[I],typeof m=="string"?Array.prototype.push.apply(a,Mp(m,o)):o?a.push(String(m)):a.push(m)):a.push("%{"+m+"}")):a.push("%{"+m+"}"),m=t.length=0))}for((o=t.join(""))&&a.push(o),L=[],t.length=0,d=0;d<a.length;d++)typeof a[d]=="string"?t.push(a[d]):((o=t.join(""))&&L.push(o),t.length=0,L.push(a[d]));return(o=t.join(""))&&L.push(o),t.length=0,L},Bp=function(t){return Mp(t,!0)},oi=function(t){return typeof t!="string"?t:(t=Mp(t,!1),t.length?String(t[0]):"")},Ph=function(t){let o=!0;const a=Ve,d=t.match(/%{BKY_[A-Z]\w*}/ig);if(d)for(let m=0;m<d.length;m++){const b=d[m].toUpperCase();a[b.slice(6,-1)]===void 0&&(console.warn("No message string for "+d[m]+" in "+t),o=!1)}return o},ia=function(t){const o=typeof t=="string"?oi(t):t;var a=Number(o);if(!isNaN(a)&&0<=a&&360>=a)return{hue:a,hex:Dp(a,mE(),255*gE())};if(a=ll(o))return{hue:null,hex:a};throw a='Invalid colour: "'+o+'"',t!==o&&(a+=' (from "'+t+'")'),Error(a)},ra=function(){return Us},g3=function(t){Us=t},_E=function(){Us||(Us=document.createElement("div"),Us.className="blocklyWidgetDiv",(At()||document.body).appendChild(Us))},Pp=function(t,o,a){tn(),Ed=t,$d=a,(t=Us)&&(t.style.direction=o?"rtl":"ltr",t.style.display="block",o=re(),ba=o.getRenderer().getClassName(),Ta=o.getTheme().getClassName(),ba&&Ce(t,ba),Ta&&Ce(t,Ta))},tn=function(){if(bE()){Ed=null;var t=Us;t&&(t.style.display="none",t.style.left="",t.style.top="",$d&&$d(),$d=null,t.textContent="",ba&&(qe(t,ba),ba=""),Ta&&(qe(t,Ta),Ta=""),re().markFocused())}},bE=function(){return!!Ed},Fp=function(t){Ed===t&&tn()},TE=function(t,o,a){Us.style.left=t+"px",Us.style.top=o+"px",Us.style.height=a+"px"},EE=function(t,o,a,d){const m=b3(t,o,a);t=_3(t,o,a,d),0>m?TE(t,0,a.height+m):TE(t,m,a.height)},_3=function(t,o,a,d){return d?Math.min(Math.max(o.right-a.width,t.left),t.right-a.width):Math.max(Math.min(o.left,t.right-a.width),t.left)},b3=function(t,o,a){return o.bottom+a.height>=t.bottom?o.top-a.height:o.bottom},ds=function(t,o){tt(fe.FIELD,t,o)},T3=function(t){Ih(fe.FIELD,t)},Up=function(t){return tv.fromJsonInternal(t)},E3=function(t){const o=kh(fe.FIELD,t.type);if(o){if(typeof o.fromJson!="function")throw new TypeError("returned Field was not a IRegistrableField");return o.fromJson(t)}return console.warn("Blockly could not create a field of type "+t.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null},rn=function(t,o){t.setAttribute(mN,o)},ti=function(t,o,a){Array.isArray(a)&&(a=a.join(" ")),t.setAttribute(pN+o,`${a}`)},$3=function(t){return t!==pt.SKIP_SETUP},v3=function(t){let o=!1;const a=t.map(([I,L])=>typeof I=="string"?[oi(I),L]:(o=!0,[I.alt!==null?Object.assign({},I,{alt:oi(I.alt)}):Object.assign({},I),L]));if(o||2>t.length)return{options:a};var d=a.map(([I])=>I),m=Dh(d);t=sE(d,m);const b=nE(d,m);return!t&&!b||m<=t+b?{options:a}:(m=t?d[0].substring(0,t-1):void 0,d=b?d[0].substr(1-b):void 0,{options:y3(a,t,b),prefix:m,suffix:d})},y3=function(t,o,a){return t.map(([d,m])=>[d.substring(o,d.length-a),m])},$E=function(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");let o=!1;for(let a=0;a<t.length;a++){const d=t[a];Array.isArray(d)?typeof d[1]!="string"?(o=!0,console.error("Invalid option["+a+"]: Each FieldDropdown option id must be a string. Found "+d[1]+" in: ",d)):d[0]&&typeof d[0]!="string"&&typeof d[0].src!="string"&&(o=!0,console.error("Invalid option["+a+"]: Each FieldDropdown option must have a string label or image description. Found"+d[0]+" in: ",d)):(o=!0,console.error("Invalid option["+a+"]: Each FieldDropdown option must be an array. Found: ",d))}if(o)throw TypeError("Found invalid FieldDropdown options.")},S3=function(t,o){s("Blockly.utils.object.inherits","version 9","version 10"),t.superClass_=o.prototype,Object.setPrototypeOf(t,o),t.prototype=Object.create(o.prototype),t.prototype.constructor=t},I3=function(t,o){s("Blockly.utils.object.mixin","May 2022","May 2023","Object.assign");for(const a in o)t[a]=o[a]},go=function(t,o){for(const a in o)t[a]=o[a]!==null&&typeof o[a]=="object"?go(t[a]||Object.create(null),o[a]):o[a];return t},k3=function(t){return s("Blockly.utils.object.values","version 9","version 10","Object.values"),Object.values(t)},Fh=function(t){return t?((t instanceof Element||typeof t=="string")&&(t=yE(t),t=O3(t)),A3(t),t):null},A3=function(t){const o=t.kind;if(t=t.contents,o&&o!==rv&&o!==Vm)throw Error("Invalid toolbox kind "+o+". Please supply either "+rv+" or "+Vm);if(!t)throw Error("Toolbox must have a contents attribute.")},Uh=function(t){return t?t.contents?t.contents:Array.isArray(t)&&0<t.length&&!t[0].nodeType?t:Vp(t):[]},Hp=function(t){return sv.hasCategoriesInternal(t)},C3=function(t){if(!t)return!1;const o=t.kind;return o?o===Vm:!!t.contents.filter(function(a){return a.kind.toUpperCase()==="CATEGORY"}).length},Gp=function(t){return t&&t.contents?!!t.contents.filter(function(o){return o.kind.toUpperCase()==="CATEGORY"}).length:!1},O3=function(t){const o={contents:Vp(t)};return t instanceof Node&&vE(t,o),o},Vp=function(t){const o=[];let a=t.childNodes;a||(a=t);for(let d=0,m;m=a[d];d++){if(!m.tagName)continue;t={};const b=m.tagName.toUpperCase();t.kind=b,b==="BLOCK"?t.blockxml=m:m.childNodes&&0<m.childNodes.length&&(t.contents=Vp(m)),vE(m,t),o.push(t)}return o},vE=function(t,o){for(let a=0;a<t.attributes.length;a++){const d=t.attributes[a];-1<d.nodeName.indexOf("css-")?(o.cssconfig=o.cssconfig||{},o.cssconfig[d.nodeName.replace("css-","")]=d.value):o[d.nodeName]=d.value}},yE=function(t){let o=null;if(t)if(typeof t=="string"){if(o=mr(t),o.nodeName.toLowerCase()!=="xml")throw TypeError("Toolbox should be an <xml> document.")}else t instanceof Element&&(o=t);return o},Hh=function(t,o){if(typeof t!="string"||t.trim()==="")throw Error('Error: Invalid extension name "'+t+'"');if(Ea[t])throw Error('Error: Extension "'+t+'" is already registered.');if(typeof o!="function")throw Error('Error: Extension "'+t+'" must be a function');Ea[t]=o},w3=function(t,o){if(!o||typeof o!="object")throw Error('Error: Mixin "'+t+'" must be a object');Hh(t,function(){this.mixin(o)})},R3=function(t,o,a,d){const m='Error when registering mutator "'+t+'": ';kE(m,o);const b=IE(o,m);if(a&&typeof a!="function")throw Error(m+'Extension "'+t+'" is not a function');Hh(t,function(){b&&this.setMutator(new i.Mutator$$module$build$src$core$mutator(d||[],this)),this.mixin(o),a&&a.apply(this)})},N3=function(t){SE(t)?delete Ea[t]:console.warn('No extension mapping for name "'+t+'" found to unregister')},SE=function(t){return!!Ea[t]},Wp=function(t,o,a){const d=Ea[t];if(typeof d!="function")throw Error('Error: Extension "'+t+'" not found.');let m;if(a?x3(t,o):m=Yp(o),d.apply(o),a)kE('Error after applying mutator "'+t+'": ',o);else if(!M3(m,o))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},x3=function(t,o){if(Yp(o).length)throw Error('Error: tried to apply mutation "'+t+'" to a block that already has mutator functions.  Block id: '+o.id)},D3=function(t,o){return zp(t.mutationToDom,t.domToMutation,o+" mutationToDom/domToMutation")},L3=function(t,o){return zp(t.saveExtraState,t.loadExtraState,o+" saveExtraState/loadExtraState")},IE=function(t,o){return zp(t.compose,t.decompose,o+" compose/decompose")},zp=function(t,o,a){if(t&&o){if(typeof t!="function"||typeof o!="function")throw Error(a+" must be a function");return!0}if(!t&&!o)return!1;throw Error(a+"Must have both or neither functions")},kE=function(t,o){const a=D3(o,t),d=L3(o,t);if(!a&&!d)throw Error(t+"Mutations must contain either XML hooks, or JSON hooks, or both");IE(o,t)},Yp=function(t){const o=[];return t.domToMutation!==void 0&&o.push(t.domToMutation),t.mutationToDom!==void 0&&o.push(t.mutationToDom),t.saveExtraState!==void 0&&o.push(t.saveExtraState),t.loadExtraState!==void 0&&o.push(t.loadExtraState),t.compose!==void 0&&o.push(t.compose),t.decompose!==void 0&&o.push(t.decompose),o},M3=function(t,o){if(o=Yp(o),o.length!==t.length)return!1;for(let a=0;a<o.length;a++)if(t[a]!==o[a])return!1;return!0},Gh=function(t){if(typeof document!="object")throw Error("runAfterPageLoad() requires browser document.");if(document.readyState==="complete")t();else{const o=setInterval(function(){document.readyState==="complete"&&(clearInterval(o),t())},10)}},B3=function(t,o){const a=[];return typeof document=="object"&&Gh(function(){for(const d in o)Ph(o[d])}),function(){this.type&&a.indexOf(this.type)===-1&&(P3(this,t,o),a.push(this.type)),this.setTooltip(function(){var d=String(this.getFieldValue(t));let m=o[d];return m===null?a.indexOf(this.type)===-1&&(d="No tooltip mapping for value "+d+" of field "+t,this.type!==null&&(d+=" of block type "+this.type),console.warn(d+".")):m=oi(m),m}.bind(this))}},P3=function(t,o,a){var d=t.getField(o);if(d instanceof Gs&&!d.isOptionListDynamic()){d=d.getOptions();for(let m=0;m<d.length;m++){const b=d[m][1];a[b]===null&&console.warn("No tooltip mapping for value "+b+" of field "+o+" of block type "+t.type)}}},F3=function(t,o){return typeof document=="object"&&Gh(function(){Ph(t)}),function(){this.setTooltip(function(){const a=this.getField(o);return oi(t).replace("%1",a?a.getText():"")}.bind(this))}},U3=function(){const t=this.tooltip;this.setTooltip(function(){const o=this.getParent();return o&&o.getInputsInline()&&o.tooltip||t}.bind(this))},kr=function(t,o){return o=t.indexOf(o),o===-1?!1:(t.splice(o,1),!0)},Me=function(t,o){return" "+t+","+o+" "},Yr=function(t,o){return" "+t+o.join("")},lr=function(t,o){return" M "+t+","+o+" "},qt=function(t,o){return" m "+t+","+o+" "},Bn=function(t,o){return" l "+t+","+o+" "},vu=function(t){return" l"+t.join("")},ke=function(t,o){return" "+t+" "+o+" "},bi=function(t,o,a,d){return t+" "+a+" "+a+" "+o+d},H3=function(t){return s("Blockly.utils.getRelativeXY","December 2021","December 2022","Blockly.utils.svgMath.getRelativeXY"),Ls(t)},G3=function(t){return s("Blockly.utils.getInjectionDivXY_","December 2021","December 2022","Blockly.utils.svgMath.getInjectionDivXY"),Nh(t)},V3=function(t){return s("Blockly.utils.tokenizeInterpolation","December 2021","December 2022","Blockly.utils.parsing.tokenizeInterpolation"),Bp(t)},W3=function(t){return s("Blockly.utils.replaceMessageReferences","December 2021","December 2022","Blockly.utils.parsing.replaceMessageReferences"),oi(t)},z3=function(t){return s("Blockly.utils.checkMessageReferences","December 2021","December 2022","Blockly.utils.parsing.checkMessageReferences"),Ph(t)},Y3=function(){return s("Blockly.utils.is3dSupported","December 2021","December 2022","Blockly.utils.svgMath.is3dSupported"),QT()},X3=function(){return s("Blockly.utils.getViewportBBox","December 2021","December 2022","Blockly.utils.svgMath.getViewportBBox"),Op()},j3=function(t,o){return s("Blockly.utils.arrayRemove","December 2021","December 2022","Blockly.array.removeElem"),kr(t,o)},K3=function(){return s("Blockly.utils.getDocumentScroll","December 2021","December 2022","Blockly.utils.svgMath.getDocumentScroll"),wp()},q3=function(t,o){return s("Blockly.utils.getBlockTypeCounts","December 2021","December 2022","Blockly.common.getBlockTypeCounts"),we(t,o)},J3=function(t,o){return s("Blockly.utils.screenToWsCoordinates","December 2021","December 2022","Blockly.utils.svgMath.screenToWsCoordinates"),ZT(t,o)},Q3=function(t){return s("Blockly.utils.parseBlockColour","December 2021","December 2022","Blockly.utils.parsing.parseBlockColour"),ia(t)},Z3=function(t){s("Blockly.utils.runAfterPageLoad","December 2021","December 2022"),Gh(t)},Xp=function(t,o){tt(fe.SERIALIZER,t,o)},e6=function(t){Ih(fe.SERIALIZER,t)},Pn=function(t,{addCoordinates:o=!1,addInputBlocks:a=!0,addNextBlocks:d=!0,doFullSerialization:m=!0}={}){if(t.isInsertionMarker())return null;const b={type:t.type,id:t.id};return o&&i6(t,b),t6(t,b),r6(t,b),s6(t,b),n6(t,b,m),a&&o6(t,b,m),d&&l6(t,b,m),b},t6=function(t,o){t.isCollapsed()&&(o.collapsed=!0),t.isEnabled()||(o.enabled=!1),t.inputsInline!==void 0&&t.inputsInline!==t.inputsInlineDefault&&(o.inline=t.inputsInline),t.data&&(o.data=t.data)},i6=function(t,o){const a=t.workspace;t=t.getRelativeToSurfaceXY(),o.x=Math.round(a.RTL?a.getWidth()-t.x:t.x),o.y=Math.round(t.y)},r6=function(t,o){t.saveExtraState?(t=t.saveExtraState(),t!==null&&(o.extraState=t)):t.mutationToDom&&(t=t.mutationToDom(),t!==null&&(o.extraState=hs(t).replace(' xmlns="https://developers.google.com/blockly/xml"',"")))},s6=function(t,o){t.getCommentText()&&(o.icons={comment:{text:t.getCommentText(),pinned:t.commentModel.pinned,height:Math.round(t.commentModel.size.height),width:Math.round(t.commentModel.size.width)}})},n6=function(t,o,a){const d=Object.create(null);for(let m=0;m<t.inputList.length;m++){const b=t.inputList[m];for(let I=0;I<b.fieldRow.length;I++){const L=b.fieldRow[I];L.isSerializable()&&(d[L.name]=L.saveState(a))}}Object.keys(d).length&&(o.fields=d)},o6=function(t,o,a){const d=Object.create(null);for(let m=0;m<t.inputList.length;m++){const b=t.inputList[m];if(b.type===it.DUMMY)continue;const I=AE(b.connection,a);I&&(d[b.name]=I)}Object.keys(d).length&&(o.inputs=d)},l6=function(t,o,a){t.nextConnection&&(t=AE(t.nextConnection,a))&&(o.next=t)},AE=function(t,o){const a=t.getShadowState(!0);if(t=t.targetBlock(),!a&&!t)return null;const d=Object.create(null);return a&&(d.shadow=a),t&&!t.isShadow()&&(d.block=Pn(t,{doFullSerialization:o})),d},al=function(t,o,{recordUndo:a=!1}={}){return jp(t,o,{recordUndo:a})},jp=function(t,o,{parentConnection:a,isShadow:d=!1,recordUndo:m=!1}={}){const b=xs();zr(m),(m=Kt())||He(!0),Ci();const I=CE(t,o,{parentConnection:a,isShadow:d});return Oi(),De(new(Le(Ji))(I)),He(m),zr(b),o.rendered&&setTimeout(()=>{I.disposed||I.setConnectionTracking(!0)},1),I},CE=function(t,o,{parentConnection:a,isShadow:d=!1}={}){if(!t.type)throw new lv(t);const m=o.newBlock(t.type,t.id);return m.setShadow(d),a6(m,t),u6(m,t),c6(m,t),h6(a,m,t),d6(m,t),f6(m,t),p6(m,t),m6(m,t),g6(m,o.rendered),m},a6=function(t,o){let a=o.x===void 0?0:o.x;o=o.y===void 0?0:o.y;const d=t.workspace;a=d.RTL?d.getWidth()-a:a,t.moveBy(a,o)},u6=function(t,o){o.collapsed&&t.setCollapsed(!0),o.enabled===!1&&t.setEnabled(!1),o.inline!==void 0&&t.setInputsInline(o.inline),o.data!==void 0&&(t.data=o.data)},c6=function(t,o){o.extraState&&(t.loadExtraState?t.loadExtraState(o.extraState):t.domToMutation&&t.domToMutation(mr(o.extraState)))},h6=function(t,o,a){if(t){if(t.getSourceBlock().isShadow()&&!o.isShadow())throw new uv(a);if(t.type===it.VALUE){var d=o.outputConnection;if(!d)throw new Xu("output",o,a)}else if(d=o.previousConnection,!d)throw new Xu("previous",o,a);if(!t.connect(d)){const m=o.workspace.connectionChecker;throw new av(m.getErrorMessage(m.canConnectWithReason(d,t,!1),d,t),t.type===it.VALUE?"output connection":"previous connection",o,a)}}},d6=function(t,o){o.icons&&(o=o.icons.comment)&&(t.setCommentText(o.text),"pinned"in o&&(t.commentModel.pinned=o.pinned),"width"in o&&"height"in o&&(t.commentModel.size=new Xi(o.width,o.height)),o.pinned&&t.rendered&&!t.isInFlyout&&setTimeout(()=>t.getCommentIcon().setVisible(!0),1))},f6=function(t,o){if(o.fields){var a=Object.keys(o.fields);for(let d=0;d<a.length;d++){const m=a[d],b=o.fields[m],I=t.getField(m);I?I.loadState(b):console.warn(`Ignoring non-existant field ${m} in block ${t.type}`)}}},p6=function(t,o){if(o.inputs){var a=Object.keys(o.inputs);for(let d=0;d<a.length;d++){const m=a[d],b=t.getInput(m);if(!b||!b.connection)throw new Xu(m,t,o);OE(b.connection,o.inputs[m])}}},m6=function(t,o){if(o.next){if(!t.nextConnection)throw new Xu("next",t,o);OE(t.nextConnection,o.next)}},OE=function(t,o){o.shadow&&t.setShadowState(o.shadow),o.block&&CE(o.block,t.getSourceBlock().workspace,{parentConnection:t})},g6=function(t,o){if(o)for(t.setConnectionTracking(!1),t.initSvg(),t.render(!1),t=t.getIcons(),o=0;o<t.length;o++)t[o].computeIconLocation();else t.initModel()},_6=function(t,o){if(!t||!o)throw Error("Cannot connect null connections.");t.targetConnection=o,o.targetConnection=t},b6=function(t,o){let a=null;o=o.outputConnection;const d=o.getConnectionChecker();for(let m=0,b;b=t.inputList[m];m++){const I=b.connection;if(I&&d.canConnect(o,I,!1)){if(a)return null;a=I}}return a},T6=function(t,o){let a;for(;a=b6(t,o);)if(t=a.targetBlock(),!t||t.isShadow())return a;return null},Vh=function(t){let o=t.outputConnection;return(!o||t.previousConnection&&t.previousConnection.isConnected())&&(o=t.previousConnection),o},wE=function(t){const o=t.workspace;var a=t.getSvgRoot();o.getAudioManager().play("delete");const d=o.getSvgXY(a);a=a.cloneNode(!0),a.setAttribute("transform","translate("+d.x+","+d.y+")"),o.getParentSvg().appendChild(a),RE(a,{x:d.x,y:d.y,width:t.width,height:t.height},o.RTL,new Date,o.scale)},RE=function(t,o,a,d,m){const b=(new Date().getTime()-d.getTime())/150;1<b?ft(t):(t.setAttribute("transform","translate("+(o.x+(a?-1:1)*o.width*m/2*b)+","+(o.y+o.height*m*b)+") scale("+(1-b)*m+")"),setTimeout(RE,10,t,o,a,d,m))},NE=function(t){const o=t.workspace,a=o.scale;if(o.getAudioManager().play("click"),!(1>a)){var d=o.getSvgXY(t.getSvgRoot());t.outputConnection?(d.x+=(t.RTL?3:-3)*a,d.y+=13*a):t.previousConnection&&(d.x+=(t.RTL?-23:23)*a,d.y+=3*a),t=z(G.CIRCLE,{cx:d.x,cy:d.y,r:0,fill:"none",stroke:"#888","stroke-width":10},o.getParentSvg()),xE(t,new Date,a)}},xE=function(t,o,a){const d=(new Date().getTime()-o.getTime())/150;1<d?ft(t):(t.setAttribute("r",(25*d*a).toString()),t.style.opacity=(1-d).toString(),Id=setTimeout(xE,10,t,o,a))},DE=function(t){if(yu(),t.workspace.getAudioManager().play("disconnect"),!(1>t.workspace.scale)){var o=t.getHeightWidth().height;o=Math.atan(10/o)/Math.PI*180,t.RTL||(o*=-1),Ju=t.getSvgRoot(),LE(Ju,o,new Date)}},LE=function(t,o,a){const d=(new Date().getTime()-a.getTime())/200;let m="";1>=d&&(m=`skewX(${Math.round(Math.sin(d*Math.PI*3)*(1-d)*o)})`,Id=setTimeout(LE,10,t,o,a)),t.skew_=m,t.setAttribute("transform",t.translate_+t.skew_)},yu=function(){if(Ju){Id&&clearTimeout(Id);const t=Ju;t.skew_="",t.setAttribute("transform",t.translate_),Ju=null}},Su=function(t){qm.copyInternal(t)},E6=function(t){Yn=t.toCopyData()},Kp=function(){if(!Yn)return null;let t=Yn.source;return t.isFlyout&&(t=t.targetWorkspace),Yn.typeCounts&&t.isCapacityAvailable(Yn.typeCounts)?t.paste(Yn.saveInfo):null},Wh=function(t){return qm.duplicateInternal(t)},$6=function(t){const o=Yn;Su(t);let a,d,m;return t=(m=(a=t.toCopyData())==null||(d=a.source)==null?void 0:d.paste(Yn.saveInfo))!=null?m:null,Yn=o,t},ME=function(){return ec},BE=function(t){ec=t},zh=function(t,o,a){if(Pp(Jm,a,PE),o.length){var d=v6(o,a);tc=d,y6(d,t,a),setTimeout(function(){d.focus()},1),ec=null}else Yh()},v6=function(t,o){const a=new Pm;a.setRole(Rr.MENU);for(let d=0;d<t.length;d++){const m=t[d],b=new Fm(m.text);b.setRightToLeft(o),b.setRole(Rr.MENUITEM),a.addChild(b),b.setEnabled(m.enabled),m.enabled&&b.onAction(function(){Yh(),m.callback(m.scope)},{})}return a},y6=function(t,o,a){const d=Op();o=new li(o.clientY+d.top,o.clientY+d.top,o.clientX+d.left,o.clientX+d.left),S6(t);const m=t.getSize();a&&(o.left+=m.width,o.right+=m.width,d.left+=m.width,d.right+=m.width),EE(d,o,m,a),t.focus()},S6=function(t){var o=ra();if(!o)throw Error("Attempting to create a context menu when widget div is null");o=t.render(o),Ce(o,"blocklyContextMenu"),y(o,"contextmenu",null,I6),t.focus()},I6=function(t){t.preventDefault(),t.stopPropagation()},Yh=function(){Fp(Jm),ec=null},PE=function(){tc&&(tc.dispose(),tc=null)},k6=function(t,o){return()=>{Ci();let a;try{a=ea(o,t.workspace);const d=t.getRelativeToSurfaceXY();d.x=t.RTL?d.x-i.config$$module$build$src$core$config.snapRadius:d.x+i.config$$module$build$src$core$config.snapRadius,d.y+=2*i.config$$module$build$src$core$config.snapRadius,a.moveBy(d.x,d.y)}finally{Oi()}Pi()&&!a.isShadow()&&De(new(Le(Ji))(a)),a.select()}},FE=function(t){return{text:Ve.REMOVE_COMMENT,enabled:!0,callback:function(){He(!0),t.dispose(),He(!1)}}},UE=function(t){return{text:Ve.DUPLICATE_COMMENT,enabled:!0,callback:function(){Wh(t)}}},A6=function(t,o){const a={enabled:!0};return a.text=Ve.ADD_COMMENT,a.callback=function(){const d=new ar(t,Ve.WORKSPACE_COMMENT_DEFAULT_TEXT,ar.DEFAULT_SIZE,ar.DEFAULT_SIZE);var m=t.getInjectionDiv().getBoundingClientRect();m=new ve(o.clientX-m.left,o.clientY-m.top);const b=t.getOriginOffsetInPixels();m=ve.difference(m,b),m.scale(1/t.scale),d.moveBy(m.x,m.y),t.rendered&&(d.initSvg(),d.render(),d.select())},a},qp=function(t,o,a,d,m,b){const I=b.scrollbar&&b.scrollbar.canScrollVertically();return t.horizontal===Sa.LEFT?(a=m.absoluteMetrics.left+a,I&&b.RTL&&(a+=ii.scrollbarThickness)):(a=m.absoluteMetrics.left+m.viewMetrics.width-o.width-a,I&&!b.RTL&&(a-=ii.scrollbarThickness)),t.vertical===Xn.TOP?t=m.absoluteMetrics.top+d:(t=m.absoluteMetrics.top+m.viewMetrics.height-o.height-d,b.scrollbar&&b.scrollbar.canScrollHorizontally()&&(t-=ii.scrollbarThickness)),new li(t,t+o.height,a,a+o.width)},Jp=function(t,o){return{horizontal:o.toolboxMetrics.position===Je.LEFT||t.horizontalLayout&&!t.RTL?Sa.RIGHT:Sa.LEFT,vertical:o.toolboxMetrics.position===Je.BOTTOM?Xn.TOP:Xn.BOTTOM}},Qp=function(t,o,a,d){const m=t.left,b=t.right-t.left,I=t.bottom-t.top;for(let L=0;L<d.length;L++){const oe=d[L];t.intersects(oe)&&(t=a===So.UP?oe.top-I-o:oe.bottom+o,t=new li(t,t+I,m,m+b),L=-1)}return t},HE=function(){Lt.registry.register({name:un.ESCAPE,preconditionFn(t){return!t.options.readOnly},callback(t){return t.hideChaff(),!0},keyCodes:[Re.ESC]})},GE=function(){Lt.registry.register({name:un.DELETE,preconditionFn(t){const o=_e();return!t.options.readOnly&&o!=null&&o.isDeletable()},callback(t,o){return o.preventDefault(),an.inProgress()?!1:(_e().checkAndDelete(),!0)},keyCodes:[Re.DELETE,Re.BACKSPACE]})},VE=function(){const t=Lt.registry.createSerializedKey(Re.C,[Re.CTRL]),o=Lt.registry.createSerializedKey(Re.C,[Re.ALT]),a=Lt.registry.createSerializedKey(Re.C,[Re.META]);Lt.registry.register({name:un.COPY,preconditionFn(d){const m=_e();return!d.options.readOnly&&!an.inProgress()&&m!=null&&m.isDeletable()&&m.isMovable()},callback(d,m){return m.preventDefault(),d.hideChaff(),Su(_e()),!0},keyCodes:[t,o,a]})},WE=function(){const t=Lt.registry.createSerializedKey(Re.X,[Re.CTRL]),o=Lt.registry.createSerializedKey(Re.X,[Re.ALT]),a=Lt.registry.createSerializedKey(Re.X,[Re.META]);Lt.registry.register({name:un.CUT,preconditionFn(d){const m=_e();return!d.options.readOnly&&!an.inProgress()&&m!=null&&m instanceof ps&&m.isDeletable()&&m.isMovable()&&!m.workspace.isFlyout},callback(){const d=_e();return d?(Su(d),d.checkAndDelete(),!0):!1},keyCodes:[t,o,a]})},zE=function(){const t=Lt.registry.createSerializedKey(Re.V,[Re.CTRL]),o=Lt.registry.createSerializedKey(Re.V,[Re.ALT]),a=Lt.registry.createSerializedKey(Re.V,[Re.META]);Lt.registry.register({name:un.PASTE,preconditionFn(d){return!d.options.readOnly&&!an.inProgress()},callback(){return!!Kp()},keyCodes:[t,o,a]})},YE=function(){const t=Lt.registry.createSerializedKey(Re.Z,[Re.CTRL]),o=Lt.registry.createSerializedKey(Re.Z,[Re.ALT]),a=Lt.registry.createSerializedKey(Re.Z,[Re.META]);Lt.registry.register({name:un.UNDO,preconditionFn(d){return!d.options.readOnly&&!an.inProgress()},callback(d){return d.hideChaff(),d.undo(!1),!0},keyCodes:[t,o,a]})},XE=function(){const t=Lt.registry.createSerializedKey(Re.Z,[Re.SHIFT,Re.CTRL]),o=Lt.registry.createSerializedKey(Re.Z,[Re.SHIFT,Re.ALT]),a=Lt.registry.createSerializedKey(Re.Z,[Re.SHIFT,Re.META]),d=Lt.registry.createSerializedKey(Re.Y,[Re.CTRL]);Lt.registry.register({name:un.REDO,preconditionFn(m){return!an.inProgress()&&!m.options.readOnly},callback(m){return m.hideChaff(),m.undo(!0),!0},keyCodes:[t,o,a,d]})},jE=function(){HE(),GE(),VE(),WE(),zE(),YE(),XE()},sa=function(t){return t.startPublishing!==void 0&&t.stopPublishing!==void 0},C6=function(t){return t.doProcedureUpdate!==void 0},_o=function(t){for(const o of t.getAllBlocks(!1))C6(o)&&o.doProcedureUpdate()},Zp=function(t){const o=t.getBlocksByType("procedures_defnoreturn",!1).map(function(a){return a.getProcedureDef()});return t=t.getBlocksByType("procedures_defreturn",!1).map(function(a){return a.getProcedureDef()}),o.sort(KE),t.sort(KE),[o,t]},KE=function(t,o){return t[0].localeCompare(o[0],void 0,{sensitivity:"base"})},qE=function(t,o){if(o.isInFlyout)return t;for(t=t||Ve.UNNAMED_KEY||"unnamed";!O6(t,o.workspace,o);){const a=t.match(/^(.*?)(\d+)$/);t=a?a[1]+(parseInt(a[2])+1):t+"2"}return t},O6=function(t,o,a){return!JE(t,o,a)},JE=function(t,o,a){o=o.getAllBlocks(!1);for(let m=0;m<o.length;m++)if(o[m]!==a){var d=o[m];if(d.getProcedureDef&&(d=d.getProcedureDef(),ms.equals(d[0],t)))return!0}return!1},w6=function(t){var o=this.getSourceBlock();if(!o)throw new Ei;t=t.trim();const a=qE(t,o),d=this.getValue();if(d!==t&&d!==a)for(t=o.workspace.getAllBlocks(!1),o=0;o<t.length;o++){const m=t[o];m.renameProcedure&&m.renameProcedure(d,a)}return a},em=function(t){function o(b,I){for(let oe=0;oe<b.length;oe++){var L=b[oe][0];const ye=b[oe][1],yt=Dt("block");yt.setAttribute("type",I),yt.setAttribute("gap","16");const Jt=Dt("mutation");for(Jt.setAttribute("name",L),yt.appendChild(Jt),L=0;L<ye.length;L++){const Qr=Dt("arg");Qr.setAttribute("name",ye[L]),Jt.appendChild(Qr)}a.push(yt)}}const a=[];if(Cr.procedures_defnoreturn){var d=Dt("block");d.setAttribute("type","procedures_defnoreturn"),d.setAttribute("gap","16");var m=Dt("field");m.setAttribute("name","NAME"),m.appendChild(mo(Ve.PROCEDURES_DEFNORETURN_PROCEDURE)),d.appendChild(m),a.push(d)}return Cr.procedures_defreturn&&(d=Dt("block"),d.setAttribute("type","procedures_defreturn"),d.setAttribute("gap","16"),m=Dt("field"),m.setAttribute("name","NAME"),m.appendChild(mo(Ve.PROCEDURES_DEFRETURN_PROCEDURE)),d.appendChild(m),a.push(d)),Cr.procedures_ifreturn&&(d=Dt("block"),d.setAttribute("type","procedures_ifreturn"),d.setAttribute("gap","16"),a.push(d)),a.length&&a[a.length-1].setAttribute("gap","24"),t=Zp(t),o(t[0],"procedures_callnoreturn"),o(t[1],"procedures_callreturn"),a},QE=function(t){var o=[],a=t.getBlocksByType("procedures_mutatorarg",!1);for(let b=0,I;I=a[b];b++)o.push(I.getFieldValue("NAME"));a=Dt("xml");const d=Dt("block");d.setAttribute("type","procedures_mutatorarg");const m=Dt("field");m.setAttribute("name","NAME"),o=kp(dg,o),o=mo(o),m.appendChild(o),d.appendChild(m),a.appendChild(d),t.updateToolbox(a)},ZE=function(t){if(t.type===Gn&&t.bubbleType==="mutator"&&t.isOpen&&t.blockId){t=W(t.workspaceId).getBlockById(t.blockId);var o=t.type;(o==="procedures_defnoreturn"||o==="procedures_defreturn")&&(t=t.mutator.getWorkspace(),QE(t),t.addChangeListener(R6))}},R6=function(t){(t.type===Ji||t.type===on||t.type===Ui)&&(t=W(t.workspaceId),QE(t))},e$=function(t,o){const a=[];o=o.getAllBlocks(!1);for(let m=0;m<o.length;m++){var d=o[m];d.getProcedureCall&&(d=d.getProcedureCall())&&ms.equals(d,t)&&a.push(o[m])}return a},N6=function(t){const o=xs();var a=t.getProcedureDef()[0];const d=t.mutationToDom(!0);t=e$(a,t.workspace);for(let b=0,I;I=t[b];b++){a=(a=I.mutationToDom())&&hs(a),I.domToMutation&&I.domToMutation(d);var m=I.mutationToDom();m=m&&hs(m),a!==m&&(zr(!1),De(new(Le(Ui))(I,"mutation",null,a,m)),zr(o))}},x6=function(t,o){o=o.getAllBlocks(!1);for(let d=0;d<o.length;d++){var a=o[d];if(a.getProcedureDef&&(a=a.getProcedureDef())&&ms.equals(a[0],t))return o[d]}return null},t$=function(t){return t.isDynamic},Xh=function(){return Dv},D6=function(){s("Blockly.blockRendering.debug.stopDebugger()","version 8","version 10","the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)"),Dv=!1},Iu=function(t,o){tt(fe.RENDERER,t,o)},L6=function(t){Ih(fe.RENDERER,t)},M6=function(){s("Blockly.blockRendering.stopDebugger()","September 2021","September 2022","the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)"),D6()},i$=function(t,o,a){return t=new(Ql(fe.RENDERER,t))(t),t.init(o,a),t},r$=function(t){Tu(t.getTargetWorkspace(),void 0,"String")},s$=function(t){Tu(t.getTargetWorkspace(),void 0,"Number")},n$=function(t){Tu(t.getTargetWorkspace(),void 0,"Colour")},tm=function(t){let o=[],a=document.createElement("button");return a.setAttribute("text",Ve.NEW_STRING_VARIABLE),a.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),o.push(a),a=document.createElement("button"),a.setAttribute("text",Ve.NEW_NUMBER_VARIABLE),a.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),o.push(a),a=document.createElement("button"),a.setAttribute("text",Ve.NEW_COLOUR_VARIABLE),a.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),o.push(a),t.registerButtonCallback("CREATE_VARIABLE_STRING",r$),t.registerButtonCallback("CREATE_VARIABLE_NUMBER",s$),t.registerButtonCallback("CREATE_VARIABLE_COLOUR",n$),t=o$(t),o=o.concat(t)},o$=function(t){t=t.getAllVariables();const o=[];if(0<t.length){if(Cr.variables_set_dynamic){var a=t[t.length-1];const d=Dt("block");d.setAttribute("type","variables_set_dynamic"),d.setAttribute("gap","24"),d.appendChild(Zl(a)),o.push(d)}if(Cr.variables_get_dynamic){t.sort(Bu.compareByName);for(let d=0,m;m=t[d];d++)a=Dt("block"),a.setAttribute("type","variables_get_dynamic"),a.setAttribute("gap","8"),a.appendChild(Zl(m)),o.push(a)}}return o},B6=function(t){t.resizeContents()},P6=function(t){const o=Object.create(null),a=Tp(fe.SERIALIZER,!0);for(const d in a){let m;const b=(m=a[d])==null?void 0:m.save(t);b&&(o[d]=b)}return o},F6=function(t,o,{recordUndo:a=!1}={}){var d=Tp(fe.SERIALIZER,!0);if(d){d=Object.entries(d).sort((b,I)=>I[1].priority-b[1].priority);var m=xs();zr(a),(a=Kt())||He(!0),Cs(),o instanceof zs&&o.setResizesEnabled(!1);for(const[,b]of d.reverse()){let I;(I=b)==null||I.clear(o)}for(let[b,I]of d.reverse())if(t[b]){let L;(L=I)==null||L.load(t[b],o)}o instanceof zs&&o.setResizesEnabled(!0),Os(),De(new(Le(pa))(o)),He(a),zr(m)}},im=function(t){const o={id:t.getId(),name:t.getName(),returnTypes:t.getReturnTypes()};return t.getParameters().length&&(o.parameters=t.getParameters().map(a=>rm(a))),o},rm=function(t){const o={id:t.getId(),name:t.getName()};return t.getTypes().length&&(o.types=t.getTypes()),o},sm=function(t,o,a,d){if(t=new t(d,a.name,a.id).setReturnTypes(a.returnTypes),!a.parameters)return t;for(const[m,b]of a.parameters.entries())t.insertParameter(nm(o,b,d),m);return t},nm=function(t,o,a){return t=new t(a,o.name,o.id),o.types&&t.setTypes(o.types),t},jh=function(t,o,a){const d=a.getBoundingRectangle(),m=d.right-d.left,b=us(o.top,d.top,o.top+o.height-(d.bottom-d.top))-d.top;let I=o.left;return o=o.left+o.width-m,t.RTL?I=Math.min(o,I):o=Math.max(I,o),(t=us(I,d.left,o)-d.left)||b?(a.moveBy(t,b),!0):!1},l$=function(t){return o=>{var a=t.getMetricsManager();if(a.hasFixedEdges()&&!t.isDragging()){var d;if(vm.indexOf((d=o.type)!=null?d:"")!==-1){d=a.getScrollMetrics(!0);const m=U6(t,o);m&&(a=Kt(),He(o.group),jh(t,d,m)&&!o.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),a!==null&&He(a))}else o.type===pl&&o.scale&&o.oldScale&&o.scale>o.oldScale&&om(t)}}},U6=function(t,o){let a=null;switch(o.type){case Ji:case gr:(a=t.getBlockById(o.blockId))&&(a=a.getRootBlock());break;case ml:case Vn:a=t.getCommentById(o.commentId)}return a},om=function(t){var o=t.getMetricsManager();if(o.hasFixedEdges()&&!t.isDragging()){o=o.getScrollMetrics(!0);var a=t.getTopBoundedElements();for(let d=0,m;m=a[d];d++)jh(t,o,m)}},H6=function(t,o){if(typeof t=="string"&&(t=document.getElementById(t)||document.querySelector(t)),!t||!ls(document,t))throw Error("Error: container is not in current document.");o=new Vs(o||{});const a=document.createElement("div");a.className="injectionDiv",a.tabIndex=0,ti(a,Yt.LABEL,Ve.WORKSPACE_ARIA_LABEL),t.appendChild(a),t=G6(a,o);const d=new m2(a),m=new p2(a),b=V6(t,o,d,m);return W6(b),Y(b),je(b),a.addEventListener("focusin",function(){Y(b)}),b},G6=function(t,o){t.setAttribute("dir","LTR"),JT(o.hasCss,o.pathToMedia),t=z(G.SVG,{xmlns:la,"xmlns:html":Ms,"xmlns:xlink":Or,version:"1.1",class:"blocklySvg",tabindex:"0"},t);const a=z(G.DEFS,{},t),d=String(Math.random()).substring(2);return o.gridPattern=hg.createDom(d,o.gridOptions,a),t},V6=function(t,o,a,d){o.parentWorkspace=null,o=new zs(o,a,d),a=o.options,o.scale=a.zoomOptions.startScale,t.appendChild(o.createDom("blocklyMainBackground")),d=o.getInjectionDiv();var m=o.getRenderer().getClassName();return m&&Ce(d,m),(m=o.getTheme().getClassName())&&Ce(d,m),!a.hasCategories&&a.languageTree&&(d=o.addFlyout(G.SVG),pi(d,t)),a.hasTrashcan&&o.addTrashcan(),a.zoomOptions&&a.zoomOptions.controls&&o.addZoomControls(),o.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),o.translate(0,0),o.addChangeListener(l$(o)),je(o),_E(),vh(),cE(),o},W6=function(t){const o=t.options;var a=t.getParentSvg();if(y(a.parentNode,"contextmenu",null,function(d){x(d)||d.preventDefault()}),a=y(window,"resize",null,function(){t.hideChaff(!0),je(t),om(t)}),t.setResizeHandlerWrapper(a),Y6(),o.languageTree){a=t.getToolbox();const d=t.getFlyout(!0);a?a.init():d&&(d.init(t),d.show(o.languageTree),typeof d.scrollToStart=="function"&&d.scrollToStart())}o.hasTrashcan&&t.trashcan.init(),o.zoomOptions&&o.zoomOptions.controls&&t.zoomControls_.init(),o.moveOptions&&o.moveOptions.scrollbars?(t.scrollbar=new Ag(t,o.moveOptions.scrollbars===!0||!!o.moveOptions.scrollbars.horizontal,o.moveOptions.scrollbars===!0||!!o.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),t.scrollbar.resize()):t.setMetrics({x:.5,y:.5}),o.hasSounds&&X6(o.pathToMedia,t)},z6=function(t){const o=re();o&&!(x(t)||o.rendered&&!o.isVisible())&&Lt.registry.onKeyDown(o,t)},Y6=function(){g2||(y(document,"scroll",null,function(){const t=ne();for(let o=0,a;a=t[o];o++)a instanceof zs&&a.updateInverseScreenCTM()}),y(document,"keydown",null,z6),R(document,"touchend",null,l),R(document,"touchcancel",null,l),na&&y(window,"orientationchange",document,function(){je(re())})),g2=!0},X6=function(t,o){function a(){for(;m.length;)C(m.pop());d.preload()}const d=o.getAudioManager();d.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),d.load([t+"disconnect.wav",t+"disconnect.mp3",t+"disconnect.ogg"],"disconnect"),d.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");const m=[];m.push(y(document,"pointermove",null,a,!0)),m.push(y(document,"touchstart",null,a,!0))},a$=function(t,o,a){if(t=t.getProcedureMap().get(o),!t)throw Error("Cannot rename the parameter of a procedure that does not exist in the procedure map");return t.getParameters().find(d=>d.getId()===a)},u$=function(){wt.registry.register({displayText(){return Ve.UNDO},preconditionFn(t){return 0<t.workspace.getUndoStack().length?"enabled":"disabled"},callback(t){t.workspace.undo(!1)},scopeType:wt.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},c$=function(){wt.registry.register({displayText(){return Ve.REDO},preconditionFn(t){return 0<t.workspace.getRedoStack().length?"enabled":"disabled"},callback(t){t.workspace.undo(!0)},scopeType:wt.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},h$=function(){wt.registry.register({displayText(){return Ve.CLEAN_UP},preconditionFn(t){return t.workspace.isMovable()?1<t.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback(t){t.workspace.cleanUp()},scopeType:wt.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},d$=function(t,o){function a(b){m--,b.setCollapsed(t),m===0&&He(!1)}let d=0,m=0;He(!0);for(let b=0;b<o.length;b++){let I=o[b];for(;I;)m++,setTimeout(a.bind(null,I),d),I=I.getNextBlock(),d+=10}},f$=function(){wt.registry.register({displayText(){return Ve.COLLAPSE_ALL},preconditionFn(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(let o=0;o<t.length;o++){let a=t[o];for(;a;){if(!a.isCollapsed())return"enabled";a=a.getNextBlock()}}return"disabled"}return"hidden"},callback(t){d$(!0,t.workspace.getTopBlocks(!0))},scopeType:wt.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},p$=function(){wt.registry.register({displayText(){return Ve.EXPAND_ALL},preconditionFn(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(let o=0;o<t.length;o++){let a=t[o];for(;a;){if(a.isCollapsed())return"enabled";a=a.getNextBlock()}}return"disabled"}return"hidden"},callback(t){d$(!1,t.workspace.getTopBlocks(!0))},scopeType:wt.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},m$=function(t,o){if(t.isDeletable())Array.prototype.push.apply(o,t.getDescendants(!1));else{t=t.getChildren(!1);for(let a=0;a<t.length;a++)m$(t[a],o)}},lm=function(t){const o=[];t=t.getTopBlocks(!0);for(let a=0;a<t.length;a++)m$(t[a],o);return o},Kh=function(t,o){He(o);const a=t.shift();a&&(a.isDeadOrDying()?Kh(t,o):(a.dispose(!1,!0),setTimeout(Kh,10,t,o))),He(!1)},g$=function(){wt.registry.register({displayText(t){return t.workspace?(t=lm(t.workspace).length,t===1?Ve.DELETE_BLOCK:Ve.DELETE_X_BLOCKS.replace("%1",String(t))):""},preconditionFn(t){return t.workspace&&0<lm(t.workspace).length?"enabled":"disabled"},callback(t){if(t.workspace){t.workspace.cancelCurrentGesture();var o=lm(t.workspace),a=Ns();2>o.length?Kh(o,a):vp(Ve.DELETE_ALL_BLOCKS.replace("%1",String(o.length)),function(d){d&&Kh(o,a)})}},scopeType:wt.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},j6=function(){u$(),c$(),h$(),f$(),p$(),g$()},_$=function(){wt.registry.register({displayText(){return Ve.DUPLICATE_BLOCK},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.isDeletable()&&t.isMovable()?t.isDuplicatable()?"enabled":"disabled":"hidden"},callback(t){t.block&&Wh(t.block)},scopeType:wt.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},b$=function(){wt.registry.register({displayText(t){return t.block.getCommentIcon()?Ve.REMOVE_COMMENT:Ve.ADD_COMMENT},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.workspace.options.comments&&!t.isCollapsed()&&t.isEditable()?"enabled":"hidden"},callback(t){t=t.block,t.getCommentIcon()?t.setCommentText(null):t.setCommentText("")},scopeType:wt.ScopeType.BLOCK,id:"blockComment",weight:2})},T$=function(){wt.registry.register({displayText(t){return t.block.getInputsInline()?Ve.EXTERNAL_INPUTS:Ve.INLINE_INPUTS},preconditionFn(t){if(t=t.block,!t.isInFlyout&&t.isMovable()&&!t.isCollapsed()){for(let o=1;o<t.inputList.length;o++)if(t.inputList[o-1].type!==it.STATEMENT&&t.inputList[o].type!==it.STATEMENT)return"enabled"}return"hidden"},callback(t){t.block.setInputsInline(!t.block.getInputsInline())},scopeType:wt.ScopeType.BLOCK,id:"blockInline",weight:3})},E$=function(){wt.registry.register({displayText(t){return t.block.isCollapsed()?Ve.EXPAND_BLOCK:Ve.COLLAPSE_BLOCK},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden"},callback(t){t.block.setCollapsed(!t.block.isCollapsed())},scopeType:wt.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},$$=function(){wt.registry.register({displayText(t){return t.block.isEnabled()?Ve.DISABLE_BLOCK:Ve.ENABLE_BLOCK},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.workspace.options.disable&&t.isEditable()?t.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback(t){t=t.block;const o=Kt();o||He(!0),t.setEnabled(!t.isEnabled()),o||He(!1)},scopeType:wt.ScopeType.BLOCK,id:"blockDisable",weight:5})},v$=function(){wt.registry.register({displayText(t){var o=t.block;return t=o.getDescendants(!1).length,(o=o.getNextBlock())&&(t-=o.getDescendants(!1).length),t===1?Ve.DELETE_BLOCK:Ve.DELETE_X_BLOCKS.replace("%1",String(t))},preconditionFn(t){return!t.block.isInFlyout&&t.block.isDeletable()?"enabled":"hidden"},callback(t){t.block&&t.block.checkAndDelete()},scopeType:wt.ScopeType.BLOCK,id:"blockDelete",weight:6})},y$=function(){wt.registry.register({displayText(){return Ve.HELP},preconditionFn(t){return t=t.block,(typeof t.helpUrl=="function"?t.helpUrl():t.helpUrl)?"enabled":"hidden"},callback(t){t.block.showHelp()},scopeType:wt.ScopeType.BLOCK,id:"blockHelp",weight:7})},K6=function(){_$(),b$(),T$(),E$(),$$(),v$(),y$()},S$=function(){j6(),K6()},q6=function(t){const o=[];t=t.getDescendants(!1);for(let a=0,d;d=t[a];a++){const m=d.getIcons();for(let b=0;b<m.length;b++){const I={location:m[b].getIconLocation(),icon:m[b]};o.push(I)}}return o},J6=function(t){re().hideChaff(t)},Q6=function(t){s("Blockly.resizeSvgContents","December 2021","December 2022","Blockly.WorkspaceSvg.resizeSvgContents"),B6(t)},Z6=function(t){s("Blockly.copy","December 2021","December 2022","Blockly.clipboard.copy"),Su(t)},eN=function(){return s("Blockly.paste","December 2021","December 2022","Blockly.clipboard.paste"),!!Kp()},tN=function(t){s("Blockly.duplicate","December 2021","December 2022","Blockly.clipboard.duplicate"),Wh(t)},iN=function(t){return s("Blockly.isNumber","December 2021","December 2022","Blockly.utils.string.isNumber"),aE(t)},rN=function(t){return s("Blockly.hueToHex","December 2021","December 2022","Blockly.utils.colour.hueToHex"),Lp(t)},sN=function(t,o,a,d){return s("Blockly.bindEvent_","December 2021","December 2022","Blockly.browserEvents.bind"),R(t,o,a,d)},nN=function(t){return s("Blockly.unbindEvent_","December 2021","December 2022","Blockly.browserEvents.unbind"),C(t)},oN=function(t,o,a,d,m,b){return s("Blockly.bindEventWithChecks_","December 2021","December 2022","Blockly.browserEvents.conditionalBind"),y(t,o,a,d,m)},Ue=Ue||{};Ue.scope={},Ue.ASSUME_ES5=!1,Ue.ASSUME_NO_NATIVE_MAP=!1,Ue.ASSUME_NO_NATIVE_SET=!1,Ue.SIMPLE_FROUND_POLYFILL=!1,Ue.ISOLATE_POLYFILLS=!1,Ue.FORCE_POLYFILL_PROMISE=!1,Ue.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,Ue.defineProperty=Ue.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(t,o,a){return t==Array.prototype||t==Object.prototype||(t[o]=a.value),t},Ue.getGlobal=function(t){t=[typeof globalThis=="object"&&globalThis,t,typeof window=="object"&&window,typeof self=="object"&&self,typeof ys=="object"&&ys];for(var o=0;o<t.length;++o){var a=t[o];if(a&&a.Math==Math)return a}throw Error("Cannot find global object")},Ue.global=Ue.getGlobal(this),Ue.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",Ue.TRUST_ES6_POLYFILLS=!Ue.ISOLATE_POLYFILLS||Ue.IS_SYMBOL_NATIVE,Ue.polyfills={},Ue.propertyToPolyfillSymbol={},Ue.POLYFILL_PREFIX="$jscp$",Ue.polyfill=function(t,o,a,d){o&&(Ue.ISOLATE_POLYFILLS?Ue.polyfillIsolated(t,o,a,d):Ue.polyfillUnisolated(t,o,a,d))},Ue.polyfillUnisolated=function(t,o,a,d){for(a=Ue.global,t=t.split("."),d=0;d<t.length-1;d++){var m=t[d];if(!(m in a))return;a=a[m]}t=t[t.length-1],d=a[t],o=o(d),o!=d&&o!=null&&Ue.defineProperty(a,t,{configurable:!0,writable:!0,value:o})},Ue.polyfillIsolated=function(t,o,a,d){var m=t.split(".");t=m.length===1,d=m[0],d=!t&&d in Ue.polyfills?Ue.polyfills:Ue.global;for(var b=0;b<m.length-1;b++){var I=m[b];if(!(I in d))return;d=d[I]}m=m[m.length-1],a=Ue.IS_SYMBOL_NATIVE&&a==="es6"?d[m]:null,o=o(a),o!=null&&(t?Ue.defineProperty(Ue.polyfills,m,{configurable:!0,writable:!0,value:o}):o!==a&&(Ue.propertyToPolyfillSymbol[m]===void 0&&(a=1e9*Math.random()>>>0,Ue.propertyToPolyfillSymbol[m]=Ue.IS_SYMBOL_NATIVE?Ue.global.Symbol(m):Ue.POLYFILL_PREFIX+a+"$"+m),Ue.defineProperty(d,Ue.propertyToPolyfillSymbol[m],{configurable:!0,writable:!0,value:o})))},Ue.polyfill("globalThis",function(t){return t||Ue.global},"es_2020","es3"),Ue.polyfill("Object.getOwnPropertyDescriptors",function(t){return t||function(o){for(var a={},d=Reflect.ownKeys(o),m=0;m<d.length;m++)a[d[m]]=Object.getOwnPropertyDescriptor(o,d[m]);return a}},"es8","es5"),Ue.arrayIteratorImpl=function(t){var o=0;return function(){return o<t.length?{done:!1,value:t[o++]}:{done:!0}}},Ue.arrayIterator=function(t){return{next:Ue.arrayIteratorImpl(t)}},Ue.initSymbol=function(){},Ue.iteratorPrototype=function(t){return t={next:t},t[Symbol.iterator]=function(){return this},t},Ue.iteratorFromArray=function(t,o){t instanceof String&&(t+="");var a=0,d=!1,m={next:function(){if(!d&&a<t.length){var b=a++;return{value:o(b,t[b]),done:!1}}return d=!0,{done:!0,value:void 0}}};return m[Symbol.iterator]=function(){return m},m},Ue.polyfill("Array.prototype.values",function(t){return t||function(){return Ue.iteratorFromArray(this,function(o,a){return a})}},"es8","es3"),Ue.owns=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},Ue.polyfill("Object.values",function(t){return t||function(o){var a=[],d;for(d in o)Ue.owns(o,d)&&a.push(o[d]);return a}},"es8","es3"),Ue.polyfill("Array.prototype.flat",function(t){return t||function(o){o=o===void 0?1:o;for(var a=[],d=0;d<this.length;d++){var m=this[d];Array.isArray(m)&&0<o?(m=Array.prototype.flat.call(m,o-1),a.push.apply(a,m)):a.push(m)}return a}},"es9","es5"),Ue.polyfill("Object.entries",function(t){return t||function(o){var a=[],d;for(d in o)Ue.owns(o,d)&&a.push([d,o[d]]);return a}},"es8","es3");var Ar=Ar||{};Ar.global=globalThis||root,Ar.define=function(t,o){return o},Ar.DEBUG=!1,Ar.DISALLOW_TEST_ONLY_CODE=!Ar.DEBUG,Ar.provide=function(t){},Ar.module=function(t){},Ar.module.get=function(t){},Ar.module.declareLegacyNamespace=function(){},Ar.setTestOnly=function(t){if(Ar.DISALLOW_TEST_ONLY_CODE)throw t=t||"",Error("Importing test-only code into non-debug environment"+(t?": "+t:"."))},Ar.require=function(t){},Ar.requireType=function(t){};var Fi={};Fi.warn=s;var lN=750,I$="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),qh=null,ul={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},Jh=0,Xr={};Xr.TOUCH_ENABLED=I$,Xr.TOUCH_MAP=ul,Xr.checkTouchIdentifier=f,Xr.clearTouchIdentifier=u,Xr.getTouchIdentifierFromEvent=h,Xr.isMouseOrTouchEvent=g,Xr.isTouchEvent=T,Xr.longStart=n,Xr.longStop=l,Xr.setClientFromTouch=p,Xr.shouldHandleEvent=c,Xr.splitEventByTouches=$;var am,k$,A$,C$,Qh,Zh,um,O$,w$,R$;(function(t){function o(d){return a.indexOf(d.toUpperCase())!==-1}am=t;const a=am.toUpperCase();k$=o("JavaFX"),A$=o("WebKit"),C$=o("Gecko")&&!A$,Qh=o("Android"),t=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Zh=o("iPad")||o("Macintosh")&&0<t,um=o("iPhone")&&!Zh,O$=o("Macintosh"),w$=Zh||Qh&&!o("Mobile")||o("Silk"),R$=!w$&&(um||Qh)})(globalThis.navigator&&globalThis.navigator.userAgent||"");var aN=am,N$=k$,cm=C$,ed=Qh,na=Zh,x$=um,hm=O$,dm=R$,Fn={};Fn.ANDROID=ed,Fn.GECKO=cm,Fn.IPAD=na,Fn.IPHONE=x$,Fn.JavaFx=N$,Fn.MAC=hm,Fn.MOBILE=dm,Fn.raw=aN;var D$=40,L$=125,Un={};Un.bind=R,Un.conditionalBind=y,Un.getScrollDeltaPixels=q,Un.isRightButton=j,Un.isTargetInput=x,Un.mouseToSvg=F,Un.unbind=C;var Cr=Object.create(null),oa,M$,fm,B$,cl,pm;oa=Object.create(null),fm=null,cl=[],pm={defineBlocksWithJsonArrayInternal:It},i.module$build$src$core$common={},i.module$build$src$core$common.TEST_ONLY=pm,i.module$build$src$core$common.createBlockDefinitionsFromJsonArray=bt,i.module$build$src$core$common.defineBlocks=ei,i.module$build$src$core$common.defineBlocksWithJsonArray=St,i.module$build$src$core$common.draggingConnections=cl,i.module$build$src$core$common.getAllWorkspaces=ne,i.module$build$src$core$common.getBlockTypeCounts=we,i.module$build$src$core$common.getMainWorkspace=re,i.module$build$src$core$common.getParentContainer=At,i.module$build$src$core$common.getSelected=_e,i.module$build$src$core$common.getWorkspaceById=W,i.module$build$src$core$common.registerWorkspace=P,i.module$build$src$core$common.setMainWorkspace=Y,i.module$build$src$core$common.setParentContainer=vt,i.module$build$src$core$common.setSelected=Xe,i.module$build$src$core$common.svgResize=je,i.module$build$src$core$common.unregisterWorkpace=Q;var la="http://www.w3.org/2000/svg",Ms="http://www.w3.org/1999/xhtml",Or="http://www.w3.org/1999/xlink",sn;(function(t){t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE",t[t.DOCUMENT_POSITION_CONTAINED_BY=16]="DOCUMENT_POSITION_CONTAINED_BY"})(sn||(sn={}));var Bs=null,mm=0,td=null,wi={};wi.HTML_NS=Ms,wi.NodeType=sn,wi.SVG_NS=la,wi.XLINK_NS=Or,wi.addClass=Ce,wi.containsNode=ls,wi.createSvgElement=z,wi.getFastTextWidth=as,wi.getFastTextWidthWithSizeString=po,wi.getTextWidth=gu,wi.hasClass=Kl,wi.insertAfter=pi,wi.measureFontMetrics=ws,wi.removeClass=qe,wi.removeClasses=pr,wi.removeNode=ft,wi.setCssTransform=Wr,wi.startTextWidthCache=Cs,wi.stopTextWidthCache=Os;var id={};id.clamp=us,id.toDegrees=Ln,id.toRadians=Bi;var li=class{constructor(t,o,a,d){this.top=t,this.bottom=o,this.left=a,this.right=d}contains(t,o){return t>=this.left&&t<=this.right&&o>=this.top&&o<=this.bottom}intersects(t){return!(this.left>t.right||this.right<t.left||this.top>t.bottom||this.bottom<t.top)}},ve=class{constructor(t,o){this.x=t,this.y=o}clone(){return new ve(this.x,this.y)}scale(t){return this.x*=t,this.y*=t,this}translate(t,o){return this.x+=t,this.y+=o,this}static equals(t,o){return t===o?!0:t&&o?t.x===o.x&&t.y===o.y:!1}static distance(t,o){const a=t.x-o.x;return t=t.y-o.y,Math.sqrt(a*a+t*t)}static magnitude(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static difference(t,o){return new ve(t.x-o.x,t.y-o.y)}static sum(t,o){return new ve(t.x+o.x,t.y+o.y)}},Xi=class{constructor(t,o){this.width=t,this.height=o}static equals(t,o){return t===o?!0:t&&o?t.width===o.width&&t.height===o.height:!1}},P$={getSizeInternal:gp},nn={};nn.TEST_ONLY=P$,nn.getBorderBox=Zs,nn.getCascadedStyle=_p,nn.getComputedStyle=Rs,nn.getContainerOffsetToScrollInto=$h,nn.getPageOffset=Mn,nn.getSize=ql,nn.getViewportPageOffset=nr,nn.scrollIntoContainerView=be;var ku=16,gm=1,F$=12,_m=16,rd=.25,bm=null,hl=null,aa="",ua="",Ct,ca,dl,Tm=null,bo=null,U$=null,Em={getBoundsInfo:function(){const t=Mn(Tm),o=ql(Tm);return{left:t.x,right:t.x+o.width,top:t.y,bottom:t.y+o.height,width:o.width,height:o.height}},getPositionMetrics:function(t,o,a,d){const m=Em.getBoundsInfo(),b=ql(Ct);return o+b.height<m.bottom?BT(t,o,m,b):d-b.height>m.top?PT(a,d,m,b):o+b.height<document.documentElement.clientHeight?BT(t,o,m,b):d-b.height>document.documentElement.clientTop?PT(a,d,m,b):yR(t,m,b)}},mi={};mi.ANIMATION_TIME=rd,mi.ARROW_HORIZONTAL_PADDING=F$,mi.ARROW_SIZE=ku,mi.BORDER_SIZE=gm,mi.PADDING_Y=_m,mi.TEST_ONLY=Em,mi.clearContent=or,mi.createDom=vh,mi.getContentDiv=Jl,mi.getOwner=yh,mi.getPositionX=Sh,mi.hide=bp,mi.hideIfOwner=_u,mi.hideWithoutAnimation=en,mi.isVisible=FT,mi.repositionForWindowResize=SR,mi.setBoundsElement=rl,mi.setColour=S,mi.show=sl,mi.showPositionedByBlock=w,mi.showPositionedByField=H;var To=Object.create(null),uN={typeMap:To},sd=Object.create(null),Hn="default",fe=class{constructor(t){this.name=t}toString(){return this.name}};fe.CONNECTION_CHECKER=new fe("connectionChecker"),fe.CURSOR=new fe("cursor"),fe.EVENT=new fe("event"),fe.FIELD=new fe("field"),fe.RENDERER=new fe("renderer"),fe.TOOLBOX=new fe("toolbox"),fe.THEME=new fe("theme"),fe.TOOLBOX_ITEM=new fe("toolboxItem"),fe.FLYOUTS_VERTICAL_TOOLBOX=new fe("flyoutsVerticalToolbox"),fe.FLYOUTS_HORIZONTAL_TOOLBOX=new fe("flyoutsHorizontalToolbox"),fe.METRICS_MANAGER=new fe("metricsManager"),fe.BLOCK_DRAGGER=new fe("blockDragger"),fe.SERIALIZER=new fe("serializer");var Ps={};Ps.DEFAULT=Hn,Ps.TEST_ONLY=uN,Ps.Type=fe,Ps.getAllItems=Tp,Ps.getClass=Ql,Ps.getClassFromOptions=cs,Ps.getObject=kh,Ps.hasItem=GT,Ps.register=tt,Ps.unregister=Ih;var H$="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",G$={genUid:()=>{const t=H$.length,o=[];for(let a=0;20>a;a++)o[a]=H$.charAt(Math.random()*t);return o.join("")}},cN=0,nd={};nd.TEST_ONLY=G$,nd.genUid=Ns,nd.getNextUniqueId=bu;var V$="",Au=!0,$m=0,Ji="create",on="delete",Ui="change",gr="move",fl="var_create",ha="var_delete",Cu="var_rename",Ou="ui",da="drag",Eo="selected",$o="click",wu="marker_move",Gn="bubble_open",Ru="trashcan_open",Nu="toolbox_item_select",xu="theme_change",pl="viewport_change",ml="comment_create",fa="comment_delete",Du="comment_change",Vn="comment_move",pa="finished_loading",od="procedure_create",Lu="procedure_delete",ld="procedure_rename",ad="procedure_enable",ud="procedure_change_return",cd="procedure_parameter_create",hd="procedure_parameter_delete",dd="procedure_parameter_rename",vm=[Ji,gr,ml,Vn],ma=[],ym={FIRE_QUEUE:ma,fireNow:VT,fireInternal:kR,setGroupInternal:AR},We={};We.BLOCK_CHANGE=Ui,We.BLOCK_CREATE=Ji,We.BLOCK_DELETE=on,We.BLOCK_DRAG=da,We.BLOCK_MOVE=gr,We.BUBBLE_OPEN=Gn,We.BUMP_EVENTS=vm,We.CHANGE=Ui,We.CLICK=$o,We.COMMENT_CHANGE=Du,We.COMMENT_CREATE=ml,We.COMMENT_DELETE=fa,We.COMMENT_MOVE=Vn,We.CREATE=Ji,We.DELETE=on,We.FINISHED_LOADING=pa,We.MARKER_MOVE=wu,We.MOVE=gr,We.PROCEDURE_CHANGE_RETURN=ud,We.PROCEDURE_CREATE=od,We.PROCEDURE_DELETE=Lu,We.PROCEDURE_ENABLE=ad,We.PROCEDURE_PARAMETER_CREATE=cd,We.PROCEDURE_PARAMETER_DELETE=hd,We.PROCEDURE_PARAMETER_RENAME=dd,We.PROCEDURE_RENAME=ld,We.SELECTED=Eo,We.TEST_ONLY=ym,We.THEME_CHANGE=xu,We.TOOLBOX_ITEM_SELECT=Nu,We.TRASHCAN_OPEN=Ru,We.UI=Ou,We.VAR_CREATE=fl,We.VAR_DELETE=ha,We.VAR_RENAME=Cu,We.VIEWPORT_CHANGE=pl,We.clearPendingUndo=Ep,We.disable=Ci,We.disableOrphans=$p,We.enable=Oi,We.filter=Ah,We.fire=De,We.fromJson=WT,We.get=Le,We.getDescendantIds=Ch,We.getGroup=Kt,We.getRecordUndo=xs,We.isEnabled=Pi,We.setGroup=He,We.setRecordUndo=zr;var it;(function(t){t[t.VALUE=1]="VALUE",t[t.STATEMENT=3]="STATEMENT",t[t.DUMMY=5]="DUMMY"})(it||(it={})),i.module$build$src$core$input_types={},i.module$build$src$core$input_types.inputTypes=it;var gl,fd,pd,Sm;({document:gl,DOMParser:fd,XMLSerializer:pd}=globalThis),Sm="https://developers.google.com/blockly/xml",i.module$build$src$core$utils$xml={},i.module$build$src$core$utils$xml.NAME_SPACE=Sm,i.module$build$src$core$utils$xml.createElement=Dt,i.module$build$src$core$utils$xml.createTextNode=mo,i.module$build$src$core$utils$xml.domToText=YT,i.module$build$src$core$utils$xml.getDocument=wR,i.module$build$src$core$utils$xml.injectDependencies=OR,i.module$build$src$core$utils$xml.setDocument=RR,i.module$build$src$core$utils$xml.textToDomDocument=zT;var W$=function(t,o){window.alert(t),o&&o()},z$=function(t,o){o(window.confirm(t))},Y$=function(t,o,a){a(window.prompt(t,o))},X$={confirmInternal:xR},wr={};wr.TEST_ONLY=X$,wr.alert=Oh,wr.confirm=vp,wr.prompt=yp,wr.setAlert=NR,wr.setConfirm=DR,wr.setPrompt=LR;var Ve,Im;Ve=Object.create(null),Im=function(t){Object.keys(t).forEach(function(o){Ve[o]=t[o]})},i.module$build$src$core$msg={},i.module$build$src$core$msg.Msg=Ve,i.module$build$src$core$msg.setLocale=Im;var _l=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=Kt(),this.recordUndo=xs()}toJson(){return{type:this.type,group:this.group}}fromJson(t){this.isBlank=!1,this.group=t.group||""}static fromJson(t,o,a){return s("Blockly.Events.Abstract.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),a.isBlank=!1,a.group=t.group||"",a.workspaceId=o.id,a}isNull(){return!1}run(t){}getEventWorkspace_(){let t;if(this.workspaceId&&(t=W(this.workspaceId)),!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t}},Mu=class extends _l{constructor(t){super(),this.isBlank=typeof t>"u",t&&(this.varId=t.getId(),this.workspaceId=t.workspace.id)}toJson(){const t=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return t.varId=this.varId,t}fromJson(t){s("Blockly.Events.VarBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.varId=t.varId}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new Mu),o.varId=t.varId,o}},km=class extends Mu{constructor(t){super(t),this.type=fl,t&&(this.varType=t.type,this.varName=t.name)}toJson(){const t=super.toJson();if(!this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return t.varType=this.varType,t.varName=this.varName,t}fromJson(t){s("Blockly.Events.VarCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.varType=t.varType,this.varName=t.varName}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new km),o.varType=t.varType,o.varName=t.varName,o}run(t){const o=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t?o.createVariable(this.varName,this.varType,this.varId):o.deleteVariableById(this.varId)}};tt(fe.EVENT,fl,km);var Bu=class{constructor(t,o,a,d){this.workspace=t,this.name=o,this.type=a||"",this.id_=d||Ns()}getId(){return this.id_}static compareByName(t,o){return t.name.localeCompare(o.name,void 0,{sensitivity:"base"})}},md,gd,Am;md="VARIABLE",gd="ijkmnopqrstuvwxyzabcdefgh",Am={generateUniqueNameInternal:BR},i.module$build$src$core$variables={},i.module$build$src$core$variables.CATEGORY_NAME=md,i.module$build$src$core$variables.TEST_ONLY=Am,i.module$build$src$core$variables.VAR_LETTER_OPTIONS=gd,i.module$build$src$core$variables.allDeveloperVariables=MR,i.module$build$src$core$variables.allUsedVarModels=Sp,i.module$build$src$core$variables.createVariableButtonHandler=Tu,i.module$build$src$core$variables.flyoutCategory=Ip,i.module$build$src$core$variables.flyoutCategoryBlocks=XT,i.module$build$src$core$variables.generateUniqueName=jT,i.module$build$src$core$variables.generateUniqueNameFromOptions=kp,i.module$build$src$core$variables.generateVariableFieldDom=Zl,i.module$build$src$core$variables.getAddedVariables=Cp,i.module$build$src$core$variables.getOrCreateVariablePackage=wh,i.module$build$src$core$variables.getVariable=Rh,i.module$build$src$core$variables.nameUsedWithAnyType=qT,i.module$build$src$core$variables.promptName=Ap,i.module$build$src$core$variables.renameVariable=KT;var ln=class{constructor(t,o,a,d,m){this.workspace=t,this.editable_=this.movable_=this.deletable_=!0,this.disposed_=!1,this.isComment=!0,this.id=m&&!t.getCommentById(m)?m:Ns(),t.addTopComment(this),this.xy_=new ve(0,0),this.height_=a,this.width_=d,this.RTL=t.RTL,this.content_=o,ln.fireCreateEvent(this)}dispose(){this.disposed_||(Pi()&&De(new(Le(fa))(this)),this.workspace.removeTopComment(this),this.disposed_=!0)}getHeight(){return this.height_}setHeight(t){this.height_=t}getWidth(){return this.width_}setWidth(t){this.width_=t}getXY(){return new ve(this.xy_.x,this.xy_.y)}moveBy(t,o){const a=new(Le(Vn))(this);this.xy_.translate(t,o),a.recordNew(),De(a)}isDeletable(){return this.deletable_&&!(this.workspace&&this.workspace.options.readOnly)}setDeletable(t){this.deletable_=t}isMovable(){return this.movable_&&!(this.workspace&&this.workspace.options.readOnly)}setMovable(t){this.movable_=t}isEditable(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)}setEditable(t){this.editable_=t}getContent(){return this.content_}setContent(t){this.content_!==t&&(De(new(Le(Du))(this,this.content_,t)),this.content_=t)}toXmlWithXY(t){return t=this.toXml(t),t.setAttribute("x",`${Math.round(this.xy_.x)}`),t.setAttribute("y",`${Math.round(this.xy_.y)}`),t.setAttribute("h",`${this.height_}`),t.setAttribute("w",`${this.width_}`),t}toXml(t){const o=Dt("comment");return t||(o.id=this.id),o.textContent=this.getContent(),o}static fireCreateEvent(t){if(Pi()){const o=Kt();o||He(!0);try{De(new(Le(ml))(t))}finally{o||He(!1)}}}static fromXml(t,o){var a=ln.parseAttributes(t);return o=new ln(o,a.content,a.h,a.w,a.id),a=t.getAttribute("x"),t=t.getAttribute("y"),a=a?parseInt(a,10):NaN,t=t?parseInt(t,10):NaN,isNaN(a)||isNaN(t)||o.moveBy(a,t),ln.fireCreateEvent(o),o}static parseAttributes(t){const o=t.getAttribute("h"),a=t.getAttribute("w"),d=t.getAttribute("x"),m=t.getAttribute("y"),b=t.getAttribute("id");if(!b)throw Error("No ID present in XML comment definition.");let I;return{id:b,h:o?parseInt(o):100,w:a?parseInt(a):100,x:d?parseInt(d):NaN,y:m?parseInt(m):NaN,content:(I=t.textContent)!=null?I:""}}},Fs=class extends _l{constructor(t){super(),this.isBlank=!0,this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=typeof t>"u",this.workspaceId=t||""}},Cm=class extends Fs{constructor(t,o,a){super(a),this.type=Eo,this.oldElementId=t??void 0,this.newElementId=o??void 0}toJson(){const t=super.toJson();return t.oldElementId=this.oldElementId,t.newElementId=this.newElementId,t}fromJson(t){s("Blockly.Events.Selected.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.oldElementId=t.oldElementId,this.newElementId=t.newElementId}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new Cm),o.oldElementId=t.oldElementId,o.newElementId=t.newElementId,o}};tt(fe.EVENT,Eo,Cm);var Om=!1,wm=`
.blocklySvg {
  background-color: #fff;
  outline: none;
  overflow: hidden;  /* IE overflows by default. */
  position: absolute;
  display: block;
}

.blocklyWidgetDiv {
  display: none;
  position: absolute;
  z-index: 99999;  /* big value for bootstrap3 compatibility */
}

.injectionDiv {
  height: 100%;
  position: relative;
  overflow: hidden;  /* So blocks in drag surface disappear at edges */
  touch-action: none;
}

.blocklyNonSelectable {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
}

.blocklyWsDragSurface {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
}

/* Added as a separate rule with multiple classes to make it more specific
   than a bootstrap rule that selects svg:root. See issue #1275 for context.
*/
.blocklyWsDragSurface.blocklyOverflowVisible {
  overflow: visible;
}

.blocklyBlockDragSurface {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: visible !important;
  z-index: 50;  /* Display below toolbox, but above everything else. */
}

.blocklyBlockCanvas.blocklyCanvasTransitioning,
.blocklyBubbleCanvas.blocklyCanvasTransitioning {
  transition: transform .5s;
}

.blocklyTooltipDiv {
  background-color: #ffffc7;
  border: 1px solid #ddc;
  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);
  color: #000;
  display: none;
  font: 9pt sans-serif;
  opacity: .9;
  padding: 2px;
  position: absolute;
  z-index: 100000;  /* big value for bootstrap3 compatibility */
}

.blocklyDropDownDiv {
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1000;
  display: none;
  border: 1px solid;
  border-color: #dadce0;
  background-color: #fff;
  border-radius: 2px;
  padding: 4px;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownContent {
  max-height: 300px;  /* @todo: spec for maximum height. */
  overflow: auto;
  overflow-x: hidden;
  position: relative;
}

.blocklyDropDownArrow {
  position: absolute;
  left: 0;
  top: 0;
  width: 16px;
  height: 16px;
  z-index: -1;
  background-color: inherit;
  border-color: inherit;
}

.blocklyDropDownButton {
  display: inline-block;
  float: left;
  padding: 0;
  margin: 4px;
  border-radius: 4px;
  outline: none;
  border: 1px solid;
  transition: box-shadow .1s;
  cursor: pointer;
}

.blocklyArrowTop {
  border-top: 1px solid;
  border-left: 1px solid;
  border-top-left-radius: 4px;
  border-color: inherit;
}

.blocklyArrowBottom {
  border-bottom: 1px solid;
  border-right: 1px solid;
  border-bottom-right-radius: 4px;
  border-color: inherit;
}

.blocklyResizeSE {
  cursor: se-resize;
  fill: #aaa;
}

.blocklyResizeSW {
  cursor: sw-resize;
  fill: #aaa;
}

.blocklyResizeLine {
  stroke: #515A5A;
  stroke-width: 1;
}

.blocklyHighlightedConnectionPath {
  fill: none;
  stroke: #fc3;
  stroke-width: 4px;
}

.blocklyPathLight {
  fill: none;
  stroke-linecap: round;
  stroke-width: 1;
}

.blocklySelected>.blocklyPathLight {
  display: none;
}

.blocklyDraggable {
  /* backup for browsers (e.g. IE11) that don't support grab */
  cursor: url("<<<PATH>>>/handopen.cur"), auto;
  cursor: grab;
  cursor: -webkit-grab;
}

  /* backup for browsers (e.g. IE11) that don't support grabbing */
.blocklyDragging {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

  /* Changes cursor on mouse down. Not effective in Firefox because of
     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */
.blocklyDraggable:active {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Change the cursor on the whole drag surface in case the mouse gets
   ahead of block during a drag. This way the cursor is still a closed hand.
  */
.blocklyBlockDragSurface .blocklyDraggable {
  /* backup for browsers (e.g. IE11) that don't support grabbing */
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

.blocklyDragging.blocklyDraggingDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyDragging>.blocklyPath,
.blocklyDragging>.blocklyPathLight {
  fill-opacity: .8;
  stroke-opacity: .8;
}

.blocklyDragging>.blocklyPathDark {
  display: none;
}

.blocklyDisabled>.blocklyPath {
  fill-opacity: .5;
  stroke-opacity: .5;
}

.blocklyDisabled>.blocklyPathLight,
.blocklyDisabled>.blocklyPathDark {
  display: none;
}

.blocklyInsertionMarker>.blocklyPath,
.blocklyInsertionMarker>.blocklyPathLight,
.blocklyInsertionMarker>.blocklyPathDark {
  fill-opacity: .2;
  stroke: none;
}

.blocklyMultilineText {
  font-family: monospace;
}

.blocklyNonEditableText>text {
  pointer-events: none;
}

.blocklyFlyout {
  position: absolute;
  z-index: 20;
}

.blocklyText text {
  cursor: default;
}

/*
  Don't allow users to select text.  It gets annoying when trying to
  drag a block and selected text moves instead.
*/
.blocklySvg text,
.blocklyBlockDragSurface text {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  cursor: inherit;
}

.blocklyHidden {
  display: none;
}

.blocklyFieldDropdown:not(.blocklyHidden) {
  display: block;
}

.blocklyIconGroup {
  cursor: default;
}

.blocklyIconGroup:not(:hover),
.blocklyIconGroupReadonly {
  opacity: .6;
}

.blocklyIconShape {
  fill: #00f;
  stroke: #fff;
  stroke-width: 1px;
}

.blocklyIconSymbol {
  fill: #fff;
}

.blocklyMinimalBody {
  margin: 0;
  padding: 0;
}

.blocklyHtmlInput {
  border: none;
  border-radius: 4px;
  height: 100%;
  margin: 0;
  outline: none;
  padding: 0;
  width: 100%;
  text-align: center;
  display: block;
  box-sizing: border-box;
}

/* Edge and IE introduce a close icon when the input value is longer than a
   certain length. This affects our sizing calculations of the text input.
   Hiding the close icon to avoid that. */
.blocklyHtmlInput::-ms-clear {
  display: none;
}

.blocklyMainBackground {
  stroke-width: 1;
  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */
}

.blocklyMutatorBackground {
  fill: #fff;
  stroke: #ddd;
  stroke-width: 1;
}

.blocklyFlyoutBackground {
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyMainWorkspaceScrollbar {
  z-index: 20;
}

.blocklyFlyoutScrollbar {
  z-index: 30;
}

.blocklyScrollbarHorizontal,
.blocklyScrollbarVertical {
  position: absolute;
  outline: none;
}

.blocklyScrollbarBackground {
  opacity: 0;
}

.blocklyScrollbarHandle {
  fill: #ccc;
}

.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyScrollbarHandle:hover {
  fill: #bbb;
}

/* Darken flyout scrollbars due to being on a grey background. */
/* By contrast, workspace scrollbars are on a white background. */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #bbb;
}

.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #aaa;
}

.blocklyInvalidInput {
  background: #faa;
}

.blocklyVerticalMarker {
  stroke-width: 3px;
  fill: rgba(255,255,255,.5);
  pointer-events: none;
}

.blocklyComputeCanvas {
  position: absolute;
  width: 0;
  height: 0;
}

.blocklyNoPointerEvents {
  pointer-events: none;
}

.blocklyContextMenu {
  border-radius: 4px;
  max-height: 100%;
}

.blocklyDropdownMenu {
  border-radius: 2px;
  padding: 0 !important;
}

.blocklyDropdownMenu .blocklyMenuItem {
  /* 28px on the left for icon or checkbox. */
  padding-left: 28px;
}

/* BiDi override for the resting state. */
.blocklyDropdownMenu .blocklyMenuItemRtl {
  /* Flip left/right padding for BiDi. */
  padding-left: 5px;
  padding-right: 28px;
}

.blocklyWidgetDiv .blocklyMenu {
  background: #fff;
  border: 1px solid transparent;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
  font: normal 13px Arial, sans-serif;
  margin: 0;
  outline: none;
  padding: 4px 0;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 100%;
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

.blocklyWidgetDiv .blocklyMenu.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv .blocklyMenu {
  background: inherit;  /* Compatibility with gapi, reset from goog-menu */
  border: inherit;  /* Compatibility with gapi, reset from goog-menu */
  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;
  outline: none;
  position: relative;  /* Compatibility with gapi, reset from goog-menu */
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

/* State: resting. */
.blocklyMenuItem {
  border: none;
  color: #000;
  cursor: pointer;
  list-style: none;
  margin: 0;
  /* 7em on the right for shortcut. */
  min-width: 7em;
  padding: 6px 15px;
  white-space: nowrap;
}

/* State: disabled. */
.blocklyMenuItemDisabled {
  color: #ccc;
  cursor: inherit;
}

/* State: hover. */
.blocklyMenuItemHighlight {
  background-color: rgba(0,0,0,.1);
}

/* State: selected/checked. */
.blocklyMenuItemCheckbox {
  height: 16px;
  position: absolute;
  width: 16px;
}

.blocklyMenuItemSelected .blocklyMenuItemCheckbox {
  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;
  float: left;
  margin-left: -24px;
  position: static;  /* Scroll with the menu. */
}

.blocklyMenuItemRtl .blocklyMenuItemCheckbox {
  float: right;
  margin-right: -24px;
}
`,Rm={};Rm.inject=JT,Rm.register=Ds;var G=class{constructor(t){this.tagName=t}toString(){return this.tagName}};G.ANIMATE=new G("animate"),G.CIRCLE=new G("circle"),G.CLIPPATH=new G("clipPath"),G.DEFS=new G("defs"),G.FECOMPOSITE=new G("feComposite"),G.FECOMPONENTTRANSFER=new G("feComponentTransfer"),G.FEFLOOD=new G("feFlood"),G.FEFUNCA=new G("feFuncA"),G.FEGAUSSIANBLUR=new G("feGaussianBlur"),G.FEPOINTLIGHT=new G("fePointLight"),G.FESPECULARLIGHTING=new G("feSpecularLighting"),G.FILTER=new G("filter"),G.FOREIGNOBJECT=new G("foreignObject"),G.G=new G("g"),G.IMAGE=new G("image"),G.LINE=new G("line"),G.PATH=new G("path"),G.PATTERN=new G("pattern"),G.POLYGON=new G("polygon"),G.RECT=new G("rect"),G.SVG=new G("svg"),G.TEXT=new G("text"),G.TSPAN=new G("tspan");var j$=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,K$=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,hN={XY_REGEX:j$,XY_STYLE_REGEX:K$},vo={};vo.TEST_ONLY=hN,vo.getDocumentScroll=wp,vo.getInjectionDivXY=Nh,vo.getRelativeXY=Ls,vo.getViewportBBox=Op,vo.is3dSupported=QT,vo.screenToWsCoordinates=ZT;var Qi=8,_d=3,dN=2,ar=class extends ln{constructor(t,o,a,d,m){super(t,o,a,d,m),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.eventsInit_=!1,this.deleteIconBorder_=this.deleteGroup_=this.resizeGroup_=this.foreignObject_=this.svgHandleTarget_=this.svgRectTarget_=this.textarea_=null,this.rendered_=this.autoLayout_=this.focused_=!1,this.svgGroup_=z(G.G,{class:"blocklyComment"}),this.svgGroup_.translate_="",this.workspace=t,this.svgRect_=z(G.RECT,{class:"blocklyCommentRect",x:0,y:0,rx:_d,ry:_d}),this.svgGroup_.appendChild(this.svgRect_),this.useDragSurface_=!!t.getBlockDragSurface(),this.render()}dispose(){this.disposed_||(_e()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),Pi()&&De(new(Le(fa))(this)),ft(this.svgGroup_),this.disposeInternal_(),Ci(),super.dispose(),Oi())}initSvg(t){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");this.workspace.options.readOnly||this.eventsInit_||(y(this.svgRectTarget_,"pointerdown",this,this.pathMouseDown_),y(this.svgHandleTarget_,"pointerdown",this,this.pathMouseDown_)),this.eventsInit_=!0,this.updateMovable(),this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot()),!t&&this.textarea_&&this.textarea_.select()}pathMouseDown_(t){const o=this.workspace.getGesture(t);o&&o.handleBubbleStart(t,this)}showContextMenu(t){throw Error("The implementation of showContextMenu should be monkey-patched in by blockly.ts")}select(){if(_e()!==this){var t=null;if(_e()){t=_e().id,Ci();try{_e().unselect()}finally{Oi()}}t=new(Le(Eo))(t,this.id,this.workspace.id),De(t),Xe(this),this.addSelect()}}unselect(){if(_e()===this){var t=new(Le(Eo))(this.id,null,this.workspace.id);De(t),Xe(null),this.removeSelect(),this.blurFocus()}}addSelect(){Ce(this.svgGroup_,"blocklySelected"),this.setFocus()}removeSelect(){Ce(this.svgGroup_,"blocklySelected"),this.blurFocus()}addFocus(){Ce(this.svgGroup_,"blocklyFocused")}removeFocus(){qe(this.svgGroup_,"blocklyFocused")}getRelativeToSurfaceXY(){let t=0,o=0;const a=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null;let d=this.getSvgRoot();if(d)do{var m=Ls(d);t+=m.x,o+=m.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===d&&(m=this.workspace.getBlockDragSurface().getSurfaceTranslation(),t+=m.x,o+=m.y),d=d.parentNode}while(d&&d!==this.workspace.getBubbleCanvas()&&d!==a);return this.xy_=new ve(t,o)}moveBy(t,o){const a=new(Le(Vn))(this),d=this.getRelativeToSurfaceXY();this.translate(d.x+t,d.y+o),this.xy_=new ve(d.x+t,d.y+o),a.recordNew(),De(a),this.workspace.resizeContents()}translate(t,o){this.xy_=new ve(t,o),this.getSvgRoot().setAttribute("transform","translate("+t+","+o+")")}moveToDragSurface(){if(this.useDragSurface_){var t=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(t.x,t.y),this.workspace.getBlockDragSurface().setBlocksAndShow(this.getSvgRoot())}}moveDuringDrag(t,o){t?t.translateSurface(o.x,o.y):(this.svgGroup_.translate_="translate("+o.x+","+o.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))}moveTo(t,o){this.translate(t,o)}clearTransformAttributes_(){this.getSvgRoot().removeAttribute("transform")}getBoundingRectangle(){var t=this.getRelativeToSurfaceXY();const o=this.getHeightWidth(),a=t.y,d=t.y+o.height;let m;return this.RTL?(m=t.x-o.width,t=t.x):(m=t.x,t=t.x+o.width),new li(a,d,m,t)}updateMovable(){this.isMovable()?Ce(this.svgGroup_,"blocklyDraggable"):qe(this.svgGroup_,"blocklyDraggable")}setMovable(t){super.setMovable(t),this.updateMovable()}setEditable(t){super.setEditable(t),this.textarea_&&(this.textarea_.readOnly=!t)}setDragging(t){t?(t=this.getSvgRoot(),t.translate_="",t.skew_="",Ce(this.svgGroup_,"blocklyDragging")):qe(this.svgGroup_,"blocklyDragging")}getSvgRoot(){return this.svgGroup_}getContent(){return this.textarea_?this.textarea_.value:this.content_}setContent(t){super.setContent(t),this.textarea_&&(this.textarea_.value=t)}setDeleteStyle(t){t?Ce(this.svgGroup_,"blocklyDraggingDelete"):qe(this.svgGroup_,"blocklyDraggingDelete")}setAutoLayout(t){}toXmlWithXY(t){let o=0;this.workspace.RTL&&(o=this.workspace.getWidth()),t=this.toXml(t);const a=this.getRelativeToSurfaceXY();return t.setAttribute("x",Math.round(this.workspace.RTL?o-a.x:a.x)),t.setAttribute("y",Math.round(a.y)),t.setAttribute("h",this.getHeight()),t.setAttribute("w",this.getWidth()),t}toCopyData(){return{saveInfo:this.toXmlWithXY(),source:this.workspace,typeCounts:null}}getHeightWidth(){return{width:this.getWidth(),height:this.getHeight()}}render(){if(!this.rendered_){var t=this.getHeightWidth();this.createEditor_(),this.svgGroup_.appendChild(this.foreignObject_),this.svgHandleTarget_=z(G.RECT,{class:"blocklyCommentHandleTarget",x:0,y:0}),this.svgGroup_.appendChild(this.svgHandleTarget_),this.svgRectTarget_=z(G.RECT,{class:"blocklyCommentTarget",x:0,y:0,rx:_d,ry:_d}),this.svgGroup_.appendChild(this.svgRectTarget_),this.addResizeDom_(),this.isDeletable()&&this.addDeleteDom_(),this.setSize_(t.width,t.height),this.textarea_.value=this.content_,this.rendered_=!0,this.resizeGroup_&&y(this.resizeGroup_,"pointerdown",this,this.resizeMouseDown_),this.isDeletable()&&(y(this.deleteGroup_,"pointerdown",this,this.deleteMouseDown_),y(this.deleteGroup_,"pointerout",this,this.deleteMouseOut_),y(this.deleteGroup_,"pointerup",this,this.deleteMouseUp_))}}createEditor_(){this.foreignObject_=z(G.FOREIGNOBJECT,{x:0,y:ar.TOP_OFFSET,class:"blocklyCommentForeignObject"});const t=document.createElementNS(Ms,"body");t.setAttribute("xmlns",Ms),t.className="blocklyMinimalBody";const o=document.createElementNS(Ms,"textarea");return o.className="blocklyCommentTextarea",o.setAttribute("dir",this.RTL?"RTL":"LTR"),o.readOnly=!this.isEditable(),t.appendChild(o),this.textarea_=o,this.foreignObject_.appendChild(t),y(o,"wheel",this,function(a){a.stopPropagation()}),y(o,"change",this,function(a){this.setContent(o.value)}),this.foreignObject_}addResizeDom_(){this.resizeGroup_=z(G.G,{class:this.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.svgGroup_),z(G.POLYGON,{points:"0,x x,x x,0".replace(/x/g,Qi.toString())},this.resizeGroup_),z(G.LINE,{class:"blocklyResizeLine",x1:Qi/3,y1:Qi-1,x2:Qi-1,y2:Qi/3},this.resizeGroup_),z(G.LINE,{class:"blocklyResizeLine",x1:2*Qi/3,y1:Qi-1,x2:Qi-1,y2:2*Qi/3},this.resizeGroup_)}addDeleteDom_(){this.deleteGroup_=z(G.G,{class:"blocklyCommentDeleteIcon"},this.svgGroup_),this.deleteIconBorder_=z(G.CIRCLE,{class:"blocklyDeleteIconShape",r:"7",cx:"7.5",cy:"7.5"},this.deleteGroup_),z(G.LINE,{x1:"5",y1:"10",x2:"10",y2:"5",stroke:"#fff","stroke-width":"2"},this.deleteGroup_),z(G.LINE,{x1:"5",y1:"5",x2:"10",y2:"10",stroke:"#fff","stroke-width":"2"},this.deleteGroup_)}resizeMouseDown_(t){this.unbindDragEvents_(),j(t)||(this.workspace.startDrag(t,new ve(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper_=y(document,"pointerup",this,this.resizeMouseUp_),this.onMouseMoveWrapper_=y(document,"pointermove",this,this.resizeMouseMove_),this.workspace.hideChaff()),t.stopPropagation()}deleteMouseDown_(t){this.deleteIconBorder_&&Ce(this.deleteIconBorder_,"blocklyDeleteIconHighlighted"),t.stopPropagation()}deleteMouseOut_(t){this.deleteIconBorder_&&qe(this.deleteIconBorder_,"blocklyDeleteIconHighlighted")}deleteMouseUp_(t){this.dispose(),t.stopPropagation()}unbindDragEvents_(){this.onMouseUpWrapper_&&(C(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(C(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}resizeMouseUp_(t){u(),this.unbindDragEvents_()}resizeMouseMove_(t){this.autoLayout_=!1,t=this.workspace.moveDrag(t),this.setSize_(this.RTL?-t.x:t.x,t.y)}resizeComment_(){const t=this.getHeightWidth(),o=ar.TOP_OFFSET,a=2*dN;this.foreignObject_.setAttribute("width",t.width),this.foreignObject_.setAttribute("height",(t.height-o).toString()),this.RTL&&this.foreignObject_.setAttribute("x",(-t.width).toString()),this.textarea_.style.width=t.width-a+"px",this.textarea_.style.height=t.height-a-o+"px"}setSize_(t,o){t=Math.max(t,45),o=Math.max(o,20+ar.TOP_OFFSET),this.width_=t,this.height_=o,this.svgRect_.setAttribute("width",t),this.svgRect_.setAttribute("height",o),this.svgRectTarget_.setAttribute("width",t),this.svgRectTarget_.setAttribute("height",o),this.svgHandleTarget_.setAttribute("width",t),this.svgHandleTarget_.setAttribute("height",ar.TOP_OFFSET),this.RTL&&(this.svgRect_.setAttribute("transform","scale(-1 1)"),this.svgRectTarget_.setAttribute("transform","scale(-1 1)")),this.resizeGroup_&&(this.RTL?(this.resizeGroup_.setAttribute("transform","translate("+(-t+Qi)+","+(o-Qi)+") scale(-1 1)"),this.deleteGroup_.setAttribute("transform","translate("+(-t+Qi)+","+-Qi+") scale(-1 1)")):(this.resizeGroup_.setAttribute("transform","translate("+(t-Qi)+","+(o-Qi)+")"),this.deleteGroup_.setAttribute("transform","translate("+(t-Qi)+","+-Qi+")"))),this.resizeComment_()}disposeInternal_(){this.svgHandleTarget_=this.svgRectTarget_=this.foreignObject_=this.textarea_=null,this.disposed_=!0}setFocus(){this.focused_=!0,setTimeout(()=>{this.disposed_||(this.textarea_.focus(),this.addFocus(),this.svgRectTarget_&&Ce(this.svgRectTarget_,"blocklyCommentTargetFocused"),this.svgHandleTarget_&&Ce(this.svgHandleTarget_,"blocklyCommentHandleTargetFocused"))},0)}blurFocus(){this.focused_=!1,setTimeout(()=>{this.disposed_||(this.textarea_.blur(),this.removeFocus(),this.svgRectTarget_&&qe(this.svgRectTarget_,"blocklyCommentTargetFocused"),this.svgHandleTarget_&&qe(this.svgHandleTarget_,"blocklyCommentHandleTargetFocused"))},0)}static fromXmlRendered(t,o,a){Ci();let d;try{const m=ln.parseAttributes(t);if(d=new ar(o,m.content,m.h,m.w,m.id),o.rendered&&(d.initSvg(!0),d.render()),!isNaN(m.x)&&!isNaN(m.y))if(o.RTL){const b=a||o.getWidth();d.moveBy(b-m.x,m.y)}else d.moveBy(m.x,m.y)}finally{Oi()}return ln.fireCreateEvent(d),d}};ar.DEFAULT_SIZE=100,ar.TOP_OFFSET=10,Ds(`
.blocklyCommentForeignObject {
  position: relative;
  z-index: 0;
}

.blocklyCommentRect {
  fill: #E7DE8E;
  stroke: #bcA903;
  stroke-width: 1px;
}

.blocklyCommentTarget {
  fill: transparent;
  stroke: #bcA903;
}

.blocklyCommentTargetFocused {
  fill: none;
}

.blocklyCommentHandleTarget {
  fill: none;
}

.blocklyCommentHandleTargetFocused {
  fill: transparent;
}

.blocklyFocused>.blocklyCommentRect {
  fill: #B9B272;
  stroke: #B9B272;
}

.blocklySelected>.blocklyCommentTarget {
  stroke: #fc3;
  stroke-width: 3px;
}

.blocklyCommentDeleteIcon {
  cursor: pointer;
  fill: #000;
  display: none;
}

.blocklySelected > .blocklyCommentDeleteIcon {
  display: block;
}

.blocklyDeleteIconShape {
  fill: #000;
  stroke: #000;
  stroke-width: 1px;
}

.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {
  stroke: #fc3;
}
`),i.module$build$src$core$xml={},i.module$build$src$core$xml.appendDomToWorkspace=zR,i.module$build$src$core$xml.blockToDom=nl,i.module$build$src$core$xml.blockToDomWithXY=xh,i.module$build$src$core$xml.clearWorkspaceAndLoadFromXml=WR,i.module$build$src$core$xml.deleteNext=e3,i.module$build$src$core$xml.domToBlock=ea,i.module$build$src$core$xml.domToPrettyText=VR,i.module$build$src$core$xml.domToText=hs,i.module$build$src$core$xml.domToVariables=iE,i.module$build$src$core$xml.domToWorkspace=Eu,i.module$build$src$core$xml.textToDom=mr,i.module$build$src$core$xml.variablesToDom=eE,i.module$build$src$core$xml.workspaceToDom=UR;var ga=class extends _l{constructor(t){super(),this.isBlank=!t,t&&(this.blockId=t.id,this.workspaceId=t.workspace.id)}toJson(){const t=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return t.blockId=this.blockId,t}fromJson(t){s("Blockly.Events.BlockBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.blockId=t.blockId}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new ga),o.blockId=t.blockId,o}},bl=class extends ga{constructor(t,o,a,d,m){super(t),this.type=Ui,t&&(this.element=o,this.name=a||void 0,this.oldValue=d,this.newValue=m)}toJson(){const t=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return t.element=this.element,t.name=this.name,t.oldValue=this.oldValue,t.newValue=this.newValue,t}fromJson(t){s("Blockly.Events.BlockChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.element=t.element,this.name=t.name,this.oldValue=t.oldValue,this.newValue=t.newValue}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new bl),o.element=t.element,o.name=t.name,o.oldValue=t.oldValue,o.newValue=t.newValue,o}isNull(){return this.oldValue===this.newValue}run(t){var o=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(o=o.getBlockById(this.blockId),!o)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");switch(o.mutator&&o.mutator.setVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(o=o.getField(this.name))?o.setValue(t):console.warn("Can't set non-existent field: "+this.name);break;case"comment":o.setCommentText(t||null);break;case"collapsed":o.setCollapsed(!!t);break;case"disabled":o.setEnabled(!t);break;case"inline":o.setInputsInline(!!t);break;case"mutation":const a=bl.getExtraBlockState_(o);o.loadExtraState?o.loadExtraState(JSON.parse(t||"{}")):o.domToMutation&&o.domToMutation(mr(t||"<mutation/>")),De(new bl(o,"mutation",null,a,t));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(t){return t.saveExtraState?(t=t.saveExtraState())?JSON.stringify(t):"":t.mutationToDom&&(t=t.mutationToDom())?hs(t):""}};tt(fe.EVENT,Ui,bl);var Pu=class{constructor(t){this.workspace=t,this.cursorSvg_=this.cursor_=null,this.markers=new Map,this.markerSvg_=null}registerMarker(t,o){this.markers.has(t)&&this.unregisterMarker(t),o.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,o)),this.setMarkerSvg(o.getDrawer().createDom()),this.markers.set(t,o)}unregisterMarker(t){const o=this.markers.get(t);if(o)o.dispose(),this.markers.delete(t);else throw Error("Marker with ID "+t+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor_}getMarker(t){return this.markers.get(t)||null}setCursor(t){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=t)&&(t=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(t),this.setCursorSvg(this.cursor_.getDrawer().createDom()))}setCursorSvg(t){t?(this.workspace.getBlockCanvas().appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null}setMarkerSvg(t){t?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(t,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(t)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const t=Object.keys(this.markers);for(let o=0,a;a=t[o];o++)this.unregisterMarker(a);this.markers.clear(),this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};Pu.LOCAL_MARKER="local_marker_1",i.module$build$src$core$utils$string={},i.module$build$src$core$utils$string.commonWordPrefix=sE,i.module$build$src$core$utils$string.commonWordSuffix=nE,i.module$build$src$core$utils$string.isNumber=aE,i.module$build$src$core$utils$string.shortestStringLength=Dh,i.module$build$src$core$utils$string.startsWith=t3,i.module$build$src$core$utils$string.wrap=oE;var bd=void 0,Fu=!1,_a=!1,q$=50,J$=0,Uu=0,Nm=0,xm=0,fs=null,Hu=null,Dm=0,Lm=10,Q$=10,Z$=750,Td=5,Ti=null,gi={};gi.HOVER_MS=Z$,gi.LIMIT=q$,gi.MARGINS=Td,gi.OFFSET_X=Dm,gi.OFFSET_Y=Lm,gi.RADIUS_OK=Q$,gi.bindMouseEvents=Lh,gi.block=fE,gi.createDom=cE,gi.dispose=dE,gi.getCustomTooltip=n3,gi.getDiv=l3,gi.getTooltipOfObject=$u,gi.hide=ol,gi.isVisible=o3,gi.setCustomTooltip=s3,gi.unbindMouseEvents=Mh,gi.unblock=pE;var Mm=.45,Bm=.65,ev={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},ur={};ur.blend=ta,ur.getHsvSaturation=mE,ur.getHsvValue=gE,ur.hexToRgb=xp,ur.hsvToHex=Dp,ur.hueToHex=Lp,ur.names=ev,ur.parse=ll,ur.rgbToHex=Bh,ur.setHsvSaturation=p3,ur.setHsvValue=m3;var Gu={};Gu.checkMessageReferences=Ph,Gu.parseBlockColour=ia,Gu.replaceMessageReferences=oi,Gu.tokenizeInterpolation=Bp;var fN=class{},Ed=null,$d=null,ba="",Ta="",Us,Hs={};Hs.createDom=_E,Hs.getDiv=ra,Hs.hide=tn,Hs.hideIfOwner=Fp,Hs.isVisible=bE,Hs.positionWithAnchor=EE,Hs.show=Pp,Hs.testOnly_setDiv=g3;var pt=class{constructor(t,o,a){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Xi(0,0),t!==pt.SKIP_SETUP&&(a&&this.configure_(a),this.setValue(t),o&&this.setValidator(o))}configure_(t){t.tooltip&&this.setTooltip(oi(t.tooltip))}setSourceBlock(t){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=t}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=z(G.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}createBorderRect_(){this.borderRect_=z(G.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=z(G.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const t=this.getClickTarget_();if(!t)throw Error("A click target has not been set.");Lh(t),this.mouseDownWrapper_=y(t,"pointerdown",this,this.onMouseDown_)}fromXml(t){this.setValue(t.textContent)}toXml(t){return t.textContent=this.getValue(),t}saveState(t){return t=this.saveLegacyState(pt),t!==null?t:this.getValue()}loadState(t){this.loadLegacyState(pt,t)||this.setValue(t)}saveLegacyState(t){return t.prototype.saveState===this.saveState&&t.prototype.toXml!==this.toXml?(t=Dt("field"),t.setAttribute("name",this.name||""),hs(this.toXml(t)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(t,o){return t.prototype.loadState===this.loadState&&t.prototype.fromXml!==this.fromXml?(this.fromXml(mr(o)),!0):!1}dispose(){_u(this),Fp(this),Mh(this.getClickTarget_()),this.mouseDownWrapper_&&C(this.mouseDownWrapper_),ft(this.fieldGroup_),this.disposed=!0}updateEditable(){const t=this.fieldGroup_,o=this.getSourceBlock();this.EDITABLE&&t&&o&&(this.enabled_&&o.isEditable()?(Ce(t,"blocklyEditableText"),qe(t,"blocklyNonEditableText"),t.style.cursor=this.CURSOR):(Ce(t,"blocklyNonEditableText"),qe(t,"blocklyEditableText"),t.style.cursor=""))}setEnabled(t){this.enabled_=t,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==pt.prototype.showEditor_}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let t=!1;return this.name&&(this.SERIALIZABLE?t=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),t=!0)),t}isVisible(){return this.visible_}setVisible(t){if(this.visible_!==t){this.visible_=t;var o=this.fieldGroup_;o&&(o.style.display=t?"block":"none")}}setValidator(t){this.validator_=t}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(t){this.isClickable()&&this.showEditor_(t)}showEditor_(t){}updateSize_(t){const o=this.getConstants();t=t!==void 0?t:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let a=2*t,d=o.FIELD_TEXT_HEIGHT,m=0;this.textElement_&&(m=as(this.textElement_,o.FIELD_TEXT_FONTSIZE,o.FIELD_TEXT_FONTWEIGHT,o.FIELD_TEXT_FONTFAMILY),a+=m),this.borderRect_&&(d=Math.max(d,o.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=d,this.size_.width=a,this.positionTextElement_(t,m),this.positionBorderRect_()}positionTextElement_(t,o){if(this.textElement_){var a=this.getConstants(),d=this.size_.height/2,m;this.textElement_.setAttribute("x",`${(m=this.getSourceBlock())!=null&&m.RTL?this.size_.width-o-t:t}`),this.textElement_.setAttribute("y",`${a.FIELD_TEXT_BASELINE_CENTER?d:d-a.FIELD_TEXT_HEIGHT/2+a.FIELD_TEXT_BASELINE}`)}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",`${this.size_.width}`),this.borderRect_.setAttribute("height",`${this.size_.height}`),this.borderRect_.setAttribute("rx",`${this.getConstants().FIELD_BORDER_RECT_RADIUS}`),this.borderRect_.setAttribute("ry",`${this.getConstants().FIELD_BORDER_RECT_RADIUS}`))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&this.size_.width===0&&(this.render_(),this.size_.width!==0&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new Xi(0,0)}getScaledBBox(){let t;var o=this.getSourceBlock();if(!o)throw new Ei;if(this.borderRect_){var a=this.borderRect_.getBoundingClientRect();t=Mn(this.borderRect_),o=a.width,a=a.height}else{a=this.sourceBlock_.getHeightWidth();const d=o.workspace.scale;t=this.getAbsoluteXY_(),o=(a.width+1)*d,a=(a.height+1)*d,cm?(t.x+=1.5*d,t.y+=1.5*d):(t.x-=.5*d,t.y-=.5*d)}return new li(t.y,t.y+a,t.x,t.x+o)}getDisplayText_(){let t=this.getText();return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+"…"),t=t.replace(/\s/g,pt.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(t+="‏"),t):pt.NBSP}getText(){const t=this.getText_();return String(t!==null?t:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())}setValue(t){if(t!==null){var o=this.doClassValidation_(t);if(t=this.processValidation_(t,o),!(t instanceof Error)){if((o=this.getValidator())&&(o=o.call(this,t),t=this.processValidation_(t,o),t instanceof Error))return;if(o=this.sourceBlock_,!o||!o.disposed){var a=this.getValue();a===t?this.doValueUpdate_(t):(this.doValueUpdate_(t),o&&Pi()&&De(new(Le(Ui))(o,"field",this.name||null,a,t)),this.isDirty_&&this.forceRerender())}}}}processValidation_(t,o){return o===null?(this.doValueInvalid_(t),this.isDirty_&&this.forceRerender(),Error()):(o!==void 0&&(t=o),t)}getValue(){return this.value_}doClassValidation_(t){return t??null}doValueUpdate_(t){this.value_=t,this.isDirty_=!0}doValueInvalid_(t){}onMouseDown_(t){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)}setTooltip(t){t||t===""||(t=this.sourceBlock_);const o=this.getClickTarget_();o?o.tooltip=t:this.tooltip_=t}getTooltip(){const t=this.getClickTarget_();return $u(t||{tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return Mn(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let t=null;const o=this.getSourceBlock();if(!o)throw new Ei;const a=o.inputList;for(let d=0;d<o.inputList.length;d++){const m=a[d],b=m.fieldRow;for(let I=0;I<b.length;I++)if(b[I]===this){t=m;break}}return t}getFlipRtl(){return!1}isTabNavigable(){return!1}onShortcut(t){return!1}setCursorSvg(t){if(t){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(t),this.cursorSvg_=t}else this.cursorSvg_=null}setMarkerSvg(t){if(t){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(t),this.markerSvg_=t}else this.markerSvg_=null}updateMarkers_(){var t=this.getSourceBlock();if(!t)throw new Ei;t=t.workspace,t.keyboardAccessibilityMode&&this.cursorSvg_&&t.getCursor().draw(),t.keyboardAccessibilityMode&&this.markerSvg_&&t.getMarker(Pu.LOCAL_MARKER).draw()}};pt.NBSP=" ",pt.SKIP_SETUP=new fN;var Ei=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},tv={fromJsonInternal:E3},Vu={};Vu.TEST_ONLY=tv,Vu.fromJson=Up,Vu.register=ds,Vu.unregister=T3;var pN="aria-",mN="role",Rr;(function(t){t.GRID="grid",t.GRIDCELL="gridcell",t.GROUP="group",t.LISTBOX="listbox",t.MENU="menu",t.MENUITEM="menuitem",t.MENUITEMCHECKBOX="menuitemcheckbox",t.OPTION="option",t.PRESENTATION="presentation",t.ROW="row",t.TREE="tree",t.TREEITEM="treeitem"})(Rr||(Rr={}));var Yt;(function(t){t.ACTIVEDESCENDANT="activedescendant",t.COLCOUNT="colcount",t.DISABLED="disabled",t.EXPANDED="expanded",t.INVALID="invalid",t.LABEL="label",t.LABELLEDBY="labelledby",t.LEVEL="level",t.ORIENTATION="orientation",t.POSINSET="posinset",t.ROWCOUNT="rowcount",t.SELECTED="selected",t.SETSIZE="setsize",t.VALUEMAX="valuemax",t.VALUEMIN="valuemin"})(Yt||(Yt={}));var Wu={};Wu.Role=Rr,Wu.State=Yt,Wu.setRole=rn,Wu.setState=ti;var Re;(function(t){t[t.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",t[t.MAC_ENTER=3]="MAC_ENTER",t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.NUM_CENTER=12]="NUM_CENTER",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL=17]="CTRL",t[t.ALT=18]="ALT",t[t.PAUSE=19]="PAUSE",t[t.CAPS_LOCK=20]="CAPS_LOCK",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.PLUS_SIGN=43]="PLUS_SIGN",t[t.PRINT_SCREEN=44]="PRINT_SCREEN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.ZERO=48]="ZERO",t[t.ONE=49]="ONE",t[t.TWO=50]="TWO",t[t.THREE=51]="THREE",t[t.FOUR=52]="FOUR",t[t.FIVE=53]="FIVE",t[t.SIX=54]="SIX",t[t.SEVEN=55]="SEVEN",t[t.EIGHT=56]="EIGHT",t[t.NINE=57]="NINE",t[t.FF_SEMICOLON=59]="FF_SEMICOLON",t[t.FF_EQUALS=61]="FF_EQUALS",t[t.FF_DASH=173]="FF_DASH",t[t.FF_HASH=163]="FF_HASH",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.AT_SIGN=64]="AT_SIGN",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.META=91]="META",t[t.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",t[t.CONTEXT_MENU=93]="CONTEXT_MENU",t[t.NUM_ZERO=96]="NUM_ZERO",t[t.NUM_ONE=97]="NUM_ONE",t[t.NUM_TWO=98]="NUM_TWO",t[t.NUM_THREE=99]="NUM_THREE",t[t.NUM_FOUR=100]="NUM_FOUR",t[t.NUM_FIVE=101]="NUM_FIVE",t[t.NUM_SIX=102]="NUM_SIX",t[t.NUM_SEVEN=103]="NUM_SEVEN",t[t.NUM_EIGHT=104]="NUM_EIGHT",t[t.NUM_NINE=105]="NUM_NINE",t[t.NUM_MULTIPLY=106]="NUM_MULTIPLY",t[t.NUM_PLUS=107]="NUM_PLUS",t[t.NUM_MINUS=109]="NUM_MINUS",t[t.NUM_PERIOD=110]="NUM_PERIOD",t[t.NUM_DIVISION=111]="NUM_DIVISION",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NUMLOCK=144]="NUMLOCK",t[t.SCROLL_LOCK=145]="SCROLL_LOCK",t[t.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",t[t.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",t[t.SEMICOLON=186]="SEMICOLON",t[t.DASH=189]="DASH",t[t.EQUALS=187]="EQUALS",t[t.COMMA=188]="COMMA",t[t.PERIOD=190]="PERIOD",t[t.SLASH=191]="SLASH",t[t.APOSTROPHE=192]="APOSTROPHE",t[t.TILDE=192]="TILDE",t[t.SINGLE_QUOTE=222]="SINGLE_QUOTE",t[t.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",t[t.BACKSLASH=220]="BACKSLASH",t[t.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",t[t.WIN_KEY=224]="WIN_KEY",t[t.MAC_FF_META=224]="MAC_FF_META",t[t.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",t[t.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",t[t.WIN_IME=229]="WIN_IME",t[t.VK_NONAME=252]="VK_NONAME",t[t.PHANTOM=255]="PHANTOM"})(Re||(Re={}));var Pm=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(t){this.menuItems.push(t)}render(t){const o=document.createElement("div");o.className="blocklyMenu goog-menu blocklyNonSelectable",o.tabIndex=0,this.roleName&&rn(o,this.roleName),this.element=o;for(let a=0,d;d=this.menuItems[a];a++)o.appendChild(d.createDom());return this.mouseOverHandler=y(o,"pointerover",this,this.handleMouseOver,!0),this.clickHandler=y(o,"pointerdown",this,this.handleClick,!0),this.mouseEnterHandler=y(o,"pointerenter",this,this.handleMouseEnter,!0),this.mouseLeaveHandler=y(o,"pointerleave",this,this.handleMouseLeave,!0),this.onKeyDownHandler=y(o,"keydown",this,this.handleKeyEvent),t.appendChild(o),o}getElement(){return this.element}focus(){const t=this.getElement();t&&(t.focus({preventScroll:!0}),Ce(t,"blocklyFocused"))}blur(){const t=this.getElement();t&&(t.blur(),qe(t,"blocklyFocused"))}setRole(t){this.roleName=t}dispose(){this.mouseOverHandler&&(C(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(C(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(C(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(C(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(C(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let t=0,o;o=this.menuItems[t];t++)o.dispose();this.element=null}getMenuItem(t){const o=this.getElement();for(;t&&t!==o;){if(t.classList.contains("blocklyMenuItem")){for(let a=0,d;d=this.menuItems[a];a++)if(d.getElement()===t)return d}t=t.parentElement}return null}setHighlighted(t){var o=this.highlightedItem;o&&(o.setHighlighted(!1),this.highlightedItem=null),t&&(t.setHighlighted(!0),this.highlightedItem=t,o=this.getElement(),be(t.getElement(),o),ti(o,Yt.ACTIVEDESCENDANT,t.getId()))}highlightNext(){const t=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(t,1)}highlightPrevious(){const t=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>t?this.menuItems.length:t,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(t,o){t+=o;let a;for(;a=this.menuItems[t];){if(a.isEnabled()){this.setHighlighted(a);break}t+=o}}handleMouseOver(t){(t=this.getMenuItem(t.target))&&(t.isEnabled()?this.highlightedItem!==t&&this.setHighlighted(t):this.setHighlighted(null))}handleClick(t){const o=this.openingCoords;if(this.openingCoords=null,o&&typeof t.clientX=="number"){const a=new ve(t.clientX,t.clientY);if(1>ve.distance(o,a))return}(t=this.getMenuItem(t.target))&&t.performAction()}handleMouseEnter(t){this.focus()}handleMouseLeave(t){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(t){if(this.menuItems.length&&!(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)){var o=this.highlightedItem;switch(t.keyCode){case Re.ENTER:case Re.SPACE:o&&o.performAction();break;case Re.UP:this.highlightPrevious();break;case Re.DOWN:this.highlightNext();break;case Re.PAGE_UP:case Re.HOME:this.highlightFirst();break;case Re.PAGE_DOWN:case Re.END:this.highlightLast();break;default:return}t.preventDefault(),t.stopPropagation()}}getSize(){const t=this.getElement(),o=ql(t);return o.height=t.scrollHeight,o}},Fm=class{constructor(t,o){this.content=t,this.opt_value=o,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const t=document.createElement("div");t.id=bu(),this.element=t,t.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const o=document.createElement("div");if(o.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var a=document.createElement("div");a.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",o.appendChild(a)}return a=this.content,typeof this.content=="string"&&(a=document.createTextNode(this.content)),o.appendChild(a),t.appendChild(o),this.roleName&&rn(t,this.roleName),ti(t,Yt.SELECTED,this.checkable&&this.checked||!1),ti(t,Yt.DISABLED,!this.enabled),t}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let t;return(t=this.opt_value)!=null?t:null}setRightToLeft(t){this.rightToLeft=t}setRole(t){this.roleName=t}setCheckable(t){this.checkable=t}setChecked(t){this.checked=t}setHighlighted(t){this.highlight=t;const o=this.getElement();o&&this.isEnabled()&&(t?(Ce(o,"blocklyMenuItemHighlight"),Ce(o,"goog-menuitem-highlight")):(qe(o,"blocklyMenuItemHighlight"),qe(o,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(t,o){this.actionHandler=t.bind(o)}},Gs=class extends pt{constructor(t,o,a){super(pt.SKIP_SETUP),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null,this.SERIALIZABLE=!0,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions_=null,$3(t)&&(Array.isArray(t)?($E(t),t=v3(t),this.menuGenerator_=t.options,this.prefixField=t.prefix||null,this.suffixField=t.suffix||null):this.menuGenerator_=t,this.selectedOption_=this.getOptions(!1)[0],a&&this.configure_(a),this.setValue(this.selectedOption_[1]),o&&this.setValidator(o))}fromXml(t){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t.textContent)}loadState(t){this.loadLegacyState(Gs,t)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=z(G.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&Ce(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let t;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!((t=this.getSourceBlock())!=null&&t.isShadow())}createTextArrow_(){this.arrow_=z(G.TSPAN,{},this.textElement_);let t;this.arrow_.appendChild(document.createTextNode((t=this.getSourceBlock())!=null&&t.RTL?Gs.ARROW_CHAR+" ":" "+Gs.ARROW_CHAR));let o;(o=this.getSourceBlock())!=null&&o.RTL?this.getTextElement().insertBefore(this.arrow_,this.textContent_):this.getTextElement().appendChild(this.arrow_)}createSVGArrow_(){this.svgArrow_=z(G.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(Or,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(t){var o=this.getSourceBlock();if(!o)throw new Ei;this.dropdownCreate_(),this.menu_.openingCoords=t&&typeof t.clientX=="number"?new ve(t.clientX,t.clientY):null,or(),t=this.menu_.render(Jl()),Ce(t,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=o.isShadow()?o.getParent().getColour():o.getColour(),o=o.isShadow()?o.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,S(t,o)),H(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()}dropdownCreate_(){const t=this.getSourceBlock();if(!t)throw new Ei;const o=new Pm;o.setRole(Rr.LISTBOX),this.menu_=o;const a=this.getOptions(!1);this.selectedMenuItem_=null;for(let m=0;m<a.length;m++){const[b,I]=a[m];if(typeof b=="object"){var d=new Image(b.width,b.height);d.src=b.src,d.alt=b.alt||""}else d=b;d=new Fm(d,I),d.setRole(Rr.OPTION),d.setRightToLeft(t.RTL),d.setCheckable(!0),o.addChild(d),d.setChecked(I===this.value_),I===this.value_&&(this.selectedMenuItem_=d),d.onAction(this.handleMenuActionEvent_,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()}handleMenuActionEvent_(t){_u(this,!0),this.onItemSelected_(this.menu_,t)}onItemSelected_(t,o){this.setValue(o.getValue())}isOptionListDynamic(){return typeof this.menuGenerator_=="function"}getOptions(t){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:t&&this.generatedOptions_?this.generatedOptions_:(this.generatedOptions_=this.menuGenerator_(),$E(this.generatedOptions_),this.generatedOptions_)}doClassValidation_(t){return this.getOptions(!0).some(o=>o[1]===t)?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)}doValueUpdate_(t){super.doValueUpdate_(t),t=this.getOptions(!0);for(let o=0,a;a=t[o];o++)a[1]===this.value_&&(this.selectedOption_=a)}applyColour(){const t=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",t.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",t.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow_&&(this.sourceBlock_.isShadow()?this.arrow_.style.fill=t.colourSecondary:this.arrow_.style.fill=t.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement_.style.display="none";const t=this.selectedOption_&&this.selectedOption_[0];t&&typeof t=="object"?this.renderSelectedImage_(t):this.renderSelectedText_(),this.positionBorderRect_()}renderSelectedImage_(t){const o=this.getSourceBlock();if(!o)throw new Ei;this.imageElement_.style.display="",this.imageElement_.setAttributeNS(Or,"xlink:href",t.src),this.imageElement_.setAttribute("height",`${t.height}`),this.imageElement_.setAttribute("width",`${t.width}`);const a=Number(t.height);t=Number(t.width);var d=!!this.borderRect_;const m=Math.max(d?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,a+_N);d=d?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let b;b=this.svgArrow_?this.positionSVGArrow_(t+d,m/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):as(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=t+b+2*d,this.size_.height=m;let I=0;o.RTL?this.imageElement_.setAttribute("x",(d+b).toString()):(I=t+b,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",d.toString())),this.imageElement_.setAttribute("y",(m/2-a/2).toString()),this.positionTextElement_(I+d,t+b)}renderSelectedText_(){this.getTextContent().nodeValue=this.getDisplayText_();var t=this.getTextElement();Ce(t,"blocklyDropdownText"),t.setAttribute("text-anchor","start");var o=!!this.borderRect_;t=Math.max(o?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const a=as(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);o=o?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let d=0;this.svgArrow_&&(d=this.positionSVGArrow_(a+o,t/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=a+d+2*o,this.size_.height=t,this.positionTextElement_(o,a)}positionSVGArrow_(t,o){if(!this.svgArrow_)return 0;const a=this.getSourceBlock();if(!a)throw new Ei;const d=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,m=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,b=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(a.RTL?d:t+m)+","+o+")"),b+m}getText_(){if(!this.selectedOption_)return null;const t=this.selectedOption_[0];return typeof t=="object"?t.alt:t}static fromJson(t){if(!t.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(t.options,void 0,t)}};Gs.CHECKMARK_OVERHANG=25,Gs.MAX_MENU_HEIGHT_VH=.45,Gs.ARROW_CHAR="▾";var gN=5,_N=2*gN;ds("field_dropdown",Gs),i.module$build$src$core$field_dropdown={},i.module$build$src$core$field_dropdown.FieldDropdown=Gs;var Um=class extends Fs{constructor(t,o,a){super(t?t.workspace.id:void 0),this.type=Gn,t&&(this.blockId=t.id,this.isOpen=o,this.bubbleType=a)}toJson(){const t=super.toJson();if(this.isOpen===void 0)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return t.isOpen=this.isOpen,t.bubbleType=this.bubbleType,t.blockId=this.blockId||"",t}fromJson(t){s("Blockly.Events.BubbleOpen.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.isOpen=t.isOpen,this.bubbleType=t.bubbleType,this.blockId=t.blockId}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new Um),o.isOpen=t.isOpen,o.bubbleType=t.bubbleType,o.blockId=t.blockId,o}},Hm;(function(t){t.MUTATOR="mutator",t.COMMENT="comment",t.WARNING="warning"})(Hm||(Hm={})),tt(fe.EVENT,Gn,Um);var ii=class{constructor(t,o,a,d,m){this.workspace=t,this.horizontal=o,this.oldHostMetrics=null,this.ratio=1,this.origin=new ve(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new ve(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=a||!1,this.margin=m!==void 0?m:ii.DEFAULT_SCROLLBAR_MARGIN,t="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),d&&(t+=" "+d),this.outerSvg=z(G.SVG,{class:t}),d=z(G.G,{},this.outerSvg),this.svgBackground=z(G.RECT,{class:"blocklyScrollbarBackground"},d),t=Math.floor((ii.scrollbarThickness-5)/2),this.svgHandle=z(G.RECT,{class:"blocklyScrollbarHandle",rx:t,ry:t},d),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),pi(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),o?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=y(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=y(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const t=ii.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(t)),this.outerSvg.setAttribute("height",String(t)),this.svgHandle.setAttribute("height",String(t-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(t)),this.outerSvg.setAttribute("width",String(t)),this.svgHandle.setAttribute("width",String(t-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),C(this.onMouseDownBarWrapper_),C(this.onMouseDownHandleWrapper_),ft(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(t){return t=0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength)}setHandleLength(t){this.handleLength=t,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(t){return t=0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength-this.handleLength)}setHandlePosition(t){this.handlePosition=t,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(t){this.scrollbarLength=t,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(t,o){this.position.x=t,this.position.y=o,Wr(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(t){!t&&(t=this.workspace.getMetrics(),!t)||this.oldHostMetrics&&ii.metricsAreEquivalent(t,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(t):this.resizeVertical(t),this.oldHostMetrics=t,this.updateMetrics())}requiresViewResize(t){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==t.viewWidth||this.oldHostMetrics.viewHeight!==t.viewHeight||this.oldHostMetrics.absoluteLeft!==t.absoluteLeft||this.oldHostMetrics.absoluteTop!==t.absoluteTop:!0}resizeHorizontal(t){this.requiresViewResize(t)?this.resizeViewHorizontal(t):this.resizeContentHorizontal(t)}resizeViewHorizontal(t){var o=t.viewWidth-2*this.margin;this.pair&&(o-=ii.scrollbarThickness),this.setScrollbarLength(Math.max(0,o)),o=t.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(o+=ii.scrollbarThickness),this.setPosition(o,t.absoluteTop+t.viewHeight-ii.scrollbarThickness-this.margin),this.resizeContentHorizontal(t)}resizeContentHorizontal(t){if(t.viewWidth>=t.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var o=this.scrollbarLength*t.viewWidth/t.scrollWidth;o=this.constrainHandleLength(o),this.setHandleLength(o),o=t.scrollWidth-t.viewWidth;var a=this.scrollbarLength-this.handleLength;t=(t.viewLeft-t.scrollLeft)/o*a,t=this.constrainHandlePosition(t),this.setHandlePosition(t),this.ratio=a/o}}resizeVertical(t){this.requiresViewResize(t)?this.resizeViewVertical(t):this.resizeContentVertical(t)}resizeViewVertical(t){let o=t.viewHeight-2*this.margin;this.pair&&(o-=ii.scrollbarThickness),this.setScrollbarLength(Math.max(0,o)),this.setPosition(this.workspace.RTL?t.absoluteLeft+this.margin:t.absoluteLeft+t.viewWidth-ii.scrollbarThickness-this.margin,t.absoluteTop+this.margin),this.resizeContentVertical(t)}resizeContentVertical(t){if(t.viewHeight>=t.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var o=this.scrollbarLength*t.viewHeight/t.scrollHeight;o=this.constrainHandleLength(o),this.setHandleLength(o),o=t.scrollHeight-t.viewHeight;var a=this.scrollbarLength-this.handleLength;t=(t.viewTop-t.scrollTop)/o*a,t=this.constrainHandlePosition(t),this.setHandlePosition(t),this.ratio=a/o}}isVisible(){return this.isHandleVisible}setContainerVisible(t){const o=t!==this.containerVisible;this.containerVisible=t,o&&this.updateDisplay_()}setVisible(t){const o=t!==this.isVisible();if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.isHandleVisible=t,o&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(t){if(this.workspace.markFocused(),u(),this.cleanUp(),j(t))t.stopPropagation();else{var o=F(t,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());o=this.horizontal?o.x:o.y;var a=Nh(this.svgHandle);a=this.horizontal?a.x:a.y;var d=this.handlePosition,m=.95*this.handleLength;o<=a?d-=m:o>=a+this.handleLength&&(d+=m),this.setHandlePosition(this.constrainHandlePosition(d)),this.updateMetrics(),t.stopPropagation(),t.preventDefault()}}onMouseDownHandle(t){this.workspace.markFocused(),this.cleanUp(),j(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition,this.workspace.setupDragSurface(),this.startDragMouse=this.horizontal?t.clientX:t.clientY,this.onMouseUpWrapper_=y(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=y(document,"pointermove",this,this.onMouseMoveHandle),t.stopPropagation(),t.preventDefault())}onMouseMoveHandle(t){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?t.clientX:t.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){this.workspace.resetDragSurface(),u(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(C(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(C(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let t=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(t)&&(t=0),t}updateMetrics(){const t=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:t}):this.workspace.setMetrics({y:t})}set(t,o){this.setHandlePosition(this.constrainHandlePosition(t*this.ratio)),(o||o===void 0)&&this.updateMetrics()}setOrigin(t,o){this.origin=new ve(t,o)}static metricsAreEquivalent(t,o){return t.viewWidth===o.viewWidth&&t.viewHeight===o.viewHeight&&t.viewLeft===o.viewLeft&&t.viewTop===o.viewTop&&t.absoluteTop===o.absoluteTop&&t.absoluteLeft===o.absoluteLeft&&t.scrollWidth===o.scrollWidth&&t.scrollHeight===o.scrollHeight&&t.scrollLeft===o.scrollLeft&&t.scrollTop===o.scrollTop}};ii.scrollbarThickness=I$?25:15,ii.DEFAULT_SCROLLBAR_MARGIN=.5;var Qe=class{constructor(t,o,a,d,m,b){this.resizeGroup=this.bubbleBack=this.bubbleArrow=this.bubbleGroup=null,this.height=this.width=this.relativeTop=this.relativeLeft=0,this.autoLayout=!0,this.onMouseDownResizeWrapper=this.onMouseDownBubbleWrapper=this.moveCallback=this.resizeCallback=null,this.rendered=this.disposed=!1,this.workspace_=t,this.content_=o,this.shape_=a,a=Qe.ARROW_ANGLE,this.workspace_.RTL&&(a=-a),this.arrowRadians=Bi(a),t.getBubbleCanvas().appendChild(this.createDom(o,!(!m||!b))),this.setAnchorLocation(d),m&&b||(t=this.content_.getBBox(),m=t.width+2*Qe.BORDER_WIDTH,b=t.height+2*Qe.BORDER_WIDTH),this.setBubbleSize(m,b),this.positionBubble(),this.renderArrow(),this.rendered=!0}createDom(t,o){this.bubbleGroup=z(G.G,{});var a={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return N$&&(a={}),a=z(G.G,a,this.bubbleGroup),this.bubbleArrow=z(G.PATH,{},a),this.bubbleBack=z(G.RECT,{class:"blocklyDraggable",x:0,y:0,rx:Qe.BORDER_WIDTH,ry:Qe.BORDER_WIDTH},a),o?(this.resizeGroup=z(G.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup),o=2*Qe.BORDER_WIDTH,z(G.POLYGON,{points:"0,x x,x x,0".replace(/x/g,o.toString())},this.resizeGroup),z(G.LINE,{class:"blocklyResizeLine",x1:o/3,y1:o-1,x2:o-1,y2:o/3},this.resizeGroup),z(G.LINE,{class:"blocklyResizeLine",x1:2*o/3,y1:o-1,x2:o-1,y2:2*o/3},this.resizeGroup)):this.resizeGroup=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper=y(this.bubbleBack,"pointerdown",this,this.bubbleMouseDown),this.resizeGroup&&(this.onMouseDownResizeWrapper=y(this.resizeGroup,"pointerdown",this,this.resizeMouseDown))),this.bubbleGroup.appendChild(t),this.bubbleGroup}getSvgRoot(){return this.bubbleGroup}setSvgId(t){let o;(o=this.bubbleGroup)==null||o.setAttribute("data-block-id",t)}bubbleMouseDown(t){const o=this.workspace_.getGesture(t);o&&o.handleBubbleStart(t,this)}showContextMenu(t){}isDeletable(){return!1}setDeleteStyle(t){}resizeMouseDown(t){this.promote(),Qe.unbindDragEvents(),j(t)||(this.workspace_.startDrag(t,new ve(this.workspace_.RTL?-this.width:this.width,this.height)),Qe.onMouseUpWrapper=y(document,"pointerup",this,Qe.bubbleMouseUp),Qe.onMouseMoveWrapper=y(document,"pointermove",this,this.resizeMouseMove),this.workspace_.hideChaff()),t.stopPropagation()}resizeMouseMove(t){this.autoLayout=!1,t=this.workspace_.moveDrag(t),this.setBubbleSize(this.workspace_.RTL?-t.x:t.x,t.y),this.workspace_.RTL&&this.positionBubble()}registerResizeEvent(t){this.resizeCallback=t}registerMoveEvent(t){this.moveCallback=t}promote(){let t;const o=(t=this.bubbleGroup)==null?void 0:t.parentNode;return(o==null?void 0:o.lastChild)!==this.bubbleGroup&&this.bubbleGroup?(o==null||o.appendChild(this.bubbleGroup),!0):!1}setAnchorLocation(t){this.anchorXY=t,this.rendered&&this.positionBubble()}layoutBubble(){var t=this.workspace_.getMetricsManager().getViewMetrics(!0),o=this.getOptimalRelativeLeft(t),a=this.getOptimalRelativeTop(t),d=this.shape_.getBBox();const m={x:o,y:-this.height-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},b={x:-this.width-30,y:a};a={x:d.width,y:a};var I={x:o,y:d.height};o=d.width<d.height?a:I,d=d.width<d.height?I:a,a=this.getOverlap(m,t),I=this.getOverlap(b,t);const L=this.getOverlap(o,t);t=this.getOverlap(d,t),t=Math.max(a,I,L,t),a===t?(this.relativeLeft=m.x,this.relativeTop=m.y):I===t?(this.relativeLeft=b.x,this.relativeTop=b.y):L===t?(this.relativeLeft=o.x,this.relativeTop=o.y):(this.relativeLeft=d.x,this.relativeTop=d.y)}getOverlap(t,o){var a=this.workspace_.RTL?this.anchorXY.x-t.x-this.width:t.x+this.anchorXY.x;return t=t.y+this.anchorXY.y,Math.max(0,Math.min(1,(Math.min(a+this.width,o.left+o.width)-Math.max(a,o.left))*(Math.min(t+this.height,o.top+o.height)-Math.max(t,o.top))/(this.width*this.height)))}getOptimalRelativeLeft(t){let o=-this.width/4;if(this.width>t.width)return o;if(this.workspace_.RTL){var a=this.anchorXY.x-o,d=t.left+t.width;t=t.left+ii.scrollbarThickness/this.workspace_.scale,a-this.width<t?o=-(t-this.anchorXY.x+this.width):a>d&&(o=-(d-this.anchorXY.x))}else{a=o+this.anchorXY.x,d=a+this.width;const m=t.left;t=t.left+t.width-ii.scrollbarThickness/this.workspace_.scale,a<m?o=m-this.anchorXY.x:d>t&&(o=t-this.anchorXY.x-this.width)}return o}getOptimalRelativeTop(t){let o=-this.height/4;if(this.height>t.height)return o;const a=this.anchorXY.y+o,d=a+this.height,m=t.top;t=t.top+t.height-ii.scrollbarThickness/this.workspace_.scale;const b=this.anchorXY.y;return a<m?o=m-b:d>t&&(o=t-b-this.height),o}positionBubble(){let t=this.anchorXY.x;t=this.workspace_.RTL?t-(this.relativeLeft+this.width):t+this.relativeLeft,this.moveTo(t,this.relativeTop+this.anchorXY.y)}moveTo(t,o){let a;(a=this.bubbleGroup)==null||a.setAttribute("transform","translate("+t+","+o+")")}setDragging(t){!t&&this.moveCallback&&this.moveCallback()}getBubbleSize(){return new Xi(this.width,this.height)}setBubbleSize(t,o){const a=2*Qe.BORDER_WIDTH;t=Math.max(t,a+45),o=Math.max(o,a+20),this.width=t,this.height=o;let d;(d=this.bubbleBack)==null||d.setAttribute("width",t.toString());let m;(m=this.bubbleBack)==null||m.setAttribute("height",o.toString()),this.resizeGroup&&(this.workspace_.RTL?this.resizeGroup.setAttribute("transform","translate("+2*Qe.BORDER_WIDTH+","+(o-a)+") scale(-1 1)"):this.resizeGroup.setAttribute("transform","translate("+(t-a)+","+(o-a)+")")),this.autoLayout&&this.layoutBubble(),this.positionBubble(),this.renderArrow(),this.resizeCallback&&this.resizeCallback()}renderArrow(){const t=[];var o=this.width/2,a=this.height/2,d=-this.relativeLeft,m=-this.relativeTop;if(o===d&&a===m)t.push("M "+o+","+a);else{m-=a,d-=o,this.workspace_.RTL&&(d*=-1);var b=Math.sqrt(m*m+d*d),I=Math.acos(d/b);0>m&&(I=2*Math.PI-I);var L=I+Math.PI/2;L>2*Math.PI&&(L-=2*Math.PI);var oe=Math.sin(L);const Jt=Math.cos(L);var ye=this.getBubbleSize();L=(ye.width+ye.height)/Qe.ARROW_THICKNESS,L=Math.min(L,ye.width,ye.height)/4,ye=1-Qe.ANCHOR_RADIUS/b,d=o+ye*d,m=a+ye*m,ye=o+L*Jt;const Qr=a+L*oe;o-=L*Jt,a-=L*oe,oe=I+this.arrowRadians,oe>2*Math.PI&&(oe-=2*Math.PI),I=Math.sin(oe)*b/Qe.ARROW_BEND,b=Math.cos(oe)*b/Qe.ARROW_BEND,t.push("M"+ye+","+Qr),t.push("C"+(ye+b)+","+(Qr+I)+" "+d+","+m+" "+d+","+m),t.push("C"+d+","+m+" "+(o+b)+","+(a+I)+" "+o+","+a)}t.push("z");let yt;(yt=this.bubbleArrow)==null||yt.setAttribute("d",t.join(" "))}setColour(t){let o;(o=this.bubbleBack)==null||o.setAttribute("fill",t);let a;(a=this.bubbleArrow)==null||a.setAttribute("fill",t)}dispose(){this.onMouseDownBubbleWrapper&&C(this.onMouseDownBubbleWrapper),this.onMouseDownResizeWrapper&&C(this.onMouseDownResizeWrapper),Qe.unbindDragEvents(),ft(this.bubbleGroup),this.disposed=!0}moveDuringDrag(t,o){t?t.translateSurface(o.x,o.y):this.moveTo(o.x,o.y),this.relativeLeft=this.workspace_.RTL?this.anchorXY.x-o.x-this.width:o.x-this.anchorXY.x,this.relativeTop=o.y-this.anchorXY.y,this.renderArrow()}getRelativeToSurfaceXY(){return new ve(this.workspace_.RTL?-this.relativeLeft+this.anchorXY.x-this.width:this.anchorXY.x+this.relativeLeft,this.anchorXY.y+this.relativeTop)}setAutoLayout(t){this.autoLayout=t}static unbindDragEvents(){Qe.onMouseUpWrapper&&(C(Qe.onMouseUpWrapper),Qe.onMouseUpWrapper=null),Qe.onMouseMoveWrapper&&(C(Qe.onMouseMoveWrapper),Qe.onMouseMoveWrapper=null)}static bubbleMouseUp(t){u(),Qe.unbindDragEvents()}static textToDom(t){const o=z(G.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:Qe.BORDER_WIDTH});t=t.split(`
`);for(let a=0;a<t.length;a++){const d=z(G.TSPAN,{dy:"1em",x:Qe.BORDER_WIDTH},o),m=document.createTextNode(t[a]);d.appendChild(m)}return o}static createNonEditableBubble(t,o,a){if(a=new Qe(o.workspace,t,o.pathObject.svgPath,a,null,null),a.setSvgId(o.id),o.RTL){o=t.getBBox().width;for(let d=0,m;m=t.childNodes[d];d++)m.setAttribute("text-anchor","end"),m.setAttribute("x",(o+Qe.BORDER_WIDTH).toString())}return a}};Qe.BORDER_WIDTH=6,Qe.ARROW_THICKNESS=5,Qe.ARROW_ANGLE=20,Qe.ARROW_BEND=4,Qe.ANCHOR_RADIUS=8,Qe.onMouseUpWrapper=null,Qe.onMouseMoveWrapper=null;var Gm,iv;Gm=28,i.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:Gm,connectingSnapRadius:Gm,currentConnectionPreference:8,bumpDelay:250},iv={},iv.config=i.config$$module$build$src$core$config;var vd=class{constructor(t){this.iconGroup_=null,this.collapseHidden=!0,this.SIZE=17,this.iconXY_=this.bubble_=null,t||s("Calling the Icon constructor with a null block","version 9","version 10","a non-null block"),this.block_=t}createIcon(){this.iconGroup_||(this.iconGroup_=z(G.G,{class:"blocklyIconGroup"}),this.getBlock().isInFlyout&&Ce(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.getBlock().getSvgRoot().appendChild(this.iconGroup_),y(this.iconGroup_,"pointerup",this,this.iconClick_),this.updateEditable())}dispose(){ft(this.iconGroup_),this.setVisible(!1)}updateEditable(){}isVisible(){return!!this.bubble_}iconClick_(t){this.getBlock().workspace.isDragging()||this.getBlock().isInFlyout||j(t)||this.setVisible(!this.isVisible())}applyColour(){this.bubble_&&this.isVisible()&&this.bubble_.setColour(this.getBlock().style.colourPrimary)}setIconLocation(t){this.iconXY_=t,this.bubble_&&this.isVisible()&&this.bubble_.setAnchorLocation(t)}computeIconLocation(){var t=this.getBlock().getRelativeToSurfaceXY();const o=Ls(this.iconGroup_);t=new ve(t.x+o.x+this.SIZE/2,t.y+o.y+this.SIZE/2),ve.equals(this.getIconLocation(),t)||this.setIconLocation(t)}getIconLocation(){return this.iconXY_}getCorrectedSize(){return new Xi(this.SIZE,this.SIZE-2)}drawIcon_(t){}setVisible(t){}getBlock(){if(!this.block_)throw Error("Block is not set for this icon.");return this.block_}},zu={};zu.deepMerge=go,zu.inherits=S3,zu.mixin=I3,zu.values=k3;var Tl=class{constructor(t,o,a,d){this.name=t,this.startHats=!1,this.blockStyles=o||Object.create(null),this.categoryStyles=a||Object.create(null),this.componentStyles=d||Object.create(null),this.fontStyle=Object.create(null),tt(fe.THEME,t,this)}getClassName(){return this.name+"-theme"}setBlockStyle(t,o){this.blockStyles[t]=o}setCategoryStyle(t,o){this.categoryStyles[t]=o}getComponentStyle(t){return(t=this.componentStyles[t])&&typeof t=="string"&&this.getComponentStyle(t)?this.getComponentStyle(t):t?String(t):null}setComponentStyle(t,o){this.componentStyles[t]=o}setFontStyle(t){this.fontStyle=t}setStartHats(t){this.startHats=t}static defineTheme(t,o){t=t.toLowerCase();const a=new Tl(t);let d=o.base;if(d){if(typeof d=="string"){let m;d=(m=kh(fe.THEME,d))!=null?m:void 0}d instanceof Tl&&(go(a,d),a.name=t)}return go(a.blockStyles,o.blockStyles),go(a.categoryStyles,o.categoryStyles),go(a.componentStyles,o.componentStyles),go(a.fontStyle,o.fontStyle),o.startHats!==null&&(a.startHats=o.startHats),a}},bN={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},TN={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},yd=new Tl("classic",bN,TN),Vm="categoryToolbox",rv="flyoutToolbox",Je;(function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"})(Je||(Je={}));var sv={hasCategoriesInternal:C3},yo={};yo.Position=Je,yo.TEST_ONLY=sv,yo.convertFlyoutDefToJsonArray=Uh,yo.convertToolboxDefToJson=Fh,yo.hasCategories=Hp,yo.isCategoryCollapsible=Gp,yo.parseToolboxTree=yE;var Vs=class{constructor(t){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let o=null,a=!1;var d=!1,m=!1,b=!1,I=!1,L=!1;const oe=!!t.readOnly;if(!oe){var ye;o=Fh((ye=t.toolbox)!=null?ye:null),a=Hp(o),d=t.trashcan,d=d===void 0?a:d,m=t.collapse,m=m===void 0?a:m,b=t.comments,b=b===void 0?a:b,I=t.disable,I=I===void 0?a:I,L=t.sounds,L=L===void 0?!0:L}ye=t.maxTrashcanContents,d?ye===void 0&&(ye=32):ye=0;const yt=!!t.rtl;let Jt=t.horizontalLayout;Jt===void 0&&(Jt=!1);var Qr=t.toolboxPosition!=="end";Qr=Jt?Qr?Je.TOP:Je.BOTTOM:Qr===yt?Je.RIGHT:Je.LEFT;let Yg=t.css;Yg===void 0&&(Yg=!0);let Xg="https://blockly-demo.appspot.com/static/media/";t.media?Xg=t.media.endsWith("/")?t.media:t.media+"/":"path"in t&&(s("path","Nov 2014","Jul 2023","media"),Xg=t.path+"media/");const y2=t.oneBasedIndex,ZN=t.renderer||"geras",ex=t.plugins||{};let jg=t.modalInputs;jg===void 0&&(jg=!0),this.RTL=yt,this.oneBasedIndex=y2===void 0?!0:y2,this.collapse=m,this.comments=b,this.disable=I,this.readOnly=oe,this.maxBlocks=t.maxBlocks||1/0;let S2;this.maxInstances=(S2=t.maxInstances)!=null?S2:null,this.modalInputs=jg,this.pathToMedia=Xg,this.hasCategories=a,this.moveOptions=Vs.parseMoveOptions_(t,a),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=d,this.maxTrashcanContents=ye,this.hasSounds=L,this.hasCss=Yg,this.horizontalLayout=Jt,this.languageTree=o,this.gridOptions=Vs.parseGridOptions_(t),this.zoomOptions=Vs.parseZoomOptions_(t),this.toolboxPosition=Qr,this.theme=Vs.parseThemeOptions_(t),this.renderer=ZN;let I2;this.rendererOverrides=(I2=t.rendererOverrides)!=null?I2:null;let k2;this.parentWorkspace=(k2=t.parentWorkspace)!=null?k2:null,this.plugins=ex}static parseMoveOptions_(t,o){const a=t.move||{},d={};return a.scrollbars===void 0&&t.scrollbars===void 0?d.scrollbars=o:typeof a.scrollbars=="object"?(d.scrollbars={horizontal:!!a.scrollbars.horizontal,vertical:!!a.scrollbars.vertical},d.scrollbars.horizontal&&d.scrollbars.vertical?d.scrollbars=!0:d.scrollbars.horizontal||d.scrollbars.vertical||(d.scrollbars=!1)):d.scrollbars=!!a.scrollbars||!!t.scrollbars,d.wheel=d.scrollbars&&a.wheel!==void 0?!!a.wheel:typeof d.scrollbars=="object",d.drag=d.scrollbars?a.drag===void 0?!0:!!a.drag:!1,d}static parseZoomOptions_(t){t=t.zoom||{};const o={};return o.controls=t.controls===void 0?!1:!!t.controls,o.wheel=t.wheel===void 0?!1:!!t.wheel,o.startScale=t.startScale===void 0?1:Number(t.startScale),o.maxScale=t.maxScale===void 0?3:Number(t.maxScale),o.minScale=t.minScale===void 0?.3:Number(t.minScale),o.scaleSpeed=t.scaleSpeed===void 0?1.2:Number(t.scaleSpeed),o.pinch=t.pinch===void 0?o.wheel||o.controls:!!t.pinch,o}static parseGridOptions_(t){t=t.grid||{};const o={};return o.spacing=Number(t.spacing)||0,o.colour=t.colour||"#888",o.length=t.length===void 0?1:Number(t.length),o.snap=0<o.spacing&&!!t.snap,o}static parseThemeOptions_(t){return t=t.theme||yd,typeof t=="string"?kh(fe.THEME,t):t instanceof Tl?t:Tl.defineTheme(t.name||"builtin"+bu(),t)}},nv;i.Mutator$$module$build$src$core$mutator=class extends vd{constructor(t,o){o||s("Calling the Mutator constructor without passing the block it is attached to","version 9","version 10","the constructor by passing the list of subblocks and the block instance to attach the mutator to"),super(o??null),this.workspace_=null,this.workspaceHeight=this.workspaceWidth=0,this.updateWorkspacePid=this.sourceListener=this.rootBlock=this.svgDialog=null,this.quarkNames=t}setBlock(t){this.block_=t}getWorkspace(){return this.workspace_}drawIcon_(t){z(G.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},t),z(G.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},t),z(G.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},t)}iconClick_(t){this.getBlock().isEditable()&&super.iconClick_(t)}createEditor(){if(this.svgDialog=z(G.SVG,{x:Qe.BORDER_WIDTH,y:Qe.BORDER_WIDTH}),this.quarkNames.length){var t=Dt("xml");for(let d=0,m;m=this.quarkNames[d];d++){var o=Dt("block");o.setAttribute("type",m),t.appendChild(o)}}else t=null;var a=this.getBlock();return o=new Vs({disable:!1,parentWorkspace:a.workspace,media:a.workspace.options.pathToMedia,rtl:a.RTL,horizontalLayout:!1,renderer:a.workspace.options.renderer,rendererOverrides:a.workspace.options.rendererOverrides}),o.toolboxPosition=a.RTL?Je.RIGHT:Je.LEFT,(a=!!t)&&(o.languageTree=Fh(t)),this.workspace_=this.newWorkspaceSvg(o),this.workspace_.internalIsMutator=!0,this.workspace_.addChangeListener($p),t=a?this.workspace_.addFlyout(G.G):null,o=this.workspace_.createDom("blocklyMutatorBackground"),t&&o.insertBefore(t,this.workspace_.svgBlockCanvas_),this.svgDialog.appendChild(o),this.svgDialog}newWorkspaceSvg(t){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}updateEditable(){super.updateEditable(),this.getBlock().isInFlyout||(this.getBlock().isEditable()?this.iconGroup_&&qe(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&Ce(this.iconGroup_,"blocklyIconGroupReadonly")))}resizeBubble(){if(this.workspace_){var t=2*Qe.BORDER_WIDTH,o=this.workspace_.getCanvas(),a=o.getBBox(),d=a.width+a.x,m=a.height+3*t,b=this.workspace_.getFlyout();if(b){const I=b.getWorkspace().getMetricsManager().getScrollMetrics();m=Math.max(m,I.height+20),d+=b.getWidth()}(b=this.getBlock().RTL)&&(d=-a.x),d+=3*t,(Math.abs(this.workspaceWidth-d)>t||Math.abs(this.workspaceHeight-m)>t)&&(this.workspaceWidth=d,this.workspaceHeight=m,this.bubble_.setBubbleSize(d+t,m+t),this.svgDialog.setAttribute("width",`${d}`),this.svgDialog.setAttribute("height",`${m}`),this.workspace_.setCachedParentSvgSize(d,m)),b&&o.setAttribute("transform",`translate(${this.workspaceWidth}, 0)`),this.workspace_.resize()}}onBubbleMove(){this.workspace_&&this.workspace_.recordDragTargets()}setVisible(t){if(t!==this.isVisible()){var o=this.getBlock();if(De(new(Le(Gn))(o,t,"mutator")),t){this.bubble_=new Qe(o.workspace,this.createEditor(),o.pathObject.svgPath,this.iconXY_,null,null),t=this.workspace_,this.bubble_.setSvgId(o.id),this.bubble_.registerMoveEvent(this.onBubbleMove.bind(this));var a=t.options.languageTree,d=t.getFlyout();a&&(d.init(t),d.show(a)),this.rootBlock=o.decompose(t),a=this.rootBlock.getDescendants(!1);for(let m=0,b;b=a[m];m++)b.render();if(this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),d?(a=2*d.CORNER_RADIUS,d=this.rootBlock.RTL?d.getWidth()+a:a):d=a=16,o.RTL&&(d=-d),this.rootBlock.moveBy(d,a),o.saveConnections){const m=this.rootBlock;o.saveConnections(m),this.sourceListener=()=>{const b=this.getBlock();b.saveConnections&&b.saveConnections(m)},o.workspace.addChangeListener(this.sourceListener)}this.resizeBubble(),t.addChangeListener(this.workspaceChanged.bind(this)),this.updateWorkspace(),this.applyColour()}else this.svgDialog=null,this.workspace_.dispose(),this.rootBlock=this.workspace_=null,(d=this.bubble_)==null||d.dispose(),this.bubble_=null,this.workspaceHeight=this.workspaceWidth=0,this.sourceListener&&(o.workspace.removeChangeListener(this.sourceListener),this.sourceListener=null)}}workspaceChanged(t){this.shouldIgnoreMutatorEvent_(t)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.updateWorkspace()},0))}shouldIgnoreMutatorEvent_(t){return t.isUiEvent||t.type===Ji||t.type===Ui&&t.element==="disabled"}updateWorkspace(){if(!this.workspace_.isDragging()){var t=this.workspace_.getTopBlocks(!1);for(let d=0,m;m=t[d];d++){var o=m.getRelativeToSurfaceXY();if(20>o.y&&m.moveBy(0,20-o.y),m.RTL){var a=-20;const b=this.workspace_.getFlyout();b&&(a-=b.getWidth()),o.x>a&&m.moveBy(a-o.x,0)}else 20>o.x&&m.moveBy(20-o.x,0)}}if(this.rootBlock&&this.rootBlock.workspace===this.workspace_){(t=Kt())||He(!0);const d=this.getBlock();if(o=bl.getExtraBlockState_(d),a=d.rendered,d.rendered=!1,d.compose(this.rootBlock),d.rendered=a,d.initSvg(),d.rendered&&d.render(),a=bl.getExtraBlockState_(d),o!==a){De(new(Le(Ui))(d,"mutation",null,o,a));const m=Kt();setTimeout(function(){const b=Kt();He(m),d.bumpNeighbours(),He(b)},i.config$$module$build$src$core$config.bumpDelay)}this.workspace_.isDragging()||setTimeout(()=>this.resizeBubble(),0),He(t)}}dispose(){this.getBlock().mutator=null,super.dispose()}updateBlockStyle(){var t=this.workspace_;if(t&&t.getAllBlocks(!1)){const o=t.getAllBlocks(!1);for(let a=0,d;d=o[a];a++)d.setStyle(d.getStyleName());if(t=t.getFlyout()){t=t.getWorkspace().getAllBlocks(!1);for(let a=0,d;d=t[a];a++)d.setStyle(d.getStyleName())}}}static reconnect(t,o,a){if(!t||!t.getSourceBlock().workspace)return!1;a=o.getInput(a).connection;const d=t.targetBlock();return d&&d!==o||!a||a.targetConnection===t?!1:(a.isConnected()&&a.disconnect(),a.connect(t),!0)}static findParentWs(t){let o=null;if(t&&t.options){const a=t.options.parentWorkspace;t.isFlyout?a&&a.options&&(o=a.options.parentWorkspace):a&&(o=a)}return o}},nv={},nv.Mutator=i.Mutator$$module$build$src$core$mutator;var Ea=Object.create(null),EN={allExtensions:Ea};Hh("parent_tooltip_when_inline",U3),i.module$build$src$core$extensions={},i.module$build$src$core$extensions.TEST_ONLY=EN,i.module$build$src$core$extensions.apply=Wp,i.module$build$src$core$extensions.buildTooltipForDropdown=B3,i.module$build$src$core$extensions.buildTooltipWithFieldText=F3,i.module$build$src$core$extensions.isRegistered=SE,i.module$build$src$core$extensions.register=Hh,i.module$build$src$core$extensions.registerMixin=w3,i.module$build$src$core$extensions.registerMutator=R3,i.module$build$src$core$extensions.runAfterPageLoad=Gh,i.module$build$src$core$extensions.unregister=N3;var ov={};ov.removeElem=kr;var Wn={};Wn.arc=bi,Wn.curve=Yr,Wn.line=vu,Wn.lineOnAxis=ke,Wn.lineTo=Bn,Wn.moveBy=qt,Wn.moveTo=lr,Wn.point=Me;var Tt={};Tt.Coordinate=ve,Tt.KeyCodes=Re,Tt.Rect=li,Tt.Size=Xi,Tt.Svg=G,Tt.aria=Wu,Tt.array=ov,Tt.arrayRemove=j3,Tt.browserEvents=Un,Tt.checkMessageReferences=z3,Tt.colour=ur,Tt.deprecation=Fi,Tt.dom=wi,Tt.extensions=i.module$build$src$core$extensions,Tt.getBlockTypeCounts=q3,Tt.getDocumentScroll=K3,Tt.getInjectionDivXY_=G3,Tt.getRelativeXY=H3,Tt.getViewportBBox=X3,Tt.idGenerator=nd,Tt.is3dSupported=Y3,Tt.math=id,Tt.object=zu,Tt.parseBlockColour=Q3,Tt.parsing=Gu,Tt.replaceMessageReferences=W3,Tt.runAfterPageLoad=Z3,Tt.screenToWsCoordinates=J3,Tt.string=i.module$build$src$core$utils$string,Tt.style=nn,Tt.svgMath=vo,Tt.svgPaths=Wn,Tt.tokenizeInterpolation=V3,Tt.toolbox=yo,Tt.userAgent=Fn,Tt.xml=i.module$build$src$core$utils$xml;var Wm=class extends Fs{constructor(t,o){super(o),this.type=Ru,this.isOpen=t}toJson(){const t=super.toJson();if(this.isOpen===void 0)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return t.isOpen=this.isOpen,t}fromJson(t){s("Blockly.Events.TrashcanOpen.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.isOpen=t.isOpen}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new Wm),o.isOpen=t.isOpen,o}};tt(fe.EVENT,Ru,Wm);var zn=class{constructor(t){this.name_=t}toString(){return this.name_}};zn.POSITIONABLE=new zn("positionable"),zn.DRAG_TARGET=new zn("drag_target"),zn.DELETE_AREA=new zn("delete_area"),zn.AUTOHIDEABLE=new zn("autohideable");var ji=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(t,o){const a=t.component.id;if(!o&&this.componentData.has(a)){var d;throw Error('Plugin "'+a+'" with capabilities "'+((d=this.componentData.get(a))==null?void 0:d.capabilities)+'" already added.')}for(this.componentData.set(a,t),o=[],d=0;d<t.capabilities.length;d++){const m=String(t.capabilities[d]).toLowerCase();if(o.push(m),this.capabilityToComponentIds.has(m)){let b;(b=this.capabilityToComponentIds.get(m))==null||b.push(a)}else this.capabilityToComponentIds.set(m,[a])}this.componentData.get(a).capabilities=o}removeComponent(t){const o=this.componentData.get(t);if(o){for(let a=0;a<o.capabilities.length;a++){const d=String(o.capabilities[a]).toLowerCase();kr(this.capabilityToComponentIds.get(d),t)}this.componentData.delete(t)}}addCapability(t,o){if(!this.getComponent(t))throw Error('Cannot add capability, "'+o+'". Plugin "'+t+'" has not been added to the ComponentManager');if(this.hasCapability(t,o))console.warn('Plugin "'+t+'already has capability "'+o+'"');else{o=String(o).toLowerCase();var a;(a=this.componentData.get(t))==null||a.capabilities.push(o);var d;(d=this.capabilityToComponentIds.get(o))==null||d.push(t)}}removeCapability(t,o){if(!this.getComponent(t))throw Error('Cannot remove capability, "'+o+'". Plugin "'+t+'" has not been added to the ComponentManager');this.hasCapability(t,o)?(o=String(o).toLowerCase(),kr(this.componentData.get(t).capabilities,o),kr(this.capabilityToComponentIds.get(o),t)):console.warn('Plugin "'+t+`doesn't have capability "`+o+'" to remove')}hasCapability(t,o){return o=String(o).toLowerCase(),this.componentData.has(t)&&this.componentData.get(t).capabilities.indexOf(o)!==-1}getComponent(t){let o;return(o=this.componentData.get(t))==null?void 0:o.component}getComponents(t,o){if(t=String(t).toLowerCase(),t=this.capabilityToComponentIds.get(t),!t)return[];const a=[];if(o){const d=[];t.forEach(m=>{d.push(this.componentData.get(m))}),d.sort(function(m,b){return m.weight-b.weight}),d.forEach(function(m){a.push(m.component)})}else t.forEach(d=>{a.push(this.componentData.get(d).component)});return a}};ji.Capability=zn;var Yu=class extends Error{},lv=class extends Yu{constructor(t){super("Expected to find a 'type' property, defining the block type"),this.state=t}},Xu=class extends Yu{constructor(t,o,a){super(`The block ${o.toDevString()} is missing a(n) ${t}
connection`),this.block=o,this.state=a}},av=class extends Yu{constructor(t,o,a,d){super(`The block ${a.toDevString()} could not connect its
${o} to its parent, because: ${t}`),this.childBlock=a,this.childState=d}},uv=class extends Yu{constructor(t){super(`Encountered a real block which is defined as a child of a shadow
block. It is an invariant of Blockly that shadow blocks only have shadow
children`),this.state=t}},$a={};$a.BadConnectionCheck=av,$a.DeserializationError=Yu,$a.MissingBlockType=lv,$a.MissingConnection=Xu,$a.RealChildOfShadow=uv;var cv=100,hv=75,dv=50,Sd={};Sd.BLOCKS=dv,Sd.PROCEDURES=hv,Sd.VARIABLES=cv;var zm={};zm.register=Xp,zm.unregister=e6;var fv=class{constructor(){this.priority=dv}save(t){const o=[];for(const a of t.getTopBlocks(!1))(t=Pn(a,{addCoordinates:!0,doFullSerialization:!1}))&&o.push(t);return o.length?{languageVersion:0,blocks:o}:null}load(t,o){t=t.blocks;for(const a of t)al(a,o,{recordUndo:xs()})}clear(t){for(const o of t.getTopBlocks(!1))o.dispose(!1)}};Xp("blocks",new fv);var ju={};ju.BlockSerializer=fv,ju.append=al,ju.appendInternal=jp,ju.save=Pn;var Ym=class extends ga{constructor(t){super(t),this.type=Ji,t&&(t.isShadow()&&(this.recordUndo=!1),this.xml=xh(t),this.ids=Ch(t),this.json=Pn(t,{addCoordinates:!0}))}toJson(){const t=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.xml=hs(this.xml),t.ids=this.ids,t.json=this.json,this.recordUndo||(t.recordUndo=this.recordUndo),t}fromJson(t){s("Blockly.Events.BlockCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.xml=mr(t.xml),this.ids=t.ids,this.json=t.json,t.recordUndo!==void 0&&(this.recordUndo=t.recordUndo)}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new Ym),o.xml=mr(t.xml),o.ids=t.ids,o.json=t.json,t.recordUndo!==void 0&&(o.recordUndo=t.recordUndo),o}run(t){const o=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(t)al(this.json,o);else for(t=0;t<this.ids.length;t++){const a=this.ids[t],d=o.getBlockById(a);d?d.dispose(!1):a===this.blockId&&console.warn("Can't uncreate non-existent block: "+a)}}};tt(fe.EVENT,Ji,Ym);var Xm=class extends ga{constructor(t){if(super(t),this.type=on,t){if(t.getParent())throw Error("Connected blocks cannot be deleted.");t.isShadow()&&(this.recordUndo=!1),this.oldXml=xh(t),this.ids=Ch(t),this.wasShadow=t.isShadow(),this.oldJson=Pn(t,{addCoordinates:!0})}}toJson(){const t=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.wasShadow===void 0)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.oldXml=hs(this.oldXml),t.ids=this.ids,t.wasShadow=this.wasShadow,t.oldJson=this.oldJson,this.recordUndo||(t.recordUndo=this.recordUndo),t}fromJson(t){s("Blockly.Events.BlockDelete.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.oldXml=mr(t.oldXml),this.ids=t.ids,this.wasShadow=t.wasShadow||this.oldXml.tagName.toLowerCase()==="shadow",this.oldJson=t.oldJson,t.recordUndo!==void 0&&(this.recordUndo=t.recordUndo)}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new Xm),o.oldXml=mr(t.oldXml),o.ids=t.ids,o.wasShadow=t.wasShadow||o.oldXml.tagName.toLowerCase()==="shadow",o.oldJson=t.oldJson,t.recordUndo!==void 0&&(o.recordUndo=t.recordUndo),o}run(t){const o=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(t)for(t=0;t<this.ids.length;t++){const a=this.ids[t],d=o.getBlockById(a);d?d.dispose(!1):a===this.blockId&&console.warn("Can't delete non-existent block: "+a)}else al(this.oldJson,o)}};tt(fe.EVENT,on,Xm);var Ie;(function(t){t[t.INPUT_VALUE=1]="INPUT_VALUE",t[t.OUTPUT_VALUE=2]="OUTPUT_VALUE",t[t.NEXT_STATEMENT=3]="NEXT_STATEMENT",t[t.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"})(Ie||(Ie={})),i.module$build$src$core$connection_type={},i.module$build$src$core$connection_type.ConnectionType=Ie;var Ot=class{constructor(t,o){this.type=o,this.targetConnection=null,this.disposed=!1,this.shadowDom_=this.check_=null,this.y=this.x=0,this.shadowState_=null,this.sourceBlock_=t}connect_(t){const o=Ie.INPUT_VALUE,a=this.getSourceBlock();var d=t.getSourceBlock();t.isConnected()&&t.disconnect();let m;if(this.isConnected()){const I=this.stashShadowState_(),L=this.targetBlock();L.isShadow()?L.dispose(!1):(this.disconnect(),m=L),this.applyShadowState_(I)}let b;Pi()&&(b=new(Le(gr))(d)),_6(this,t),d.setParent(a),b&&(b.recordNew(),De(b)),m&&(t=this.type===o?m.outputConnection:m.previousConnection,(d=Ot.getConnectionForOrphanedConnection(d,t))?t.connect(d):t.onFailedConnect(this))}dispose(){if(this.isConnected()){this.setShadowStateInternal_();const t=this.targetBlock();t&&t.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===Ie.INPUT_VALUE||this.type===Ie.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(t){}connect(t){if(this.targetConnection===t)return!0;if(this.getConnectionChecker().canConnect(this,t,!1)){const o=Kt();o||He(!0),this.isSuperior()?this.connect_(t):t.connect_(this),o||He(!1)}return this.isConnected()}disconnect(){var t=this.targetConnection;if(!t)throw Error("Source connection not connected.");if(t.targetConnection!==this)throw Error("Target connection not connected to source connection.");let o,a;this.isSuperior()?(o=this.sourceBlock_,a=t.getSourceBlock(),t=this):(o=t.getSourceBlock(),a=this.sourceBlock_);const d=Kt();d||He(!0),this.disconnectInternal_(o,a),a.isShadow()||t.respawnShadow_(),d||He(!1)}disconnectInternal_(t,o){let a;Pi()&&(a=new(Le(gr))(o)),(t=this.targetConnection)&&(t.targetConnection=null),this.targetConnection=null,o.setParent(null),a&&(a.recordNew(),De(a))}respawnShadow_(){this.createShadowBlock_(!0)}targetBlock(){if(this.isConnected()){let t,o;return(o=(t=this.targetConnection)==null?void 0:t.getSourceBlock())!=null?o:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(t){return t?(Array.isArray(t)||(t=[t]),this.check_=t,this.onCheckChanged_()):this.check_=null,this}getCheck(){return this.check_}setShadowDom(t){this.setShadowStateInternal_({shadowDom:t})}getShadowDom(t){return t&&this.targetBlock().isShadow()?nl(this.targetBlock()):this.shadowDom_}setShadowState(t){this.setShadowStateInternal_({shadowState:t})}getShadowState(t){return t&&this.targetBlock()&&this.targetBlock().isShadow()?Pn(this.targetBlock()):this.shadowState_}neighbours(t){return[]}getParentInput(){let t=null;const o=this.sourceBlock_.inputList;for(let a=0;a<o.length;a++)if(o[a].connection===this){t=o[a];break}return t}toString(){const t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection===this)var o="Output Connection of ";else if(t.previousConnection===this)o="Previous Connection of ";else if(t.nextConnection===this)o="Next Connection of ";else{o=null;for(let a=0,d;d=t.inputList[a];a++)if(d.connection===this){o=d;break}if(o)o='Input "'+o.name+'" connection on ';else return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection"}return o+t.toDevString()}stashShadowState_(){const t=this.getShadowDom(!0),o=this.getShadowState(!0);return this.shadowState_=this.shadowDom_=null,{shadowDom:t,shadowState:o}}applyShadowState_({shadowDom:t,shadowState:o}){this.shadowDom_=t,this.shadowState_=o}setShadowStateInternal_({shadowDom:t=null,shadowState:o=null}={}){this.shadowDom_=t,this.shadowState_=o,(t=this.targetBlock())?t.isShadow()?(t.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock())):(t=this.createShadowBlock_(!1),this.serializeShadow_(t),t&&t.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock()))}createShadowBlock_(t){var o=this.getSourceBlock();const a=this.getShadowState(),d=this.getShadowDom();if(o.isDeadOrDying()||!a&&!d)return null;if(a)return o=jp(a,o.workspace,{parentConnection:t?this:void 0,isShadow:!0,recordUndo:!1});if(d){if(o=ea(d,o.workspace),t)if(this.type===Ie.INPUT_VALUE){if(!o.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(o.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===Ie.NEXT_STATEMENT){if(!o.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(o.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return o}return null}serializeShadow_(t){t&&(this.shadowDom_=nl(t),this.shadowState_=Pn(t))}static getConnectionForOrphanedConnection(t,o){if(o.type===Ie.OUTPUT_VALUE)return T6(t,o.getSourceBlock());t=t.lastConnectionInStack(!0);const a=o.getConnectionChecker();return t&&a.canConnect(o,t,!1)?t:null}};Ot.CAN_CONNECT=0,Ot.REASON_SELF_CONNECTION=1,Ot.REASON_WRONG_TYPE=2,Ot.REASON_TARGET_NULL=3,Ot.REASON_CHECKS_FAILED=4,Ot.REASON_DIFFERENT_WORKSPACES=5,Ot.REASON_SHADOW_PARENT=6,Ot.REASON_DRAG_CHECKS_FAILED=7,Ot.REASON_PREVIOUS_AND_OUTPUT=8;var Ku="_TEMP_COLLAPSED_INPUT",qu="_TEMP_COLLAPSED_FIELD",jm={};jm.COLLAPSED_FIELD_NAME=qu,jm.COLLAPSED_INPUT_NAME=Ku,i.FieldLabel$$module$build$src$core$field_label=class extends pt{constructor(t,o,a){super(pt.SKIP_SETUP),this.class_=null,this.EDITABLE=!1,t!==pt.SKIP_SETUP&&(a?this.configure_(a):this.class_=o||null,this.setValue(t))}configure_(t){super.configure_(t),t.class&&(this.class_=t.class)}initView(){this.createTextElement_(),this.class_&&Ce(this.getTextElement(),this.class_)}doClassValidation_(t){return t==null?null:String(t)}setClass(t){this.textElement_&&(this.class_&&qe(this.textElement_,this.class_),t&&Ce(this.textElement_,t)),this.class_=t}static fromJson(t){return new this(oi(t.text),void 0,t)}},ds("field_label",i.FieldLabel$$module$build$src$core$field_label),i.FieldLabel$$module$build$src$core$field_label.prototype.DEFAULT_VALUE="",i.FieldLabel$$module$build$src$core$field_label;var va=class{constructor(t,o,a,d){if(this.type=t,this.name=o,this.connection=d,this.fieldRow=[],this.align=i.Align$$module$build$src$core$input.LEFT,this.visible=!0,t!==it.DUMMY&&!o)throw Error("Value inputs and statement inputs must have non-empty name.");this.sourceBlock=a}getSourceBlock(){return this.sourceBlock}appendField(t,o){return this.insertFieldAt(this.fieldRow.length,t,o),this}insertFieldAt(t,o,a){if(0>t||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return(o||o===""&&a)&&(typeof o=="string"&&(o=Up({type:"field_label",text:o})),o.setSourceBlock(this.sourceBlock),this.sourceBlock.rendered&&(o.init(),o.applyColour()),o.name=a,o.setVisible(this.isVisible()),o.prefixField&&(t=this.insertFieldAt(t,o.prefixField)),this.fieldRow.splice(t,0,o),t++,o.suffixField&&(t=this.insertFieldAt(t,o.suffixField)),this.sourceBlock.rendered&&(this.sourceBlock.render(),this.sourceBlock.bumpNeighbours())),t}removeField(t,o){for(let a=0,d;d=this.fieldRow[a];a++)if(d.name===t)return d.dispose(),this.fieldRow.splice(a,1),this.sourceBlock.rendered&&(this.sourceBlock.render(),this.sourceBlock.bumpNeighbours()),!0;if(o)return!1;throw Error('Field "'+t+'" not found.')}isVisible(){return this.visible}setVisible(t){let o=[];if(this.visible===t)return o;this.visible=t;for(let d=0,m;m=this.fieldRow[d];d++)m.setVisible(t);if(this.connection){var a=this.connection;t?o=a.startTrackingAll():a.stopTrackingAll(),(a=a.targetBlock())&&(a.getSvgRoot().style.display=t?"block":"none")}return o}markDirty(){for(let t=0,o;o=this.fieldRow[t];t++)o.markDirty()}setCheck(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(t),this}setAlign(t){return this.align=t,this.sourceBlock.rendered&&this.sourceBlock.render(),this}setShadowDom(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(t),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){if(this.sourceBlock.workspace.rendered)for(let t=0;t<this.fieldRow.length;t++)this.fieldRow[t].init()}dispose(){for(let t=0,o;o=this.fieldRow[t];t++)o.dispose();this.connection&&this.connection.dispose()}},Km;(function(t){t=t.Align||(t.Align={}),t[t.LEFT=-1]="LEFT",t[t.CENTRE=0]="CENTRE",t[t.RIGHT=1]="RIGHT"})(va||(va={})),i.Align$$module$build$src$core$input=va.Align,Km={},Km.Align=i.Align$$module$build$src$core$input,Km.Input=va;var le=class{constructor(t,o,a){if(this.wsCoordinate_=null,!o)throw Error("Cannot create a node without a location.");this.type_=t,this.isConnection_=le.isConnectionType_(t),this.location_=o,this.processParams_(a||null)}processParams_(t){t&&t.wsCoordinate&&(this.wsCoordinate_=t.wsCoordinate)}getLocation(){return this.location_}getType(){return this.type_}getWsCoordinate(){return this.wsCoordinate_}isConnection(){return this.isConnection_}findNextForInput_(){var t=this.location_.getParentInput();const o=t.getSourceBlock();for(t=o.inputList.indexOf(t),t+=1;t<o.inputList.length;t++){const a=o.inputList[t],d=a.fieldRow;for(let m=0;m<d.length;m++){const b=d[m];if(b.isClickable()||le.NAVIGATE_ALL_FIELDS)return le.createFieldNode(b)}if(a.connection)return le.createInputNode(a)}return null}findNextForField_(){var t=this.location_,o=t.getParentInput();const a=t.getSourceBlock();if(!a)throw Error("The current AST location is not associated with a block");var d=a.inputList.indexOf(o);for(t=o.fieldRow.indexOf(t)+1;d<a.inputList.length;d++){o=a.inputList[d];const m=o.fieldRow;for(;t<m.length;){if(m[t].isClickable()||le.NAVIGATE_ALL_FIELDS)return le.createFieldNode(m[t]);t++}if(t=0,o.connection)return le.createInputNode(o)}return null}findPrevForInput_(){const t=this.location_.getParentInput(),o=t.getSourceBlock();for(var a=o.inputList.indexOf(t);0<=a;a--){var d=o.inputList[a];if(d.connection&&d!==t)return le.createInputNode(d);d=d.fieldRow;for(let m=d.length-1;0<=m;m--){const b=d[m];if(b.isClickable()||le.NAVIGATE_ALL_FIELDS)return le.createFieldNode(b)}}return null}findPrevForField_(){var t=this.location_;const o=t.getParentInput(),a=t.getSourceBlock();if(!a)throw Error("The current AST location is not associated with a block");var d=a.inputList.indexOf(o);for(t=o.fieldRow.indexOf(t)-1;0<=d;d--){var m=a.inputList[d];if(m.connection&&m!==o)return le.createInputNode(m);for(m=m.fieldRow;-1<t;){if(m[t].isClickable()||le.NAVIGATE_ALL_FIELDS)return le.createFieldNode(m[t]);t--}0<=d-1&&(t=a.inputList[d-1].fieldRow.length-1)}return null}navigateBetweenStacks_(t){var o=this.getLocation();if(o.getSourceBlock){var a=o.getSourceBlock();a&&(o=a)}if(!o||o.isDeadOrDying())return null;a=o.getRootBlock(),o=a.workspace.getTopBlocks(!0);for(let d=0;d<o.length;d++)if(a.id===o[d].id)return t=d+(t?1:-1),t===-1||t===o.length?null:le.createStackNode(o[t]);throw Error("Couldn't find "+(t?"next":"previous")+" stack?!")}findTopASTNodeForBlock_(t){const o=Vh(t);return o?le.createConnectionNode(o):le.createBlockNode(t)}getOutAstNodeForBlock_(t){if(!t)return null;t=t.getTopStackBlock();const o=Vh(t);return o&&o.targetConnection&&o.targetConnection.getParentInput()?le.createInputNode(o.targetConnection.getParentInput()):le.createStackNode(t)}findFirstFieldOrInput_(t){t=t.inputList;for(let o=0;o<t.length;o++){const a=t[o],d=a.fieldRow;for(let m=0;m<d.length;m++){const b=d[m];if(b.isClickable()||le.NAVIGATE_ALL_FIELDS)return le.createFieldNode(b)}if(a.connection)return le.createInputNode(a)}return null}getSourceBlock(){return this.getType()===le.types.BLOCK?this.getLocation():this.getType()===le.types.STACK?this.getLocation():this.getType()===le.types.WORKSPACE?null:this.getLocation().getSourceBlock()}next(){switch(this.type_){case le.types.STACK:return this.navigateBetweenStacks_(!0);case le.types.OUTPUT:return le.createBlockNode(this.location_.getSourceBlock());case le.types.FIELD:return this.findNextForField_();case le.types.INPUT:return this.findNextForInput_();case le.types.BLOCK:return le.createConnectionNode(this.location_.nextConnection);case le.types.PREVIOUS:return le.createBlockNode(this.location_.getSourceBlock());case le.types.NEXT:return le.createConnectionNode(this.location_.targetConnection)}return null}in(){switch(this.type_){case le.types.WORKSPACE:const t=this.location_.getTopBlocks(!0);if(0<t.length)return le.createStackNode(t[0]);break;case le.types.STACK:return this.findTopASTNodeForBlock_(this.location_);case le.types.BLOCK:return this.findFirstFieldOrInput_(this.location_);case le.types.INPUT:return le.createConnectionNode(this.location_.targetConnection)}return null}prev(){switch(this.type_){case le.types.STACK:return this.navigateBetweenStacks_(!1);case le.types.FIELD:return this.findPrevForField_();case le.types.INPUT:return this.findPrevForInput_();case le.types.BLOCK:var t=Vh(this.location_);return le.createConnectionNode(t);case le.types.PREVIOUS:if((t=this.location_.targetConnection)&&!t.getParentInput())return le.createConnectionNode(t);break;case le.types.NEXT:return le.createBlockNode(this.location_.getSourceBlock())}return null}out(){switch(this.type_){case le.types.STACK:var t=this.location_,o=t.getRelativeToSurfaceXY();return o=new ve(o.x,o.y+le.DEFAULT_OFFSET_Y),le.createWorkspaceNode(t.workspace,o);case le.types.OUTPUT:return t=this.location_,(o=t.targetConnection)?le.createConnectionNode(o):le.createStackNode(t.getSourceBlock());case le.types.FIELD:if(t=this.location_.getSourceBlock(),!t)throw Error("The current AST location is not associated with a block");return le.createBlockNode(t);case le.types.INPUT:return le.createBlockNode(this.location_.getSourceBlock());case le.types.BLOCK:return this.getOutAstNodeForBlock_(this.location_);case le.types.PREVIOUS:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock());case le.types.NEXT:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock())}return null}static isConnectionType_(t){switch(t){case le.types.PREVIOUS:case le.types.NEXT:case le.types.INPUT:case le.types.OUTPUT:return!0}return!1}static createFieldNode(t){return t?new le(le.types.FIELD,t):null}static createConnectionNode(t){if(!t)return null;const o=t.type;return o===Ie.INPUT_VALUE||o===Ie.NEXT_STATEMENT&&t.getParentInput()?le.createInputNode(t.getParentInput()):o===Ie.NEXT_STATEMENT?new le(le.types.NEXT,t):o===Ie.OUTPUT_VALUE?new le(le.types.OUTPUT,t):o===Ie.PREVIOUS_STATEMENT?new le(le.types.PREVIOUS,t):null}static createInputNode(t){return t&&t.connection?new le(le.types.INPUT,t.connection):null}static createBlockNode(t){return t?new le(le.types.BLOCK,t):null}static createStackNode(t){return t?new le(le.types.STACK,t):null}static createWorkspaceNode(t,o){return o&&t?new le(le.types.WORKSPACE,t,{wsCoordinate:o}):null}static createTopNode(t){const o=Vh(t);return o?le.createConnectionNode(o):le.createBlockNode(t)}};le.NAVIGATE_ALL_FIELDS=!1,le.DEFAULT_OFFSET_Y=-20,function(t){t=t.types||(t.types={}),t.FIELD="field",t.BLOCK="block",t.INPUT="input",t.OUTPUT="output",t.NEXT="next",t.PREVIOUS="previous",t.STACK="stack",t.WORKSPACE="workspace"}(le||(le={}));var ya=class{constructor(t,o,a){if(this.data=null,this.disposed=!1,this.hue_=null,this.colour_="#000000",this.styleName_="",this.loadExtraState=this.saveExtraState=this.domToMutation=this.mutationToDom=this.destroy=this.init=void 0,this.suppressPrefixSuffix=!1,this.decompose=this.compose=this.getDeveloperVariables=void 0,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.outputShape_=null,this.disposing=!1,this.comment=null,this.isInsertionMarker_=!1,this.hat=void 0,this.onchangeWrapper_=this.helpUrl=this.rendered=null,this.statementInputCount=0,this.workspace=t,this.id=a&&!t.getBlockById(a)?a:Ns(),t.setBlockById(this.id,this),this.commentModel={text:null,pinned:!1,size:new Xi(160,80)},this.xy_=new ve(0,0),this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,o){if(this.type=o,a=Cr[o],!a||typeof a!="object")throw TypeError("Invalid block definition for type: "+o);Object.assign(this,a)}t.addTopBlock(this),t.addTypedBlock(this),new.target===ya&&this.doInit_()}doInit_(){const t=Kt();t||He(!0);const o=xs();try{typeof this.init=="function"&&(zr(!1),this.init(),zr(o)),Pi()&&De(new(Le(Ji))(this))}finally{t||He(!1),zr(o)}this.inputsInlineDefault=this.inputsInline,typeof this.onchange=="function"&&this.setOnChange(this.onchange)}dispose(t){if(!this.isDeadOrDying()){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(t),Pi()&&De(new(Le(on))(this)),Ci();try{this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.disposing=!0;for(let a=this.childBlocks_.length-1;0<=a;a--)this.childBlocks_[a].dispose(!1);for(let a=0,d;d=this.inputList[a];a++)d.dispose();this.inputList.length=0;const o=this.getConnections_(!0);for(let a=0,d;d=o[a];a++)d.dispose()}finally{Oi(),typeof this.destroy=="function"&&this.destroy(),this.disposed=!0}}}isDeadOrDying(){return this.disposing||this.disposed}initModel(){for(let t=0,o;o=this.inputList[t];t++)for(let a=0,d;d=o.fieldRow[a];a++)d.initModel&&d.initModel()}unplug(t){this.outputConnection&&this.unplugFromRow_(t),this.previousConnection&&this.unplugFromStack_(t)}unplugFromRow_(t){let o=null;this.outputConnection.isConnected()&&(o=this.outputConnection.targetConnection,this.outputConnection.disconnect()),o&&t&&(t=this.getOnlyValueConnection_())&&t.isConnected()&&!t.targetBlock().isShadow()&&(t=t.targetConnection,t==null||t.disconnect(),this.workspace.connectionChecker.canConnect(t,o,!1)?o.connect(t):t==null||t.onFailedConnect(o))}getOnlyValueConnection_(){let t=null;for(let o=0;o<this.inputList.length;o++){const a=this.inputList[o].connection;if(a&&a.type===Ie.INPUT_VALUE&&a.targetConnection){if(t)return null;t=a}}return t}unplugFromStack_(t){let o=null;this.previousConnection.isConnected()&&(o=this.previousConnection.targetConnection,this.previousConnection.disconnect());const a=this.getNextBlock();t&&a&&!a.isShadow()&&(t=this.nextConnection.targetConnection,t==null||t.disconnect(),o&&this.workspace.connectionChecker.canConnect(o,t,!1)&&o.connect(t))}getConnections_(t){t=[],this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(let o=0,a;a=this.inputList[o];o++)a.connection&&t.push(a.connection);return t}lastConnectionInStack(t){let o=this.nextConnection;for(;o;){const a=o.targetBlock();if(!a||t&&a.isShadow())return o;o=a.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(t){for(let o=0,a;a=this.inputList[o];o++)if(a.connection&&a.connection.targetBlock()===t)return a;return null}getSurroundParent(){let t=this,o;do if(o=t,t=t.getParent(),!t)return null;while(t.getNextBlock()===o);return t}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getFirstStatementConnection(){for(let t=0,o;o=this.inputList[t];t++)if(o.connection&&o.connection.type===Ie.NEXT_STATEMENT)return o.connection;return null}getRootBlock(){let t,o=this;do t=o,o=t.parentBlock_;while(o);return t}getTopStackBlock(){let t=this,o;do o=t.getPreviousBlock();while(o&&o.getNextBlock()===t&&(t=o));return t}getChildren(t){if(!t)return this.childBlocks_;t=[];for(let a=0,d;d=this.inputList[a];a++)if(d.connection){var o=d.connection.targetBlock();o&&t.push(o)}return(o=this.getNextBlock())&&t.push(o),t}setParent(t){if(t!==this.parentBlock_){var o=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),a=!!o;if(a&&t&&o!==t)throw Error("Block connected to superior one that is not new parent.");if(!a&&t)throw Error("Block not connected to new parent.");if(a&&!t)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?kr(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(t){const o=[this],a=this.getChildren(t);for(let d,m=0;d=a[m];m++)o.push(...d.getDescendants(t));return o}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setDeletable(t){this.deletable_=t}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setMovable(t){this.movable_=t}isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable(we(this,!0)):!0}isShadow(){return this.isShadow_}setShadow(t){this.isShadow_=t}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(t){this.isInsertionMarker_=t}isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}setEditable(t){this.editable_=t;for(let o=0,a;a=this.inputList[o];o++)for(let d=0,m;m=a.fieldRow[d];d++)m.updateEditable()}isDisposed(){return this.disposed}getMatchingConnection(t,o){const a=this.getConnections_(!0);if(t=t.getConnections_(!0),a.length!==t.length)throw Error("Connection lists did not match in length.");for(let d=0;d<t.length;d++)if(t[d]===o)return a[d];return null}setHelpUrl(t){this.helpUrl=t}setTooltip(t){this.tooltip=t}getTooltip(){return $u(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(t){t=ia(t),this.hue_=t.hue,this.colour_=t.hex}setStyle(t){this.styleName_=t}setOnChange(t){if(t&&typeof t!="function")throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.onchange=t,this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}getField(t){if(typeof t!="string")throw TypeError("Block.prototype.getField expects a string with the field name but received "+(t===void 0?"nothing":t+" of type "+typeof t)+" instead");for(let o=0,a;a=this.inputList[o];o++)for(let d=0,m;m=a.fieldRow[d];d++)if(m.name===t)return m;return null}getVars(){const t=[];for(let o=0,a;a=this.inputList[o];o++)for(let d=0,m;m=a.fieldRow[d];d++)m.referencesVariables()&&t.push(m.getValue());return t}getVarModels(){const t=[];for(let o=0,a;a=this.inputList[o];o++)for(let d=0,m;m=a.fieldRow[d];d++)if(m.referencesVariables()){const b=this.workspace.getVariableById(m.getValue());b&&t.push(b)}return t}updateVarName(t){for(let o=0,a;a=this.inputList[o];o++)for(let d=0,m;m=a.fieldRow[d];d++)m.referencesVariables()&&t.getId()===m.getValue()&&m.refreshVariableName()}renameVarById(t,o){for(let a=0,d;d=this.inputList[a];a++)for(let m=0,b;b=d.fieldRow[m];m++)b.referencesVariables()&&t===b.getValue()&&b.setValue(o)}getFieldValue(t){return(t=this.getField(t))?t.getValue():null}setFieldValue(t,o){const a=this.getField(o);if(!a)throw Error('Field "'+o+'" not found.');a.setValue(t)}setPreviousStatement(t,o){if(t)o===void 0&&(o=null),this.previousConnection||(this.previousConnection=this.makeConnection_(Ie.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(o);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(t,o){if(t)o===void 0&&(o=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Ie.NEXT_STATEMENT)),this.nextConnection.setCheck(o);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(t,o){if(t)o===void 0&&(o=null),this.outputConnection||(this.outputConnection=this.makeConnection_(Ie.OUTPUT_VALUE)),this.outputConnection.setCheck(o);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(t){this.inputsInline!==t&&(De(new(Le(Ui))(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)}getInputsInline(){if(this.inputsInline!==void 0)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type===it.DUMMY&&this.inputList[t].type===it.DUMMY)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type===it.VALUE&&this.inputList[t].type===it.DUMMY)return!0;return!1}setOutputShape(t){this.outputShape_=t}getOutputShape(){return this.outputShape_}isEnabled(){return!this.disabled}setEnabled(t){if(this.isEnabled()!==t){const o=this.disabled;this.disabled=!t,De(new(Le(Ui))(this,"disabled",null,o,!t))}}getInheritedDisabled(){let t=this.getSurroundParent();for(;t;){if(t.disabled)return!0;t=t.getSurroundParent()}return!1}isCollapsed(){return this.collapsed_}setCollapsed(t){this.collapsed_!==t&&(De(new(Le(Ui))(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)}toString(t,o){function a(ye){let yt=ye.getCheck();return!yt&&ye.targetConnection&&(yt=ye.targetConnection.getCheck()),!!yt&&(yt.indexOf("Boolean")!==-1||yt.indexOf("Number")!==-1)}function d(){let ye,yt;I&&I.getType()===((ye=L)==null?void 0:ye.getType())&&I.getLocation()===((yt=L)==null?void 0:yt.getLocation())&&(I=null)}var m=[];o=o||"?";const b=le.NAVIGATE_ALL_FIELDS;le.NAVIGATE_ALL_FIELDS=!0;let I=le.createBlockNode(this);const L=I;for(;I;){switch(I.getType()){case le.types.INPUT:var oe=I.getLocation();I.in()?a(oe)&&m.push("("):m.push(o);break;case le.types.FIELD:oe=I.getLocation(),oe.name!==qu&&m.push(oe.getText())}if(oe=I,I=oe.in()||oe.next(),!I){for(I=oe.out(),d();I&&!I.next();)I=I.out(),d(),I&&I.getType()===le.types.INPUT&&a(I.getLocation())&&m.push(")");I&&(I=I.next())}}for(le.NAVIGATE_ALL_FIELDS=b,o=2;o<m.length;o++)m[o-2]==="("&&m[o]===")"&&(m[o-2]=m[o-1],m.splice(o-1,2));return m=m.reduce(function(ye,yt){return ye+(ye.substr(-1)==="("||yt===")"?"":" ")+yt},""),m=m.trim()||"???",t&&m.length>t&&(m=m.substring(0,t-3)+"..."),m}appendValueInput(t){return this.appendInput_(it.VALUE,t)}appendStatementInput(t){return this.appendInput_(it.STATEMENT,t)}appendDummyInput(t){return this.appendInput_(it.DUMMY,t||"")}jsonInit(t){var o=t.type?'Block "'+t.type+'": ':"";if(t.output&&t.previousStatement)throw Error(o+"Must not have both an output and a previousStatement.");if(t.style&&t.style.hat&&(this.hat=t.style.hat,t.style=null),t.style&&t.colour)throw Error(o+"Must not have both a colour and a style.");t.style?this.jsonInitStyle_(t,o):this.jsonInitColour_(t,o);for(var a=0;t["message"+a]!==void 0;)this.interpolate_(t["message"+a],t["args"+a]||[],t["lastDummyAlign"+a],o),a++;if(t.inputsInline!==void 0&&this.setInputsInline(t.inputsInline),t.output!==void 0&&this.setOutput(!0,t.output),t.outputShape!==void 0&&this.setOutputShape(t.outputShape),t.previousStatement!==void 0&&this.setPreviousStatement(!0,t.previousStatement),t.nextStatement!==void 0&&this.setNextStatement(!0,t.nextStatement),t.tooltip!==void 0&&(a=oi(t.tooltip),this.setTooltip(a)),t.enableContextMenu!==void 0&&(this.contextMenu=!!t.enableContextMenu),t.suppressPrefixSuffix!==void 0&&(this.suppressPrefixSuffix=!!t.suppressPrefixSuffix),t.helpUrl!==void 0&&(a=oi(t.helpUrl),this.setHelpUrl(a)),typeof t.extensions=="string"&&(console.warn(o+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),t.mutator!==void 0&&Wp(t.mutator,this,!0),t=t.extensions,Array.isArray(t))for(o=0;o<t.length;o++)Wp(t[o],this,!1)}jsonInitColour_(t,o){if("colour"in t)if(t.colour===void 0)console.warn(o+"Undefined colour value.");else{t=t.colour;try{this.setColour(t)}catch{console.warn(o+"Illegal colour value: ",t)}}}jsonInitStyle_(t,o){t=t.style;try{this.setStyle(t)}catch{console.warn(o+"Style does not exist: ",t)}}mixin(t,o){if(o!==void 0&&typeof o!="boolean")throw Error("opt_disableCheck must be a boolean if provided");if(!o){o=[];for(const a in t)this[a]!==void 0&&o.push(a);if(o.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(o))}Object.assign(this,t)}interpolate_(t,o,a,d){t=Bp(t),this.validateTokens_(t,o.length),o=this.interpolateArguments_(t,o,a),a=[];for(let m=0,b;b=o[m];m++)if(this.isInputKeyword_(b.type)){if(t=this.inputFromJson_(b,d)){for(let I=0,L;L=a[I];I++)t.appendField(L[0],L[1]);a.length=0}}else(t=this.fieldFromJson_(b))&&a.push([t,b.name])}validateTokens_(t,o){const a=[];let d=0;for(let m=0;m<t.length;m++){const b=t[m];if(typeof b=="number"){if(1>b||b>o)throw Error('Block "'+this.type+'": Message index %'+b+" out of range.");if(a[b])throw Error('Block "'+this.type+'": Message index %'+b+" duplicated.");a[b]=!0,d++}}if(d!==o)throw Error('Block "'+this.type+'": Message does not reference all '+o+" arg(s).")}interpolateArguments_(t,o,a){const d=[];for(let m=0;m<t.length;m++){let b=t[m];typeof b=="number"&&(b=o[b-1]),!(typeof b=="string"&&(b=this.stringToFieldJson_(b),!b))&&d.push(b)}return(t=d.length)&&!this.isInputKeyword_(d[t-1].type)&&(t={type:"input_dummy"},a&&(t.align=a),d.push(t)),d}fieldFromJson_(t){const o=Up(t);return!o&&t.alt?typeof t.alt=="string"?(t=this.stringToFieldJson_(t.alt))?this.fieldFromJson_(t):null:this.fieldFromJson_(t.alt):o}inputFromJson_(t,o){var a={LEFT:i.Align$$module$build$src$core$input.LEFT,RIGHT:i.Align$$module$build$src$core$input.RIGHT,CENTRE:i.Align$$module$build$src$core$input.CENTRE,CENTER:i.Align$$module$build$src$core$input.CENTRE};let d=null;switch(t.type){case"input_value":d=this.appendValueInput(t.name);break;case"input_statement":d=this.appendStatementInput(t.name);break;case"input_dummy":d=this.appendDummyInput(t.name)}return d?(t.check&&d.setCheck(t.check),t.align&&(a=a[t.align.toUpperCase()],a===void 0?console.warn(o+"Illegal align value: ",t.align):d.setAlign(a)),d):null}isInputKeyword_(t){return t==="input_value"||t==="input_statement"||t==="input_dummy"}stringToFieldJson_(t){return(t=t.trim())?{type:"field_label",text:t}:null}appendInput_(t,o){let a=null;return(t===it.VALUE||t===it.STATEMENT)&&(a=this.makeConnection_(t)),t===it.STATEMENT&&this.statementInputCount++,t=new va(t,o,this,a),this.inputList.push(t),t}moveInputBefore(t,o){if(t!==o){var a=-1,d=o?-1:this.inputList.length;for(let m=0,b;b=this.inputList[m];m++)if(b.name===t){if(a=m,d!==-1)break}else if(o&&b.name===o&&(d=m,a!==-1))break;if(a===-1)throw Error('Named input "'+t+'" not found.');if(d===-1)throw Error('Reference input "'+o+'" not found.');this.moveNumberedInputBefore(a,d)}}moveNumberedInputBefore(t,o){if(t===o)throw Error("Can't move input to itself.");if(t>=this.inputList.length)throw RangeError("Input index "+t+" out of bounds.");if(o>this.inputList.length)throw RangeError("Reference input "+o+" out of bounds.");const a=this.inputList[t];this.inputList.splice(t,1),t<o&&o--,this.inputList.splice(o,0,a)}removeInput(t,o){for(let a=0,d;d=this.inputList[a];a++)if(d.name===t)return d.type===it.STATEMENT&&this.statementInputCount--,d.dispose(),this.inputList.splice(a,1),!0;if(o)return!1;throw Error("Input not found: "+t)}getInput(t){for(let o=0,a;a=this.inputList[o];o++)if(a.name===t)return a;return null}getInputTargetBlock(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()}getCommentText(){return this.commentModel.text}setCommentText(t){this.commentModel.text!==t&&(De(new(Le(Ui))(this,"comment",null,this.commentModel.text,t)),this.comment=this.commentModel.text=t)}setWarningText(t,o){}setMutator(t){}getRelativeToSurfaceXY(){return this.xy_}moveBy(t,o){if(this.parentBlock_)throw Error("Block has parent.");const a=new(Le(gr))(this);this.xy_.translate(t,o),a.recordNew(),De(a)}makeConnection_(t){return new Ot(this,t)}allInputsFilled(t){if(t===void 0&&(t=!0),!t&&this.isShadow())return!1;for(let a=0,d;d=this.inputList[a];a++)if(d.connection){var o=d.connection.targetBlock();if(!o||!o.allInputsFilled(t))return!1}return(o=this.getNextBlock())?o.allInputsFilled(t):!0}toDevString(){let t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t}};ya.COLLAPSED_INPUT_NAME=Ku,ya.COLLAPSED_FIELD_NAME=qu;var Id=null,Ju=null,Qu={};Qu.connectionUiEffect=NE,Qu.disconnectUiEffect=DE,Qu.disconnectUiStop=yu,Qu.disposeUiEffect=wE;var pv=class extends vd{constructor(t){super(t),this.cachedText="",this.paragraphElement_=this.textarea_=this.foreignObject=this.onInputWrapper=this.onChangeWrapper=this.onWheelWrapper=this.onMouseUpWrapper=null,this.model=t.commentModel;let o;this.model.text=(o=this.model.text)!=null?o:"",this.createIcon()}drawIcon_(t){z(G.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},t),z(G.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},t),z(G.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},t)}createEditor(){this.foreignObject=z(G.FOREIGNOBJECT,{x:Qe.BORDER_WIDTH,y:Qe.BORDER_WIDTH});const t=document.createElementNS(Ms,"body");t.setAttribute("xmlns",Ms),t.className="blocklyMinimalBody";const o=this.textarea_=document.createElementNS(Ms,"textarea");o.className="blocklyCommentTextarea",o.setAttribute("dir",this.getBlock().RTL?"RTL":"LTR");let a;return o.value=(a=this.model.text)!=null?a:"",this.resizeTextarea(),t.appendChild(o),this.foreignObject.appendChild(t),this.onMouseUpWrapper=y(o,"focus",this,this.startEdit,!0),this.onWheelWrapper=y(o,"wheel",this,function(d){d.stopPropagation()}),this.onChangeWrapper=y(o,"change",this,function(d){this.cachedText!==this.model.text&&De(new(Le(Ui))(this.getBlock(),"comment",null,this.cachedText,this.model.text))}),this.onInputWrapper=y(o,"input",this,function(d){this.model.text=o.value}),setTimeout(o.focus.bind(o),0),this.foreignObject}updateEditable(){super.updateEditable(),this.isVisible()&&(this.disposeBubble(),this.createBubble())}onBubbleResize(){this.isVisible()&&this.bubble_&&(this.model.size=this.bubble_.getBubbleSize(),this.resizeTextarea())}resizeTextarea(){if(this.textarea_&&this.foreignObject){var t=this.model.size,o=2*Qe.BORDER_WIDTH,a=t.width-o;t=t.height-o,this.foreignObject.setAttribute("width",`${a}`),this.foreignObject.setAttribute("height",`${t}`),this.textarea_.style.width=a-4+"px",this.textarea_.style.height=t-4+"px"}}setVisible(t){t!==this.isVisible()&&(De(new(Le(Gn))(this.getBlock(),t,"comment")),(this.model.pinned=t)?this.createBubble():this.disposeBubble())}createBubble(){this.getBlock().isEditable()?this.createEditableBubble():this.createNonEditableBubble()}createEditableBubble(){const t=this.getBlock();this.bubble_=new Qe(t.workspace,this.createEditor(),t.pathObject.svgPath,this.iconXY_,this.model.size.width,this.model.size.height),this.bubble_.setSvgId(t.id),this.bubble_.registerResizeEvent(this.onBubbleResize.bind(this)),this.applyColour()}createNonEditableBubble(){let t;this.paragraphElement_=Qe.textToDom((t=this.model.text)!=null?t:""),this.bubble_=Qe.createNonEditableBubble(this.paragraphElement_,this.getBlock(),this.iconXY_),this.applyColour()}disposeBubble(){this.onMouseUpWrapper&&(C(this.onMouseUpWrapper),this.onMouseUpWrapper=null),this.onWheelWrapper&&(C(this.onWheelWrapper),this.onWheelWrapper=null),this.onChangeWrapper&&(C(this.onChangeWrapper),this.onChangeWrapper=null),this.onInputWrapper&&(C(this.onInputWrapper),this.onInputWrapper=null),this.bubble_&&(this.bubble_.dispose(),this.bubble_=null),this.paragraphElement_=this.foreignObject=this.textarea_=null}startEdit(t){let o;(o=this.bubble_)!=null&&o.promote()&&this.textarea_.focus(),this.cachedText=this.model.text}getBubbleSize(){return this.model.size}setBubbleSize(t,o){this.bubble_?this.bubble_.setBubbleSize(t,o):(this.model.size.width=t,this.model.size.height=o)}updateText(){if(this.textarea_){let t;this.textarea_.value=(t=this.model.text)!=null?t:""}else this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model.text)}dispose(){this.getBlock().comment=null,super.dispose()}};Ds(`
.blocklyCommentTextarea {
  background-color: #fef49c;
  border: 0;
  display: block;
  margin: 0;
  outline: 0;
  padding: 3px;
  resize: none;
  text-overflow: hidden;
}
`);var Yn=null,qm={duplicateInternal:$6,copyInternal:E6},Zu={};Zu.TEST_ONLY=qm,Zu.copy=Su,Zu.duplicate=Wh,Zu.paste=Kp;var ec,Jm,tc;ec=null,Jm={},tc=null,i.module$build$src$core$contextmenu={},i.module$build$src$core$contextmenu.callbackFactory=k6,i.module$build$src$core$contextmenu.commentDeleteOption=FE,i.module$build$src$core$contextmenu.commentDuplicateOption=UE,i.module$build$src$core$contextmenu.dispose=PE,i.module$build$src$core$contextmenu.getCurrentBlock=ME,i.module$build$src$core$contextmenu.hide=Yh,i.module$build$src$core$contextmenu.setCurrentBlock=BE,i.module$build$src$core$contextmenu.show=zh,i.module$build$src$core$contextmenu.workspaceCommentOption=A6;var wt=class{constructor(){this.registry_=new Map,this.reset()}reset(){this.registry_.clear()}register(t){if(this.registry_.has(t.id))throw Error('Menu item with ID "'+t.id+'" is already registered.');this.registry_.set(t.id,t)}unregister(t){if(!this.registry_.has(t))throw Error('Menu item with ID "'+t+'" not found.');this.registry_.delete(t)}getItem(t){let o;return(o=this.registry_.get(t))!=null?o:null}getContextMenuOptions(t,o){const a=[];for(const m of this.registry_.values())if(t===m.scopeType){var d=m.preconditionFn(o);d!=="hidden"&&(d={text:typeof m.displayText=="function"?m.displayText(o):m.displayText,enabled:d==="enabled",callback:m.callback,scope:o,weight:m.weight},a.push(d))}return a.sort(function(m,b){return m.weight-b.weight}),a}};(function(t){var o=t.ScopeType||(t.ScopeType={});o.BLOCK="block",o.WORKSPACE="workspace",t.registry=new t})(wt||(wt={})),wt.ScopeType;var mv=30,gv=!0,El=[];El[Ie.INPUT_VALUE]=Ie.OUTPUT_VALUE,El[Ie.OUTPUT_VALUE]=Ie.INPUT_VALUE,El[Ie.NEXT_STATEMENT]=Ie.PREVIOUS_STATEMENT,El[Ie.PREVIOUS_STATEMENT]=Ie.NEXT_STATEMENT;var Qm="RENAME_VARIABLE_ID",Zm="DELETE_VARIABLE_ID",_v=class{constructor(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"}setDrawer(t){this.drawer_=t}getDrawer(){return this.drawer_}getCurNode(){return this.curNode_}setCurNode(t){const o=this.curNode_;this.curNode_=t,this.drawer_&&this.drawer_.draw(o,this.curNode_)}draw(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)}hide(){this.drawer_&&this.drawer_.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},eg=class extends _v{constructor(){super(),this.type="cursor"}next(){var t=this.getCurNode();if(!t)return null;for(t=t.next();t&&t.next()&&(t.getType()===le.types.NEXT||t.getType()===le.types.BLOCK);)t=t.next();return t&&this.setCurNode(t),t}in(){var t=this.getCurNode();if(!t)return null;(t.getType()===le.types.PREVIOUS||t.getType()===le.types.OUTPUT)&&(t=t.next());let o,a;return(t=(a=(o=t)==null?void 0:o.in())!=null?a:null)&&this.setCurNode(t),t}prev(){var t=this.getCurNode();if(!t)return null;for(t=t.prev();t&&t.prev()&&(t.getType()===le.types.NEXT||t.getType()===le.types.BLOCK);)t=t.prev();return t&&this.setCurNode(t),t}out(){var t=this.getCurNode();return t?((t=t.out())&&t.getType()===le.types.BLOCK&&(t=t.prev()||t),t&&this.setCurNode(t),t):null}};tt(fe.CURSOR,Hn,eg);var ic=class extends eg{constructor(){super()}next(){var t=this.getCurNode();return t?((t=this.getNextNode_(t,this.validNode_))&&this.setCurNode(t),t):null}in(){return this.next()}prev(){var t=this.getCurNode();return t?((t=this.getPreviousNode_(t,this.validNode_))&&this.setCurNode(t),t):null}out(){return this.prev()}getNextNode_(t,o){if(!t)return null;const a=t.in()||t.next();return o(a)?a:a?this.getNextNode_(a,o):(t=this.findSiblingOrParent_(t.out()),o(t)?t:t?this.getNextNode_(t,o):null)}getPreviousNode_(t,o){if(!t)return null;let a=t.prev();return a=a?this.getRightMostChild_(a):t.out(),o(a)?a:a?this.getPreviousNode_(a,o):null}validNode_(t){let o=!1;return t=t&&t.getType(),(t===le.types.OUTPUT||t===le.types.INPUT||t===le.types.FIELD||t===le.types.NEXT||t===le.types.PREVIOUS||t===le.types.WORKSPACE)&&(o=!0),o}findSiblingOrParent_(t){if(!t)return null;const o=t.next();return o||this.findSiblingOrParent_(t.out())}getRightMostChild_(t){if(!t.in())return t;for(t=t.in();t&&t.next();)t=t.next();return this.getRightMostChild_(t)}};ic.registrationName="basicCursor",tt(fe.CURSOR,ic.registrationName,ic);var bv=class extends ic{validNode_(t){let o=!1;const a=t&&t.getType();return t&&(t=t.getLocation(),a===le.types.FIELD&&t&&t.isTabNavigable()&&t.isClickable()&&(o=!0)),o}},tg=10,_r=class extends Ot{constructor(t,o){super(t,o),this.targetConnection=this.highlightPath=null,this.db_=t.workspace.connectionDBList[o],this.dbOpposite_=t.workspace.connectionDBList[El[o]],this.offsetInBlock_=new ve(0,0),this.trackedState_=_r.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState_===_r.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(t){const o=this.x-t.x;return t=this.y-t.y,Math.sqrt(o*o+t*t)}bumpAwayFrom(t){if(!this.sourceBlock_.workspace.isDragging()){var o=this.sourceBlock_.getRootBlock();if(!o.isInFlyout){var a=!1;if(!o.isMovable()){if(o=t.getSourceBlock().getRootBlock(),!o.isMovable())return;t=this,a=!0}var d=_e()==o;d||o.addSelect();var m=t.x+i.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*tg)-this.x,b=t.y+i.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*tg)-this.y;a&&(b=-b),o.RTL&&(m=t.x-i.config$$module$build$src$core$config.snapRadius-Math.floor(Math.random()*tg)-this.x),o.moveBy(m,b),d||o.removeSelect()}}}moveTo(t,o){this.trackedState_===_r.TrackedState.WILL_TRACK?(this.db_.addConnection(this,o),this.trackedState_=_r.TrackedState.TRACKED):this.trackedState_===_r.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,o)),this.x=t,this.y=o}moveBy(t,o){this.moveTo(this.x+t,this.y+o)}moveToOffset(t){this.moveTo(t.x+this.offsetInBlock_.x,t.y+this.offsetInBlock_.y)}setOffsetInBlock(t,o){this.offsetInBlock_.x=t,this.offsetInBlock_.y=o}getOffsetInBlock(){return this.offsetInBlock_}tighten(){const t=this.targetConnection.x-this.x,o=this.targetConnection.y-this.y;if(t!==0||o!==0){const d=this.targetBlock();var a=d.getSvgRoot();if(!a)throw Error("block is not rendered.");a=Ls(a),d.getSvgRoot().setAttribute("transform","translate("+(a.x-t)+","+(a.y-o)+")"),d.moveConnections(-t,-o)}}closest(t,o){return this.dbOpposite_.searchForClosest(this,t,o)}highlight(){if(!this.highlightPath){var t=this.sourceBlock_.workspace.getRenderer().getConstants(),o=t.shapeFor(this);this.type===Ie.INPUT_VALUE||this.type===Ie.OUTPUT_VALUE?(t=t.TAB_OFFSET_FROM_TOP,o=qt(0,-t)+ke("v",t)+o.pathDown+ke("v",t)):(t=t.NOTCH_OFFSET_LEFT-t.CORNER_RADIUS,o=qt(-t,0)+ke("h",t)+o.pathLeft+ke("h",t)),t=this.sourceBlock_.getRelativeToSurfaceXY(),this.highlightPath=z(G.PATH,{class:"blocklyHighlightedConnectionPath",d:o,transform:"translate("+(this.x-t.x)+","+(this.y-t.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())}}unhighlight(){this.highlightPath&&(ft(this.highlightPath),this.highlightPath=null)}setTracking(t){t&&this.trackedState_===_r.TrackedState.TRACKED||!t&&this.trackedState_===_r.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(t?(this.db_.addConnection(this,this.y),this.trackedState_=_r.TrackedState.TRACKED):(this.trackedState_===_r.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=_r.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const a=this.targetBlock().getDescendants(!1);for(let d=0;d<a.length;d++){var t=a[d],o=t.getConnections_(!0);for(let m=0;m<o.length;m++)o[m].setTracking(!1);for(t=t.getIcons(),o=0;o<t.length;o++)t[o].setVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let t=[];if(this.type!==Ie.INPUT_VALUE&&this.type!==Ie.NEXT_STATEMENT)return t;const o=this.targetBlock();if(o){let a;o.isCollapsed()?(a=[],o.outputConnection&&a.push(o.outputConnection),o.nextConnection&&a.push(o.nextConnection),o.previousConnection&&a.push(o.previousConnection)):a=o.getConnections_(!0);for(let d=0;d<a.length;d++)t.push(...a[d].startTrackingAll());t.length||(t=[o])}return t}onFailedConnect(t){const o=this.getSourceBlock();if(xs()){const a=Kt();setTimeout(function(){o.isDisposed()||o.getParent()||(He(a),this.bumpAwayFrom(t),He(!1))}.bind(this),i.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal_(t,o){super.disconnectInternal_(t,o),t.rendered&&t.render(),o.rendered&&(o.updateDisabled(),o.render(),o.getSvgRoot().style.display="block")}respawnShadow_(){super.respawnShadow_();var t=this.targetBlock();t&&(t.initSvg(),t.render(!1),t=this.getSourceBlock(),t.rendered&&t.render())}neighbours(t){return this.dbOpposite_.getNeighbours(this,t)}connect_(t){super.connect_(t);var o=this.getSourceBlock();t=t.getSourceBlock();const a=o.rendered,d=t.rendered;a&&o.updateDisabled(),d&&t.updateDisabled(),a&&d&&(this.type===Ie.NEXT_STATEMENT||this.type===Ie.PREVIOUS_STATEMENT?t.render():o.render()),(o=o.getInputWithBlock(t))&&(o=o.isVisible(),t.getSvgRoot().style.display=o?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())}};(function(t){t=t.TrackedState||(t.TrackedState={}),t[t.WILL_TRACK=-1]="WILL_TRACK",t[t.UNTRACKED=0]="UNTRACKED",t[t.TRACKED=1]="TRACKED"})(_r||(_r={})),_r.TrackedState;var Tv=class extends vd{constructor(t){super(t),this.paragraphElement=null,this.collapseHidden=!1,this.createIcon(),this.text=Object.create(null)}drawIcon_(t){z(G.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},t),z(G.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},t),z(G.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},t)}setVisible(t){t!==this.isVisible()&&(De(new(Le(Gn))(this.getBlock(),t,"warning")),t?this.createBubble():this.disposeBubble())}createBubble(){this.paragraphElement=Qe.textToDom(this.getText()),this.bubble_=Qe.createNonEditableBubble(this.paragraphElement,this.getBlock(),this.iconXY_),this.applyColour()}disposeBubble(){this.bubble_&&(this.bubble_.dispose(),this.bubble_=null),this.paragraphElement=null}setText(t,o){this.text[o]!==t&&(t?this.text[o]=t:delete this.text[o],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))}getText(){const t=[];for(const o in this.text)t.push(this.text[o]);return t.join(`
`)}dispose(){this.getBlock().warning=null,super.dispose()}},ps=class extends ya{constructor(t,o,a){super(t,o,a),this.renderingDebugger=null,this.width=this.height=0,this.warningTextDb=new Map,this.warning=this.commentIcon_=this.mutator=null,this.eventsInit_=this.renderIsInProgress_=this.rendered=!1,this.workspace=t,this.decompose=this.decompose,this.compose=this.compose,this.saveConnections=this.saveConnections,this.customContextMenu=this.customContextMenu,this.svgGroup_=z(G.G,{}),this.svgGroup_.translate_="",this.style=t.getRenderer().getConstants().getBlockStyle(null),this.pathObject=t.getRenderer().makePathObject(this.svgGroup_,this.style),this.useDragSurface_=!!t.getBlockDragSurface(),t=this.pathObject.svgPath,t.tooltip=this,Lh(t),this.svgGroup_.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(let o=0,a;a=this.inputList[o];o++)a.init();var t=this.getIcons();for(let o=0;o<t.length;o++)t[o].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),t=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!t||y(t,"pointerdown",this,this.onMouseDown_),this.eventsInit_=!0,t.parentNode||this.workspace.getCanvas().appendChild(t)}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(_e()!==this){var t=null;if(_e()){t=_e().id,Ci();try{_e().unselect()}finally{Oi()}}t=new(Le(Eo))(t,this.id,this.workspace.id),De(t),Xe(this),this.addSelect()}}unselect(){if(_e()===this){var t=new(Le(Eo))(this.id,null,this.workspace.id);t.workspaceId=this.workspace.id,De(t),Xe(null),this.removeSelect()}}getIcons(){const t=[];return this.mutator&&t.push(this.mutator),this.commentIcon_&&t.push(this.commentIcon_),this.warning&&t.push(this.warning),t}setParent(t){const o=this.parentBlock_;if(t!==o){Cs(),super.setParent(t),Os();var a=this.getSvgRoot();if(!this.workspace.isClearing&&a){var d=this.getRelativeToSurfaceXY();t?(t.getSvgRoot().appendChild(a),t=this.getRelativeToSurfaceXY(),this.moveConnections(t.x-d.x,t.y-d.y)):o&&(this.workspace.getCanvas().appendChild(a),this.translate(d.x,d.y)),this.applyColour()}}}getRelativeToSurfaceXY(){let t=0,o=0;const a=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null;let d=this.getSvgRoot();if(d)do{var m=Ls(d);t+=m.x,o+=m.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===d&&(m=this.workspace.getBlockDragSurface().getSurfaceTranslation(),t+=m.x,o+=m.y),d=d.parentNode}while(d&&d!==this.workspace.getCanvas()&&d!==a);return new ve(t,o)}moveBy(t,o){if(this.parentBlock_)throw Error("Block has parent.");const a=Pi();let d=null;a&&(d=new(Le(gr))(this));const m=this.getRelativeToSurfaceXY();this.translate(m.x+t,m.y+o),this.moveConnections(t,o),a&&d&&(d.recordNew(),De(d)),this.workspace.resizeContents()}translate(t,o){this.getSvgRoot().setAttribute("transform","translate("+t+","+o+")")}moveToDragSurface(){if(this.useDragSurface_){var t=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(t.x,t.y),(t=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(t)}}moveTo(t){const o=this.getRelativeToSurfaceXY();this.moveBy(t.x-o.x,t.y-o.y)}moveOffDragSurface(t){this.useDragSurface_&&(this.translate(t.x,t.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))}moveDuringDrag(t){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(t.x,t.y):(this.svgGroup_.translate_="translate("+t.x+","+t.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))}clearTransformAttributes_(){this.getSvgRoot().removeAttribute("transform")}snapToGrid(){if(!(this.isDeadOrDying()||this.workspace.isDragging()||this.getParent()||this.isInFlyout)){var t=this.workspace.getGrid();if(t&&t.shouldSnap()){var o=t.getSpacing(),a=o/2,d=this.getRelativeToSurfaceXY();t=Math.round(Math.round((d.x-a)/o)*o+a-d.x),o=Math.round(Math.round((d.y-a)/o)*o+a-d.y),(t||o)&&this.moveBy(t,o)}}}getBoundingRectangle(){const t=this.getRelativeToSurfaceXY(),o=this.getHeightWidth();let a,d;return this.RTL?(a=t.x-o.width,d=t.x):(a=t.x,d=t.x+o.width),new li(t.y,t.y+o.height,a,d)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let t=0,o;o=this.inputList[t];t++)o.markDirty()}setCollapsed(t){this.collapsed_!==t&&(super.setCollapsed(t),t?this.rendered&&this.render():this.updateCollapsed_())}updateCollapsed_(){var t=this.isCollapsed();const o=Ku,a=qu;for(let m=0,b;b=this.inputList[m];m++)b.name!==o&&b.setVisible(!t);if(t){t=this.getIcons();for(let m=0,b;b=t[m];m++)b.setVisible(!1);t=this.toString(mv);var d=this.getField(a);d?d.setValue(t):(this.getInput(o)||this.appendDummyInput(o)).appendField(new i.FieldLabel$$module$build$src$core$field_label(t),a)}else this.updateDisabled(),this.removeInput(o)}tab(t,o){const a=new bv;a.setCurNode(le.createFieldNode(t)),t=a.getCurNode(),o?a.next():a.prev(),(o=a.getCurNode())&&o!==t&&(o.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(o))}onMouseDown_(t){const o=this.workspace.getGesture(t);o&&o.handleBlockStart(t,this)}showHelp(){const t=typeof this.helpUrl=="function"?this.helpUrl():this.helpUrl;t&&window.open(t)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const t=wt.registry.getContextMenuOptions(wt.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(t),t}showContextMenu(t){const o=this.generateContextMenu();o&&o.length&&(zh(t,o,this.RTL),BE(this))}moveConnections(t,o){if(this.rendered){for(var a=this.getConnections_(!1),d=0;d<a.length;d++)a[d].moveBy(t,o);for(a=this.getIcons(),d=0;d<a.length;d++)a[d].computeIconLocation();for(a=0;a<this.childBlocks_.length;a++)this.childBlocks_[a].moveConnections(t,o)}}setDragging(t){if(t){var o=this.getSvgRoot();o.translate_="",o.skew_="",cl.push(...this.getConnections_(!0)),Ce(this.svgGroup_,"blocklyDragging")}else cl.length=0,qe(this.svgGroup_,"blocklyDragging");for(o=0;o<this.childBlocks_.length;o++)this.childBlocks_[o].setDragging(t)}setMovable(t){super.setMovable(t),this.pathObject.updateMovable(t)}setEditable(t){super.setEditable(t),t=this.getIcons();for(let o=0;o<t.length;o++)t[o].updateEditable()}setShadow(t){super.setShadow(t),this.applyColour()}setInsertionMarker(t){this.isInsertionMarker_!==t&&(this.isInsertionMarker_=t)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup_}dispose(t,o){if(!this.isDeadOrDying()){dE(),Mh(this.pathObject.svgPath),Cs();var a=this.workspace;_e()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),ME()===this&&Yh(),o&&this.rendered&&(this.unplug(t),wE(this)),this.rendered=!1;for(var d of this.warningTextDb.values())clearTimeout(d);for(this.warningTextDb.clear(),o=this.getIcons(),d=0;d<o.length;d++)o[d].dispose();_e()===this&&Xe(null),super.dispose(!!t),ft(this.svgGroup_),a.resizeContents(),this.svgGroup_=null,Os()}}checkAndDelete(){this.workspace.isFlyout||(He(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),He(!1))}toCopyData(){return this.isInsertionMarker_?null:{saveInfo:Pn(this,{addCoordinates:!0,addNextBlocks:!1}),source:this.workspace,typeCounts:we(this,!0)}}applyColour(){this.pathObject.applyColour(this);const t=this.getIcons();for(let o=0;o<t.length;o++)t[o].applyColour();for(let o=0,a;a=this.inputList[o];o++)for(let d=0,m;m=a.fieldRow[d];d++)m.applyColour()}updateDisabled(){const t=this.getChildren(!1);if(this.applyColour(),!this.isCollapsed())for(let o=0,a;a=t[o];o++)a.rendered&&a.updateDisabled()}getCommentIcon(){return this.commentIcon_}setCommentText(t){this.commentModel.text!==t&&(super.setCommentText(t),t=t!==null,!!this.commentIcon_===t?this.commentIcon_.updateText():(t?this.comment=this.commentIcon_=new pv(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))}setWarningText(t,o){const a=o||"";if(a)this.warningTextDb.has(a)&&(clearTimeout(this.warningTextDb.get(a)),this.warningTextDb.delete(a));else{for(var d of this.warningTextDb.values())clearTimeout(d);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(a,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(a),this.setWarningText(t,a))},100));else{if(this.isInFlyout&&(t=null),o=!1,typeof t=="string"){d=this.getSurroundParent();let m=null;for(;d;)d.isCollapsed()&&(m=d),d=d.getSurroundParent();m&&m.setWarningText(Ve.COLLAPSED_WARNINGS_WARNING,ps.COLLAPSED_WARNING_ID),this.warning||(this.warning=new Tv(this),o=!0),this.warning.setText(t,a)}else this.warning&&!a?(this.warning.dispose(),o=!0):this.warning&&(o=this.warning.getText(),this.warning.setText("",a),(d=this.warning.getText())||this.warning.dispose(),o=o!==d);o&&this.rendered&&(this.render(),this.bumpNeighbours())}}setMutator(t){this.mutator&&this.mutator!==t&&this.mutator.dispose(),t&&(t.setBlock(this),this.mutator=t,t.createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())}setEnabled(t){this.isEnabled()!==t&&(super.setEnabled(t),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())}setHighlighted(t){this.rendered&&this.pathObject.updateHighlighted(t)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(t){this.pathObject.updateDraggingDelete(t)}getColour(){return this.style.colourPrimary}setColour(t){super.setColour(t),t=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(t.style),this.style=t.style,this.styleName_=t.name,this.applyColour()}setStyle(t){const o=this.workspace.getRenderer().getConstants().getBlockStyle(t);if(this.styleName_=t,o)this.hat=o.hat,this.pathObject.setStyle(o),this.colour_=o.colourPrimary,this.style=o,this.applyColour();else throw Error("Invalid style name: "+t)}bringToFront(){let t=this;do{const o=t.getSvgRoot(),a=o.parentNode,d=a.childNodes;d[d.length-1]!==o&&a.appendChild(o),t=t.getParent()}while(t)}setPreviousStatement(t,o){super.setPreviousStatement(t,o),this.rendered&&(this.render(),this.bumpNeighbours())}setNextStatement(t,o){super.setNextStatement(t,o),this.rendered&&(this.render(),this.bumpNeighbours())}setOutput(t,o){super.setOutput(t,o),this.rendered&&(this.render(),this.bumpNeighbours())}setInputsInline(t){super.setInputsInline(t),this.rendered&&(this.render(),this.bumpNeighbours())}removeInput(t,o){return t=super.removeInput(t,o),this.rendered&&(this.render(),this.bumpNeighbours()),t}moveNumberedInputBefore(t,o){super.moveNumberedInputBefore(t,o),this.rendered&&(this.render(),this.bumpNeighbours())}appendInput_(t,o){return t=super.appendInput_(t,o),this.rendered&&(this.render(),this.bumpNeighbours()),t}setConnectionTracking(t){if(this.previousConnection&&this.previousConnection.setTracking(t),this.outputConnection&&this.outputConnection.setTracking(t),this.nextConnection){this.nextConnection.setTracking(t);var o=this.nextConnection.targetBlock();o&&o.setConnectionTracking(t)}if(!this.collapsed_)for(o=0;o<this.inputList.length;o++){var a=this.inputList[o].connection;a&&(a.setTracking(t),(a=a.targetBlock())&&a.setConnectionTracking(t))}}getConnections_(t){const o=[];if((t||this.rendered)&&(this.outputConnection&&o.push(this.outputConnection),this.previousConnection&&o.push(this.previousConnection),this.nextConnection&&o.push(this.nextConnection),t||!this.collapsed_))for(let a=0,d;d=this.inputList[a];a++)d.connection&&o.push(d.connection);return o}lastConnectionInStack(t){return super.lastConnectionInStack(t)}getMatchingConnection(t,o){return super.getMatchingConnection(t,o)}makeConnection_(t){return new _r(this,t)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){this.getRootBlock().bumpNeighboursInternal()}bumpNeighboursInternal(){const t=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||t.isInFlyout))for(const o of this.getConnections_(!1)){if(o.isSuperior()){let a;(a=o.targetBlock())==null||a.bumpNeighboursInternal()}for(const a of o.neighbours(i.config$$module$build$src$core$config.snapRadius))a.getSourceBlock().getRootBlock()!==t&&(o.isConnected()&&a.isConnected()||(o.isSuperior()?a.bumpAwayFrom(o):o.bumpAwayFrom(a)))}}scheduleSnapAndBump(){const t=Kt();setTimeout(()=>{He(t),this.snapToGrid(),He(!1)},i.config$$module$build$src$core$config.bumpDelay/2),setTimeout(()=>{He(t),this.bumpNeighbours(),He(!1)},i.config$$module$build$src$core$config.bumpDelay)}positionNearConnection(t,o){t.type!==Ie.NEXT_STATEMENT&&t.type!==Ie.INPUT_VALUE||this.moveBy(o.x-t.x,o.y-t.y)}getFirstStatementConnection(){return super.getFirstStatementConnection()}getChildren(t){return super.getChildren(t)}render(t){if(!this.renderIsInProgress_){this.renderIsInProgress_=!0;try{if(this.rendered=!0,Cs(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),t!==!1){const o=this.getParent();o?o.render(!0):this.workspace.resizeContents()}Os(),this.updateMarkers_()}finally{this.renderIsInProgress_=!1}}}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(Pu.LOCAL_MARKER).draw()}updateConnectionLocations_(){const t=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(t),this.outputConnection&&this.outputConnection.moveToOffset(t);for(let o=0;o<this.inputList.length;o++){const a=this.inputList[o].connection;a&&(a.moveToOffset(t),a.isConnected()&&a.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(t),this.nextConnection.isConnected()&&this.nextConnection.tighten())}setCursorSvg(t){this.pathObject.setCursorSvg(t)}setMarkerSvg(t){this.pathObject.setMarkerSvg(t)}getHeightWidth(){let t=this.height,o=this.width;var a=this.getNextBlock();if(a){a=a.getHeightWidth();const d=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;t+=a.height-d,o=Math.max(o,a.width)}return{height:t,width:o}}fadeForReplacement(t){this.pathObject.updateReplacementFade(t)}highlightShapeForInput(t,o){this.pathObject.updateShapeForInputHighlight(t,o)}};ps.INLINE=-1,ps.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var Ev=class{constructor(){}onDragEnter(t){}onDragOver(t){}onDragExit(t){}onDrop(t){}getClientRect(){return null}shouldPreventMove(t){return!1}},kd=class extends Ev{constructor(){super(),this.wouldDelete_=!1}wouldDelete(t,o){return t instanceof ps?(t=!t.getParent()&&t.isDeletable(),this.updateWouldDelete_(t&&!o)):this.updateWouldDelete_(t.isDeletable()),this.wouldDelete_}updateWouldDelete_(t){this.wouldDelete_=t}},Xn;(function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM"})(Xn||(Xn={}));var Sa;(function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"})(Sa||(Sa={}));var So;(function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN"})(So||(So={}));var $l={};$l.bumpDirection=So,$l.bumpPositionRect=Qp,$l.getCornerOppositeToolbox=Jp,$l.getStartPositionRect=qp,$l.horizontalPosition=Sa,$l.verticalPosition=Xn;var br={width:96,height:124,url:"sprites.png"},$v=class extends kd{constructor(t){super(),this.workspace=t,this.id="trashcan",this.contents_=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness_=0,this.lidTask_=this.svgLid_=this.svgGroup_=null,this.top_=this.left_=this.lidOpen_=0,this.initialized_=!1,0>=this.workspace.options.maxTrashcanContents||(t=new Vs({scrollbars:!0,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace.horizontalLayout?(t.toolboxPosition=this.workspace.toolboxPosition===Je.TOP?Je.BOTTOM:Je.TOP,this.flyout=new(cs(fe.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(t)):(t.toolboxPosition=this.workspace.toolboxPosition===Je.RIGHT?Je.LEFT:Je.RIGHT,this.flyout=new(cs(fe.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(t)),this.workspace.addChangeListener(this.onDelete_.bind(this)))}createDom(){this.svgGroup_=z(G.G,{class:"blocklyTrash"});let t;const o=String(Math.random()).substring(2);t=z(G.CLIPPATH,{id:"blocklyTrashBodyClipPath"+o},this.svgGroup_),z(G.RECT,{width:Ia,height:Ad,y:ka},t);const a=z(G.IMAGE,{width:br.width,x:-ig,height:br.height,y:-rg,"clip-path":"url(#blocklyTrashBodyClipPath"+o+")"},this.svgGroup_);return a.setAttributeNS(Or,"xlink:href",this.workspace.options.pathToMedia+br.url),t=z(G.CLIPPATH,{id:"blocklyTrashLidClipPath"+o},this.svgGroup_),z(G.RECT,{width:Ia,height:ka},t),this.svgLid_=z(G.IMAGE,{width:br.width,x:-ig,height:br.height,y:-rg,"clip-path":"url(#blocklyTrashLidClipPath"+o+")"},this.svgGroup_),this.svgLid_.setAttributeNS(Or,"xlink:href",this.workspace.options.pathToMedia+br.url),R(this.svgGroup_,"pointerdown",this,this.blockMouseDownWhenOpenable_),R(this.svgGroup_,"pointerup",this,this.click),R(a,"pointerover",this,this.mouseOver_),R(a,"pointerout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_}init(){0<this.workspace.options.maxTrashcanContents&&(pi(this.flyout.createDom(G.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[ji.Capability.AUTOHIDEABLE,ji.Capability.DELETE_AREA,ji.Capability.DRAG_TARGET,ji.Capability.POSITIONABLE]}),this.initialized_=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup_&&(ft(this.svgGroup_),this.svgGroup_=null),this.svgLid_=null,this.lidTask_&&clearTimeout(this.lidTask_)}hasContents_(){return!!this.contents_.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var t=this.contents_.map(function(a){return JSON.parse(a)}),o=this.workspace.getParentSvg().style;o.cursor="wait",setTimeout(()=>{let a;(a=this.flyout)==null||a.show(t),o.cursor=""},10),this.fireUiEvent_(!0)}}closeFlyout(){if(this.contentsIsOpen()){var t;(t=this.flyout)==null||t.hide(),this.fireUiEvent_(!1),this.workspace.recordDragTargets()}}autoHide(t){!t&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())}position(t,o){if(this.initialized_){var a=Jp(this.workspace,t);t=qp(a,new Xi(Ia,Ad+ka),$N,vv,t,this.workspace),o=Qp(t,vv,a.vertical===Xn.TOP?So.DOWN:So.UP,o),this.top_=o.top,this.left_=o.left;var d;(d=this.svgGroup_)==null||d.setAttribute("transform","translate("+this.left_+","+this.top_+")")}}getBoundingRectangle(){return new li(this.top_,this.top_+Ad+ka,this.left_,this.left_+Ia)}getClientRect(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect();const o=t.top+rg-Cd;return t=t.left+ig-Cd,new li(o,o+ka+Ad+2*Cd,t,t+Ia+2*Cd)}onDragOver(t){this.setLidOpen(this.wouldDelete_)}onDragExit(t){this.setLidOpen(!1)}onDrop(t){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(t){this.isLidOpen!==t&&(this.lidTask_&&clearTimeout(this.lidTask_),this.isLidOpen=t,this.animateLid_())}animateLid_(){const t=SN;var o=1/(t+1);this.lidOpen_+=this.isLidOpen?o:-o,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(this.lidOpen_*Sv),o=yv+this.lidOpen_*(IN-yv),this.svgGroup_&&(this.svgGroup_.style.opacity=o.toString()),this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),yN/t))}setLidAngle_(t){const o=this.workspace.toolboxPosition===Je.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let a;(a=this.svgLid_)==null||a.setAttribute("transform","rotate("+(o?-t:t)+","+(o?4:Ia-4)+","+(ka-2)+")")}setMinOpenness_(t){this.minOpenness_=t,this.isLidOpen||this.setLidAngle_(t*Sv)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents_()&&this.openFlyout()}fireUiEvent_(t){t=new(Le(Ru))(t,this.workspace.id),De(t)}blockMouseDownWhenOpenable_(t){!this.contentsIsOpen()&&this.hasContents_()&&t.stopPropagation()}mouseOver_(){this.hasContents_()&&this.setLidOpen(!0)}mouseOut_(){this.setLidOpen(!1)}onDelete_(t){if(!(0>=this.workspace.options.maxTrashcanContents||t.type!==on||t.type!==on||t.wasShadow)){if(!t.oldJson)throw Error("Encountered a delete event without proper oldJson");if(t=JSON.stringify(this.cleanBlockJson_(t.oldJson)),this.contents_.indexOf(t)===-1){for(this.contents_.unshift(t);this.contents_.length>this.workspace.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_(vN)}}}cleanBlockJson_(t){function o(a){if(a){if(delete a.id,delete a.x,delete a.y,delete a.enabled,a.icons&&a.icons.comment){var d=a.icons.comment;delete d.height,delete d.width,delete d.pinned}d=a.inputs;for(var m in d){var b=d[m];const I=b.block;b=b.shadow,I&&o(I),b&&o(b)}a.next&&(m=a.next,a=m.block,m=m.shadow,a&&o(a),m&&o(m))}}return t=JSON.parse(JSON.stringify(t)),o(t),Object.assign({},{kind:"BLOCK"},t)}},Ia=47,Ad=44,ka=16,vv=20,$N=20,Cd=10,ig=0,rg=32,vN=.1,yN=80,SN=4,yv=.4,IN=.8,Sv=45,sg=class extends Fs{constructor(t,o,a){super(a),this.type=Nu,this.oldItem=t??void 0,this.newItem=o??void 0}toJson(){const t=super.toJson();return t.oldItem=this.oldItem,t.newItem=this.newItem,t}fromJson(t){s("Blockly.Events.ToolboxItemSelect.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.oldItem=t.oldItem,this.newItem=t.newItem}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new sg),o.oldItem=t.oldItem,o.newItem=t.newItem,o}};tt(fe.EVENT,Nu,sg);var ng=class{constructor(t,o,a){this.id_=t.toolboxitemid||bu(),this.level_=(this.parent_=a||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=t,this.parentToolbox_=o,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(t){}},Ws=class extends ng{constructor(t,o,a){super(t,o,a),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),this.toolboxItemDef_.hidden==="true"&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else if(t=t.contents)for(let o=0;o<t.length;o++){const a=t[o];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(a)}}parseCategoryDef_(t){this.name_="name"in t?oi(t.name):"",this.colour_=this.getColour_(t),Object.assign(this.cssConfig_,t.cssconfig||t.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),rn(this.htmlDiv_,Rr.TREEITEM),ti(this.htmlDiv_,Yt.SELECTED,!1),ti(this.htmlDiv_,Yt.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),rn(this.iconDom_,Rr.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const t=this.labelDom_.getAttribute("id");return t&&ti(this.htmlDiv_,Yt.LABELLEDBY,t),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const t=document.createElement("div"),o=this.cssConfig_.container;return o&&Ce(t,o),t}createRowContainer_(){const t=document.createElement("div");var o=this.cssConfig_.row;return o&&Ce(t,o),o=`${Ws.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?t.style.paddingRight=o:t.style.paddingLeft=o,t}createRowContentsContainer_(){const t=document.createElement("div"),o=this.cssConfig_.rowcontentcontainer;return o&&Ce(t,o),t}createIconDom_(){const t=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const o=this.cssConfig_.icon;o&&Ce(t,o)}return t.style.display="inline-block",t}createLabelDom_(t){const o=document.createElement("span");return o.setAttribute("id",this.getId()+".label"),o.textContent=t,(t=this.cssConfig_.label)&&Ce(o,t),o}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(t){t&&(t=Ws.borderWidth+"px solid "+(t||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=t:this.rowDiv_.style.borderLeft=t)}getColour_(t){const o=t.categorystyle||t.categoryStyle;if((t=t.colour)&&o)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(o)return this.getColourfromStyle_(o);if(t)return this.parseColour_(t)}return""}getColourfromStyle_(t){var o=this.workspace_.getTheme();if(t&&o){if((o=o.categoryStyles[t])&&o.colour)return this.parseColour_(o.colour);console.warn('Style "'+t+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour_(t){if(t=oi(t),t==null||t==="")return"";var o=Number(t);return isNaN(o)?(o=ll(t))?o:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+t),""):Lp(o)}openIcon_(t){if(t){var o=this.cssConfig_.closedicon;o&&pr(t,o),(o=this.cssConfig_.openicon)&&Ce(t,o)}}closeIcon_(t){if(t){var o=this.cssConfig_.openicon;o&&pr(t,o),(o=this.cssConfig_.closedicon)&&Ce(t,o)}}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none",this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let t=this;for(;t.getParent();)if(t=t.getParent(),!t.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(t){}setSelected(t){if(this.rowDiv_){var o=this.cssConfig_.selected;if(t){const a=this.parseColour_(Ws.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||a,o&&Ce(this.rowDiv_,o)}else this.rowDiv_.style.backgroundColor="",o&&qe(this.rowDiv_,o);ti(this.htmlDiv_,Yt.SELECTED,t)}}setDisabled(t){this.isDisabled_=t,this.getDiv().setAttribute("disabled",`${t}`),t?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(t){this.flyoutItems_=[],this.toolboxItemDef_=typeof t=="string"?{kind:this.toolboxItemDef_.kind,custom:t,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:Uh(t),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){ft(this.htmlDiv_)}};Ws.registrationName="category",Ws.nestedPadding=19,Ws.borderWidth=8,Ws.defaultBackgroundColour="#57e",Ds(`
.blocklyTreeRow:not(.blocklyTreeSelected):hover {
  background-color: rgba(255, 255, 255, .2);
}

.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {
  margin: 1px 5px 1px 0;
}

.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {
  margin: 1px 0 1px 5px;
}

.blocklyTreeRow {
  height: 22px;
  line-height: 22px;
  margin-bottom: 3px;
  padding-right: 8px;
  white-space: nowrap;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {
  margin-left: 8px;
  padding-right: 0;
}

.blocklyTreeIcon {
  background-image: url(<<<PATH>>>/sprites.png);
  height: 16px;
  vertical-align: middle;
  visibility: hidden;
  width: 16px;
}

.blocklyTreeIconClosed {
  background-position: -32px -1px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {
  background-position: 0 -1px;
}

.blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: -32px -17px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: 0 -17px;
}

.blocklyTreeIconOpen {
  background-position: -16px -1px;
}

.blocklyTreeSelected>.blocklyTreeIconOpen {
  background-position: -16px -17px;
}

.blocklyTreeLabel {
  cursor: default;
  font: 16px sans-serif;
  padding: 0 3px;
  vertical-align: middle;
}

.blocklyToolboxDelete .blocklyTreeLabel {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyTreeSelected .blocklyTreeLabel {
  color: #fff;
}
`),tt(fe.TOOLBOX_ITEM,Ws.registrationName,Ws);var rc=class extends ng{constructor(t,o){super(t,o),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv_=null,Object.assign(this.cssConfig_,t.cssconfig||t.cssConfig)}init(){this.createDom_()}createDom_(){const t=document.createElement("div"),o=this.cssConfig_.container;return o&&Ce(t,o),this.htmlDiv_=t}getDiv(){return this.htmlDiv_}dispose(){ft(this.htmlDiv_)}};rc.registrationName="sep",Ds(`
.blocklyTreeSeparator {
  border-bottom: solid #e5e5e5 1px;
  height: 0;
  margin: 5px 0;
}

.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {
  border-right: solid #e5e5e5 1px;
  border-bottom: none;
  height: auto;
  margin: 0 5px 0 5px;
  padding: 5px 0;
  width: 0;
}
`),tt(fe.TOOLBOX_ITEM,rc.registrationName,rc);var Aa=class extends Ws{constructor(t,o,a){super(t,o,a),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const t=super.makeDefaultCssConfig_();return t.contents="blocklyToolboxContents",t}parseContents_(t){const o=t.contents;let a=!0;if(t.custom)this.flyoutItems_=t.custom;else if(o)for(t=0;t<o.length;t++){const d=o[t];!GT(fe.TOOLBOX_ITEM,d.kind)||d.kind.toLowerCase()===rc.registrationName&&a?(this.flyoutItems_.push(d),a=!0):(this.createToolboxItem_(d),a=!1)}}createToolboxItem_(t){let o=t.kind;o.toUpperCase()==="CATEGORY"&&Gp(t)&&(o=Aa.registrationName),t=new(Ql(fe.TOOLBOX_ITEM,o))(t,this.parentToolbox_,this),this.toolboxItems_.push(t)}init(){super.init(),this.setExpanded(this.toolboxItemDef_.expanded==="true"||this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const t=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(t),rn(this.subcategoriesDiv_,Rr.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_}createIconDom_(){const t=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const o=this.cssConfig_.icon;o&&Ce(t,o),t.style.visibility="visible"}return t.style.display="inline-block",t}createSubCategoriesDom_(t){const o=document.createElement("div");var a=this.cssConfig_.contents;for(a&&Ce(o,a),a=0;a<t.length;a++){const d=t[a];d.init();const m=d.getDiv();if(o.appendChild(m),d.getClickTarget){let b;(b=d.getClickTarget())==null||b.setAttribute("id",d.getId())}}return o}setExpanded(t){this.expanded_!==t&&((this.expanded_=t)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),ti(this.htmlDiv_,Yt.EXPANDED,t),this.parentToolbox_.handleToolboxItemResize())}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none";const o=this.getChildToolboxItems();for(let a=0;a<o.length;a++)o[a].setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(t){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Aa.registrationName="collapsibleCategory",tt(fe.TOOLBOX_ITEM,Aa.registrationName,Aa);var Iv=class extends kd{constructor(t){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null,this.boundEvents_=[],this.workspace_=t,this.toolboxDef_=t.options.languageTree||{contents:[]},this.horizontalLayout_=t.options.horizontalLayout,this.RTL=t.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=t.options.toolboxPosition}onShortcut(t){return!1}init(){var t=this.workspace_;const o=t.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),pi(this.flyout_.createDom("svg"),o),this.setVisible(!0),this.flyout_.init(t),this.render(this.toolboxDef_),t=t.getThemeManager(),t.subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),t.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[ji.Capability.AUTOHIDEABLE,ji.Capability.DELETE_AREA,ji.Capability.DRAG_TARGET]})}createDom_(t){t=t.getParentSvg();const o=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,rn(this.contentsDiv_,Rr.TREE),o.appendChild(this.contentsDiv_),t.parentNode.insertBefore(o,t),this.attachEvents_(o,this.contentsDiv_),o}createContainer_(){const t=document.createElement("div");return t.setAttribute("layout",this.isHorizontal()?"h":"v"),Ce(t,"blocklyToolboxDiv"),Ce(t,"blocklyNonSelectable"),t.setAttribute("dir",this.RTL?"RTL":"LTR"),t}createContentsContainer_(){const t=document.createElement("div");return Ce(t,"blocklyToolboxContents"),this.isHorizontal()&&(t.style.flexDirection="row"),t}attachEvents_(t,o){t=y(t,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(t),o=y(o,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(o)}onClick_(t){if(j(t)||t.target===this.HtmlDiv)re().hideChaff(!1);else{var o=t.target.getAttribute("id");o&&(o=this.getToolboxItemById(o),o.isSelectable()&&(this.setSelectedItem(o),o.onClick(t))),re().hideChaff(!0)}u()}onKeyDown_(t){let o=!1;switch(t.keyCode){case Re.DOWN:o=this.selectNext_();break;case Re.UP:o=this.selectPrevious_();break;case Re.LEFT:o=this.selectParent_();break;case Re.RIGHT:o=this.selectChild_();break;case Re.ENTER:case Re.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),o=!0);break;default:o=!1}if(!o&&this.selectedItem_){const a=this.selectedItem_;a.onKeyDown&&(o=a.onKeyDown(t))}o&&t.preventDefault()}createFlyout_(){const t=this.workspace_,o=new Vs({parentWorkspace:t,rtl:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,renderer:t.options.renderer,rendererOverrides:t.options.rendererOverrides,move:{scrollbars:!0}});return o.toolboxPosition=t.options.toolboxPosition,new(t.horizontalLayout?cs(fe.FLYOUTS_HORIZONTAL_TOOLBOX,t.options,!0):cs(fe.FLYOUTS_VERTICAL_TOOLBOX,t.options,!0))(o)}render(t){this.toolboxDef_=t;for(let o=0;o<this.contents_.length;o++){const a=this.contents_[o];a&&a.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(t.contents),this.position(),this.handleToolboxItemResize()}renderContents_(t){const o=document.createDocumentFragment();for(let a=0;a<t.length;a++)this.createToolboxItem_(t[a],o);this.contentsDiv_.appendChild(o)}createToolboxItem_(t,o){var a=t.kind;a.toUpperCase()==="CATEGORY"&&Gp(t)&&(a=Aa.registrationName),(a=Ql(fe.TOOLBOX_ITEM,a.toLowerCase()))&&(t=new a(t,this),t.init(),this.addToolboxItem_(t),(a=t.getDiv())&&o.appendChild(a),t.getClickTarget()&&t.getClickTarget().setAttribute("id",t.getId()))}addToolboxItem_(t){if(this.contents_.push(t),this.contentMap_[t.getId()]=t,t.isCollapsible()){t=t.getChildToolboxItems();for(let o=0;o<t.length;o++)this.addToolboxItem_(t[o])}}getToolboxItems(){return this.contents_}addStyle(t){t&&this.HtmlDiv&&Ce(this.HtmlDiv,t)}removeStyle(t){t&&this.HtmlDiv&&qe(this.HtmlDiv,t)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var t=this.HtmlDiv.getBoundingClientRect();const o=t.top,a=o+t.height,d=t.left;return t=d+t.width,this.toolboxPosition===Je.TOP?new li(-1e7,a,-1e7,1e7):this.toolboxPosition===Je.BOTTOM?new li(o,1e7,-1e7,1e7):this.toolboxPosition===Je.LEFT?new li(-1e7,1e7,-1e7,t):new li(-1e7,1e7,d,1e7)}wouldDelete(t,o){return t instanceof ps?this.updateWouldDelete_(!t.getParent()&&t.isDeletable()):this.updateWouldDelete_(t.isDeletable()),this.wouldDelete_}onDragEnter(t){this.updateCursorDeleteStyle_(!0)}onDragExit(t){this.updateCursorDeleteStyle_(!1)}onDrop(t){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(t){t!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=t,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(t){const o=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";t?this.addStyle(o):this.removeStyle(o)}getToolboxItemById(t){return this.contentMap_[t]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const t=this.workspace_.getMetrics(),o=this.HtmlDiv;o&&(this.horizontalLayout_?(o.style.left="0",o.style.height="auto",o.style.width="100%",this.height_=o.offsetHeight,this.width_=t.viewWidth,this.toolboxPosition===Je.TOP?o.style.top="0":o.style.bottom="0"):(this.toolboxPosition===Je.RIGHT?o.style.right="0":o.style.left="0",o.style.height="100%",this.width_=o.offsetWidth,this.height_=t.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const t=this.workspace_,o=this.HtmlDiv.getBoundingClientRect();t.translate(this.toolboxPosition===Je.LEFT?t.scrollX+o.width:t.scrollX,this.toolboxPosition===Je.TOP?t.scrollY+o.height:t.scrollY),je(t)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let t=0;t<this.contents_.length;t++){const o=this.contents_[t];o.refreshTheme&&o.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(t){this.isVisible_!==t&&(this.HtmlDiv.style.display=t?"block":"none",this.isVisible_=t,this.workspace_.recordDragTargets())}autoHide(t){!t&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(t){const o=this.selectedItem_;!t&&!o||t&&!t.isSelectable()||(this.shouldDeselectItem_(o,t)&&o!==null&&this.deselectItem_(o),this.shouldSelectItem_(o,t)&&t!==null&&this.selectItem_(o,t),this.updateFlyout_(o,t),this.fireSelectEvent_(o,t))}shouldDeselectItem_(t,o){return t!==null&&(!t.isCollapsible()||t!==o)}shouldSelectItem_(t,o){return o!==null&&o!==t}deselectItem_(t){this.selectedItem_=null,this.previouslySelectedItem_=t,t.setSelected(!1),ti(this.contentsDiv_,Yt.ACTIVEDESCENDANT,"")}selectItem_(t,o){this.selectedItem_=o,this.previouslySelectedItem_=t,o.setSelected(!0),ti(this.contentsDiv_,Yt.ACTIVEDESCENDANT,o.getId())}selectItemByPosition(t){-1<t&&t<this.contents_.length&&(t=this.contents_[t],t.isSelectable()&&this.setSelectedItem(t))}updateFlyout_(t,o){o&&(t!==o||o.isCollapsible())&&o.getContents().length?(this.flyout_.show(o.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(t,o){const a=t&&t.getName();let d=o&&o.getName();t===o&&(d=null),t=new(Le(Nu))(a,d,this.workspace_.id),De(t)}selectParent_(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),!0):!1:!1}selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const t=this.selectedItem_;return t.isExpanded()?this.selectNext_():t.toggleExpanded(),!0}selectNext_(){if(!this.selectedItem_)return!1;let t=this.contents_.indexOf(this.selectedItem_)+1;if(-1<t&&t<this.contents_.length){let o=this.contents_[t];for(;o&&!o.isSelectable();)o=this.contents_[++t];if(o&&o.isSelectable())return this.setSelectedItem(o),!0}return!1}selectPrevious_(){if(!this.selectedItem_)return!1;let t=this.contents_.indexOf(this.selectedItem_)-1;if(-1<t&&t<this.contents_.length){let o=this.contents_[t];for(;o&&!o.isSelectable();)o=this.contents_[--t];if(o&&o.isSelectable())return this.setSelectedItem(o),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var t=0;t<this.contents_.length;t++)this.contents_[t].dispose();for(t=0;t<this.boundEvents_.length;t++)C(this.boundEvents_[t]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),ft(this.HtmlDiv)}};Ds(`
.blocklyToolboxDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyToolboxGrab {
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Category tree in Toolbox. */
.blocklyToolboxDiv {
  background-color: #ddd;
  overflow-x: visible;
  overflow-y: auto;
  padding: 4px 0 4px 0;
  position: absolute;
  z-index: 70;  /* so blocks go under toolbox when dragging */
  -webkit-tap-highlight-color: transparent;  /* issue #1345 */
}

.blocklyToolboxContents {
  display: flex;
  flex-wrap: wrap;
  flex-direction: column;
}

.blocklyToolboxContents:focus {
  outline: none;
}
`),tt(fe.TOOLBOX,Hn,Iv);var kN={colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},AN={colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}},CN=new Tl("zelos",kN,AN),og={};og.Classic=yd,og.Zelos=CN;var lg=class extends Fs{constructor(t,o,a){o=t?t.workspace.id:o,o===null&&(o=void 0),super(o),this.type=$o,this.blockId=t?t.id:void 0,this.targetType=a}toJson(){const t=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return t.targetType=this.targetType,t.blockId=this.blockId,t}fromJson(t){s("Blockly.Events.Click.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.targetType=t.targetType,this.blockId=t.blockId}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new lg),o.targetType=t.targetType,o.blockId=t.blockId,o}},ag;(function(t){t.BLOCK="block",t.WORKSPACE="workspace",t.ZOOM_CONTROLS="zoom_controls"})(ag||(ag={})),tt(fe.EVENT,$o,lg);var kv=class{constructor(t,o){this.bubble=t,this.workspace=o,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.bubble.getRelativeToSurfaceXY(),this.dragSurface_=o.getBlockDragSurface()}startBubbleDrag(){Kt()||He(!0),this.workspace.setResizesEnabled(!1),this.bubble.setAutoLayout(!1),this.dragSurface_&&(this.bubble.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.bubble.getSvgRoot())),this.bubble.setDragging&&this.bubble.setDragging(!0)}dragBubble(t,o){o=this.pixelsToWorkspaceUnits_(o),o=ve.sum(this.startXY_,o),this.bubble.moveDuringDrag(this.dragSurface_,o),o=this.dragTarget_,this.dragTarget_=this.workspace.getDragTarget(t),t=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),t!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==o&&(o&&o.onDragExit(this.bubble),this.dragTarget_&&this.dragTarget_.onDragEnter(this.bubble)),this.dragTarget_&&this.dragTarget_.onDragOver(this.bubble)}shouldDelete_(t){return t&&this.workspace.getComponentManager().hasCapability(t.id,ji.Capability.DELETE_AREA)?t.wouldDelete(this.bubble,!1):!1}updateCursorDuringBubbleDrag_(){this.bubble.setDeleteStyle(this.wouldDeleteBubble_)}endBubbleDrag(t,o){this.dragBubble(t,o),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.bubble)?t=this.startXY_:(t=this.pixelsToWorkspaceUnits_(o),t=ve.sum(this.startXY_,t)),this.bubble.moveTo(t.x,t.y),this.dragTarget_&&this.dragTarget_.onDrop(this.bubble),this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.bubble.dispose()):(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace.getBubbleCanvas()),this.bubble.setDragging&&this.bubble.setDragging(!1),this.fireMoveEvent_()),this.workspace.setResizesEnabled(!0),He(!1)}fireMoveEvent_(){if(this.bubble instanceof ar){const t=new(Le(Vn))(this.bubble);t.setOldCoordinate(this.startXY_),t.recordNew(),De(t)}}pixelsToWorkspaceUnits_(t){return t=new ve(t.x/this.workspace.scale,t.y/this.workspace.scale),this.workspace.isMutator&&t.scale(1/this.workspace.options.parentWorkspace.scale),t}},Av=class{constructor(t){this.workspace=t,this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace.isMovableVertically(),this.startScrollXY_=new ve(t.scrollX,t.scrollY)}dispose(){this.workspace=null}startDrag(){_e()&&_e().unselect(),this.workspace.setupDragSurface()}endDrag(t){this.drag(t),this.workspace.resetDragSurface()}drag(t){if(t=ve.sum(this.startScrollXY_,t),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(t.x,t.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(t.x,this.workspace.scrollY);else if(this.verticalScrollEnabled_)this.workspace.scroll(this.workspace.scrollX,t.y);else throw new TypeError("Invalid state.")}},ON=5,wN=6,an=class{constructor(t,o){this.creatorWorkspace=o,this.mouseDownXY_=new ve(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.hasExceededDragRadius_=!1,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isMultiTouch_=this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1,this.cachedPoints=new Map,this.startDistance_=this.previousScale_=0,this.currentDropdownOwner=this.isPinchZoomEnabled_=this.onStartWrapper_=null,this.mostRecentEvent_=t,this.currentDragDeltaXY_=new ve(0,0),this.healStack_=!gv}dispose(){u(),pE(),this.creatorWorkspace.clearGesture(),this.onMoveWrapper_&&C(this.onMoveWrapper_),this.onUpWrapper_&&C(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.onStartWrapper_&&C(this.onStartWrapper_)}updateFromEvent_(t){const o=new ve(t.clientX,t.clientY);this.updateDragDelta_(o)&&(this.updateIsDragging_(),l()),this.mostRecentEvent_=t}updateDragDelta_(t){return this.currentDragDeltaXY_=ve.difference(t,this.mouseDownXY_),this.hasExceededDragRadius_?!1:this.hasExceededDragRadius_=ve.magnitude(this.currentDragDeltaXY_)>(this.flyout_?i.config$$module$build$src$core$config.flyoutDragRadius:i.config$$module$build$src$core$config.dragRadius)}updateIsDraggingFromFlyout_(){let t;if(!this.targetBlock_||(t=this.flyout_)==null||!t.isBlockCreatable(this.targetBlock_))return!1;if(!this.flyout_.targetWorkspace)throw Error(`Cannot update dragging from the flyout because the ' +
          'flyout's target workspace is undefined`);return!this.flyout_.isScrollable()||this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)?(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Kt()||He(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),!0):!1}updateIsDraggingBubble_(){return this.startBubble_?(this.startDraggingBubble_(),!0):!1}updateIsDraggingBlock_(){if(!this.targetBlock_)return!1;if(this.flyout_){if(this.updateIsDraggingFromFlyout_())return this.startDraggingBlock_(),!0}else if(this.targetBlock_.isMovable())return this.startDraggingBlock_(),!0;return!1}updateIsDraggingWorkspace_(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=new Av(this.startWorkspace_),this.workspaceDragger_.startDrag())}updateIsDragging_(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=!0,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()}startDraggingBlock_(){this.blockDragger_=new(cs(fe.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_)}startDraggingBubble_(){if(!this.startBubble_)throw Error("Cannot update dragging the bubble because the start bubble is undefined");if(!this.startWorkspace_)throw Error("Cannot update dragging the bubble because the start workspace is undefined");this.bubbleDragger_=new kv(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)}doStart(t){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,x(t)?this.cancel():(this.hasStarted_=!0,yu(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=yh(),this.startWorkspace_.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=t,fE(),this.targetBlock_&&this.targetBlock_.select(),j(t)?this.handleRightClick(t):(t.type.toLowerCase()==="pointerdown"&&t.pointerType!=="mouse"&&n(t,this),this.mouseDownXY_=new ve(t.clientX,t.clientY),this.healStack_=t.altKey||t.ctrlKey||t.metaKey,this.bindMouseEvents(t),this.isEnding_||this.handleTouchStart(t)))}bindMouseEvents(t){this.onStartWrapper_=y(document,"pointerdown",null,this.handleStart.bind(this),!0),this.onMoveWrapper_=y(document,"pointermove",null,this.handleMove.bind(this),!0),this.onUpWrapper_=y(document,"pointerup",null,this.handleUp.bind(this),!0),t.preventDefault(),t.stopPropagation()}handleStart(t){this.isDragging()||(this.handleTouchStart(t),this.isMultiTouch()&&l())}handleMove(t){this.isDragging()&&c(t)||!this.isMultiTouch()?(this.updateFromEvent_(t),this.workspaceDragger_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.bubbleDragger_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),t.preventDefault(),t.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(t),l())}handleUp(t){if(this.isDragging()||this.handleTouchEnd(t),!this.isMultiTouch()||this.isDragging()){if(!c(t))return;if(this.updateFromEvent_(t),l(),this.isEnding_){console.log("Trying to end a gesture recursively.");return}this.isEnding_=!0,this.bubbleDragger_?this.bubbleDragger_.endBubbleDrag(t,this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.endDrag(t,this.currentDragDeltaXY_):this.workspaceDragger_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(t)}t.preventDefault(),t.stopPropagation(),this.dispose()}handleTouchStart(t){var o=h(t);this.cachedPoints.set(o,this.getTouchPoint(t));var a=Array.from(this.cachedPoints.keys());a.length===2&&(o=this.cachedPoints.get(a[0]),a=this.cachedPoints.get(a[1]),this.startDistance_=ve.distance(o,a),this.isMultiTouch_=!0,t.preventDefault())}handleTouchMove(t){const o=h(t);this.cachedPoints.set(o,this.getTouchPoint(t)),this.isPinchZoomEnabled_&&this.cachedPoints.size===2?this.handlePinch_(t):this.handleMove(t)}handlePinch_(t){var o=Array.from(this.cachedPoints.keys()),a=this.cachedPoints.get(o[0]);if(o=this.cachedPoints.get(o[1]),a=ve.distance(a,o)/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){if(o=a-this.previousScale_,o=0<o?o*ON:o*wN,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const d=this.startWorkspace_,m=F(t,d.getParentSvg(),d.getInverseScreenCTM());d.zoom(m.x,m.y,o)}this.previousScale_=a,t.preventDefault()}handleTouchEnd(t){t=h(t),this.cachedPoints.has(t)&&this.cachedPoints.delete(t),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale_=0)}getTouchPoint(t){return this.startWorkspace_?new ve(t.pageX,t.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(l(),this.bubbleDragger_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.endDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.workspaceDragger_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())}handleRightClick(t){this.targetBlock_?(this.bringBlockToFront_(),this.targetBlock_.workspace.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(t)):this.startBubble_?this.startBubble_.showContextMenu(t):this.startWorkspace_&&!this.flyout_&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(t)),t.preventDefault(),t.stopPropagation(),this.dispose()}handleWsStart(t,o){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(o),this.mostRecentEvent_=t,this.doStart(t)}fireWorkspaceClick_(t){De(new(Le($o))(null,t.id,"workspace"))}handleFlyoutStart(t,o){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(o),this.handleWsStart(t,o.getWorkspace())}handleBlockStart(t,o){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(o),this.mostRecentEvent_=t}handleBubbleStart(t,o){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(o),this.mostRecentEvent_=t}doBubbleClick_(){this.startBubble_ instanceof ar&&(this.startBubble_.setFocus(),this.startBubble_.select())}doFieldClick_(){if(!this.startField_)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField_&&this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()}doBlockClick_(){if(this.flyout_&&this.flyout_.autoClose){if(!this.targetBlock_)throw Error("Cannot do a block click because the target block is undefined");this.targetBlock_.isEnabled()&&(Kt()||He(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump())}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");const t=new(Le($o))(this.startBlock_,this.startWorkspace_.id,"block");De(t)}this.bringBlockToFront_(),He(!1)}doWorkspaceClick_(t){t=this.creatorWorkspace,_e()&&_e().unselect(),this.fireWorkspaceClick_(this.startWorkspace_||t)}bringBlockToFront_(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()}setStartField(t){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=t)}setStartBubble(t){this.startBubble_||(this.startBubble_=t)}setStartBlock(t){this.startBlock_||this.startBubble_||(this.startBlock_=t,t.isInFlyout&&t!==t.getRootBlock()?this.setTargetBlock_(t.getRootBlock()):this.setTargetBlock_(t))}setTargetBlock_(t){t.isShadow()?this.setTargetBlock_(t.getParent()):this.targetBlock_=t}setStartWorkspace_(t){this.startWorkspace_||(this.startWorkspace_=t)}setStartFlyout_(t){this.flyout_||(this.flyout_=t)}isBubbleClick_(){return!!this.startBubble_&&!this.hasExceededDragRadius_}isBlockClick_(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()}isFieldClick_(){return(this.startField_?this.startField_.isClickable():!1)&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)}isWorkspaceClick_(){return!this.startBlock_&&!this.startBubble_&&!this.startField_&&!this.hasExceededDragRadius_}isDragging(){return!!this.workspaceDragger_||!!this.blockDragger_||!!this.bubbleDragger_}hasStarted(){return this.hasStarted_}getInsertionMarkers(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]}getCurrentDragger(){let t,o;return(o=(t=this.blockDragger_)!=null?t:this.workspaceDragger_)!=null?o:this.bubbleDragger_}static inProgress(){const t=ne();for(let o=0,a;a=t[o];o++)if(a.currentGesture_)return!0;return!1}},Lt=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(t,o){if(this.shortcuts.get(t.name)&&!o)throw Error(`Shortcut named "${t.name}" already exists.`);if(this.shortcuts.set(t.name,t),(o=t.keyCodes)&&0<o.length)for(let a=0;a<o.length;a++)this.addKeyMapping(o[a],t.name,!!t.allowCollision)}unregister(t){return this.shortcuts.get(t)?(this.removeAllKeyMappings(t),this.shortcuts.delete(t),!0):(console.warn(`Keyboard shortcut named "${t}" not found.`),!1)}addKeyMapping(t,o,a){t=String(t);const d=this.keyMap.get(t);if(d&&!a)throw Error(`Shortcut named "${o}" collides with shortcuts "${d}"`);d&&a?d.unshift(o):this.keyMap.set(t,[o])}removeKeyMapping(t,o,a){const d=this.keyMap.get(t);if(!d)return a||console.warn(`No keyboard shortcut named "${o}" registered with key code "${t}"`),!1;const m=d.indexOf(o);return-1<m?(d.splice(m,1),d.length===0&&this.keyMap.delete(t),!0):(a||console.warn(`No keyboard shortcut named "${o}" registered with key code "${t}"`),!1)}removeAllKeyMappings(t){for(const o of this.keyMap.keys())this.removeKeyMapping(o,t,!0)}setKeyMap(t){this.keyMap.clear();for(const o in t)this.keyMap.set(o,t[o])}getKeyMap(){const t=Object.create(null);for(const[o,a]of this.keyMap)t[o]=a;return t}getRegistry(){const t=Object.create(null);for(const[o,a]of this.shortcuts)t[o]=a;return go(Object.create(null),t)}onKeyDown(t,o){var a=this.serializeKeyEvent_(o);if(a=this.getShortcutNamesByKeyCode(a),!a)return!1;for(let d=0,m;m=a[d];d++){const b=this.shortcuts.get(m);let I,L;if((I=b)==null||!I.preconditionFn||(L=b)!=null&&L.preconditionFn(t)){let oe,ye;if((oe=b)!=null&&oe.callback&&((ye=b)!=null&&ye.callback(t,o,b)))return!0}}return!1}getShortcutNamesByKeyCode(t){return this.keyMap.get(t)||[]}getKeyCodesByShortcutName(t){const o=[];for(const[a,d]of this.keyMap)-1<d.indexOf(t)&&o.push(a);return o}serializeKeyEvent_(t){let o="";for(const a in Lt.modifierKeys)t.getModifierState(a)&&(o!==""&&(o+="+"),o+=a);return o!==""&&t.keyCode?o=o+"+"+t.keyCode:t.keyCode&&(o=t.keyCode.toString()),o}checkModifiers_(t){for(let o=0,a;a=t[o];o++)if(!(a in Lt.modifierKeys))throw Error(a+" is not a valid modifier key.")}createSerializedKey(t,o){let a="";if(o){this.checkModifiers_(o);for(const d in Lt.modifierKeys)-1<o.indexOf(Lt.modifierKeys[d])&&(a!==""&&(a+="+"),a+=d)}return a!==""&&t?a=a+"+"+t:t&&(a=t.toString()),a}};Lt.registry=new Lt,function(t){t=t.modifierKeys||(t.modifierKeys={}),t[t.Shift=16]="Shift",t[t.Control=17]="Control",t[t.Alt=18]="Alt",t[t.Meta=91]="Meta"}(Lt||(Lt={}));var un;(function(t){t.ESCAPE="escape",t.DELETE="delete",t.COPY="copy",t.CUT="cut",t.PASTE="paste",t.UNDO="undo",t.REDO="redo"})(un||(un={})),jE();var cn={};cn.names=un,cn.registerCopy=VE,cn.registerCut=WE,cn.registerDefaultShortcuts=jE,cn.registerDelete=GE,cn.registerEscape=HE,cn.registerPaste=zE,cn.registerRedo=XE,cn.registerUndo=YE;var ug=class extends Fs{constructor(t,o){super(o),this.type=xu,this.themeName=t}toJson(){const t=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return t.themeName=this.themeName,t}fromJson(t){s("Blockly.Events.ThemeChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.themeName=t.themeName}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new ug),o.themeName=t.themeName,o}};tt(fe.EVENT,xu,ug);var cg=class extends Fs{constructor(t,o,a,d,m){super(d),this.type=pl,this.viewTop=t,this.viewLeft=o,this.scale=a,this.oldScale=m}toJson(){const t=super.toJson();if(this.viewTop===void 0)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(this.viewLeft===void 0)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(this.scale===void 0)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(this.oldScale===void 0)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return t.viewTop=this.viewTop,t.viewLeft=this.viewLeft,t.scale=this.scale,t.oldScale=this.oldScale,t}fromJson(t){s("Blockly.Events.Viewport.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.viewTop=t.viewTop,this.viewLeft=t.viewLeft,this.scale=t.scale,this.oldScale=t.oldScale}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new cg),o.viewTop=t.viewTop,o.viewLeft=t.viewLeft,o.scale=t.scale,o.oldScale=t.oldScale,o}};tt(fe.EVENT,pl,cg);var Ca=class{constructor(t){this.connectionChecker=t,this.connections_=[]}addConnection(t,o){o=this.calculateIndexForYPos_(o),this.connections_.splice(o,0,t)}findIndexOfConnection_(t,o){if(!this.connections_.length)return-1;const a=this.calculateIndexForYPos_(o);if(a>=this.connections_.length)return-1;o=t.y;let d=a;for(;0<=d&&this.connections_[d].y===o;){if(this.connections_[d]===t)return d;d--}for(d=a;d<this.connections_.length&&this.connections_[d].y===o;){if(this.connections_[d]===t)return d;d++}return-1}calculateIndexForYPos_(t){if(!this.connections_.length)return 0;let o=0,a=this.connections_.length;for(;o<a;){const d=Math.floor((o+a)/2);if(this.connections_[d].y<t)o=d+1;else if(this.connections_[d].y>t)a=d;else{o=d;break}}return o}removeConnection(t,o){if(t=this.findIndexOfConnection_(t,o),t===-1)throw Error("Unable to find connection in connectionDB.");this.connections_.splice(t,1)}getNeighbours(t,o){function a(ye){const yt=m-d[ye].x,Jt=b-d[ye].y;return Math.sqrt(yt*yt+Jt*Jt)<=o&&oe.push(d[ye]),Jt<o}const d=this.connections_,m=t.x,b=t.y;t=0;let I=d.length-2,L=I;for(;t<L;)d[L].y<b?t=L:I=L,L=Math.floor((t+I)/2);const oe=[];if(I=t=L,d.length){for(;0<=t&&a(t);)t--;do I++;while(I<d.length&&a(I))}return oe}isInYRange_(t,o,a){return Math.abs(this.connections_[t].y-o)<=a}searchForClosest(t,o,a){if(!this.connections_.length)return{connection:null,radius:o};const d=t.y,m=t.x;t.x=m+a.x,t.y=d+a.y;var b=this.calculateIndexForYPos_(t.y);a=null;let I=o,L,oe=b-1;for(;0<=oe&&this.isInYRange_(oe,t.y,o);)L=this.connections_[oe],this.connectionChecker.canConnect(t,L,!0,I)&&(a=L,I=L.distanceFrom(t)),oe--;for(;b<this.connections_.length&&this.isInYRange_(b,t.y,o);)L=this.connections_[b],this.connectionChecker.canConnect(t,L,!0,I)&&(a=L,I=L.distanceFrom(t)),b++;return t.x=m,t.y=d,{connection:a,radius:I}}static init(t){const o=[];return o[Ie.INPUT_VALUE]=new Ca(t),o[Ie.OUTPUT_VALUE]=new Ca(t),o[Ie.NEXT_STATEMENT]=new Ca(t),o[Ie.PREVIOUS_STATEMENT]=new Ca(t),o}},hg=class{constructor(t,o){this.pattern=t;let a;this.spacing=(a=o.spacing)!=null?a:0;let d;this.length=(d=o.length)!=null?d:1,this.line2=(this.line1=t.firstChild)&&this.line1.nextSibling;let m;this.snapToGrid=(m=o.snap)!=null?m:!1}shouldSnap(){return this.snapToGrid}getSpacing(){return this.spacing}getPatternId(){return this.pattern.id}update(t){var o=this.spacing*t||100;this.pattern.setAttribute("width",o.toString()),this.pattern.setAttribute("height",o.toString()),o=Math.floor(this.spacing/2)+.5;let a=o-this.length/2,d=o+this.length/2;o*=t,a*=t,d*=t,this.setLineAttributes(this.line1,t,a,d,o,o),this.setLineAttributes(this.line2,t,o,o,a,d)}setLineAttributes(t,o,a,d,m,b){t&&(t.setAttribute("stroke-width",o.toString()),t.setAttribute("x1",a.toString()),t.setAttribute("y1",m.toString()),t.setAttribute("x2",d.toString()),t.setAttribute("y2",b.toString()))}moveTo(t,o){this.pattern.setAttribute("x",t.toString()),this.pattern.setAttribute("y",o.toString())}static createDom(t,o,a){t=z(G.PATTERN,{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},a);let d,m;if(0<((d=o.length)!=null?d:1)&&0<((m=o.spacing)!=null?m:0)){z(G.LINE,{stroke:o.colour},t);let b;(b=o.length)!=null&&b&&z(G.LINE,{stroke:o.colour},t)}else z(G.LINE,{},t);return t}},ms=class{constructor(t,o){this.db=new Map,this.dbReverse=new Set,this.variableMap_=null,this.variablePrefix_=o||"",this.reservedWords=new Set(t?t.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap_=null}setVariableMap(t){this.variableMap_=t}getNameForUserVariable_(t){return this.variableMap_?(t=this.variableMap_.getVariableById(t))?t.name:null:(console.warn(`Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:
Blockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());`),null)}populateVariables(t){t=Sp(t);for(let o=0;o<t.length;o++)this.getName(t[o].getId(),i.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(t){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(t,o){let a=t;o===i.NameType$$module$build$src$core$names.VARIABLE&&(t=this.getNameForUserVariable_(t))&&(a=t),t=a.toLowerCase();const d=o===i.NameType$$module$build$src$core$names.VARIABLE||o===i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix_:"";this.db.has(o)||this.db.set(o,new Map);const m=this.db.get(o);return m.has(t)?d+m.get(t):(o=this.getDistinctName(a,o),m.set(t,o.substr(d.length)),o)}getUserNames(t){let o;return(t=(o=this.db.get(t))==null?void 0:o.keys())?Array.from(t):[]}getDistinctName(t,o){t=this.safeName_(t);let a="";for(;this.dbReverse.has(t+a)||this.reservedWords.has(t+a);)a=a?a+1:2;return t+=a,this.dbReverse.add(t),(o===i.NameType$$module$build$src$core$names.VARIABLE||o===i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix_:"")+t}safeName_(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".indexOf(t[0])!==-1&&(t="my_"+t)):t=Ve.UNNAMED_KEY||"unnamed",t}static equals(t,o){return t.toLowerCase()===o.toLowerCase()}};(function(t){t=t.NameType||(t.NameType={}),t.DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",t.VARIABLE="VARIABLE",t.PROCEDURE="PROCEDURE"})(ms||(ms={})),i.NameType$$module$build$src$core$names=ms.NameType,ms.DEVELOPER_VARIABLE_TYPE=i.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,i.module$build$src$core$names={},i.module$build$src$core$names.NameType=i.NameType$$module$build$src$core$names,i.module$build$src$core$names.Names=ms;var Cv=class extends Map{constructor(t){super(),this.workspace=t}set(t,o){return this.get(t)===o?this:(super.set(t,o),De(new(Le(od))(this.workspace,o)),sa(o)&&o.startPublishing(),this)}delete(t){const o=this.get(t);return t=super.delete(t),t&&(_o(this.workspace),De(new(Le(Lu))(this.workspace,o)),sa(o)&&o.stopPublishing(),t)}clear(){if(this.size){for(const t of this.keys()){const o=this.get(t);super.delete(t),De(new(Le(Lu))(this.workspace,o))}_o(this.workspace)}}add(t){return this.set(t.getId(),t)}getProcedures(){return[...this.values()]}},sc=class{constructor(t,o,a){this.workspace=t,this.parameters=[],this.returnTypes=null,this.enabled=!0,this.shouldFireEvents=!1,this.id=a??Ns(),this.name=o}setName(t){if(t===this.name)return this;const o=this.name;return this.name=t,_o(this.workspace),this.shouldFireEvents&&De(new(Le(ld))(this.workspace,this,o)),this}insertParameter(t,o){return this.parameters[o]&&this.parameters[o].getId()===t.getId()?this:(this.parameters.splice(o,0,t),t.setProcedureModel(this),sa(t)&&(this.shouldFireEvents?t.startPublishing():t.stopPublishing()),_o(this.workspace),this.shouldFireEvents&&De(new(Le(cd))(this.workspace,this,t,o)),this)}deleteParameter(t){if(!this.parameters[t])return this;const o=this.parameters[t];return this.parameters.splice(t,1),_o(this.workspace),sa(o)&&o.stopPublishing(),this.shouldFireEvents&&De(new(Le(hd))(this.workspace,this,o,t)),this}setReturnTypes(t){if(t&&t.length)throw Error("The built-in ProcedureModel does not support typing. You need to implement your own custom ProcedureModel.");if(!!t==!!this.returnTypes)return this;const o=this.returnTypes;return this.returnTypes=t,_o(this.workspace),this.shouldFireEvents&&De(new(Le(ud))(this.workspace,this,o)),this}setEnabled(t){return t===this.enabled?this:(this.enabled=t,_o(this.workspace),this.shouldFireEvents&&De(new(Le(ad))(this.workspace,this)),this)}getId(){return this.id}getName(){return this.name}getParameter(t){return this.parameters[t]}getParameters(){return[...this.parameters]}getReturnTypes(){return this.returnTypes}getEnabled(){return this.enabled}startPublishing(){this.shouldFireEvents=!0;for(const t of this.parameters)sa(t)&&t.startPublishing()}stopPublishing(){this.shouldFireEvents=!1;for(const t of this.parameters)sa(t)&&t.stopPublishing()}},Oa=class{constructor(t,o,a){this.workspace=t,this.shouldFireEvents=!1,this.procedureModel=null,this.id=a??Ns();let d;this.variable=(d=this.workspace.getVariable(o))!=null?d:t.createVariable(o)}setName(t){if(t===this.variable.name)return this;const o=this.variable.name;let a;return this.variable=(a=this.workspace.getVariable(t))!=null?a:this.workspace.createVariable(t),_o(this.workspace),this.shouldFireEvents&&De(new(Le(dd))(this.workspace,this.procedureModel,this,o)),this}setTypes(t){throw Error("The built-in ParameterModel does not support typing. You need to implement your own custom ParameterModel.")}getName(){return this.variable.name}getTypes(){return[]}getId(){return this.id}getVariableModel(){return this.variable}startPublishing(){this.shouldFireEvents=!0}stopPublishing(){this.shouldFireEvents=!1}setProcedureModel(t){return this.procedureModel=t,this}},Od,dg;Od="PROCEDURE",dg="x",i.module$build$src$core$procedures={},i.module$build$src$core$procedures.CATEGORY_NAME=Od,i.module$build$src$core$procedures.DEFAULT_ARG=dg,i.module$build$src$core$procedures.ObservableParameterModel=Oa,i.module$build$src$core$procedures.ObservableProcedureMap=Cv,i.module$build$src$core$procedures.ObservableProcedureModel=sc,i.module$build$src$core$procedures.allProcedures=Zp,i.module$build$src$core$procedures.findLegalName=qE,i.module$build$src$core$procedures.flyoutCategory=em,i.module$build$src$core$procedures.getCallers=e$,i.module$build$src$core$procedures.getDefinition=x6,i.module$build$src$core$procedures.isNameUsed=JE,i.module$build$src$core$procedures.mutateCallers=N6,i.module$build$src$core$procedures.mutatorOpenListener=ZE,i.module$build$src$core$procedures.rename=w6;var RN=class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(t){return Object.prototype.hasOwnProperty.call(this,t)||(this[t]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[t]}isField(t){return t.type&this.FIELD}isHat(t){return t.type&this.HAT}isIcon(t){return t.type&this.ICON}isSpacer(t){return t.type&this.SPACER}isInRowSpacer(t){return t.type&this.IN_ROW_SPACER}isInput(t){return t.type&this.INPUT}isExternalInput(t){return t.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(t){return t.type&this.INLINE_INPUT}isStatementInput(t){return t.type&this.STATEMENT_INPUT}isPreviousConnection(t){return t.type&this.PREVIOUS_CONNECTION}isNextConnection(t){return t.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(t){return t.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(t){return t.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(t){return t.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(t){return t.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(t){return t.type&this.RIGHT_SQUARE_CORNER}isCorner(t){return t.type&this.CORNER}isJaggedEdge(t){return t.type&this.JAGGED_EDGE}isRow(t){return t.type&this.ROW}isBetweenRowSpacer(t){return t.type&this.BETWEEN_ROW_SPACER}isTopRow(t){return t.type&this.TOP_ROW}isBottomRow(t){return t.type&this.BOTTOM_ROW}isTopOrBottomRow(t){return t.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(t){return t.type&this.INPUT_ROW}},U=new RN,hn=class{constructor(t){this.centerline=this.xPos=this.height=this.width=0,this.constants_=t,this.type=U.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},nc=class{constructor(t){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=t,this.type=U.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let t=this.elements.length-1;0<=t;t--){const o=this.elements[t];if(U.isInput(o))return o}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let t=0;t<this.elements.length;t++){const o=this.elements[t];if(U.isSpacer(o))return o}return null}getLastSpacer(){for(let t=this.elements.length-1;0<=t;t--){const o=this.elements[t];if(U.isSpacer(o))return o}return null}},fg=class extends nc{constructor(t){super(t),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=U.BOTTOM_ROW}hasLeftSquareCorner(t){return!!t.outputConnection||!!t.getNextBlock()}hasRightSquareCorner(t){return!0}measure(){let t=0,o=0,a=0;for(let d=0;d<this.elements.length;d++){const m=this.elements[d];o+=m.width,U.isSpacer(m)||(U.isNextConnection(m)?a=Math.max(a,m.height):t=Math.max(t,m.height))}this.width=Math.max(this.minWidth,o),this.height=Math.max(this.minHeight,t)+a,this.descenderHeight=a,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},vl=class extends hn{constructor(t,o){super(t),this.connectionModel=o,this.shape=this.constants_.shapeFor(o),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.type|=U.CONNECTION}},jn=class extends vl{constructor(t,o){super(t,o.connection),this.input=o,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=U.INPUT,this.align=o.align,(this.connectedBlock=o.connection&&o.connection.targetBlock()?o.connection.targetBlock():null)?(t=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=t.width,this.connectedBlockHeight=t.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},wd=class extends jn{constructor(t,o){super(t,o),this.height=0,this.type|=U.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},yl=class extends hn{constructor(t,o,a){super(t),this.field=o,this.parentInput=a,this.isEditable=o.EDITABLE,this.flipRtl=o.getFlipRtl(),this.type|=U.FIELD,t=this.field.getSize(),this.height=t.height,this.width=t.width}},pg=class extends hn{constructor(t){super(t),this.type|=U.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},Ov=class extends hn{constructor(t,o){super(t),this.icon=o,this.flipRtl=!1,this.isVisible=o.isVisible(),this.type|=U.ICON,t=o.getCorrectedSize(),this.height=t.height,this.width=t.width}},jr=class extends hn{constructor(t,o){super(t),this.type=this.type|U.SPACER|U.IN_ROW_SPACER,this.width=o,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},mg=class extends jn{constructor(t,o){super(t,o),this.type|=U.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},oc=class extends jn{constructor(t,o){super(t,o),this.type|=U.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},gg=class extends nc{constructor(t){super(t),this.connectedBlockWidths=0,this.type|=U.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let t=0;for(let o=0;o<this.elements.length;o++){const a=this.elements[o];this.width+=a.width,U.isInput(a)&&a instanceof jn&&(U.isStatementInput(a)&&a instanceof oc?t+=a.connectedBlockWidth:U.isExternalInput(a)&&a instanceof wd&&a.connectedBlockWidth!==0&&(t+=a.connectedBlockWidth-a.connectionWidth)),U.isSpacer(a)||(this.height=Math.max(this.height,a.height))}this.connectedBlockWidths=t,this.widthWithConnectedBlocks=this.width+t}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},wv=class extends hn{constructor(t){super(t),this.type|=U.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},Rv=class extends vl{constructor(t,o){super(t,o),this.type|=U.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},Nv=class extends vl{constructor(t,o){super(t,o),this.connectionOffsetX=0,this.type|=U.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},xv=class extends vl{constructor(t,o){super(t,o),this.type|=U.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},lc=class extends hn{constructor(t,o){super(t),this.type=(o&&o!=="left"?U.RIGHT_ROUND_CORNER:U.LEFT_ROUND_CORNER)|U.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},_g=class extends nc{constructor(t,o,a){super(t),this.height=o,this.width=a,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type=this.type|U.SPACER|U.BETWEEN_ROW_SPACER,this.elements=[new jr(this.constants_,a)]}measure(){}},ac=class extends hn{constructor(t,o){super(t),this.type=(o&&o!=="left"?U.RIGHT_SQUARE_CORNER:U.LEFT_SQUARE_CORNER)|U.CORNER,this.width=this.height=this.constants_.NO_PADDING}},bg=class extends nc{constructor(t){super(t),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=U.TOP_ROW}hasLeftSquareCorner(t){const o=(t.hat?t.hat==="cap":this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection,a=t.getPreviousBlock();return!!t.outputConnection||o||(a?a.getNextBlock()===t:!1)}hasRightSquareCorner(t){return!0}measure(){let t=0,o=0,a=0;for(let d=0;d<this.elements.length;d++){const m=this.elements[d];o+=m.width,U.isSpacer(m)||(U.isHat(m)&&m instanceof pg?a=Math.max(a,m.ascenderHeight):t=Math.max(t,m.height))}this.width=Math.max(this.minWidth,o),this.height=Math.max(this.minHeight,t)+a,this.capline=this.ascenderHeight=a,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},uc=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs_=null,this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=qt(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(t){this.blockStyles=Object.create(null);const o=t.blockStyles;for(const a in o)this.blockStyles[a]=this.validatedBlockStyle_(o[a]);this.setDynamicProperties_(t)}setDynamicProperties_(t){this.setFontConstants_(t),this.setComponentConstants_(t),this.ADD_START_HATS=t.startHats!==void 0?t.startHats:this.ADD_START_HATS}setFontConstants_(t){t.fontStyle&&t.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=t.fontStyle.family),t.fontStyle&&t.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=t.fontStyle.weight),t.fontStyle&&t.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=t.fontStyle.size),t=ws("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=t.height,this.FIELD_TEXT_BASELINE=t.baseline}setComponentConstants_(t){this.CURSOR_COLOUR=t.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=t.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=t.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(t.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(t){const o="auto_"+t;return this.blockStyles[o]||(this.blockStyles[o]=this.createBlockStyle_(t)),{style:this.blockStyles[o],name:o}}getBlockStyle(t){return this.blockStyles[t||""]||(t&&t.indexOf("auto_")===0?this.getBlockStyleForColour(t.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(t){return this.validatedBlockStyle_({colourPrimary:t})}validatedBlockStyle_(t){const o={};return t&&Object.assign(o,t),t=ia(o.colourPrimary||"#000"),o.colourPrimary=t.hex,o.colourSecondary=o.colourSecondary?ia(o.colourSecondary).hex:this.generateSecondaryColour_(o.colourPrimary),o.colourTertiary=o.colourTertiary?ia(o.colourTertiary).hex:this.generateTertiaryColour_(o.colourPrimary),o.hat=o.hat||"",o}generateSecondaryColour_(t){return ta("#fff",t,.6)||t}generateTertiaryColour_(t){return ta("#fff",t,.3)||t}dispose(){this.embossFilter_&&ft(this.embossFilter_),this.disabledPattern_&&ft(this.disabledPattern_),this.debugFilter_&&ft(this.debugFilter_),this.cssNode_=null}makeJaggedTeeth(){const t=this.JAGGED_TEETH_HEIGHT,o=this.JAGGED_TEETH_WIDTH,a=vu([Me(o,t/4),Me(2*-o,t/2),Me(o,t/4)]);return{height:t,width:o,path:a}}makeStartHat(){const t=this.START_HAT_HEIGHT,o=this.START_HAT_WIDTH,a=Yr("c",[Me(30,-t),Me(70,-t),Me(o,0)]);return{height:t,width:o,path:a}}makePuzzleTab(){function t(b){b=b?-1:1;const I=-b;var L=a/2;const oe=L+2.5,ye=L+.5,yt=Me(-o,b*L);return L=Me(o,b*L),Yr("c",[Me(0,b*oe),Me(-o,I*ye),yt])+Yr("s",[Me(o,2.5*I),L])}const o=this.TAB_WIDTH,a=this.TAB_HEIGHT,d=t(!0),m=t(!1);return{type:this.SHAPES.PUZZLE,width:o,height:a,pathDown:m,pathUp:d}}makeNotch(){function t(I){return vu([Me(I*d,a),Me(3*I,0),Me(I*d,-a)])}const o=this.NOTCH_WIDTH,a=this.NOTCH_HEIGHT,d=(o-3)/2,m=t(1),b=t(-1);return{type:this.SHAPES.NOTCH,width:o,height:a,pathLeft:m,pathRight:b}}makeInsideCorners(){const t=this.CORNER_RADIUS,o=bi("a","0 0,0",t,Me(-t,t)),a=bi("a","0 0,0",t,Me(t,t));return{width:t,height:t,pathTop:o,pathBottom:a}}makeOutsideCorners(){const t=this.CORNER_RADIUS,o=qt(0,t)+bi("a","0 0,1",t,Me(t,-t)),a=bi("a","0 0,1",t,Me(t,t)),d=bi("a","0 0,1",t,Me(-t,-t)),m=bi("a","0 0,1",t,Me(-t,t));return{topLeft:o,topRight:a,bottomRight:m,bottomLeft:d,rightHeight:t}}shapeFor(t){switch(t.type){case Ie.INPUT_VALUE:case Ie.OUTPUT_VALUE:return this.PUZZLE_TAB;case Ie.PREVIOUS_STATEMENT:case Ie.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(t,o,a){this.injectCSS_(o,a),this.defs_=z(G.DEFS,{},t),t=z(G.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs_),z(G.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},t),o=z(G.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},t),z(G.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},o),z(G.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},t),z(G.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},t),this.embossFilterId=t.id,this.embossFilter_=t,t=z(G.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs_),z(G.RECT,{width:10,height:10,fill:"#aaa"},t),z(G.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},t),this.disabledPatternId=t.id,this.disabledPattern_=t,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter_){const t=z(G.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs_),o=z(G.FECOMPONENTTRANSFER,{result:"outBlur"},t);z(G.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},o),z(G.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},t),z(G.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.debugFilterId=t.id,this.debugFilter_=t}}injectCSS_(t,o){o=this.getCSS_(o),t="blockly-renderer-style-"+t,this.cssNode_=document.getElementById(t);const a=o.join(`
`);this.cssNode_?this.cssNode_.firstChild.textContent=a:(o=document.createElement("style"),o.id=t,t=document.createTextNode(a),o.appendChild(t),document.head.insertBefore(o,document.head.firstChild),this.cssNode_=o)}getCSS_(t){return[`${t} .blocklyText, `,`${t} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t} .blocklyText {`,"fill: #fff;","}",`${t} .blocklyNonEditableText>rect,`,`${t} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${t} .blocklyNonEditableText>text,`,`${t} .blocklyEditableText>text {`,"fill: #000;","}",`${t} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${t} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${t} .blocklyEditableText:not(.editing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${t} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${t} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${t} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${t} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${t} .blocklyReplaceable .blocklyPathLight,`,`${t} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${t} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},Dv=!1,Kr=class{constructor(t){this.constants=t,this.debugElements_=[],this.svgRoot_=null,this.randomColour_=""}clearElems(){for(let t=0;t<this.debugElements_.length;t++)ft(this.debugElements_[t]);this.debugElements_=[]}drawSpacerRow(t,o,a){if(Kr.config.rowSpacers){var d=Math.abs(t.height),m=0>t.height;m&&(o-=d),this.debugElements_.push(z(G.RECT,{class:"rowSpacerRect blockRenderDebug",x:a?-(t.xPos+t.width):t.xPos,y:o,width:t.width,height:d,stroke:m?"black":"blue",fill:"blue","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}}drawSpacerElem(t,o,a){if(Kr.config.elemSpacers){o=Math.abs(t.width);var d=0>t.width,m=d?t.xPos-o:t.xPos;a&&(m=-(m+o)),this.debugElements_.push(z(G.RECT,{class:"elemSpacerRect blockRenderDebug",x:m,y:t.centerline-t.height/2,width:o,height:t.height,stroke:"pink",fill:d?"black":"pink","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}}drawRenderedElem(t,o){if(Kr.config.elems){let a=t.xPos;o&&(a=-(a+t.width)),o=t.centerline-t.height/2,this.debugElements_.push(z(G.RECT,{class:"rowRenderingRect blockRenderDebug",x:a,y:o,width:t.width,height:t.height,stroke:"black",fill:"none","stroke-width":"1px"},this.svgRoot_)),U.isField(t)&&t instanceof yl&&t.field instanceof i.FieldLabel$$module$build$src$core$field_label&&this.debugElements_.push(z(G.RECT,{class:"rowRenderingRect blockRenderDebug",x:a,y:o+this.constants.FIELD_TEXT_BASELINE,width:t.width,height:"0.1px",stroke:"red",fill:"none","stroke-width":"0.5px"},this.svgRoot_))}U.isInput(t)&&t instanceof jn&&Kr.config.connections&&this.drawConnection(t.connectionModel)}drawConnection(t){if(Kr.config.connections){var o="",a=0,d="";t.type===Ie.INPUT_VALUE?(a=4,o="magenta",d="none"):t.type===Ie.OUTPUT_VALUE?(a=2,d=o="magenta"):t.type===Ie.NEXT_STATEMENT?(a=4,o="goldenrod",d="none"):t.type===Ie.PREVIOUS_STATEMENT&&(a=2,d=o="goldenrod"),this.debugElements_.push(z(G.CIRCLE,{class:"blockRenderDebug",cx:t.getOffsetInBlock().x,cy:t.getOffsetInBlock().y,r:a,fill:d,stroke:o},this.svgRoot_))}}drawRenderedRow(t,o,a){Kr.config.rows&&(this.debugElements_.push(z(G.RECT,{class:"elemRenderingRect blockRenderDebug",x:a?-(t.xPos+t.width):t.xPos,y:t.yPos,width:t.width,height:t.height,stroke:"red",fill:"none","stroke-width":"1px"},this.svgRoot_)),U.isTopOrBottomRow(t)||Kr.config.connectedBlockBounds&&this.debugElements_.push(z(G.RECT,{class:"connectedBlockWidth blockRenderDebug",x:a?-(t.xPos+t.widthWithConnectedBlocks):t.xPos,y:t.yPos,width:t.widthWithConnectedBlocks,height:t.height,stroke:this.randomColour_,fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))}drawRowWithElements(t,o,a){for(let d=0;d<t.elements.length;d++){const m=t.elements[d];m?U.isSpacer(m)?this.drawSpacerElem(m,t.height,a):this.drawRenderedElem(m,a):console.warn("A row has an undefined or null element.",t,m)}this.drawRenderedRow(t,o,a)}drawBoundingBox(t){if(Kr.config.blockBounds){var o=t.RTL?-t.width:0;this.debugElements_.push(z(G.RECT,{class:"blockBoundingBox blockRenderDebug",x:o,y:0,width:t.width,height:t.height,stroke:"black",fill:"none","stroke-width":"1px","stroke-dasharray":"5,5"},this.svgRoot_)),Kr.config.connectedBlockBounds&&(o=t.RTL?-t.widthWithChildren:0,this.debugElements_.push(z(G.RECT,{class:"blockRenderDebug",x:o,y:0,width:t.widthWithChildren,height:t.height,stroke:"#DF57BC",fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))}}drawDebug(t,o){this.clearElems(),this.svgRoot_=t.getSvgRoot(),this.randomColour_="#"+Math.floor(16777215*Math.random()).toString(16);let a=0;for(let d=0;d<o.rows.length;d++){const m=o.rows[d];U.isBetweenRowSpacer(m)?this.drawSpacerRow(m,a,o.RTL):this.drawRowWithElements(m,a,o.RTL),a+=m.height}t.previousConnection&&this.drawConnection(t.previousConnection),t.nextConnection&&this.drawConnection(t.nextConnection),t.outputConnection&&this.drawConnection(t.outputConnection),o.rightSide&&this.drawRenderedElem(o.rightSide,o.RTL),this.drawBoundingBox(o),this.drawRender(t.pathObject.svgPath)}drawRender(t){Kr.config.render&&(t.setAttribute("filter","url(#"+this.constants.debugFilterId+")"),setTimeout(function(){t.setAttribute("filter","")},100))}};Kr.config={rowSpacers:!0,elemSpacers:!0,rows:!0,elems:!0,connections:!0,blockBounds:!0,connectedBlockBounds:!0,render:!0};var cc=class{constructor(t,o){this.inlinePath_=this.outlinePath_="",this.block_=t,this.info_=o,this.topLeft_=t.getRelativeToSurfaceXY(),this.constants_=o.getRenderer().getConstants()}draw(){if(this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),Xh()){let t;(t=this.block_.renderingDebugger)==null||t.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren}hideHiddenIcons_(){for(let t=0,o;o=this.info_.hiddenIcons[t];t++){let a;(a=o.icon.iconGroup_)==null||a.setAttribute("display","none")}}drawOutline_(){this.drawTop_();for(let t=1;t<this.info_.rows.length-1;t++){const o=this.info_.rows[t];o.hasJaggedEdge?this.drawJaggedEdge_(o):o.hasStatement?this.drawStatementInput_(o):o.hasExternalInput?this.drawValueInput_(o):this.drawRightSideRow_(o)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const t=this.info_.topRow,o=t.elements;this.positionPreviousConnection_(),this.outlinePath_+=qt(t.xPos,this.info_.startY);for(let a=0,d;d=o[a];a++)U.isLeftRoundedCorner(d)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:U.isRightRoundedCorner(d)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:U.isPreviousConnection(d)&&d instanceof vl?this.outlinePath_+=d.shape.pathLeft:U.isHat(d)?this.outlinePath_+=this.constants_.START_HAT.path:U.isSpacer(d)&&(this.outlinePath_+=ke("h",d.width));this.outlinePath_+=ke("v",t.height)}drawJaggedEdge_(t){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+ke("v",t.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(t){const o=t.getLastInput();this.positionExternalValueConnection_(t);const a=t$(o.shape)?o.shape.pathDown(o.height):o.shape.pathDown;this.outlinePath_+=ke("H",o.xPos+o.width)+a+ke("v",t.height-o.connectionHeight)}drawStatementInput_(t){var o=t.getLastInput();if(o){var a=o.xPos+o.notchOffset+o.shape.width;o=o.shape.pathRight+ke("h",-(o.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var d=t.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=ke("H",a)+o+ke("v",d)+this.constants_.INSIDE_CORNERS.pathBottom+ke("H",t.xPos+t.width),this.positionStatementInputConnection_(t)}}drawRightSideRow_(t){this.outlinePath_+=ke("V",t.yPos+t.height)}drawBottom_(){const t=this.info_.bottomRow,o=t.elements;this.positionNextConnection_();let a=0,d="";for(let m=o.length-1,b;b=o[m];m--)U.isNextConnection(b)&&b instanceof vl?d+=b.shape.pathRight:U.isLeftSquareCorner(b)?d+=ke("H",t.xPos):U.isLeftRoundedCorner(b)?d+=this.constants_.OUTSIDE_CORNERS.bottomLeft:U.isRightRoundedCorner(b)?(d+=this.constants_.OUTSIDE_CORNERS.bottomRight,a=this.constants_.OUTSIDE_CORNERS.rightHeight):U.isSpacer(b)&&(d+=ke("h",-1*b.width));this.outlinePath_+=ke("V",t.baseline-a),this.outlinePath_+=d}drawLeft_(){var t=this.info_.outputConnection;if(this.positionOutputConnection_(),t){const o=t.connectionOffsetY+t.height;t=t$(t.shape)?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=ke("V",o)+t}this.outlinePath_+="z"}drawInternals_(){for(let t=0,o;o=this.info_.rows[t];t++)for(let a=0,d;d=o.elements[a];a++)U.isInlineInput(d)?this.drawInlineInput_(d):(U.isIcon(d)||U.isField(d))&&this.layoutField_(d)}layoutField_(t){const o=U.isField(t)?t.field.getSvgRoot():t.icon.iconGroup_,a=t.centerline-t.height/2;let d=t.xPos,m="";this.info_.RTL&&(d=-(d+t.width),t.flipRtl&&(d+=t.width,m="scale(-1 1)")),U.isIcon(t)?(o.setAttribute("display","block"),o.setAttribute("transform","translate("+d+","+a+")"),t.icon.computeIconLocation()):o.setAttribute("transform","translate("+d+","+a+")"+m),this.info_.isInsertionMarker&&o.setAttribute("display","none")}drawInlineInput_(t){const o=t.width,a=t.height,d=t.connectionOffsetY,m=t.connectionHeight+d;this.inlinePath_+=lr(t.xPos+t.connectionWidth,t.centerline-a/2)+ke("v",d)+t.shape.pathDown+ke("v",a-m)+ke("h",o-t.connectionWidth)+ke("v",-a)+"z",this.positionInlineInputConnection_(t)}positionInlineInputConnection_(t){const o=t.centerline-t.height/2;if(t.connectionModel){let a=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(a*=-1),t.connectionModel.setOffsetInBlock(a,o+t.connectionOffsetY)}}positionStatementInputConnection_(t){const o=t.getLastInput();if(o!=null&&o.connectionModel){let a=t.xPos+t.statementEdge+o.notchOffset;this.info_.RTL&&(a*=-1),o.connectionModel.setOffsetInBlock(a,t.yPos)}}positionExternalValueConnection_(t){const o=t.getLastInput();if(o&&o.connectionModel){let a=t.xPos+t.width;this.info_.RTL&&(a*=-1),o.connectionModel.setOffsetInBlock(a,t.yPos)}}positionPreviousConnection_(){const t=this.info_.topRow;if(t.connection){const o=t.xPos+t.notchOffset;t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-o:o,0)}}positionNextConnection_(){const t=this.info_.bottomRow;if(t.connection){const o=t.connection,a=o.xPos;o.connectionModel.setOffsetInBlock(this.info_.RTL?-a:a,t.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const t=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-t:t,this.info_.outputConnection.connectionOffsetY)}}},wa=class{constructor(t,o){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.startY=this.startX=0,this.renderer_=t,this.block_=o,this.constants_=this.renderer_.getConstants(),this.outputConnection=o.outputConnection?new Nv(this.constants_,o.outputConnection):null,this.isInline=o.getInputsInline()&&!o.isCollapsed(),this.isCollapsed=o.isCollapsed(),this.isInsertionMarker=o.isInsertionMarker(),this.RTL=o.RTL,this.topRow=new bg(this.constants_),this.bottomRow=new fg(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let t=new gg(this.constants_);this.inputRows.push(t);var o=this.block_.getIcons();for(let a=0,d;d=o[a];a++){const m=new Ov(this.constants_,d);this.isCollapsed&&d.collapseHidden?this.hiddenIcons.push(m):t.elements.push(m)}o=void 0;for(let a=0,d;d=this.block_.inputList[a];a++)if(d.isVisible()){this.shouldStartNewRow_(d,o)&&(this.rows.push(t),t=new gg(this.constants_),this.inputRows.push(t));for(let m=0,b;b=d.fieldRow[m];m++)t.elements.push(new yl(this.constants_,b,d));this.addInput_(d,t),o=d}this.isCollapsed&&(t.hasJaggedEdge=!0,t.elements.push(new wv(this.constants_))),(t.elements.length||t.hasDummyInput)&&this.rows.push(t),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var t=!!this.block_.previousConnection;const o=(this.block_.hat?this.block_.hat==="cap":this.constants_.ADD_START_HATS)&&!this.outputConnection&&!t;let a=this.topRow.hasLeftSquareCorner(this.block_)?ac:lc;this.topRow.elements.push(new a(this.constants_)),o?(t=new pg(this.constants_),this.topRow.elements.push(t),this.topRow.capline=t.ascenderHeight):t&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new xv(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0].type===it.STATEMENT&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,a=this.topRow.hasRightSquareCorner(this.block_)?ac:lc,this.topRow.elements.push(new a(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===it.STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new ac(this.constants_)):this.bottomRow.elements.push(new lc(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new Rv(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new ac(this.constants_,"right")):this.bottomRow.elements.push(new lc(this.constants_,"right"))}addInput_(t,o){this.isInline&&t.type===it.VALUE?(o.elements.push(new mg(this.constants_,t)),o.hasInlineInput=!0):t.type===it.STATEMENT?(o.elements.push(new oc(this.constants_,t)),o.hasStatement=!0):t.type===it.VALUE?(o.elements.push(new wd(this.constants_,t)),o.hasExternalInput=!0):t.type===it.DUMMY&&(o.minHeight=Math.max(o.minHeight,t.getSourceBlock()&&t.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),o.hasDummyInput=!0),o.align===null&&(o.align=t.align)}shouldStartNewRow_(t,o){return o?t.type===it.STATEMENT||o.type===it.STATEMENT?!0:t.type===it.VALUE||t.type===it.DUMMY?!this.isInline:!1:!1}addElemSpacing_(){for(let t=0,o;o=this.rows[t];t++){const a=o.elements;if(o.elements=[],o.startsWithElemSpacer()&&o.elements.push(new jr(this.constants_,this.getInRowSpacing_(null,a[0]))),a.length){for(let d=0;d<a.length-1;d++){o.elements.push(a[d]);const m=this.getInRowSpacing_(a[d],a[d+1]);o.elements.push(new jr(this.constants_,m))}o.elements.push(a[a.length-1]),o.endsWithElemSpacer()&&o.elements.push(new jr(this.constants_,this.getInRowSpacing_(a[a.length-1],null)))}}}getInRowSpacing_(t,o){if(!t&&o&&U.isStatementInput(o))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(t&&U.isInput(t)&&!o){if(U.isExternalInput(t))return this.constants_.NO_PADDING;if(U.isInlineInput(t))return this.constants_.LARGE_PADDING;if(U.isStatementInput(t))return this.constants_.NO_PADDING}return t&&U.isLeftSquareCorner(t)&&o&&(U.isPreviousConnection(o)||U.isNextConnection(o))?o.notchOffset:t&&U.isLeftRoundedCorner(t)&&o&&(U.isPreviousConnection(o)||U.isNextConnection(o))?o.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let t=0,o=0,a=0;for(let m=0,b;b=this.rows[m];m++){if(b.measure(),o=Math.max(o,b.width),b.hasStatement){var d=b.getLastInput();let I,L;d=b.width-((L=(I=d)==null?void 0:I.width)!=null?L:0),t=Math.max(t,d)}a=Math.max(a,b.widthWithConnectedBlocks)}this.statementEdge=t,this.width=o;for(let m=0,b;b=this.rows[m];m++)b.hasStatement&&(b.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(o,a),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let o=0,a;a=this.rows[o];o++)if(a.hasStatement)this.alignStatementRow_(a);else{var t=a.width;t=this.getDesiredRowWidth_(a)-t,0<t&&this.addAlignmentPadding_(a,t),U.isTopOrBottomRow(a)&&(a.widthWithConnectedBlocks=a.width)}}getDesiredRowWidth_(t){return this.width-this.startX}addAlignmentPadding_(t,o){const a=t.getFirstSpacer(),d=t.getLastSpacer();if((t.hasExternalInput||t.hasStatement)&&(t.widthWithConnectedBlocks+=o),t.align===i.Align$$module$build$src$core$input.LEFT&&d)d.width+=o;else if(t.align===i.Align$$module$build$src$core$input.CENTRE&&a&&d)a.width+=o/2,d.width+=o/2;else if(t.align===i.Align$$module$build$src$core$input.RIGHT&&a)a.width+=o;else if(d)d.width+=o;else return;t.width+=o}alignStatementRow_(t){const o=t.getLastInput();if(o){var a=t.width-o.width,d=this.statementEdge;a=d-a,0<a&&this.addAlignmentPadding_(t,a),a=t.width,d=this.getDesiredRowWidth_(t),o.width+=d-a,o.height=Math.max(o.height,t.height),t.width+=d-a,t.widthWithConnectedBlocks=Math.max(t.width,this.statementEdge+t.connectedBlockWidths)}}addRowSpacing_(){const t=this.rows;this.rows=[];for(let o=0;o<t.length;o++)this.rows.push(t[o]),o!==t.length-1&&this.rows.push(this.makeSpacerRow_(t[o],t[o+1]))}makeSpacerRow_(t,o){var a=this.getSpacerRowHeight_(t,o);const d=this.getSpacerRowWidth_(t,o);return a=new _g(this.constants_,a,d),t.hasStatement&&(a.followsStatement=!0),o.hasStatement&&(a.precedesStatement=!0),a}getSpacerRowWidth_(t,o){return this.width-this.startX}getSpacerRowHeight_(t,o){return this.constants_.MEDIUM_PADDING}getElemCenterline_(t,o){return U.isSpacer(o)?t.yPos+o.height/2:U.isBottomRow(t)?(t=t.yPos+t.height-t.descenderHeight,U.isNextConnection(o)?t+o.height/2:t-o.height/2):U.isTopRow(t)?U.isHat(o)?t.capline-o.height/2:t.capline+o.height/2:t.yPos+t.height/2}recordElemPositions_(t){let o=t.xPos;for(let a=0,d;d=t.elements[a];a++)U.isSpacer(d)&&(d.height=t.height),d.xPos=o,d.centerline=this.getElemCenterline_(t,d),o+=d.width}finalize_(){let t=0,o=0;for(let a=0,d;d=this.rows[a];a++)d.yPos=o,d.xPos=this.startX,o+=d.height,t=Math.max(t,d.widthWithConnectedBlocks),this.recordElemPositions_(d);if(this.outputConnection&&this.block_.nextConnection){const a=this.block_.nextConnection.targetBlock();a&&(t=Math.max(t,a.getHeightWidth().width))}this.widthWithChildren=t+this.startX,this.height=o,this.startY=this.topRow.capline,this.bottomRow.baseline=o-this.bottomRow.descenderHeight}},Tg=class extends Fs{constructor(t,o,a,d){let m=t?t.workspace.id:void 0;d&&d.getType()===le.types.WORKSPACE&&(m=d.getLocation().id),super(m),this.type=wu,this.blockId=t==null?void 0:t.id,this.oldNode=a||void 0,this.newNode=d,this.isCursor=o}toJson(){const t=super.toJson();if(this.isCursor===void 0)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return t.isCursor=this.isCursor,t.blockId=this.blockId,t.oldNode=this.oldNode,t.newNode=this.newNode,t}fromJson(t){s("Blockly.Events.MarkerMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.isCursor=t.isCursor,this.blockId=t.blockId,this.oldNode=t.oldNode,this.newNode=t.newNode}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new Tg),o.isCursor=t.isCursor,o.blockId=t.blockId,o.oldNode=t.oldNode,o.newNode=t.newNode,o}};tt(fe.EVENT,wu,Tg);var NN="blocklyCursor",xN="blocklyMarker",DN=.75,Eg=class{constructor(t,o,a){this.workspace=t,this.marker=a,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent_=null,this.constants_=o,t=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=a.colour||t}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return this.marker.type==="cursor"}createDom(){const t=this.isCursor()?NN:xN;return this.svgGroup_=z(G.G,{class:t}),this.createDomInternal_(),this.svgGroup_}setParent_(t){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),t.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),t.setMarkerSvg(this.getSvgRoot())),this.parent_=t}draw(t,o){if(o){this.constants_=this.workspace.getRenderer().getConstants();var a=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||a,this.applyColour_(o),this.showAtLocation_(o),this.fireMarkerEvent_(t,o),t=this.currentMarkerSvg.childNodes[0],t!==void 0&&t.beginElement&&t.beginElement()}else this.hide()}showAtLocation_(t){const o=t.getLocation().type;t.getType()===le.types.BLOCK?this.showWithBlock_(t):t.getType()===le.types.OUTPUT?this.showWithOutput_(t):o===Ie.INPUT_VALUE?this.showWithInput_(t):o===Ie.NEXT_STATEMENT?this.showWithNext_(t):t.getType()===le.types.PREVIOUS?this.showWithPrevious_(t):t.getType()===le.types.FIELD?this.showWithField_(t):t.getType()===le.types.WORKSPACE?this.showWithCoordinates_(t):t.getType()===le.types.STACK&&this.showWithStack_(t)}showWithBlockPrevOutput_(t){t=t.getSourceBlock();const o=t.width;var a=t.height,d=a*DN;const m=this.constants_.CURSOR_BLOCK_PADDING;t.previousConnection?(a=this.constants_.shapeFor(t.previousConnection),this.positionPrevious_(o,m,d,a)):t.outputConnection?(d=this.constants_.shapeFor(t.outputConnection),this.positionOutput_(o,a,d)):this.positionBlock_(o,m,d),this.setParent_(t),this.showCurrent_()}showWithBlock_(t){this.showWithBlockPrevOutput_(t)}showWithPrevious_(t){this.showWithBlockPrevOutput_(t)}showWithOutput_(t){this.showWithBlockPrevOutput_(t)}showWithCoordinates_(t){var o=t.getWsCoordinate();t=o.x,o=o.y,this.workspace.RTL&&(t-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(t,o,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(t){t=t.getLocation();const o=t.getSize().width,a=t.getSize().height;this.positionRect_(0,0,o,a),this.setParent_(t),this.showCurrent_()}showWithInput_(t){t=t.getLocation();const o=t.getSourceBlock();this.positionInput_(t),this.setParent_(o),this.showCurrent_()}showWithNext_(t){var o=t.getLocation();t=o.getSourceBlock();let a=0;o=o.getOffsetInBlock().y;const d=t.getHeightWidth().width;this.workspace.RTL&&(a=-d),this.positionLine_(a,o,d),this.setParent_(t),this.showCurrent_()}showWithStack_(t){t=t.getLocation();var o=t.getHeightWidth();const a=o.width+this.constants_.CURSOR_STACK_PADDING;o=o.height+this.constants_.CURSOR_STACK_PADDING;const d=-this.constants_.CURSOR_STACK_PADDING/2,m=-this.constants_.CURSOR_STACK_PADDING/2;let b=d;this.workspace.RTL&&(b=-(a+d)),this.positionRect_(b,m,a,o),this.setParent_(t),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(t,o,a){if(t=qt(-o,a)+ke("V",-o)+ke("H",t+2*o)+ke("V",a),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(t){const o=t.getOffsetInBlock().x,a=t.getOffsetInBlock().y;t=lr(0,0)+this.constants_.shapeFor(t).pathDown,this.markerInput_.setAttribute("d",t),this.markerInput_.setAttribute("transform","translate("+o+","+a+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(t,o,a){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x",`${t}`),this.markerSvgLine_.setAttribute("y",`${o}`),this.markerSvgLine_.setAttribute("width",`${a}`),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(t,o,a){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");t=qt(t,0)+ke("h",-(t-a.width))+ke("v",this.constants_.TAB_OFFSET_FROM_TOP)+a.pathDown+ke("V",o)+ke("H",t),this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(t,o,a,d){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");t=qt(-o,a)+ke("V",-o)+ke("H",this.constants_.NOTCH_OFFSET_LEFT)+d.pathLeft+ke("H",t+2*o)+ke("V",a),this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(t,o,a,d){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x",`${t}`),this.markerSvgRect_.setAttribute("y",`${o}`),this.markerSvgRect_.setAttribute("width",`${a}`),this.markerSvgRect_.setAttribute("height",`${d}`),this.currentMarkerSvg=this.markerSvgRect_}flipRtl_(t){t.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent_(t,o){const a=o.getSourceBlock();t=new(Le(wu))(a,this.isCursor(),t,o),De(t)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=z(G.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=z(G.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=z(G.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=z(G.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=z(G.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){const t=this.getBlinkProperties_();z(G.ANIMATE,t,this.markerSvgLine_),z(G.ANIMATE,t,this.markerInput_),z(G.ANIMATE,Object.assign({},t,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(t){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(t=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",t),this.markerInput_.firstElementChild.setAttribute("values",t),this.markerBlock_.firstElementChild.setAttribute("values",t))}dispose(){this.svgGroup_&&ft(this.svgGroup_)}},Rd=class{constructor(t,o,a){this.markerSvg=this.cursorSvg=null,this.constants=a,this.style=o,this.svgRoot=t,this.svgPath=z(G.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(t){this.svgPath.setAttribute("d",t)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(t){t?(this.svgRoot.appendChild(t),this.cursorSvg=t):this.cursorSvg=null}setMarkerSvg(t){t?(this.cursorSvg?this.svgRoot.insertBefore(t,this.cursorSvg):this.svgRoot.appendChild(t),this.markerSvg=t):this.markerSvg=null}applyColour(t){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(t.isShadow()),this.updateDisabled_(!t.isEnabled()||t.getInheritedDisabled())}setStyle(t){this.style=t}setClass_(t,o){t&&(o?Ce(this.svgRoot,t):qe(this.svgRoot,t))}updateHighlighted(t){t?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(t){t&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(t){this.setClass_("blocklyDisabled",t),t&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(t){this.setClass_("blocklySelected",t)}updateDraggingDelete(t){this.setClass_("blocklyDraggingDelete",t)}updateInsertionMarker(t){this.setClass_("blocklyInsertionMarker",t)}updateMovable(t){this.setClass_("blocklyDraggable",t)}updateReplacementFade(t){this.setClass_("blocklyReplaceable",t)}updateShapeForInputHighlight(t,o){}},Lv="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",qr=class{constructor(t){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=!1,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,Xe(t),this.topBlock=t,this.workspace=t.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections()}dispose(){this.availableConnections.length=0,Ci();try{this.firstMarker&&this.firstMarker.dispose(),this.lastMarker&&this.lastMarker.dispose()}finally{Oi()}}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){Ci(),this.hidePreview(),Oi();var{local:t,closest:o}=this.activeCandidate;if(t.connect(o),this.topBlock.rendered){const a=t.isSuperior()?o:t;NE(a.getSourceBlock()),this.topBlock.getRootBlock().bringToFront()}}}update(t,o){const a=this.getCandidate(t);((this.wouldDeleteBlock=this.shouldDelete(!!a,o))||this.shouldUpdatePreviews(a,t))&&(Ci(),this.maybeHidePreview(a),this.maybeShowPreview(a),Oi())}createMarkerBlock(t){var o=t.type;Ci();let a;try{if(a=this.workspace.newBlock(o),a.setInsertionMarker(!0),t.saveExtraState){var d=t.saveExtraState();d&&a.loadExtraState&&a.loadExtraState(d)}else if(t.mutationToDom){const m=t.mutationToDom();m&&a.domToMutation&&a.domToMutation(m)}for(o=0;o<t.inputList.length;o++){const m=t.inputList[o];if(m.name===Ku)continue;const b=a.inputList[o];if(!b)throw Error(Lv.replace("%1","an input"));for(d=0;d<m.fieldRow.length;d++){const I=m.fieldRow[d],L=b.fieldRow[d];if(!L)throw Error(Lv.replace("%1","a field"));L.setValue(I.getValue())}}a.setCollapsed(t.isCollapsed()),a.setInputsInline(t.getInputsInline()),a.initSvg(),a.getSvgRoot().setAttribute("visibility","hidden")}finally{Oi()}return a}initAvailableConnections(){const t=this.topBlock.getConnections_(!1),o=this.topBlock.lastConnectionInStack(!0);if(o&&o!==this.topBlock.nextConnection){if(t.push(o),this.lastOnStack=o,this.lastMarker){Ci();try{this.lastMarker.dispose()}finally{Oi()}}this.lastMarker=this.createMarkerBlock(o.getSourceBlock())}return t}shouldUpdatePreviews(t,o){if(!t)return!!this.activeCandidate;if(!this.activeCandidate)return!0;const{local:a,closest:d}=this.activeCandidate;if(d===t.closest&&a===t.local)return!1;const m=a.x+o.x-d.x;return o=a.y+o.y-d.y,t.radius<Math.sqrt(m*m+o*o)-i.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(t){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let o=this.getStartRadius(),a=null;for(let d=0;d<this.availableConnections.length;d++){const m=this.availableConnections[d],b=m.closest(o,t);b.connection&&(a={closest:b.connection,local:m,radius:b.radius},o=b.radius)}return a}getStartRadius(){return this.activeCandidate?i.config$$module$build$src$core$config.connectingSnapRadius:i.config$$module$build$src$core$config.snapRadius}shouldDelete(t,o){return o&&this.workspace.getComponentManager().hasCapability(o.id,ji.Capability.DELETE_AREA)?o.wouldDelete(this.topBlock,t):!1}maybeShowPreview(t){if(!this.wouldDeleteBlock&&t){var o=t.closest,a;o===((a=this.activeCandidate)==null?void 0:a.closest)||o.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=t,this.showPreview(this.activeCandidate))}}showPreview(t){const o=this.workspace.getRenderer();switch(o.getConnectionPreviewMethod(t.closest,t.local,this.topBlock)){case qr.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(t);break;case qr.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(t);break;case qr.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(t)}o.shouldHighlightConnection(t.closest)&&t.closest.highlight()}maybeHidePreview(t){if(!t)this.hidePreview();else if(this.activeCandidate){const o=this.activeCandidate.local!==t.local;(this.activeCandidate.closest!==t.closest||o||this.wouldDeleteBlock)&&this.hidePreview()}this.activeCandidate=this.markerConnection=null}hidePreview(){let t;const o=(t=this.activeCandidate)==null?void 0:t.closest;o&&o.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(o)&&o.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(t){const{local:o,closest:a}=t;let d=(t=this.lastOnStack&&o===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!d)throw Error("Cannot show the insertion marker because there is no insertion marker block");let m;try{m=d.getMatchingConnection(o.getSourceBlock(),o)}catch{if(this.firstMarker=this.createMarkerBlock(this.topBlock),d=t?this.lastMarker:this.firstMarker,!d)throw Error("Cannot show the insertion marker because there is no insertion marker block");m=d.getMatchingConnection(o.getSourceBlock(),o)}if(!m)throw Error("Cannot show the insertion marker because there is no associated connection");if(m===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");d.render(),d.rendered=!0,d.getSvgRoot().setAttribute("visibility","visible"),m&&a&&d.positionNearConnection(m,a),a&&m.connect(a),this.markerConnection=m}hideInsertionMarker(){if(this.markerConnection){var t=this.markerConnection,o=t.getSourceBlock(),a=o.previousConnection,d=o.outputConnection,m=t===o.nextConnection;if(d=t.type===Ie.INPUT_VALUE&&!(d&&d.targetConnection),m&&(!a||!a.targetConnection)||d?t.targetBlock().unplug(!1):t.type!==Ie.NEXT_STATEMENT||m?o.unplug(!0):((m=t.targetConnection)&&m.getSourceBlock().unplug(!1),a=a?a.targetConnection:null,o.unplug(!0),a&&m&&a.connect(m)),t.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(t=o.getSvgRoot())&&t.setAttribute("visibility","hidden")}}showInsertionInputOutline(t){t=t.closest,this.highlightedBlock=t.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(t,!0)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,!1),this.highlightedBlock=null}}showReplacementFade(t){if(this.fadedBlock=t.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(!0)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null)}getInsertionMarkers(){const t=[];return this.firstMarker&&t.push(this.firstMarker),this.lastMarker&&t.push(this.lastMarker),t}};(function(t){t=t.PREVIEW_TYPE||(t.PREVIEW_TYPE={}),t[t.INSERTION_MARKER=0]="INSERTION_MARKER",t[t.INPUT_OUTLINE=1]="INPUT_OUTLINE",t[t.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"})(qr||(qr={})),qr.PREVIEW_TYPE;var hc=class{constructor(t){this.overrides=null,this.name=t}getClassName(){return this.name+"-renderer"}init(t,o){this.constants_=this.makeConstants_(),o&&(this.overrides=o,Object.assign(this.constants_,o)),this.constants_.setTheme(t),this.constants_.init()}createDom(t,o){this.constants_.createDom(t,this.name+"-"+o.name,"."+this.getClassName()+"."+o.getClassName())}refreshDom(t,o){const a=this.getConstants();a.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=a.randomIdentifier,this.constants_.setTheme(o),this.constants_.init(),this.createDom(t,o)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new uc}makeRenderInfo_(t){return new wa(this,t)}makeDrawer_(t,o){return new cc(t,o)}makeDebugger_(){return new Kr(this.getConstants())}makeMarkerDrawer(t,o){return new Eg(t,this.getConstants(),o)}makePathObject(t,o){return new Rd(t,o,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(t){return!0}orphanCanConnectAtEnd(t,o,a){return!!Ot.getConnectionForOrphanedConnection(t,a===Ie.OUTPUT_VALUE?o.outputConnection:o.previousConnection)}getConnectionPreviewMethod(t,o,a){return o.type===Ie.OUTPUT_VALUE||o.type===Ie.PREVIOUS_STATEMENT?!t.isConnected()||this.orphanCanConnectAtEnd(a,t.targetBlock(),o.type)?qr.PREVIEW_TYPE.INSERTION_MARKER:qr.PREVIEW_TYPE.REPLACEMENT_FADE:qr.PREVIEW_TYPE.INSERTION_MARKER}render(t){Xh()&&!t.renderingDebugger&&(t.renderingDebugger=this.makeDebugger_());const o=this.makeRenderInfo_(t);o.measure(),this.makeDrawer_(t,o).draw()}},Rt={};Rt.BottomRow=fg,Rt.Connection=vl,Rt.ConstantProvider=uc,Rt.Debug=Kr,Rt.Drawer=cc,Rt.ExternalValueInput=wd,Rt.Field=yl,Rt.Hat=pg,Rt.Icon=Ov,Rt.InRowSpacer=jr,Rt.InlineInput=mg,Rt.InputConnection=jn,Rt.InputRow=gg,Rt.JaggedEdge=wv,Rt.MarkerSvg=Eg,Rt.Measurable=hn,Rt.NextConnection=Rv,Rt.OutputConnection=Nv,Rt.PathObject=Rd,Rt.PreviousConnection=xv,Rt.RenderInfo=wa,Rt.Renderer=hc,Rt.RoundCorner=lc,Rt.Row=nc,Rt.SpacerRow=_g,Rt.SquareCorner=ac,Rt.StatementInput=oc,Rt.TopRow=bg,Rt.Types=U,Rt.init=i$,Rt.register=Iu,Rt.stopDebugger=M6,Rt.unregister=L6;var Mv=class{constructor(t,o){this.workspace=t,this.theme=o,this.subscribedWorkspaces_=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(t){var o=this.theme;this.theme=t,(t=this.workspace.getInjectionDiv())&&(o&&(o=o.getClassName())&&qe(t,o),(o=this.theme.getClassName())&&Ce(t,o));for(let a=0,d;d=this.subscribedWorkspaces_[a];a++)d.refreshTheme();for(const[a,d]of this.componentDB)for(const m of d){t=m.element,o=m.propertyName;const b=this.theme&&this.theme.getComponentStyle(a);t.style[o]=b||""}for(const a of this.subscribedWorkspaces_)a.hideChaff()}subscribeWorkspace(t){this.subscribedWorkspaces_.push(t)}unsubscribeWorkspace(t){if(!kr(this.subscribedWorkspaces_,t))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(t,o,a){this.componentDB.has(o)||this.componentDB.set(o,[]),this.componentDB.get(o).push({element:t,propertyName:a}),o=this.theme&&this.theme.getComponentStyle(o),t.style[a]=o||""}unsubscribe(t){if(t)for(const[o,a]of this.componentDB){for(let d=a.length-1;0<=d;d--)a[d].element===t&&a.splice(d,1);a.length||this.componentDB.delete(o)}}dispose(){this.subscribedWorkspaces_=this.theme=this.owner_=null,this.componentDB.clear()}},$g="VARIABLE_DYNAMIC",Io={};Io.CATEGORY_NAME=$g,Io.flyoutCategory=tm,Io.flyoutCategoryBlocks=o$,Io.onCreateVariableButtonClick_Colour=n$,Io.onCreateVariableButtonClick_Number=s$,Io.onCreateVariableButtonClick_String=r$;var Bv=class{canConnect(t,o,a,d){return this.canConnectWithReason(t,o,a,d)===Ot.CAN_CONNECT}canConnectWithReason(t,o,a,d){const m=this.doSafetyChecks(t,o);return m!==Ot.CAN_CONNECT?m:this.doTypeChecks(t,o)?a&&!this.doDragChecks(t,o,d||0)?Ot.REASON_DRAG_CHECKS_FAILED:Ot.CAN_CONNECT:Ot.REASON_CHECKS_FAILED}getErrorMessage(t,o,a){switch(t){case Ot.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case Ot.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case Ot.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case Ot.REASON_TARGET_NULL:return"Target connection is null.";case Ot.REASON_CHECKS_FAILED:return"Connection checks failed. "+(o+" expected "+o.getCheck()+", found "+a.getCheck());case Ot.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case Ot.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case Ot.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(t,o){if(!t||!o)return Ot.REASON_TARGET_NULL;let a,d,m;return t.isSuperior()?(a=t.getSourceBlock(),d=o.getSourceBlock(),m=o):(d=t.getSourceBlock(),a=o.getSourceBlock(),m=t,t=o),a===d?Ot.REASON_SELF_CONNECTION:m.type!==El[t.type]?Ot.REASON_WRONG_TYPE:a.workspace!==d.workspace?Ot.REASON_DIFFERENT_WORKSPACES:a.isShadow()&&!d.isShadow()?Ot.REASON_SHADOW_PARENT:m.type===Ie.OUTPUT_VALUE&&d.previousConnection&&d.previousConnection.isConnected()||m.type===Ie.PREVIOUS_STATEMENT&&d.outputConnection&&d.outputConnection.isConnected()?Ot.REASON_PREVIOUS_AND_OUTPUT:Ot.CAN_CONNECT}doTypeChecks(t,o){if(t=t.getCheck(),o=o.getCheck(),!t||!o)return!0;for(let a=0;a<t.length;a++)if(o.indexOf(t[a])!==-1)return!0;return!1}doDragChecks(t,o,a){if(t.distanceFrom(o)>a||o.getSourceBlock().isInsertionMarker())return!1;switch(o.type){case Ie.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t,o);case Ie.OUTPUT_VALUE:if(o.isConnected()&&!o.targetBlock().isInsertionMarker()||t.isConnected())return!1;break;case Ie.INPUT_VALUE:if(o.isConnected()&&!o.targetBlock().isMovable()&&!o.targetBlock().isShadow())return!1;break;case Ie.NEXT_STATEMENT:if(o.isConnected()&&!t.getSourceBlock().nextConnection&&!o.targetBlock().isShadow()&&o.targetBlock().nextConnection)return!1;break;default:return!1}return cl.indexOf(o)===-1}canConnectToPrevious_(t,o){return t.targetConnection||cl.indexOf(o)!==-1?!1:o.targetConnection?(t=o.targetBlock(),t.isInsertionMarker()?!t.getPreviousBlock():!1):!0}};tt(fe.CONNECTION_CHECKER,Hn,Bv);var vg=class extends Mu{constructor(t){super(t),this.type=ha,t&&(this.varType=t.type,this.varName=t.name)}toJson(){const t=super.toJson();if(!this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return t.varType=this.varType,t.varName=this.varName,t}fromJson(t){s("Blockly.Events.VarDelete.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.varType=t.varType,this.varName=t.varName}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new vg),o.varType=t.varType,o.varName=t.varName,o}run(t){const o=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t?o.deleteVariableById(this.varId):o.createVariable(this.varName,this.varType,this.varId)}};tt(fe.EVENT,ha,vg);var yg=class extends Mu{constructor(t,o){super(t),this.type=Cu,t&&(this.oldName=t.name,this.newName=typeof o>"u"?"":o)}toJson(){const t=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return t.oldName=this.oldName,t.newName=this.newName,t}fromJson(t){s("Blockly.Events.VarRename.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.oldName=t.oldName,this.newName=t.newName}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new yg),o.oldName=t.oldName,o.newName=t.newName,o}run(t){const o=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");t?o.renameVariableById(this.varId,this.newName):o.renameVariableById(this.varId,this.oldName)}};tt(fe.EVENT,Cu,yg);var Sg=class{constructor(t){this.workspace=t,this.variableMap=new Map}clear(){this.variableMap.clear()}renameVariable(t,o){if(t.name!==o){var a=this.getVariable(o,t.type),d=this.workspace.getAllBlocks(!1);He(!0);try{a&&a.getId()!==t.getId()?this.renameVariableWithConflict_(t,o,a,d):this.renameVariableAndUses_(t,o,d)}finally{He(!1)}}}renameVariableById(t,o){const a=this.getVariableById(t);if(!a)throw Error("Tried to rename a variable that didn't exist. ID: "+t);this.renameVariable(a,o)}renameVariableAndUses_(t,o,a){for(De(new(Le(Cu))(t,o)),t.name=o,o=0;o<a.length;o++)a[o].updateVarName(t)}renameVariableWithConflict_(t,o,a,d){const m=t.type;for(o!==a.name&&this.renameVariableAndUses_(a,o,d),o=0;o<d.length;o++)d[o].renameVarById(t.getId(),a.getId());De(new(Le(ha))(t)),kr(this.variableMap.get(m),t)}createVariable(t,o,a){var d=this.getVariable(t,o);if(d){if(a&&d.getId()!==a)throw Error('Variable "'+t+'" is already in use and its id is "'+d.getId()+'" which conflicts with the passed in id, "'+a+'".');return d}if(a&&this.getVariableById(a))throw Error('Variable id, "'+a+'", is already in use.');return d=a||Ns(),o=o||"",d=new Bu(this.workspace,t,o,d),t=this.variableMap.get(o)||[],t.push(d),this.variableMap.delete(o),this.variableMap.set(o,t),De(new(Le(fl))(d)),d}deleteVariable(t){const o=t.getId(),a=this.variableMap.get(t.type);if(a){for(let d=0;d<a.length;d++)if(a[d].getId()===o){a.splice(d,1),De(new(Le(ha))(t));break}}}deleteVariableById(t){const o=this.getVariableById(t);if(o){var a=o.name;const d=this.getVariableUsesById(t);for(let m=0,b;b=d[m];m++)if(b.type==="procedures_defnoreturn"||b.type==="procedures_defreturn"){t=String(b.getFieldValue("NAME")),a=Ve.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",a).replace("%2",t),Oh(a);return}1<d.length?(a=Ve.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(d.length)).replace("%2",a),vp(a,m=>{m&&o&&this.deleteVariableInternal(o,d)})):this.deleteVariableInternal(o,d)}else console.warn("Can't delete non-existent variable: "+t)}deleteVariableInternal(t,o){const a=Kt();a||He(!0);try{for(let d=0;d<o.length;d++)o[d].dispose(!0);this.deleteVariable(t)}finally{a||He(!1)}}getVariable(t,o){if(o=this.variableMap.get(o||"")){for(let a=0,d;d=o[a];a++)if(ms.equals(d.name,t))return d}return null}getVariableById(t){for(const[,o]of this.variableMap)for(const a of o)if(a.getId()===t)return a;return null}getVariablesOfType(t){return(t=this.variableMap.get(t||""))?t.slice():[]}getVariableTypes(t){const o=new Set(this.variableMap.keys());if(t&&t.getPotentialVariableMap())for(const a of t.getPotentialVariableMap().variableMap.keys())o.add(a);return o.has("")||o.add(""),Array.from(o.values())}getAllVariables(){let t=[];for(const o of this.variableMap.values())t=t.concat(o);return t}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map(t=>t.name)}getVariableUsesById(t){const o=[],a=this.workspace.getAllBlocks(!1);for(let d=0;d<a.length;d++){const m=a[d].getVarModels();if(m)for(let b=0;b<m.length;b++)m[b].getId()===t&&o.push(a[d])}return o}},Kn=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(t){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new Cv(this),this.potentialVariableMap=null,this.id=Ns(),P(this),this.options=t||new Vs({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(cs(fe.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new Sg(this)}dispose(){this.listeners.length=0,this.clear(),Q(this)}sortObjects_(t,o){return t=t.getRelativeToSurfaceXY(),o=o.getRelativeToSurfaceXY(),t.y+Kn.prototype.sortObjects_.offset*t.x-(o.y+Kn.prototype.sortObjects_.offset*o.x)}addTopBlock(t){this.topBlocks.push(t)}removeTopBlock(t){if(!kr(this.topBlocks,t))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(t){const o=[].concat(this.topBlocks);return t&&1<o.length&&(this.sortObjects_.offset=Math.sin(Bi(Kn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),o.sort(this.sortObjects_)),o}addTypedBlock(t){this.typedBlocksDB.has(t.type)||this.typedBlocksDB.set(t.type,[]),this.typedBlocksDB.get(t.type).push(t)}removeTypedBlock(t){kr(this.typedBlocksDB.get(t.type),t),this.typedBlocksDB.get(t.type).length||this.typedBlocksDB.delete(t.type)}getBlocksByType(t,o){return this.typedBlocksDB.has(t)?(t=this.typedBlocksDB.get(t).slice(0),o&&t&&1<t.length&&(this.sortObjects_.offset=Math.sin(Bi(Kn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t.filter(function(a){return!a.isInsertionMarker()})):[]}addTopComment(t){this.topComments.push(t),this.commentDB.has(t.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+t.id+'"'),this.commentDB.set(t.id,t)}removeTopComment(t){if(!kr(this.topComments,t))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(t.id)}getTopComments(t){const o=[].concat(this.topComments);return t&&1<o.length&&(this.sortObjects_.offset=Math.sin(Bi(Kn.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),o.sort(this.sortObjects_)),o}getAllBlocks(t){if(t){var o=this.getTopBlocks(!0);t=[];for(let a=0;a<o.length;a++)t.push(...o[a].getDescendants(!0))}else for(t=this.getTopBlocks(!1),o=0;o<t.length;o++)t.push(...t[o].getChildren(!1));return t.filter(function(a){return!a.isInsertionMarker()})}clear(){this.isClearing=!0;try{const t=Kt();for(t||He(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();t||He(!1),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(t,o){this.variableMap.renameVariableById(t,o)}createVariable(t,o,a){return this.variableMap.createVariable(t,o,a)}getVariableUsesById(t){return this.variableMap.getVariableUsesById(t)}deleteVariableById(t){this.variableMap.deleteVariableById(t)}getVariable(t,o){return this.variableMap.getVariable(t,o)}getVariableById(t){return this.variableMap.getVariableById(t)}getVariablesOfType(t){return this.variableMap.getVariablesOfType(t)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(t,o){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(t){return this.options.maxInstances?(this.options.maxInstances[t]!==void 0?this.options.maxInstances[t]:1/0)-this.getBlocksByType(t,!1).length:1/0}isCapacityAvailable(t){if(!this.hasBlockLimits())return!0;let o=0;for(const a in t){if(t[a]>this.remainingCapacityOfType(a))return!1;o+=t[a]}return!(o>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(t){var o=t?this.redoStack_:this.undoStack_,a=t?this.undoStack_:this.redoStack_;const d=o.pop();if(d){for(var m=[d];o.length&&d.group&&d.group===o[o.length-1].group;)m.push(o.pop());for(o=0;o<m.length;o++)a.push(m[o]);m=Ah(m,t),zr(!1);try{for(a=0;a<m.length;a++)m[a].run(t)}finally{zr(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,Ep()}addChangeListener(t){return this.listeners.push(t),t}removeChangeListener(t){kr(this.listeners,t)}fireChangeListener(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let o=0;o<this.listeners.length;o++)(0,this.listeners[o])(t)}getBlockById(t){return this.blockDB.get(t)||null}setBlockById(t,o){this.blockDB.set(t,o)}removeBlockById(t){this.blockDB.delete(t)}getCommentById(t){let o;return(o=this.commentDB.get(t))!=null?o:null}allInputsFilled(t){const o=this.getTopBlocks(!1);for(let a=0;a<o.length;a++)if(!o[a].allInputsFilled(t))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new Sg(this)}getVariableMap(){return this.variableMap}setVariableMap(t){this.variableMap=t}getProcedureMap(){return this.procedureMap}static getById(t){return W(t)}static getAll(){return ne()}};Kn.SCAN_ANGLE=3;var LN=100,Pv=class{constructor(t){this.parentWorkspace=t,this.sounds=new Map,this.lastSound_=null}dispose(){this.sounds.clear()}load(t,o){if(t.length){try{var a=new globalThis.Audio}catch{return}for(let m=0;m<t.length;m++){const b=t[m],I=b.match(/\.(\w+)$/);if(I&&a.canPlayType("audio/"+I[1])){var d=new globalThis.Audio(b);break}}d&&this.sounds.set(o,d)}}preload(){for(const t of this.sounds.values()){t.volume=.01;const o=t.play();if(o!==void 0?o.then(t.pause).catch(function(){}):t.pause(),na||x$)break}}play(t,o){var a=this.sounds.get(t);a?(t=new Date,this.lastSound_!==null&&t.getTime()-this.lastSound_.getTime()<LN||(this.lastSound_=t,a=na||ed?a:a.cloneNode(),a.volume=o===void 0?1:o,a.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(t,o)}},Fv=class{constructor(t){this.workspace=t,this.id="zoomControls",this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=this.onZoomOutWrapper=this.onZoomInWrapper=this.onZoomResetWrapper=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=z(G.G,{});const t=String(Math.random()).substring(2);return this.createZoomOutSvg(t),this.createZoomInSvg(t),this.workspace.isMovable()&&this.createZoomResetSvg(t),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[ji.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&ft(this.svgGroup),this.onZoomResetWrapper&&C(this.onZoomResetWrapper),this.onZoomInWrapper&&C(this.onZoomInWrapper),this.onZoomOutWrapper&&C(this.onZoomOutWrapper)}getBoundingRectangle(){let t=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(t+=this.LARGE_SPACING+this.HEIGHT),new li(this.top,this.top+t,this.left,this.left+this.WIDTH)}position(t,o){if(this.initialized){var a=Jp(this.workspace,t),d=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(d+=this.LARGE_SPACING+this.HEIGHT),t=qp(a,new Xi(this.WIDTH,d),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,t,this.workspace),a=a.vertical,o=Qp(t,this.MARGIN_VERTICAL,a===Xn.TOP?So.DOWN:So.UP,o),a===Xn.TOP){var m=this.SMALL_SPACING+this.HEIGHT,b;(b=this.zoomInGroup)==null||b.setAttribute("transform","translate(0, "+m+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(m+this.LARGE_SPACING+this.HEIGHT)+")")}else{b=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;let L;(L=this.zoomInGroup)==null||L.setAttribute("transform","translate(0, "+b+")"),b=b+this.SMALL_SPACING+this.HEIGHT,(m=this.zoomOutGroup)==null||m.setAttribute("transform","translate(0, "+b+")")}this.top=o.top,this.left=o.left;var I;(I=this.svgGroup)==null||I.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(t){this.zoomOutGroup=z(G.G,{class:"blocklyZoom"},this.svgGroup);const o=z(G.CLIPPATH,{id:"blocklyZoomoutClipPath"+t},this.zoomOutGroup);z(G.RECT,{width:32,height:32},o),z(G.IMAGE,{width:br.width,height:br.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.zoomOutGroup).setAttributeNS(Or,"xlink:href",this.workspace.options.pathToMedia+br.url),this.onZoomOutWrapper=y(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1))}createZoomInSvg(t){this.zoomInGroup=z(G.G,{class:"blocklyZoom"},this.svgGroup);const o=z(G.CLIPPATH,{id:"blocklyZoominClipPath"+t},this.zoomInGroup);z(G.RECT,{width:32,height:32},o),z(G.IMAGE,{width:br.width,height:br.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.zoomInGroup).setAttributeNS(Or,"xlink:href",this.workspace.options.pathToMedia+br.url),this.onZoomInWrapper=y(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1))}zoom(t,o){this.workspace.markFocused(),this.workspace.zoomCenter(t),this.fireZoomEvent(),u(),o.stopPropagation(),o.preventDefault()}createZoomResetSvg(t){this.zoomResetGroup=z(G.G,{class:"blocklyZoom"},this.svgGroup);const o=z(G.CLIPPATH,{id:"blocklyZoomresetClipPath"+t},this.zoomResetGroup);z(G.RECT,{width:32,height:32},o),z(G.IMAGE,{width:br.width,height:br.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.zoomResetGroup).setAttributeNS(Or,"xlink:href",this.workspace.options.pathToMedia+br.url),this.onZoomResetWrapper=y(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this))}resetZoom(t){this.workspace.markFocused();const o=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(o),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),u(),t.stopPropagation(),t.preventDefault()}fireZoomEvent(){const t=new(Le($o))(null,this.workspace.id,"zoom_controls");De(t)}};Ds(`
.blocklyZoom>image, .blocklyZoom>svg>image {
  opacity: .4;
}

.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {
  opacity: .6;
}

.blocklyZoom>image:active, .blocklyZoom>svg>image:active {
  opacity: .8;
}
`);var MN=20,zs=class extends Kn{constructor(t,o,a){super(t),this.resizeHandlerWrapper=null,this.resizesEnabled=this.isVisible_=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.dragDeltaXY=null,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.workspaceDragSurface=this.blockDragSurface=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null,this.isDragSurfaceActive=!1,this.inverseScreenCTM=this.targetWorkspace=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=null,this.metricsManager=new(cs(fe.METRICS_MANAGER,t,!0))(this),this.getMetrics=t.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=t.setMetrics||zs.setTopLevelWorkspaceMetrics_,this.componentManager=new ji,this.connectionDBList=Ca.init(this.connectionChecker),o&&(this.blockDragSurface=o),a&&(this.workspaceDragSurface=a),this.useWorkspaceDragSurface=!!this.workspaceDragSurface,this.audioManager=new Pv(t.parentWorkspace),this.grid=this.options.gridPattern?new hg(this.options.gridPattern,t.gridOptions):null,this.markerManager=new Pu(this),i.module$build$src$core$variables&&Ip&&this.registerToolboxCategoryCallback(md,Ip),Io&&tm&&this.registerToolboxCategoryCallback($g,tm),i.module$build$src$core$procedures&&em&&(this.registerToolboxCategoryCallback(Od,em),this.addChangeListener(ZE)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new Mv(this,this.options.theme||yd),this.themeManager_.subscribeWorkspace(this);let d;this.renderer=i$(this.options.renderer||"geras",this.getTheme(),(d=this.options.rendererOverrides)!=null?d:void 0),this.cachedParentSvgSize=new Xi(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(t){this.metricsManager=t,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(t){this.markerManager.setCursorSvg(t)}setMarkerSvg(t){this.markerManager.setMarkerSvg(t)}getMarker(t){return this.markerManager?this.markerManager.getMarker(t):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(t){t||(t=yd),this.themeManager_.setTheme(t)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(o){return!!o.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);const t=new(Le(xu))(this.getTheme().name,this.id);De(t)}updateBlockStyles_(t){for(let o=0,a;a=t[o];o++){const d=a.getStyleName();if(d){const m=a;m.setStyle(d),m.mutator&&m.mutator.updateBlockStyle()}}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM=t.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.isVisible_}getSvgXY(t){let o=0,a=0,d=1;(ls(this.getCanvas(),t)||ls(this.getBubbleCanvas(),t))&&(d=this.scale);do{const m=Ls(t);(t===this.getCanvas()||t===this.getBubbleCanvas())&&(d=1),o+=m.x*d,a+=m.y*d,t=t.parentNode}while(t&&t!==this.getParentSvg());return new ve(o,a)}getCachedParentSvgSize(){const t=this.cachedParentSvgSize;return new Xi(t.width,t.height)}getOriginOffsetInPixels(){return Nh(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let t=this.svgGroup_;for(;t;){if((" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1){this.injectionDiv=t;break}t=t.parentNode}}return this.injectionDiv}getBlockCanvas(){return this.svgBlockCanvas_}setResizeHandlerWrapper(t){this.resizeHandlerWrapper=t}createDom(t){return this.svgGroup_=z(G.G,{class:"blocklyWorkspace"}),t&&(this.svgBackground_=z(G.RECT,{height:"100%",width:"100%",class:t},this.svgGroup_),t==="blocklyMainBackground"&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=z(G.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=z(G.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(y(this.svgGroup_,"pointerdown",this,this.onMouseDown_,!1),document.body.addEventListener("wheel",function(){}),y(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(cs(fe.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(t=cs(fe.CURSOR,this.options))&&this.markerManager.setCursor(new t),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&ft(this.svgGroup_),this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const t=this.getParentSvg();t&&t.parentNode&&ft(t.parentNode)}this.resizeHandlerWrapper&&(C(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null)}addTrashcan(){this.trashcan=zs.newTrashcan(this);const t=this.trashcan.createDom();this.svgGroup_.insertBefore(t,this.svgBlockCanvas_)}static newTrashcan(t){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new Fv(this);const t=this.zoomControls_.createDom();this.svgGroup_.appendChild(t)}addFlyout(t){const o=new Vs({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return o.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(cs(fe.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(o):new(cs(fe.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(o),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(t)}getFlyout(t){return this.flyout||t?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position(),this.flyout&&this.flyout.position();const t=this.componentManager.getComponents(ji.Capability.POSITIONABLE,!0),o=this.getMetricsManager().getUiMetrics(),a=[];for(let d=0,m;m=t[d];d++){m.position(o,a);const b=m.getBoundingRectangle();b&&a.push(b)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const t=wp();ve.equals(this.lastRecordedPageScroll,t)||(this.lastRecordedPageScroll=t,this.updateScreenCalculations_())}getCanvas(){return this.svgBlockCanvas_}setCachedParentSvgSize(t,o){const a=this.getParentSvg();t!=null&&(this.cachedParentSvgSize.width=t,a.setAttribute("data-cached-width",t.toString())),o!=null&&(this.cachedParentSvgSize.height=o,a.setAttribute("data-cached-height",o.toString()))}getBubbleCanvas(){return this.svgBubbleCanvas_}getParentSvg(){if(!this.cachedParentSvg){let t=this.svgGroup_;for(;t;){if(t.tagName==="svg"){this.cachedParentSvg=t;break}t=t.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(Pi()){var t=this.scale,o=-this.scrollY,a=-this.scrollX;if(!(t===this.oldScale&&1>Math.abs(o-this.oldTop)&&1>Math.abs(a-this.oldLeft))){var d=new(Le(pl))(o,a,t,this.id,this.oldScale);this.oldScale=t,this.oldTop=o,this.oldLeft=a,De(d)}}}translate(t,o){if(this.useWorkspaceDragSurface&&this.isDragSurfaceActive){var a;(a=this.workspaceDragSurface)==null||a.translateSurface(t,o)}else a="translate("+t+","+o+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",a),this.svgBubbleCanvas_.setAttribute("transform",a);this.blockDragSurface&&this.blockDragSurface.translateAndScaleGroup(t,o,this.scale),this.grid&&this.grid.moveTo(t,o),this.maybeFireViewportChangeEvent()}resetDragSurface(){if(this.useWorkspaceDragSurface){this.isDragSurfaceActive=!1;var t=this.workspaceDragSurface.getSurfaceTranslation();this.workspaceDragSurface.clearAndHide(this.svgGroup_),t="translate("+t.x+","+t.y+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",t),this.svgBubbleCanvas_.setAttribute("transform",t)}}setupDragSurface(){if(this.useWorkspaceDragSurface&&!this.isDragSurfaceActive){this.isDragSurfaceActive=!0;var t=this.svgBlockCanvas_.previousSibling,o,a=parseInt((o=this.getParentSvg().getAttribute("width"))!=null?o:"0"),d;o=parseInt((d=this.getParentSvg().getAttribute("height"))!=null?d:"0"),d=Ls(this.getCanvas()),this.workspaceDragSurface.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),t,a,o,this.scale),this.workspaceDragSurface.translateSurface(d.x,d.y)}}getBlockDragSurface(){return this.blockDragSurface}getWidth(){const t=this.getMetrics();return t?t.viewWidth/this.scale:0}setVisible(t){if(this.isVisible_=t,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&this.toolbox_.setVisible(t),t){t=this.getAllBlocks(!1);for(let o=t.length-1;0<=o;o--)t[o].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else this.hideChaff(!0)}render(){for(var t=this.getAllBlocks(!1),o=t.length-1;0<=o;o--)t[o].render(!1);if(this.currentGesture_)for(t=this.currentGesture_.getInsertionMarkers(),o=0;o<t.length;o++)t[o].render(!1);this.markerManager.updateMarkers()}highlightBlock(t,o){if(o===void 0){for(let a=0,d;d=this.highlightedBlocks[a];a++)d.setHighlighted(!1);this.highlightedBlocks.length=0}(t=t?this.getBlockById(t):null)&&((o=o===void 0||o)?this.highlightedBlocks.indexOf(t)===-1&&this.highlightedBlocks.push(t):kr(this.highlightedBlocks,t),t.setHighlighted(o))}paste(t){if(!this.rendered||!t.type&&!t.tagName)return null;this.currentGesture_&&this.currentGesture_.cancel();const o=Kt();return o||He(!0),t=t.type?this.pasteBlock_(null,t):t.tagName.toLowerCase()==="comment"?this.pasteWorkspaceComment_(t):this.pasteBlock_(t,null),He(o),t}pasteBlock_(t,o){Ci();let a;try{let d=0,m=0;if(t){a=ea(t,this);let b;d=parseInt((b=t.getAttribute("x"))!=null?b:"0"),this.RTL&&(d=-d);let I;m=parseInt((I=t.getAttribute("y"))!=null?I:"0")}else o&&(a=al(o,this),d=o.x||10,this.RTL&&(d=this.getWidth()-d),m=o.y||10);if(!isNaN(d)&&!isNaN(m)){let b;do{b=!1;const I=this.getAllBlocks(!1);for(let L=0,oe;oe=I[L];L++){const ye=oe.getRelativeToSurfaceXY();if(1>=Math.abs(d-ye.x)&&1>=Math.abs(m-ye.y)){b=!0;break}}if(!b){const L=a.getConnections_(!1);for(let oe=0,ye;ye=L[oe];oe++)if(ye.closest(i.config$$module$build$src$core$config.snapRadius,new ve(d,m)).connection){b=!0;break}}b&&(d=this.RTL?d-i.config$$module$build$src$core$config.snapRadius:d+i.config$$module$build$src$core$config.snapRadius,m+=2*i.config$$module$build$src$core$config.snapRadius)}while(b);a.moveTo(new ve(d,m))}}finally{Oi()}return Pi()&&!a.isShadow()&&De(new(Le(Ji))(a)),a.select(),a}pasteWorkspaceComment_(t){Ci();let o;try{o=ar.fromXmlRendered(t,this);let a,d=parseInt((a=t.getAttribute("x"))!=null?a:"0"),m,b=parseInt((m=t.getAttribute("y"))!=null?m:"0");isNaN(d)||isNaN(b)||(this.RTL&&(d=-d),o.moveBy(d+50,b+50))}finally{Oi()}return Pi()&&ln.fireCreateEvent(o),o.select(),o}refreshToolboxSelection(){const t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.getFlyout()&&t.toolbox_.refreshSelection()}renameVariableById(t,o){super.renameVariableById(t,o),this.refreshToolboxSelection()}deleteVariableById(t){super.deleteVariableById(t),this.refreshToolboxSelection()}createVariable(t,o,a){return t=super.createVariable(t,o,a),this.refreshToolboxSelection(),t}recordDragTargets(){const t=this.componentManager.getComponents(ji.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let o=0,a;a=t[o];o++){const d=a.getClientRect();d&&this.dragTargetAreas.push({component:a,clientRect:d})}}newBlock(t,o){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}getDragTarget(t){for(let o=0,a;a=this.dragTargetAreas[o];o++)if(a.clientRect.contains(t.clientX,t.clientY))return a.component;return null}onMouseDown_(t){const o=this.getGesture(t);o&&o.handleWsStart(t,this)}startDrag(t,o){t=F(t,this.getParentSvg(),this.getInverseScreenCTM()),t.x/=this.scale,t.y/=this.scale,this.dragDeltaXY=ve.difference(o,t)}moveDrag(t){return t=F(t,this.getParentSvg(),this.getInverseScreenCTM()),t.x/=this.scale,t.y/=this.scale,ve.sum(this.dragDeltaXY,t)}isDragging(){return this.currentGesture_!==null&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollVertically())}onMouseWheel_(t){if(an.inProgress())t.preventDefault(),t.stopPropagation();else{var o=this.options.zoomOptions&&this.options.zoomOptions.wheel,a=this.options.moveOptions&&this.options.moveOptions.wheel;if(o||a){var d=q(t);if(hm)var m=t.metaKey;o&&(t.ctrlKey||m||!a)?(d=-d.y/50,o=F(t,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(o.x,o.y,d)):(o=this.scrollX-d.x,a=this.scrollY-d.y,t.shiftKey&&!d.x&&(o=this.scrollX-d.y,a=this.scrollY),this.scroll(o,a)),t.preventDefault()}}}getBlocksBoundingBox(){const t=this.getTopBoundedElements();if(!t.length)return new li(0,0,0,0);const o=t[0].getBoundingRectangle();for(let d=1;d<t.length;d++){var a=t[d];a.isInsertionMarker&&a.isInsertionMarker()||(a=a.getBoundingRectangle(),a.top<o.top&&(o.top=a.top),a.bottom>o.bottom&&(o.bottom=a.bottom),a.left<o.left&&(o.left=a.left),a.right>o.right&&(o.right=a.right))}return o}cleanUp(){this.setResizesEnabled(!1),He(!0);const t=this.getTopBlocks(!0);let o=0;for(let a=0,d;d=t[a];a++){if(!d.isMovable())continue;const m=d.getRelativeToSurfaceXY();d.moveBy(-m.x,o-m.y),d.snapToGrid(),o=d.getRelativeToSurfaceXY().y+d.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}He(!1),this.setResizesEnabled(!0)}showContextMenu(t){if(!this.options.readOnly&&!this.isFlyout){var o=wt.registry.getContextMenuOptions(wt.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(o,t),zh(t,o,this.RTL)}}updateToolbox(t){if(t=Fh(t)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Hp(t)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=t,this.toolbox_.render(t)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=t,this.flyout.show(t)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(Y(this),this.setBrowserFocus())}setBrowserFocus(){document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:!0})}catch{try{this.getParentSvg().parentElement.setActive()}catch{this.getParentSvg().parentElement.focus({preventScroll:!0})}}}zoom(t,o,a){a=Math.pow(this.options.zoomOptions.scaleSpeed,a);const d=this.scale*a;if(this.scale!==d){d>this.options.zoomOptions.maxScale?a=this.options.zoomOptions.maxScale/this.scale:d<this.options.zoomOptions.minScale&&(a=this.options.zoomOptions.minScale/this.scale);var m=this.getCanvas().getCTM(),b=this.getParentSvg().createSVGPoint();b.x=t,b.y=o,b=b.matrixTransform(m.inverse()),t=b.x,o=b.y,m=m.translate(t*(1-a),o*(1-a)).scale(a),this.scrollX=m.e,this.scrollY=m.f,this.setScale(d)}}zoomCenter(t){var o=this.getMetrics();let a;this.flyout?(a=o.svgWidth?o.svgWidth/2:0,o=o.svgHeight?o.svgHeight/2:0):(a=o.viewWidth/2+o.absoluteLeft,o=o.viewHeight/2+o.absoluteTop),this.zoom(a,o,t)}zoomToFit(){if(this.isMovable()){var t=this.getMetrics(),o=t.viewWidth;t=t.viewHeight;var a=this.getBlocksBoundingBox(),d=2*MN,m=a.right-a.left+d;if(a=a.bottom-a.top+d,m){this.flyout&&(this.horizontalLayout?(t+=this.flyout.getHeight(),a+=this.flyout.getHeight()/this.scale):(o+=this.flyout.getWidth(),m+=this.flyout.getWidth()/this.scale)),o/=m,t/=a,Ci();try{this.setScale(Math.min(o,t)),this.scrollCenter()}finally{Oi()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){Ce(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),Ce(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")}endCanvasTransition(){qe(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),qe(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var t=this.getMetrics(),o=(t.scrollWidth-t.viewWidth)/2,a=(t.scrollHeight-t.viewHeight)/2;o=-o-t.scrollLeft,a=-a-t.scrollTop,this.scroll(o,a)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(t){if(this.isMovable()){if(t=t?this.getBlockById(t):null){var o=t.getRelativeToSurfaceXY(),a=t.getHeightWidth(),d=this.scale;t=(o.x+(this.RTL?-1:1)*a.width/2)*d,o=(o.y+a.height/2)*d,a=this.getMetrics(),this.scroll(-(t-a.viewWidth/2),-(o-a.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,this.hideChaff(!1),(t=this.getFlyout(!1))&&t.isVisible()&&(t.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),t=this.getMetrics(),this.scrollX-=t.absoluteLeft,this.scrollY-=t.absoluteTop,t.viewLeft+=t.absoluteLeft,t.viewTop+=t.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(t):this.scrollbar.resizeContent(t))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(t,o){this.hideChaff(!0);const a=this.getMetrics();t=Math.min(t,-a.scrollLeft),o=Math.min(o,-a.scrollTop);const d=a.scrollTop+Math.max(0,a.scrollHeight-a.viewHeight);t=Math.max(t,-(a.scrollLeft+Math.max(0,a.scrollWidth-a.viewWidth))),o=Math.max(o,-d),this.scrollX=t,this.scrollY=o,this.scrollbar&&this.scrollbar.set(-(t+a.scrollLeft),-(o+a.scrollTop),!1),t+=a.absoluteLeft,o+=a.absoluteTop,this.translate(t,o)}getBlockById(t){return super.getBlockById(t)}getAllBlocks(t){return super.getAllBlocks(t)}getTopBlocks(t){return super.getTopBlocks(t)}addTopBlock(t){this.addTopBoundedElement(t),super.addTopBlock(t)}removeTopBlock(t){this.removeTopBoundedElement(t),super.removeTopBlock(t)}addTopComment(t){this.addTopBoundedElement(t),super.addTopComment(t)}removeTopComment(t){this.removeTopBoundedElement(t),super.removeTopComment(t)}addTopBoundedElement(t){this.topBoundedElements.push(t)}removeTopBoundedElement(t){kr(this.topBoundedElements,t)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(t){const o=!this.resizesEnabled&&t;this.resizesEnabled=t,o&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(t,o){if(typeof o!="function")throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(t,o)}getButtonCallback(t){let o;return(o=this.flyoutButtonCallbacks.get(t))!=null?o:null}removeButtonCallback(t){this.flyoutButtonCallbacks.delete(t)}registerToolboxCategoryCallback(t,o){if(typeof o!="function")throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(t,o)}getToolboxCategoryCallback(t){return this.toolboxCategoryCallbacks.get(t)||null}removeToolboxCategoryCallback(t){this.toolboxCategoryCallbacks.delete(t)}getGesture(t){const o=t.type==="pointerdown",a=this.currentGesture_;return a?o&&a.hasStarted()?(console.warn("Tried to start the same gesture twice."),a.cancel(),null):a:o?this.currentGesture_=new an(t,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(t){ol(),tn(),en();const o=!!t;this.getComponentManager().getComponents(ji.Capability.AUTOHIDEABLE,!0).forEach(a=>a.autoHide(o))}static setTopLevelWorkspaceMetrics_(t){const o=this.getMetrics();typeof t.x=="number"&&(this.scrollX=-(o.scrollLeft+(o.scrollWidth-o.viewWidth)*t.x)),typeof t.y=="number"&&(this.scrollY=-(o.scrollTop+(o.scrollHeight-o.viewHeight)*t.y)),this.translate(this.scrollX+o.absoluteLeft,this.scrollY+o.absoluteTop)}},Ig={};Ig.load=F6,Ig.save=P6;var Uv=class{constructor(){this.priority=cv}save(t){const o=[];for(const a of t.getAllVariables())t={name:a.name,id:a.getId()},a.type&&(t.type=a.type),o.push(t);return o.length?o:null}load(t,o){for(const a of t)o.createVariable(a.name,a.type,a.id)}clear(t){t.getVariableMap().clear()}};Xp("variables",new Uv);var Hv={};Hv.VariableSerializer=Uv;var Gv=class{constructor(t,o){this.procedureModelClass=t,this.parameterModelClass=o,this.priority=hv}save(t){return t.getProcedureMap().getProcedures().map(o=>im(o))}load(t,o){const a=o.getProcedureMap();for(const d of t)a.add(sm(this.procedureModelClass,this.parameterModelClass,d,o))}clear(t){t.getProcedureMap().clear()}},BN=new Gv(sc,Oa),Sl={};Sl.ProcedureSerializer=Gv,Sl.loadParameter=nm,Sl.loadProcedure=sm,Sl.observableProcedureSerializer=BN,Sl.saveParameter=rm,Sl.saveProcedure=im;var PN={blocks:ju,exceptions:$a,priorities:Sd,procedures:Sl,registry:zm,variables:Hv,workspaces:Ig},Vv=class extends uc{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter_=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(t){super.setFontConstants_(t),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(t){super.setDynamicProperties_(t),this.SELECTED_GLOW_COLOUR=t.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const o=Number(t.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=o&&!isNaN(o)?o:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=t.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(t=Number(t.getComponentStyle("replacementGlowSize")))&&!isNaN(t)?t:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter_&&ft(this.selectedGlowFilter_),this.replacementGlowFilter_&&ft(this.replacementGlowFilter_)}makeStartHat(){const t=this.START_HAT_HEIGHT,o=this.START_HAT_WIDTH,a=Yr("c",[Me(25,-t),Me(71,-t),Me(o,0)]);return{height:t,width:o,path:a}}makeHexagonal(){function t(a,d,m){var b=a/2;return b=b>o?o:b,m=m?-1:1,a=(d?-1:1)*a/2,Bn(-m*b,a)+Bn(m*b,a)}const o=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width(a){return a/=2,a>o?o:a},height(a){return a},connectionOffsetY(a){return a/2},connectionOffsetX(a){return-a},pathDown(a){return t(a,!1,!1)},pathUp(a){return t(a,!0,!1)},pathRightDown(a){return t(a,!1,!0)},pathRightUp(a){return t(a,!1,!0)}}}makeRounded(){function t(d,m,b){const I=d>a?d-a:0;return d=(d>a?a:d)/2,bi("a","0 0,1",d,Me((m?-1:1)*d,(m?-1:1)*d))+ke("v",(b?1:-1)*I)+bi("a","0 0,1",d,Me((m?1:-1)*d,(m?-1:1)*d))}const o=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,a=2*o;return{type:this.SHAPES.ROUND,isDynamic:!0,width(d){return d/=2,d>o?o:d},height(d){return d},connectionOffsetY(d){return d/2},connectionOffsetX(d){return-d},pathDown(d){return t(d,!1,!1)},pathUp(d){return t(d,!0,!1)},pathRightDown(d){return t(d,!1,!0)},pathRightUp(d){return t(d,!1,!0)}}}makeSquared(){function t(a,d,m){return a-=2*o,bi("a","0 0,1",o,Me((d?-1:1)*o,(d?-1:1)*o))+ke("v",(m?1:-1)*a)+bi("a","0 0,1",o,Me((d?1:-1)*o,(d?-1:1)*o))}const o=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width(a){return o},height(a){return a},connectionOffsetY(a){return a/2},connectionOffsetX(a){return-a},pathDown(a){return t(a,!1,!1)},pathUp(a){return t(a,!0,!1)},pathRightDown(a){return t(a,!1,!0)},pathRightUp(a){return t(a,!1,!0)}}}shapeFor(t){let o=t.getCheck();switch(!o&&t.targetConnection&&(o=t.targetConnection.getCheck()),t.type){case Ie.INPUT_VALUE:case Ie.OUTPUT_VALUE:if(t=t.getSourceBlock().getOutputShape(),t!==null)switch(t){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return o&&o.indexOf("Boolean")!==-1?this.HEXAGONAL:o&&o.indexOf("Number")!==-1?this.ROUNDED:(o&&o.indexOf("String"),this.ROUNDED);case Ie.PREVIOUS_STATEMENT:case Ie.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function t(ye){return Yr("c",[Me(ye*m/2,0),Me(ye*m*3/4,I/2),Me(ye*m,I)])+vu([Me(ye*m,b)])+Yr("c",[Me(ye*m/4,I/2),Me(ye*m/2,I),Me(ye*m,I)])+ke("h",ye*d)+Yr("c",[Me(ye*m/2,0),Me(ye*m*3/4,-(I/2)),Me(ye*m,-I)])+vu([Me(ye*m,-b)])+Yr("c",[Me(ye*m/4,-(I/2)),Me(ye*m/2,-I),Me(ye*m,-I)])}const o=this.NOTCH_WIDTH,a=this.NOTCH_HEIGHT,d=o/3,m=d/3,b=a/2,I=b/2,L=t(1),oe=t(-1);return{type:this.SHAPES.NOTCH,width:o,height:a,pathLeft:L,pathRight:oe}}makeInsideCorners(){const t=this.CORNER_RADIUS,o=bi("a","0 0,0",t,Me(-t,t)),a=bi("a","0 0,1",t,Me(-t,t)),d=bi("a","0 0,0",t,Me(t,t)),m=bi("a","0 0,1",t,Me(t,t));return{width:t,height:t,pathTop:o,pathBottom:d,rightWidth:t,rightHeight:t,pathTopRight:a,pathBottomRight:m}}generateSecondaryColour_(t){return ta("#000",t,.15)||t}generateTertiaryColour_(t){return ta("#000",t,.25)||t}createDom(t,o,a){super.createDom(t,o,a),t=z(G.DEFS,{},t),o=z(G.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),z(G.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},o),a=z(G.FECOMPONENTTRANSFER,{result:"outBlur"},o),z(G.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},a),z(G.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},o),z(G.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},o),this.selectedGlowFilterId=o.id,this.selectedGlowFilter_=o,t=z(G.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),z(G.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},t),o=z(G.FECOMPONENTTRANSFER,{result:"outBlur"},t),z(G.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},o),z(G.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),z(G.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),z(G.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},t),this.replacementGlowFilterId=t.id,this.replacementGlowFilter_=t}getCSS_(t){return[`${t} .blocklyText,`,`${t} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t} .blocklyText {`,"fill: #fff;","}",`${t} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${t} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${t} .blocklyNonEditableText>text,`,`${t} .blocklyEditableText>text,`,`${t} .blocklyNonEditableText>g>text,`,`${t} .blocklyEditableText>g>text {`,"fill: #575E75;","}",`${t} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${t} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${t} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>rect,",`${t} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${t} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${t} .blocklyDropdownText {`,"fill: #fff !important;","}",`${t}.blocklyWidgetDiv .goog-menuitem,`,`${t}.blocklyDropDownDiv .goog-menuitem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t}.blocklyDropDownDiv .goog-menuitem-content {`,"color: #fff;","}",`${t} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${t} .blocklyDisabled > .blocklyOutlinePath {`,`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,"}",`${t} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},Wv=class extends cc{constructor(t,o){super(t,o)}draw(){const t=this.block_.pathObject;if(t.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),t.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&t.flipRTL(),Xh()){let o,a;(o=this.block_)==null||(a=o.renderingDebugger)==null||a.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_(),this.info_.outputConnection&&(t.outputShapeType=this.info_.outputConnection.shape.type),t.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(t){if(!(0>=t.height))if(U.isSpacer(t)&&(t.precedesStatement||t.followsStatement)){var o=this.constants_.INSIDE_CORNERS.rightHeight;o=t.height-(t.precedesStatement?o:0),this.outlinePath_+=(t.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<o?ke("V",t.yPos+o):"")+(t.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=ke("V",t.yPos+t.height)}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const t=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=qt(t.xPos,this.info_.startY),this.outlinePath_+=ke("h",t.width)}drawFlatBottom_(){const t=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=ke("V",t.baseline),this.outlinePath_+=ke("h",-t.width)}drawInlineInput_(t){this.positionInlineInputConnection_(t);const o=t.input.name;if(!t.connectedBlock&&!this.info_.isInsertionMarker){var a=t.width-2*t.connectionWidth;t=lr(t.xPos+t.connectionWidth,t.centerline-t.height/2)+ke("h",a)+t.shape.pathRightDown(t.height)+ke("h",-a)+t.shape.pathUp(t.height)+"z",this.block_.pathObject.setOutlinePath(o,t)}}drawStatementInput_(t){var o=t.getLastInput();const a=o.xPos+o.notchOffset+o.shape.width,d=o.shape.pathRight+ke("h",-(o.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,m=t.height-2*this.constants_.INSIDE_CORNERS.height;o=this.constants_.INSIDE_CORNERS.pathBottom+ke("h",o.notchOffset-this.constants_.INSIDE_CORNERS.width)+(o.connectedBottomNextConnection?"":o.shape.pathLeft),this.outlinePath_+=ke("H",a)+d+ke("v",m)+o+ke("H",t.xPos+t.width),this.positionStatementInputConnection_(t)}};i.FieldImage$$module$build$src$core$field_image=class extends pt{constructor(t,o,a,d,m,b,I){if(super(pt.SKIP_SETUP),this.imageElement_=this.clickHandler_=null,this.flipRtl_=this.isDirty_=this.EDITABLE=!1,this.altText_="",a=Number(oi(a)),o=Number(oi(o)),isNaN(a)||isNaN(o))throw Error("Height and width values of an image field must cast to numbers.");if(0>=a||0>=o)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Xi(o,a+i.FieldImage$$module$build$src$core$field_image.Y_PADDING),this.imageHeight_=a,typeof m=="function"&&(this.clickHandler_=m),t!==pt.SKIP_SETUP&&(I?this.configure_(I):(this.flipRtl_=!!b,this.altText_=oi(d)||""),this.setValue(oi(t)))}configure_(t){super.configure_(t),t.flipRtl&&(this.flipRtl_=t.flipRtl),t.alt&&(this.altText_=oi(t.alt))}initView(){this.imageElement_=z(G.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(Or,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")}updateSize_(){}doClassValidation_(t){return typeof t!="string"?null:t}doValueUpdate_(t){this.value_=t,this.imageElement_&&this.imageElement_.setAttributeNS(Or,"xlink:href",String(this.value_))}getFlipRtl(){return this.flipRtl_}setAlt(t){t!==this.altText_&&(this.altText_=t||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))}showEditor_(){this.clickHandler_&&this.clickHandler_(this)}setOnClickHandler(t){this.clickHandler_=t}getText_(){return this.altText_}static fromJson(t){if(!t.src||!t.width||!t.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(t.src,t.width,t.height,void 0,void 0,void 0,t)}},i.FieldImage$$module$build$src$core$field_image.Y_PADDING=1,ds("field_image",i.FieldImage$$module$build$src$core$field_image),i.FieldImage$$module$build$src$core$field_image.prototype.DEFAULT_VALUE="",i.FieldImage$$module$build$src$core$field_image;var dc=class extends pt{constructor(t,o,a){super(pt.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onKeyInputWrapper_=this.onKeyDownWrapper_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,this.CURSOR="text",t!==pt.SKIP_SETUP&&(a&&this.configure_(a),this.setValue(t),o&&this.setValidator(o))}configure_(t){super.configure_(t),t.spellcheck!==void 0&&(this.spellcheck_=t.spellcheck)}initView(){const t=this.getSourceBlock();if(!t)throw new Ei;if(this.getConstants().FULL_BLOCK_FIELDS){let o=0,a=0;for(let d=0,m;m=t.inputList[d];d++){for(let b=0;m.fieldRow[b];b++)o++;m.connection&&a++}this.fullBlockClickTarget_=1>=o&&t.outputConnection&&!a}else this.fullBlockClickTarget_=!1;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()}doClassValidation_(t){return t==null?null:String(t)}doValueInvalid_(t){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,t=this.value_,this.value_=this.htmlInput_.getAttribute("data-untyped-default-value"),this.sourceBlock_&&Pi()&&De(new(Le(Ui))(this.sourceBlock_,"field",this.name||null,t,this.value_)))}doValueUpdate_(t){this.isTextValid_=this.isDirty_=!0,this.value_=t}applyColour(){if(this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS){var t=this.sourceBlock_;this.borderRect_?this.borderRect_.setAttribute("stroke",t.style.colourTertiary):t.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)}}render_(){if(super.render_(),this.isBeingEdited_){this.resizeEditor_();const t=this.htmlInput_;this.isTextValid_?(qe(t,"blocklyInvalidInput"),ti(t,Yt.INVALID,!1)):(Ce(t,"blocklyInvalidInput"),ti(t,Yt.INVALID,!0))}}setSpellcheck(t){t!==this.spellcheck_&&(this.spellcheck_=t,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(t,o){this.workspace_=this.sourceBlock_.workspace,t=o||!1,!t&&this.workspace_.options.modalInputs&&(dm||ed||na)?this.showPromptEditor_():this.showInlineEditor_(t)}showPromptEditor_(){yp(Ve.CHANGE_VALUE_TITLE,this.getText(),t=>{t!==null&&this.setValue(this.getValueFromEditorText_(t))})}showInlineEditor_(t){const o=this.getSourceBlock();if(!o)throw new Ei;Pp(this,o.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,t||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var t=this.getSourceBlock();if(!t)throw new Ei;He(!0);const o=ra();var a=this.getClickTarget_();if(!a)throw Error("A click target has not been set.");Ce(a,"editing"),a=document.createElement("input"),a.className="blocklyHtmlInput",a.setAttribute("spellcheck",this.spellcheck_);const d=this.workspace_.getScale();var m=this.getConstants().FIELD_TEXT_FONTSIZE*d+"pt";return o.style.fontSize=m,a.style.fontSize=m,m=dc.BORDERRADIUS*d+"px",this.fullBlockClickTarget_&&(m=this.getScaledBBox(),m=(m.bottom-m.top)/2+"px",t=t.getParent()?t.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,a.style.border=1*d+"px solid "+t,o.style.borderRadius=m,o.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(o.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*d+"px")),a.style.borderRadius=m,o.appendChild(a),a.value=a.defaultValue=this.getEditorText_(this.value_),a.setAttribute("data-untyped-default-value",this.value_),this.resizeEditor_(),this.bindInputEvents_(a),a}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),He(!1),this.unbindInputEvents_();var t=ra().style;if(t.width="auto",t.height="auto",t.fontSize="",t.transition="",t.boxShadow="",this.htmlInput_=null,t=this.getClickTarget_(),!t)throw Error("A click target has not been set.");qe(t,"editing")}onFinishEditing_(t){}bindInputEvents_(t){this.onKeyDownWrapper_=y(t,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=y(t,"input",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&(C(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(C(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(t){t.keyCode===Re.ENTER?(tn(),en()):t.keyCode===Re.ESC?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value")),tn(),en()):t.keyCode===Re.TAB&&(tn(),en(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())}onHtmlInputChange_(t){this.setValue(this.getValueFromEditorText_(this.htmlInput_.value))}setEditorValue_(t){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(t)),this.setValue(t)}resizeEditor_(){var t=this.getSourceBlock();if(!t)throw new Ei;const o=ra(),a=this.getScaledBBox();o.style.width=a.right-a.left+"px",o.style.height=a.bottom-a.top+"px",t=new ve(t.RTL?a.right-o.offsetWidth:a.left,a.top),o.style.left=t.x+"px",o.style.top=t.y+"px"}isTabNavigable(){return!0}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(t){return String(t)}getValueFromEditorText_(t){return t}};dc.BORDERRADIUS=4,i.FieldTextInput$$module$build$src$core$field_textinput=class extends dc{constructor(t,o,a){super(t,o,a)}static fromJson(t){return new this(oi(t.text),void 0,t)}},ds("field_input",i.FieldTextInput$$module$build$src$core$field_textinput),i.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="",i.FieldTextInput$$module$build$src$core$field_textinput;var zv=class extends fg{constructor(t){super(t)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(t){return!!t.outputConnection}hasRightSquareCorner(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection}},Yv=class extends oc{constructor(t,o){if(super(t,o),this.connectedBottomNextConnection=!1,this.connectedBlock){for(t=this.connectedBlock;o=t.getNextBlock();)t=o;t.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},Xv=class extends hn{constructor(t){super(t),this.width=this.height=0,this.type|=U.getType("RIGHT_CONNECTION")}},jv=class extends bg{constructor(t){super(t)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(t){const o=(t.hat?t.hat==="cap":this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection;return!!t.outputConnection||o}hasRightSquareCorner(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection}},Kv=class extends wa{constructor(t,o){super(t,o),this.isInline=!0,this.renderer_=t,this.constants_=this.renderer_.getConstants(),this.topRow=new jv(this.constants_),this.bottomRow=new zv(this.constants_),this.isMultiRow=!o.getInputsInline()||o.isCollapsed(),this.hasStatementInput=0<o.statementInputCount,this.rightSide=this.outputConnection?new Xv(this.constants_):null,this.rightAlignedDummyInputs_=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(t,o){return o?t.type===it.STATEMENT||o.type===it.STATEMENT?!0:t.type===it.VALUE||t.type===it.DUMMY?!this.isInline||this.isMultiRow:!1:!1}getDesiredRowWidth_(t){return t.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(t)}getInRowSpacing_(t,o){return t&&o||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!t&&o&&U.isStatementInput(o)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:t&&U.isLeftRoundedCorner(t)&&o&&(U.isPreviousConnection(o)||U.isNextConnection(o))?o.notchOffset-this.constants_.CORNER_RADIUS:t&&U.isLeftSquareCorner(t)&&o&&U.isHat(o)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(t,o){if(U.isTopRow(t)&&U.isBottomRow(o))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const a=U.isInputRow(t)&&t.hasStatement,d=U.isInputRow(o)&&o.hasStatement;return d||a?(t=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),d&&a?Math.max(t,this.constants_.DUMMY_INPUT_MIN_HEIGHT):t):U.isTopRow(t)?t.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):U.isBottomRow(o)?this.outputConnection?!o.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(t,o){const a=this.width-this.startX;return U.isInputRow(t)&&t.hasStatement||U.isInputRow(o)&&o.hasStatement?Math.max(a,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):a}getElemCenterline_(t,o){if(t.hasStatement&&!U.isSpacer(o)&&!U.isStatementInput(o))return t.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(U.isInlineInput(o)&&o instanceof jn){const a=o.connectedBlock;if(a&&a.outputConnection&&a.nextConnection)return t.yPos+a.height/2}return super.getElemCenterline_(t,o)}addInput_(t,o){if(t.type===it.DUMMY&&o.hasDummyInput&&o.align===i.Align$$module$build$src$core$input.LEFT&&t.align===i.Align$$module$build$src$core$input.RIGHT)this.rightAlignedDummyInputs_.set(o,t);else if(t.type===it.STATEMENT){o.elements.push(new Yv(this.constants_,t)),o.hasStatement=!0,o.align===null&&(o.align=t.align);return}super.addInput_(t,o)}addAlignmentPadding_(t,o){if(this.rightAlignedDummyInputs_.get(t)){let a;for(let d=0;d<t.elements.length;d++){const m=t.elements[d];if(U.isSpacer(m)&&(a=m),U.isField(m)&&m instanceof yl&&m.parentInput===this.rightAlignedDummyInputs_.get(t))break}if(a){a.width+=o,t.width+=o;return}}super.addAlignmentPadding_(t,o)}adjustXPosition_(){const t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let o=t;for(let m=2;m<this.rows.length-1;m+=2){var a=this.rows[m-1];const b=this.rows[m];var d=this.rows[m+1];if(a=m===2?!!this.topRow.hasPreviousConnection:!!a.followsStatement,d=m+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!d.precedesStatement,U.isInputRow(b)&&b.hasStatement){b.measure();let I,L;o=b.width-((L=(I=b.getLastInput())==null?void 0:I.width)!=null?L:0)+t}else if(a&&(m===2||d)&&U.isInputRow(b)&&!b.hasStatement){d=b.xPos,a=null;for(let I=0;I<b.elements.length;I++){const L=b.elements[I];U.isSpacer(L)&&(a=L),a&&(U.isField(L)||U.isInput(L))&&d<o&&!(U.isField(L)&&L instanceof yl&&(L.field instanceof i.FieldLabel$$module$build$src$core$field_label||L.field instanceof i.FieldImage$$module$build$src$core$field_image))&&(a.width+=o-d),d+=L.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var t=this.outputConnection.shape;if("isDynamic"in t&&t.isDynamic){for(var o=0,a=0;a<this.rows.length;a++){const d=this.rows[a];d.yPos=o,o+=d.height}this.height=o,a=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,o=t.height(a),a=t.width(a),this.outputConnection.height=o,this.outputConnection.width=a,this.outputConnection.startX=a,this.outputConnection.connectionOffsetY=t.connectionOffsetY(o),this.outputConnection.connectionOffsetX=t.connectionOffsetX(a),t=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(t=a,this.rightSide.height=o,this.rightSide.width=t,this.rightSide.centerline=o/2,this.rightSide.xPos=this.width+t),this.startX=a,this.width+=a+t,this.widthWithChildren+=a+t}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var t=0,o=0;o<this.rows.length;o++){var a=this.rows[o];if(!U.isInputRow(a))continue;t=a.elements[a.elements.length-2];let d=this.getNegativeSpacing_(a.elements[1]),m=this.getNegativeSpacing_(t);t=d+m;const b=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-t<b&&(t=this.width-b,d=t/2,m=t/2),a.elements.unshift(new jr(this.constants_,-d)),a.elements.push(new jr(this.constants_,-m))}if(t)for(this.width-=t,this.widthWithChildren-=t,this.rightSide.xPos-=t,o=0;o<this.rows.length;o++)a=this.rows[o],U.isTopOrBottomRow(a)&&(a.elements[1].width-=t),a.width-=t,a.widthWithConnectedBlocks-=t}}getNegativeSpacing_(t){if(!t||!this.outputConnection)return 0;const o=this.outputConnection.width;var a=this.outputConnection.shape.type;const d=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)switch(a){case d.SHAPES.ROUND:return a=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,a=this.height/2>a?a:this.height/2,o-a*(1-Math.sin(Math.acos((a-this.constants_.SMALL_PADDING)/a)));default:return 0}if(U.isInlineInput(t)&&t instanceof jn){const m=t.connectedBlock;return t=m?m.pathObject.outputShapeType:t.shape.type,t==null||m&&m.outputConnection&&(m.statementInputCount||m.nextConnection)||a===d.SHAPES.HEXAGONAL&&a!==t?0:o-this.constants_.SHAPE_IN_SHAPE_PADDING[a][t]}return U.isField(t)&&t instanceof yl?a===d.SHAPES.ROUND&&t.field instanceof i.FieldTextInput$$module$build$src$core$field_textinput?o-2.75*d.GRID_UNIT:o-this.constants_.SHAPE_IN_SHAPE_PADDING[a][0]:U.isIcon(t)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let d=2;d<this.rows.length-1;d+=2){const m=this.rows[d-1],b=this.rows[d],I=this.rows[d+1];var t=d===2,o=d+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!I.precedesStatement;if(t?this.topRow.hasPreviousConnection:m.followsStatement){var a=b.elements[1];if(a=b.elements.length===3&&a instanceof yl&&(a.field instanceof i.FieldLabel$$module$build$src$core$field_label||a.field instanceof i.FieldImage$$module$build$src$core$field_image),!t&&a)m.height-=this.constants_.SMALL_PADDING,I.height-=this.constants_.SMALL_PADDING,b.height-=this.constants_.MEDIUM_PADDING;else if(!t&&!o)m.height+=this.constants_.SMALL_PADDING;else if(o){for(t=!1,o=0;o<b.elements.length;o++)if(a=b.elements[o],a instanceof jn&&U.isInlineInput(a)&&a.connectedBlock&&!a.connectedBlock.isShadow()&&40<=a.connectedBlock.getHeightWidth().height){t=!0;break}t&&(m.height-=this.constants_.SMALL_PADDING,I.height-=this.constants_.SMALL_PADDING)}}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},qv=class extends Eg{constructor(t,o,a){super(t,o,a),this.markerCircle_=null}showWithInputOutput_(t){const o=t.getSourceBlock();t=t.getLocation().getOffsetInBlock(),this.positionCircle_(t.x,t.y),this.setParent_(o),this.showCurrent_()}showWithOutput_(t){this.showWithInputOutput_(t)}showWithInput_(t){this.showWithInputOutput_(t)}showWithBlock_(t){t=t.getLocation();const o=t.getHeightWidth();this.positionRect_(0,0,o.width,o.height),this.setParent_(t),this.showCurrent_()}positionCircle_(t,o){let a;(a=this.markerCircle_)==null||a.setAttribute("cx",t.toString());let d;(d=this.markerCircle_)==null||d.setAttribute("cy",o.toString()),this.currentMarkerSvg=this.markerCircle_}hide(){super.hide(),this.markerCircle_&&(this.markerCircle_.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle_=z(G.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){const t=this.getBlinkProperties_();z(G.ANIMATE,t,this.markerCircle_)}return this.markerSvg_}applyColour_(t){super.applyColour_(t);let o;(o=this.markerCircle_)==null||o.setAttribute("fill",this.colour_);let a;if((a=this.markerCircle_)==null||a.setAttribute("stroke",this.colour_),this.isCursor()){t=this.colour_+";transparent;transparent;";let d;(d=this.markerCircle_)==null||d.firstElementChild.setAttribute("values",t)}}},Jv=class extends Rd{constructor(t,o,a){super(t,o,a),this.svgPathSelected_=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=a}setPath(t){super.setPath(t),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",t)}applyColour(t){super.applyColour(t);const o=t.getParent();t.isShadow()&&o&&this.svgPath.setAttribute("stroke",o.style.colourTertiary);for(const a of this.outlines.values())a.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const t of this.outlines.values())t.setAttribute("transform","scale(-1 1)")}updateSelected(t){this.setClass_("blocklySelected",t),t?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(!0),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)}updateReplacementFade(t){this.setClass_("blocklyReplaceable",t),t?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(t,o){t=t.getParentInput().name,(t=this.getOutlinePath_(t))&&(o?t.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):t.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const t of this.outlines.keys())this.remainingOutlines.add(t)}endDrawing(){if(this.remainingOutlines.size)for(const t of this.remainingOutlines)this.removeOutlinePath_(t);this.remainingOutlines.clear()}setOutlinePath(t,o){t=this.getOutlinePath_(t),t.setAttribute("d",o),t.setAttribute("fill",this.style.colourTertiary)}getOutlinePath_(t){return this.outlines.has(t)||this.outlines.set(t,z(G.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(t),this.outlines.get(t)}removeOutlinePath_(t){let o,a;(o=this.outlines.get(t))==null||(a=o.parentNode)==null||a.removeChild(this.outlines.get(t)),this.outlines.delete(t)}},Qv=class extends hc{constructor(t){super(t)}makeConstants_(){return new Vv}makeRenderInfo_(t){return new Kv(this,t)}makeDrawer_(t,o){return new Wv(t,o)}makeMarkerDrawer(t,o){return new qv(t,this.getConstants(),o)}makePathObject(t,o){return new Jv(t,o,this.getConstants())}getConstants(){return this.constants_}shouldHighlightConnection(t){return t.type!==Ie.INPUT_VALUE&&t.type!==Ie.OUTPUT_VALUE}getConnectionPreviewMethod(t,o,a){return o.type===Ie.OUTPUT_VALUE?t.isConnected()?qr.PREVIEW_TYPE.REPLACEMENT_FADE:qr.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(t,o,a)}};Iu("zelos",Qv);var Ys={};Ys.BottomRow=zv,Ys.ConstantProvider=Vv,Ys.Drawer=Wv,Ys.MarkerSvg=qv,Ys.PathObject=Jv,Ys.RenderInfo=Kv,Ys.Renderer=Qv,Ys.RightConnectionShape=Xv,Ys.StatementInput=Yv,Ys.TopRow=jv;var Zv=class extends wa{constructor(t,o){super(t,o)}getRenderer(){return this.renderer_}addElemSpacing_(){let t=!1;for(var o=0;o<this.rows.length;o++)if(this.rows[o].hasExternalInput){t=!0;break}for(o=0;o<this.rows.length;o++){const d=this.rows[o];var a=d.elements;if(d.elements=[],d.startsWithElemSpacer()&&d.elements.push(new jr(this.constants_,this.getInRowSpacing_(null,a[0]))),a.length){for(let m=0;m<a.length-1;m++){d.elements.push(a[m]);const b=this.getInRowSpacing_(a[m],a[m+1]);d.elements.push(new jr(this.constants_,b))}d.elements.push(a[a.length-1]),d.endsWithElemSpacer()&&(a=this.getInRowSpacing_(a[a.length-1],null),t&&d.hasDummyInput&&(a+=this.constants_.TAB_WIDTH),d.elements.push(new jr(this.constants_,a)))}}}getInRowSpacing_(t,o){if(!t)return o&&U.isField(o)&&o.isEditable?this.constants_.MEDIUM_PADDING:o&&U.isInlineInput(o)?this.constants_.MEDIUM_LARGE_PADDING:o&&U.isStatementInput(o)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!U.isInput(t)&&!o)return U.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:U.isIcon(t)?2*this.constants_.LARGE_PADDING+1:U.isHat(t)?this.constants_.NO_PADDING:U.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:U.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:U.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(U.isInput(t)&&!o){if(U.isExternalInput(t))return this.constants_.NO_PADDING;if(U.isInlineInput(t))return this.constants_.LARGE_PADDING;if(U.isStatementInput(t))return this.constants_.NO_PADDING}if(!U.isInput(t)&&o&&U.isInput(o)){if(U.isField(t)&&t.isEditable){if(U.isInlineInput(o)||U.isExternalInput(o))return this.constants_.SMALL_PADDING}else{if(U.isInlineInput(o)||U.isExternalInput(o))return this.constants_.MEDIUM_LARGE_PADDING;if(U.isStatementInput(o))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(U.isIcon(t)&&o&&!U.isInput(o))return this.constants_.LARGE_PADDING;if(U.isInlineInput(t)&&o&&U.isField(o))return o.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(U.isLeftSquareCorner(t)&&o){if(U.isHat(o))return this.constants_.NO_PADDING;if(U.isPreviousConnection(o)||U.isNextConnection(o))return o.notchOffset}return U.isLeftRoundedCorner(t)&&o?o.notchOffset-this.constants_.CORNER_RADIUS:U.isField(t)&&o&&U.isField(o)&&t.isEditable===o.isEditable||o&&U.isJaggedEdge(o)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(t,o){return U.isTopRow(t)&&U.isBottomRow(o)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:U.isTopRow(t)||U.isBottomRow(o)?this.constants_.NO_PADDING:t.hasExternalInput&&o.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&o.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&o.hasStatement||t.hasDummyInput||o.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(t,o){if(U.isSpacer(o))return t.yPos+o.height/2;if(U.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,U.isNextConnection(o)?t+o.height/2:t-o.height/2;if(U.isTopRow(t))return U.isHat(o)?t.capline-o.height/2:t.capline+o.height/2;let a=t.yPos;return a=U.isField(o)&&t.hasStatement?a+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+o.height/2):a+t.height/2}finalize_(){let t=0,o=0;for(var a=0;a<this.rows.length;a++){const m=this.rows[a];m.yPos=o,m.xPos=this.startX,o+=m.height,t=Math.max(t,m.widthWithConnectedBlocks);var d=o-this.topRow.ascenderHeight;m===this.bottomRow&&d<this.constants_.MIN_BLOCK_HEIGHT&&(d=this.constants_.MIN_BLOCK_HEIGHT-d,this.bottomRow.height+=d,o+=d),this.recordElemPositions_(m)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(a=this.block_.nextConnection.targetBlock())&&(t=Math.max(t,a.getHeightWidth().width)),this.bottomRow.baseline=o-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX,this.height=o,this.startY=this.topRow.capline}},e2=class extends hc{constructor(t){super(t)}makeRenderInfo_(t){return new Zv(this,t)}};Iu("thrasos",e2);var kg={};kg.RenderInfo=Zv,kg.Renderer=e2;var t2=class extends uc{constructor(){super()}},i2=class extends cc{constructor(t,o){super(t,o)}},r2=class extends wa{constructor(t,o){super(t,o)}getRenderer(){return this.renderer_}},s2=class extends hc{constructor(t){super(t)}makeConstants_(){return new t2}makeRenderInfo_(t){return new r2(this,t)}makeDrawer_(t,o){return new i2(t,o)}};Iu("minimalist",s2);var fc={};fc.ConstantProvider=t2,fc.Drawer=i2,fc.RenderInfo=r2,fc.Renderer=s2;var n2=class extends uc{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(t){return super.getCSS_(t).concat([`${t} .blocklyInsertionMarker>.blocklyPathLight,`,`${t} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},o2=class{constructor(t){this.inlineSteps_=this.steps_="",this.info_=t,this.RTL_=this.info_.RTL,t=t.getRenderer(),this.constants_=t.getConstants(),this.highlightConstants_=t.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+`
`+this.inlineSteps_}drawTopCorner(t){this.steps_+=qt(t.xPos,this.info_.startY);for(let o=0,a;a=t.elements[o];o++)U.isLeftSquareCorner(a)?this.steps_+=this.highlightConstants_.START_POINT:U.isLeftRoundedCorner(a)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):U.isPreviousConnection(a)?this.steps_+=this.notchPaths_.pathLeft:U.isHat(a)?this.steps_+=this.startPaths_.path(this.RTL_):U.isSpacer(a)&&a.width!==0&&(this.steps_+=ke("H",a.xPos+a.width-this.highlightOffset_));this.steps_+=ke("H",t.xPos+t.width-this.highlightOffset_)}drawJaggedEdge_(t){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+ke("v",t.height-this.jaggedTeethPaths_.height-this.highlightOffset_))}drawValueInput(t){const o=t.getLastInput();if(this.RTL_){const a=t.height-o.connectionHeight;this.steps_+=lr(o.xPos+o.width-this.highlightOffset_,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+ke("v",a)}else this.steps_+=lr(o.xPos+o.width,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(t){const o=t.getLastInput();if(o)if(this.RTL_){const a=t.height-2*this.insideCornerPaths_.height;this.steps_+=lr(o.xPos,t.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+ke("v",a)+this.insideCornerPaths_.pathBottom(this.RTL_)+Bn(t.width-o.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=lr(o.xPos,t.yPos+t.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+Bn(t.width-o.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(t){const o=t.xPos+t.width-this.highlightOffset_;t instanceof _g&&t.followsStatement&&(this.steps_+=ke("H",o)),this.RTL_&&(this.steps_+=ke("H",o),t.height>this.highlightOffset_&&(this.steps_+=ke("V",t.yPos+t.height-this.highlightOffset_)))}drawBottomRow(t){if(this.RTL_)this.steps_+=ke("V",t.baseline-this.highlightOffset_);else{const o=this.info_.bottomRow.elements[0];U.isLeftSquareCorner(o)?this.steps_+=lr(t.xPos+this.highlightOffset_,t.baseline-this.highlightOffset_):U.isLeftRoundedCorner(o)&&(this.steps_+=lr(t.xPos,t.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var t=this.info_.outputConnection;t&&(t=t.connectionOffsetY+t.height,this.RTL_?this.steps_+=lr(this.info_.startX,t):(this.steps_+=lr(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=ke("V",t)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(t=this.info_.topRow,U.isLeftRoundedCorner(t.elements[0])?this.steps_+=ke("V",this.outsideCornerPaths_.height):this.steps_+=ke("V",t.capline+this.highlightOffset_))}drawInlineInput(t){const o=this.highlightOffset_,a=t.xPos+t.connectionWidth;var d=t.centerline-t.height/2;const m=t.width-t.connectionWidth,b=d+o;this.RTL_?(d=t.connectionOffsetY-o,t=t.height-(t.connectionOffsetY+t.connectionHeight)+o,this.inlineSteps_+=lr(a-o,b)+ke("v",d)+this.puzzleTabPaths_.pathDown(this.RTL_)+ke("v",t)+ke("h",m)):this.inlineSteps_+=lr(t.xPos+t.width+o,b)+ke("v",t.height)+ke("h",-m)+lr(a,d+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},l2=class extends cc{constructor(t,o){super(t,o),this.highlighter_=new o2(o)}draw(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();const t=this.block_.pathObject;if(t.setPath(this.outlinePath_+`
`+this.inlinePath_),t.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&t.flipRTL(),Xh()){let o,a;(o=this.block_)==null||(a=o.renderingDebugger)==null||a.drawDebug(this.block_,this.info_)}this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(t){this.highlighter_.drawJaggedEdge_(t),super.drawJaggedEdge_(t)}drawValueInput_(t){this.highlighter_.drawValueInput(t),super.drawValueInput_(t)}drawStatementInput_(t){this.highlighter_.drawStatementInput(t),super.drawStatementInput_(t)}drawRightSideRow_(t){this.highlighter_.drawRightSideRow(t),this.outlinePath_+=ke("H",t.xPos+t.width)+ke("V",t.yPos+t.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(t){this.highlighter_.drawInlineInput(t),super.drawInlineInput_(t)}positionInlineInputConnection_(t){const o=t.centerline-t.height/2;if(t.connectionModel){let a=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(a*=-1),t.connectionModel.setOffsetInBlock(a,o+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(t){const o=t.getLastInput();if(o!=null&&o.connectionModel){let a=t.xPos+t.statementEdge+o.notchOffset;a=this.info_.RTL?-1*a:a+this.constants_.DARK_PATH_OFFSET,o.connectionModel.setOffsetInBlock(a,t.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(t){const o=t.getLastInput();if(o&&o.connectionModel){let a=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(a*=-1),o.connectionModel.setOffsetInBlock(a,t.yPos)}}positionNextConnection_(){const t=this.info_.bottomRow;if(t.connection){const o=t.connection,a=o.xPos;o.connectionModel.setOffsetInBlock((this.info_.RTL?-a:a)+this.constants_.DARK_PATH_OFFSET/2,t.baseline+this.constants_.DARK_PATH_OFFSET)}}},a2=class{constructor(t){this.OFFSET=.5,this.constantProvider=t,this.START_POINT=qt(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const t=this.constantProvider.CORNER_RADIUS,o=this.OFFSET,a=(1-Math.SQRT1_2)*(t+o)-o,d=qt(a,a)+bi("a","0 0,0",t,Me(-a-o,t-a)),m=bi("a","0 0,0",t+o,Me(t+o,t+o)),b=qt(a,-a)+bi("a","0 0,0",t+o,Me(t-a,a+o));return{width:t+o,height:t,pathTop(I){return I?d:""},pathBottom(I){return I?m:b}}}makeOutsideCorner(){const t=this.constantProvider.CORNER_RADIUS,o=this.OFFSET,a=(1-Math.SQRT1_2)*(t-o)+o,d=qt(a,a)+bi("a","0 0,1",t-o,Me(t-a,-a+o)),m=qt(o,t)+bi("a","0 0,1",t-o,Me(t,-t+o)),b=-a,I=qt(a,b)+bi("a","0 0,1",t-o,Me(-a+o,-b-t));return{height:t,topLeft(L){return L?d:m},bottomLeft(){return I}}}makePuzzleTab(){const t=this.constantProvider.TAB_WIDTH,o=this.constantProvider.TAB_HEIGHT,a=qt(-2,-o+3.4)+Bn(-.45*t,-2.1),d=ke("v",2.5)+qt(.97*-t,2.5)+Yr("q",[Me(.05*-t,10),Me(.3*t,9.5)])+qt(.67*t,-1.9)+ke("v",2.5),m=ke("v",-1.5)+qt(-.92*t,-.5)+Yr("q",[Me(-.19*t,-5.5),Me(0,-11)])+qt(.92*t,1),b=qt(-5,o-.7)+Bn(.46*t,-2.1);return{width:t,height:o,pathUp(I){return I?a:m},pathDown(I){return I?d:b}}}makeNotch(){return{pathLeft:ke("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:Bn(5.1,2.6)+qt(-10.2,6.8)+Bn(5.1,2.6),height:12,width:10.2}}makeStartHat(){const t=this.constantProvider.START_HAT.height,o=qt(25,-8.7)+Yr("c",[Me(29.7,-6.2),Me(57.2,-.5),Me(75,8.7)]),a=Yr("c",[Me(17.8,-9.2),Me(45.3,-14.9),Me(75,-8.7)])+lr(100.5,t+.5);return{path(d){return d?o:a}}}},u2=class extends mg{constructor(t,o){super(t,o),this.constants_=t,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},c2=class extends oc{constructor(t,o){super(t,o),this.constants_=t,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},h2=class extends wa{constructor(t,o){super(t,o),this.renderer_=t}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===it.STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(t,o){this.isInline&&t.type===it.VALUE?(o.elements.push(new u2(this.constants_,t)),o.hasInlineInput=!0):t.type===it.STATEMENT?(o.elements.push(new c2(this.constants_,t)),o.hasStatement=!0):t.type===it.VALUE?(o.elements.push(new wd(this.constants_,t)),o.hasExternalInput=!0):t.type===it.DUMMY&&(o.minHeight=Math.max(o.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),o.hasDummyInput=!0),this.isInline||o.align!==null||(o.align=t.align)}addElemSpacing_(){let t=!1;for(let a=0,d;d=this.rows[a];a++)d.hasExternalInput&&(t=!0);for(let a=0,d;d=this.rows[a];a++){var o=d.elements;if(d.elements=[],d.startsWithElemSpacer()&&d.elements.push(new jr(this.constants_,this.getInRowSpacing_(null,o[0]))),o.length){for(let m=0;m<o.length-1;m++){d.elements.push(o[m]);const b=this.getInRowSpacing_(o[m],o[m+1]);d.elements.push(new jr(this.constants_,b))}d.elements.push(o[o.length-1]),d.endsWithElemSpacer()&&(o=this.getInRowSpacing_(o[o.length-1],null),t&&d.hasDummyInput&&(o+=this.constants_.TAB_WIDTH),d.elements.push(new jr(this.constants_,o)))}}}getInRowSpacing_(t,o){if(!t)return o&&U.isField(o)&&o.isEditable?this.constants_.MEDIUM_PADDING:o&&U.isInlineInput(o)?this.constants_.MEDIUM_LARGE_PADDING:o&&U.isStatementInput(o)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!U.isInput(t)&&(!o||U.isStatementInput(o)))return U.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:U.isIcon(t)?2*this.constants_.LARGE_PADDING+1:U.isHat(t)?this.constants_.NO_PADDING:U.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:U.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:U.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(U.isInput(t)&&!o){if(U.isExternalInput(t))return this.constants_.NO_PADDING;if(U.isInlineInput(t))return this.constants_.LARGE_PADDING;if(U.isStatementInput(t))return this.constants_.NO_PADDING}if(!U.isInput(t)&&o&&U.isInput(o)){if(U.isField(t)&&t.isEditable){if(U.isInlineInput(o)||U.isExternalInput(o))return this.constants_.SMALL_PADDING}else{if(U.isInlineInput(o)||U.isExternalInput(o))return this.constants_.MEDIUM_LARGE_PADDING;if(U.isStatementInput(o))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(U.isIcon(t)&&o&&!U.isInput(o))return this.constants_.LARGE_PADDING;if(U.isInlineInput(t)&&o&&U.isField(o))return o.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(U.isLeftSquareCorner(t)&&o){if(U.isHat(o))return this.constants_.NO_PADDING;if(U.isPreviousConnection(o))return o.notchOffset;if(U.isNextConnection(o))return o.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(U.isLeftRoundedCorner(t)&&o){if(U.isPreviousConnection(o))return o.notchOffset-this.constants_.CORNER_RADIUS;if(U.isNextConnection(o))return o.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return U.isField(t)&&o&&U.isField(o)&&t.isEditable===o.isEditable||o&&U.isJaggedEdge(o)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(t,o){return U.isTopRow(t)&&U.isBottomRow(o)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:U.isTopRow(t)||U.isBottomRow(o)?this.constants_.NO_PADDING:t.hasExternalInput&&o.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&o.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&o.hasStatement||!t.hasStatement&&o.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(t,o){if(U.isSpacer(o))return t.yPos+o.height/2;if(U.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,U.isNextConnection(o)?t+o.height/2:t-o.height/2;if(U.isTopRow(t))return U.isHat(o)?t.capline-o.height/2:t.capline+o.height/2;let a=t.yPos;return U.isField(o)||U.isIcon(o)?(a+=o.height/2,(t.hasInlineInput||t.hasStatement)&&o.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=t.height&&(a+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):a=U.isInlineInput(o)?a+o.height/2:a+t.height/2,a}alignRowElements_(){if(this.isInline){var t=0,o=new WeakMap,a=null;for(let d=this.rows.length-1,m;m=this.rows[d];d--)o.set(m,t),U.isInputRow(m)&&(m.hasStatement&&this.alignStatementRow_(m),a&&a.hasStatement&&m.width<a.width?o.set(m,a.width):t=m.width,a=m);t=0;for(let d=0,m;m=this.rows[d];d++)m.hasStatement?t=this.getDesiredRowWidth_(m):U.isSpacer(m)?m.width=Math.max(t,o.get(m)):(a=m.width,t=Math.max(t,o.get(m))-a,0<t&&this.addAlignmentPadding_(m,t),t=m.width)}else super.alignRowElements_()}getDesiredRowWidth_(t){return this.isInline&&t.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(t)}finalize_(){let t=0,o=0;for(let d=0,m;m=this.rows[d];d++){m.yPos=o,m.xPos=this.startX,o+=m.height,t=Math.max(t,m.widthWithConnectedBlocks);var a=o-this.topRow.ascenderHeight;m===this.bottomRow&&a<this.constants_.MIN_BLOCK_HEIGHT&&(a=this.constants_.MIN_BLOCK_HEIGHT-a,this.bottomRow.height+=a,o+=a),this.recordElemPositions_(m)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(a=this.block_.nextConnection.targetBlock())&&(t=Math.max(t,a.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=o-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=o+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},d2=class extends Rd{constructor(t,o,a){super(t,o,a),this.constants=a,this.colourDark="#000000",this.svgPathDark=z(G.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=z(G.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(t){this.svgPath.setAttribute("d",t),this.svgPathDark.setAttribute("d",t)}setHighlightPath(t){this.svgPathLight.setAttribute("d",t)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(t){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(t),this.svgPath.setAttribute("stroke","none")}setStyle(t){this.style=t,this.colourDark=ta("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(t){t?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(t){if(t){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(t){super.updateDisabled_(t),t&&this.svgPath.setAttribute("stroke","none")}},f2=class extends hc{constructor(t){super(t),this.highlightConstants_=null}init(t,o){super.init(t,o),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()}refreshDom(t,o){super.refreshDom(t,o),this.getHighlightConstants().init()}makeConstants_(){return new n2}makeRenderInfo_(t){return new h2(this,t)}makeDrawer_(t,o){return new l2(t,o)}makePathObject(t,o){return new d2(t,o,this.getConstants())}makeHighlightConstants_(){return new a2(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants_)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants_}};Iu("geras",f2);var dn={};dn.ConstantProvider=n2,dn.Drawer=l2,dn.HighlightConstantProvider=a2,dn.Highlighter=o2,dn.InlineInput=u2,dn.PathObject=d2,dn.RenderInfo=h2,dn.Renderer=f2,dn.StatementInput=c2;var p2=class{constructor(t){this.container=t,this.previousSibling=null,this.createDom()}createDom(){this.SVG||(this.SVG=z(G.SVG,{xmlns:la,"xmlns:html":Ms,"xmlns:xlink":Or,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"}),this.container.appendChild(this.SVG))}translateSurface(t,o){t=Math.round(t),o=Math.round(o),this.SVG.style.display="block",Wr(this.SVG,"translate3d("+t+"px, "+o+"px, 0)")}getSurfaceTranslation(){return Ls(this.SVG)}clearAndHide(t){if(!t)throw Error("Couldn't clear and hide the drag surface: missing new surface.");const o=this.SVG.childNodes[0],a=this.SVG.childNodes[1];if(!o||!a||!o.classList.contains("blocklyBlockCanvas")&&a.classList.contains("blocklyBubbleCanvas"))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(this.previousSibling!==null?pi(o,this.previousSibling):t.insertBefore(o,t.firstChild),pi(a,o),this.SVG.style.display="none",this.SVG.childNodes.length)throw Error("Drag surface was not cleared.");Wr(this.SVG,""),this.previousSibling=null}setContentsAndShow(t,o,a,d,m,b){if(this.SVG.childNodes.length)throw Error("Already dragging a block.");this.previousSibling=a,t.setAttribute("transform","translate(0, 0) scale("+b+")"),o.setAttribute("transform","translate(0, 0) scale("+b+")"),this.SVG.setAttribute("width",String(d)),this.SVG.setAttribute("height",String(m)),this.SVG.appendChild(t),this.SVG.appendChild(o),this.SVG.style.display="block"}},m2=class{constructor(t){this.container=t,this.scale=1,this.surfaceXY=new ve(0,0),this.childSurfaceXY=new ve(0,0),this.svg=z(G.SVG,{xmlns:la,"xmlns:html":Ms,"xmlns:xlink":Or,version:"1.1",class:"blocklyBlockDragSurface"},this.container),this.dragGroup=z(G.G,{},this.svg)}createDom(){s("BlockDragSurfaceSvg createDom","June 2022","June 2023")}setBlocksAndShow(t){if(this.dragGroup.childNodes.length)throw Error("Already dragging a block.");this.dragGroup.appendChild(t),this.svg.style.display="block",this.surfaceXY=new ve(0,0)}translateAndScaleGroup(t,o,a){this.scale=a,t=Math.round(t),o=Math.round(o),this.childSurfaceXY.x=t,this.childSurfaceXY.y=o,this.dragGroup.setAttribute("transform","translate("+t+","+o+") scale("+a+")")}translateSurfaceInternal_(){const t=Math.round(this.surfaceXY.x),o=Math.round(this.surfaceXY.y);this.svg.style.display="block",Wr(this.svg,"translate3d("+t+"px, "+o+"px, 0)")}translateBy(t,o){this.surfaceXY=new ve(this.surfaceXY.x+t,this.surfaceXY.y+o),this.translateSurfaceInternal_()}translateSurface(t,o){this.surfaceXY=new ve(t*this.scale,o*this.scale),this.translateSurfaceInternal_()}getSurfaceTranslation(){const t=Ls(this.svg);return new ve(t.x/this.scale,t.y/this.scale)}getGroup(){return this.dragGroup}getSvgRoot(){return this.svg}getCurrentBlock(){return this.dragGroup.firstChild}getWsTranslation(){return this.childSurfaceXY.clone()}clearAndHide(t){const o=this.getCurrentBlock();if(o&&(t?t.appendChild(o):this.dragGroup.removeChild(o)),this.svg.style.display="none",this.dragGroup.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY=new ve(0,0)}},Nd={};Nd.bumpIntoBounds=jh,Nd.bumpIntoBoundsHandler=l$,Nd.bumpTopObjectsIntoBounds=om;var Ag=class{constructor(t,o,a,d,m){this.workspace=t,this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null,o=o===void 0?!0:o,a=a===void 0?!0:a;const b=o&&a;o&&(this.hScroll=new ii(t,!0,b,d,m)),a&&(this.vScroll=new ii(t,!1,b,d,m)),b&&(this.corner_=z(G.RECT,{height:ii.scrollbarThickness,width:ii.scrollbarThickness,class:"blocklyScrollbarBackground"}),pi(this.corner_,t.getBubbleCanvas()))}dispose(){ft(this.corner_),this.oldHostMetrics_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const t=this.workspace.getMetrics();if(t){var o=!1,a=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===t.viewWidth&&this.oldHostMetrics_.viewHeight===t.viewHeight&&this.oldHostMetrics_.absoluteTop===t.absoluteTop&&this.oldHostMetrics_.absoluteLeft===t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===t.scrollWidth&&this.oldHostMetrics_.viewLeft===t.viewLeft&&this.oldHostMetrics_.scrollLeft===t.scrollLeft||(o=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===t.scrollHeight&&this.oldHostMetrics_.viewTop===t.viewTop&&this.oldHostMetrics_.scrollTop===t.scrollTop||(a=!0)):a=o=!0,o||a){try{Ci(),this.hScroll&&o&&this.hScroll.resize(t),this.vScroll&&a&&this.vScroll.resize(t)}finally{Oi()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==t.viewWidth||this.oldHostMetrics_.absoluteLeft!==t.absoluteLeft){let d;(d=this.corner_)==null||d.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==t.viewHeight||this.oldHostMetrics_.absoluteTop!==t.absoluteTop){let d;(d=this.corner_)==null||d.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics_=t}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(t,o){this.hScroll&&this.hScroll.setOrigin(t,o),this.vScroll&&this.vScroll.setOrigin(t,o)}set(t,o,a){this.hScroll&&this.hScroll.set(t,!1),this.vScroll&&this.vScroll.set(o,!1),(a||a===void 0)&&(t={},this.hScroll&&(t.x=this.hScroll.getRatio_()),this.vScroll&&(t.y=this.vScroll.getRatio_()),this.workspace.setMetrics(t))}setX(t){this.hScroll&&this.hScroll.set(t,!0)}setY(t){this.vScroll&&this.vScroll.set(t,!0)}setContainerVisible(t){this.hScroll&&this.hScroll.setContainerVisible(t),this.vScroll&&this.vScroll.setContainerVisible(t)}isVisible(){let t=!1;return this.hScroll&&(t=this.hScroll.isVisible()),this.vScroll&&(t=t||this.vScroll.isVisible()),t}resizeContent(t){this.hScroll&&this.hScroll.resizeContentHorizontal(t),this.vScroll&&this.vScroll.resizeContentVertical(t)}resizeView(t){this.hScroll&&this.hScroll.resizeViewHorizontal(t),this.vScroll&&this.vScroll.resizeViewVertical(t)}},g2=!1;i.CodeGenerator$$module$build$src$core$generator=class{constructor(t){this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=re());var o=[];this.init(t),t=t.getTopBlocks(!0);for(let a=0,d;d=t[a];a++){let m=this.blockToCode(d);Array.isArray(m)&&(m=m[0]),m&&(d.outputConnection&&(m=this.scrubNakedValue(m),this.STATEMENT_PREFIX&&!d.suppressPrefixSuffix&&(m=this.injectId(this.STATEMENT_PREFIX,d)+m),this.STATEMENT_SUFFIX&&!d.suppressPrefixSuffix&&(m+=this.injectId(this.STATEMENT_SUFFIX,d))),o.push(m))}return o=o.join(`
`),o=this.finish(o),o=o.replace(/^\s+\n/,""),o=o.replace(/\n\s+$/,`
`),o=o.replace(/[ \t]+\n/g,`
`)}prefixLines(t,o){return o+t.replace(/(?!\n$)\n/g,`
`+o)}allNestedComments(t){const o=[];t=t.getDescendants(!0);for(let a=0;a<t.length;a++){const d=t[a].getCommentText();d&&o.push(d)}return o.length&&o.push(""),o.join(`
`)}blockToCode(t,o){if(this.isInitialized===!1&&console.warn("CodeGenerator init was not called before blockToCode was called."),!t)return"";if(!t.isEnabled())return o?"":this.blockToCode(t.getNextBlock());if(t.isInsertionMarker())return o?"":this.blockToCode(t.getChildren(!1)[0]);var a=this[t.type];if(typeof a!="function")throw Error('Language "'+this.name_+'" does not know how to generate code for block type "'+t.type+'".');if(a=a.call(t,t),Array.isArray(a)){if(!t.outputConnection)throw TypeError("Expecting string from statement block: "+t.type);return[this.scrub_(t,a[0],o),a[1]]}if(typeof a=="string")return this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(a=this.injectId(this.STATEMENT_PREFIX,t)+a),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(a+=this.injectId(this.STATEMENT_SUFFIX,t)),this.scrub_(t,a,o);if(a===null)return"";throw SyntaxError("Invalid code generated: "+a)}valueToCode(t,o,a){if(isNaN(a))throw TypeError("Expecting valid order from block: "+t.type);var d=t.getInputTargetBlock(o);if(!d||(o=this.blockToCode(d),o===""))return"";if(!Array.isArray(o))throw TypeError("Expecting tuple from value block: "+d.type);if(t=o[0],o=o[1],isNaN(o))throw TypeError("Expecting valid order from value block: "+d.type);if(!t)return"";d=!1;var m=Math.floor(a);const b=Math.floor(o);if(m<=b&&(m!==b||m!==0&&m!==99)){for(d=!0,m=0;m<this.ORDER_OVERRIDES.length;m++)if(this.ORDER_OVERRIDES[m][0]===a&&this.ORDER_OVERRIDES[m][1]===o){d=!1;break}}return d&&(t="("+t+")"),t}statementToCode(t,o){if(t=t.getInputTargetBlock(o),o=this.blockToCode(t),typeof o!="string")throw TypeError("Expecting code from statement block: "+(t&&t.type));return o&&(o=this.prefixLines(o,this.INDENT)),o}addLoopTrap(t,o){return this.INFINITE_LOOP_TRAP&&(t=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,o),this.INDENT)+t),this.STATEMENT_SUFFIX&&!o.suppressPrefixSuffix&&(t=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,o),this.INDENT)+t),this.STATEMENT_PREFIX&&!o.suppressPrefixSuffix&&(t+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,o),this.INDENT)),t}injectId(t,o){return o=o.id.replace(/\$/g,"$$$$"),t.replace(/%1/g,"'"+o+"'")}addReservedWords(t){this.RESERVED_WORDS_+=t+","}provideFunction_(t,o){if(!this.definitions_[t]){const a=this.nameDB_.getDistinctName(t,i.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[t]=a,Array.isArray(o)&&(o=o.join(`
`)),o=o.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,a);let d;for(;d!==o;)d=o,o=o.replace(/^(( {2})*) {2}/gm,"$1\0");o=o.replace(/\0/g,this.INDENT),this.definitions_[t]=o}return this.functionNames_[t]}init(t){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(t,o,a){return o}finish(t){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),t}scrubNakedValue(t){return t}},Object.defineProperties(i.CodeGenerator$$module$build$src$core$generator.prototype,{variableDB_:{get(){return s("variableDB_","version 9","version 10","nameDB_"),this.nameDB_},set(t){s("variableDB_","version 9","version 10","nameDB_"),this.nameDB_=t}}}),i.CodeGenerator$$module$build$src$core$generator;var Ra=class{constructor(t,o,a,d){this.workspace=t,this.targetWorkspace=o,this.isLabel_=d,this.onMouseUpWrapper_=null,this.height=this.width=0,this.svgText_=this.svgGroup_=null,this.text_=a.text,this.position_=new ve(0,0),this.callbackKey_=a.callbackKey||a.callbackkey,this.cssClass_=a["web-class"]||null,this.info=a}createDom(){var t=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass_&&(t+=" "+this.cssClass_),this.svgGroup_=z(G.G,{class:t},this.workspace.getCanvas());let o;this.isLabel_||(o=z(G.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_)),t=z(G.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);const a=z(G.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_);var d=oi(this.text_);this.workspace.RTL&&(d+="‏"),a.textContent=d,this.isLabel_&&(this.svgText_=a,this.workspace.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));const m=Rs(a,"fontSize"),b=Rs(a,"fontWeight"),I=Rs(a,"fontFamily");if(this.width=po(a,m,b,I),d=ws(d,m,b,I),this.height=d.height,!this.isLabel_){this.width+=2*Ra.TEXT_MARGIN_X,this.height+=2*Ra.TEXT_MARGIN_Y;let L;(L=o)==null||L.setAttribute("width",this.width.toString());let oe;(oe=o)==null||oe.setAttribute("height",this.height.toString())}return t.setAttribute("width",this.width.toString()),t.setAttribute("height",this.height.toString()),a.setAttribute("x",(this.width/2).toString()),a.setAttribute("y",(this.height/2-d.height/2+d.baseline).toString()),this.updateTransform_(),this.onMouseUpWrapper_=y(this.svgGroup_,"pointerup",this,this.onMouseUp_),this.svgGroup_}show(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")}updateTransform_(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")}moveTo(t,o){this.position_.x=t,this.position_.y=o,this.updateTransform_()}isLabel(){return this.isLabel_}getPosition(){return this.position_}getButtonText(){return this.text_}getTargetWorkspace(){return this.targetWorkspace}dispose(){this.onMouseUpWrapper_&&C(this.onMouseUpWrapper_),this.svgGroup_&&ft(this.svgGroup_),this.svgText_&&this.workspace.getThemeManager().unsubscribe(this.svgText_)}onMouseUp_(t){(t=this.targetWorkspace.getGesture(t))&&t.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace.getButtonCallback(this.callbackKey_)?this.isLabel_||(t=this.targetWorkspace.getButtonCallback(this.callbackKey_))&&t(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)}};Ra.TEXT_MARGIN_X=5,Ra.TEXT_MARGIN_Y=2,Ds(`
.blocklyFlyoutButton {
  fill: #888;
  cursor: default;
}

.blocklyFlyoutButtonShadow {
  fill: #666;
}

.blocklyFlyoutButton:hover {
  fill: #aaa;
}

.blocklyFlyoutLabel {
  cursor: default;
}

.blocklyFlyoutLabelBackground {
  opacity: 0;
}
`);var Cg=class{constructor(t){this.workspace_=t}getDimensionsPx_(t){let o=0,a=0;return t&&(o=t.getWidth(),a=t.getHeight()),new Xi(o,a)}getFlyoutMetrics(t){return t=this.getDimensionsPx_(this.workspace_.getFlyout(t)),{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const t=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let t=0;const o=this.getToolboxMetrics(),a=this.getFlyoutMetrics(!0),d=!!this.workspace_.getToolbox(),m=!!this.workspace_.getFlyout(!0);var b=d?o.position:a.position,I=b===Je.LEFT;return b=b===Je.TOP,d&&I?t=o.width:m&&I&&(t=a.width),I=0,d&&b?I=o.height:m&&b&&(I=a.height),{top:I,left:t}}getViewMetrics(t){t=t?this.workspace_.scale:1;const o=this.getSvgMetrics(),a=this.getToolboxMetrics(),d=this.getFlyoutMetrics(!0),m=this.workspace_.getToolbox()?a.position:d.position;return this.workspace_.getToolbox()?m===Je.TOP||m===Je.BOTTOM?o.height-=a.height:(m===Je.LEFT||m===Je.RIGHT)&&(o.width-=a.width):this.workspace_.getFlyout(!0)&&(m===Je.TOP||m===Je.BOTTOM?o.height-=d.height:(m===Je.LEFT||m===Je.RIGHT)&&(o.width-=d.width)),{height:o.height/t,width:o.width/t,top:-this.workspace_.scrollY/t,left:-this.workspace_.scrollX/t}}getContentMetrics(t){t=t?1:this.workspace_.scale;const o=this.workspace_.getBlocksBoundingBox();return{height:(o.bottom-o.top)*t,width:(o.right-o.left)*t,top:o.top*t,left:o.left*t}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(t){if(!this.hasFixedEdges())return{};const o=this.workspace_.isMovableHorizontally(),a=this.workspace_.isMovableVertically();t=t||this.getViewMetrics(!1);const d={};return a||(d.top=t.top,d.bottom=t.top+t.height),o||(d.left=t.left,d.right=t.left+t.width),d}getPaddedContent_(t,o){const a=o.top+o.height,d=o.left+o.width,m=t.width;t=t.height;const b=m/2,I=t/2;return{top:Math.min(o.top-I,a-t),bottom:Math.max(a+I,o.top+t),left:Math.min(o.left-b,d-m),right:Math.max(d+b,o.left+m)}}getScrollMetrics(t,o,a){t=t?this.workspace_.scale:1,o=o||this.getViewMetrics(!1);var d=a||this.getContentMetrics();a=this.getComputedFixedEdges_(o),o=this.getPaddedContent_(o,d),d=a.top!==void 0?a.top:o.top;const m=a.left!==void 0?a.left:o.left;return{top:d/t,left:m/t,width:((a.right!==void 0?a.right:o.right)-m)/t,height:((a.bottom!==void 0?a.bottom:o.bottom)-d)/t}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const t=this.getToolboxMetrics(),o=this.getFlyoutMetrics(!0),a=this.getSvgMetrics(),d=this.getAbsoluteMetrics(),m=this.getViewMetrics(),b=this.getContentMetrics(),I=this.getScrollMetrics(!1,m,b);return{contentHeight:b.height,contentWidth:b.width,contentTop:b.top,contentLeft:b.left,scrollHeight:I.height,scrollWidth:I.width,scrollTop:I.top,scrollLeft:I.left,viewHeight:m.height,viewWidth:m.width,viewTop:m.top,viewLeft:m.left,absoluteTop:d.top,absoluteLeft:d.left,svgHeight:a.height,svgWidth:a.width,toolboxWidth:t.width,toolboxHeight:t.height,toolboxPosition:t.position,flyoutWidth:o.width,flyoutHeight:o.height}}};tt(fe.METRICS_MANAGER,Hn,Cg);var _2=class extends Cg{constructor(t,o){super(t),this.flyout_=o}getBoundingBox_(){let t;try{t=this.workspace_.getCanvas().getBBox()}catch{t={height:0,y:0,width:0,x:0}}return t}getContentMetrics(t){const o=this.getBoundingBox_();return t=t?1:this.workspace_.scale,{height:o.height*t,width:o.width*t,top:o.y*t,left:o.x*t}}getScrollMetrics(t,o,a){return o=a||this.getContentMetrics(),a=this.flyout_.MARGIN*this.workspace_.scale,t=t?this.workspace_.scale:1,{height:(o.height+2*a)/t,width:(o.width+o.left+a)/t,top:0,left:0}}},Na;(function(t){t.BLOCK="block",t.BUTTON="button"})(Na||(Na={}));var xd=class extends kd{constructor(t){super(),this.horizontalLayout=!1,this.eventWrappers_=[],this.filterWrapper_=this.reflowWrapper_=null,this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.recycledBlocks_=[],this.autoClose=!0,this.isVisible_=!1,this.containerVisible_=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new zs(t),this.workspace_.setMetricsManager(new _2(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=Ns(),this.RTL=!!t.RTL,this.toolboxPosition_=t.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(t){return this.svgGroup_=z(t,{class:"blocklyFlyout",style:"display: none"}),this.svgBackground_=z(G.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(t){this.targetWorkspace=t,this.workspace_.targetWorkspace=t,this.workspace_.scrollbar=new Ag(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),Array.prototype.push.apply(this.eventWrappers_,y(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,y(this.svgBackground_,"pointerdown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),t.getComponentManager().addComponent({component:this,weight:1,capabilities:[ji.Capability.DELETE_AREA,ji.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.workspace_.getComponentManager().removeComponent(this.id),C(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&(ft(this.svgGroup_),this.svgGroup_=null),this.svgBackground_=null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}isVisible(){return this.isVisible_}setVisible(t){const o=t!==this.isVisible();this.isVisible_=t,o&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay_())}setContainerVisible(t){const o=t!==this.containerVisible_;this.containerVisible_=t,o&&this.updateDisplay_()}updateDisplay_(){let t;t=this.containerVisible_?this.isVisible():!1,this.svgGroup_&&(this.svgGroup_.style.display=t?"block":"none");let o;(o=this.workspace_.scrollbar)==null||o.setContainerVisible(t)}positionAt_(t,o,a,d){let m;(m=this.svgGroup_)==null||m.setAttribute("width",t.toString());let b;(b=this.svgGroup_)==null||b.setAttribute("height",o.toString()),this.workspace_.setCachedParentSvgSize(t,o);let I;if(((I=this.svgGroup_)==null?void 0:I.tagName)==="svg")Wr(this.svgGroup_,"translate("+a+"px,"+d+"px)");else{let L;(L=this.svgGroup_)==null||L.setAttribute("transform","translate("+a+","+d+")")}(t=this.workspace_.scrollbar)&&(t.setOrigin(a,d),t.resize(),t.hScroll&&t.hScroll.setPosition(t.hScroll.position.x,t.hScroll.position.y),t.vScroll&&t.vScroll.setPosition(t.vScroll.position.x,t.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(!1);for(let t=0,o;o=this.listeners_[t];t++)C(o);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}}show(t){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),typeof t=="string"&&(t=this.getDynamicCategoryContents_(t)),this.setVisible(!0),t=Uh(t),t=this.createFlyoutInfo_(t),this.layout_(t.contents,t.gaps),this.listeners_.push(y(this.svgBackground_,"pointerover",this,function(){const o=this.workspace_.getTopBlocks(!1);for(let a=0,d;d=o[a];a++)d.removeSelect()})),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_),this.emptyRecycledBlocks_()}createFlyoutInfo_(t){const o=[],a=[];this.permanentlyDisabled_.length=0;const d=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(let b=0,I;I=t[b];b++){if("custom"in I){var m=this.getDynamicCategoryContents_(I.custom);m=Uh(m),t.splice.apply(t,[b,1,...m]),I=t[b]}switch(I.kind.toUpperCase()){case"BLOCK":m=I;const L=this.createFlyoutBlock_(m);o.push({type:Na.BLOCK,block:L}),this.addBlockGap_(m,a,d);break;case"SEP":this.addSeparatorGap_(I,a,d);break;case"LABEL":m=this.createButton_(I,!0),o.push({type:Na.BUTTON,button:m}),a.push(d);break;case"BUTTON":m=this.createButton_(I,!1),o.push({type:Na.BUTTON,button:m}),a.push(d)}}return{contents:o,gaps:a}}getDynamicCategoryContents_(t){if(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t),typeof t!="function")throw TypeError("Couldn't find a callback function when opening a toolbox category.");return t(this.workspace_.targetWorkspace)}createButton_(t,o){return new Ra(this.workspace_,this.targetWorkspace,t,o)}createFlyoutBlock_(t){let o;return t.blockxml?(t=typeof t.blockxml=="string"?mr(t.blockxml):t.blockxml,(o=this.getRecycledBlock_(t.getAttribute("type")))||(o=ea(t,this.workspace_))):(o=this.getRecycledBlock_(t.type),o||(t.enabled===void 0&&(t.enabled=t.disabled!=="true"&&t.disabled!==!0),o=al(t,this.workspace_))),o.isEnabled()||this.permanentlyDisabled_.push(o),o}getRecycledBlock_(t){let o=-1;for(let a=0;a<this.recycledBlocks_.length;a++)if(this.recycledBlocks_[a].type===t){o=a;break}return o===-1?void 0:this.recycledBlocks_.splice(o,1)[0]}addBlockGap_(t,o,a){let d;t.gap?d=parseInt(t.gap.toString()):t.blockxml&&(t=typeof t.blockxml=="string"?mr(t.blockxml):t.blockxml,d=parseInt(t.getAttribute("gap"))),o.push(!d||isNaN(d)?a:d)}addSeparatorGap_(t,o,a){t=parseInt(t.gap.toString()),!isNaN(t)&&0<o.length?o[o.length-1]=t:o.push(a)}clearOldBlocks_(){var t=this.workspace_.getTopBlocks(!1);for(let a=0,d;d=t[a];a++)this.blockIsRecyclable_(d)?this.recycleBlock_(d):d.dispose(!1,!1);for(t=0;t<this.mats_.length;t++){const a=this.mats_[t];a&&(Mh(a),ft(a))}this.mats_.length=0;for(let a=0,d;d=this.buttons_[a];a++)d.dispose();this.buttons_.length=0;let o;(o=this.workspace_.getPotentialVariableMap())==null||o.clear()}emptyRecycledBlocks_(){for(let t=0;t<this.recycledBlocks_.length;t++)this.recycledBlocks_[t].dispose();this.recycledBlocks_=[]}blockIsRecyclable_(t){return!1}recycleBlock_(t){const o=t.getRelativeToSurfaceXY();t.moveBy(-o.x,-o.y),this.recycledBlocks_.push(t)}addBlockListeners_(t,o,a){this.listeners_.push(y(t,"pointerdown",null,this.blockMouseDown_(o))),this.listeners_.push(y(a,"pointerdown",null,this.blockMouseDown_(o))),this.listeners_.push(R(t,"pointerenter",o,o.addSelect)),this.listeners_.push(R(t,"pointerleave",o,o.removeSelect)),this.listeners_.push(R(a,"pointerenter",o,o.addSelect)),this.listeners_.push(R(a,"pointerleave",o,o.removeSelect))}blockMouseDown_(t){return o=>{const a=this.targetWorkspace.getGesture(o);a&&(a.setStartBlock(t),a.handleFlyoutStart(o,this))}}onMouseDown_(t){const o=this.targetWorkspace.getGesture(t);o&&o.handleFlyoutStart(t,this)}isBlockCreatable(t){return t.isEnabled()}createBlock(t){let o=null;Ci();var a=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{o=this.placeNewBlock_(t)}finally{Oi()}if(this.targetWorkspace.hideChaff(),t=Cp(this.targetWorkspace,a),Pi()){for(He(!0),a=0;a<t.length;a++){const d=t[a];De(new(Le(fl))(d))}De(new(Le(Ji))(o))}return this.autoClose?this.hide():this.filterForCapacity_(),o}initFlyoutButton_(t,o,a){const d=t.createDom();t.moveTo(o,a),t.show(),this.listeners_.push(y(d,"pointerdown",this,this.onMouseDown_)),this.buttons_.push(t)}createRect_(t,o,a,d,m){return o=z(G.RECT,{"fill-opacity":0,x:o,y:a,height:d.height,width:d.width}),o.tooltip=t,Lh(o),this.workspace_.getCanvas().insertBefore(o,t.getSvgRoot()),this.rectMap_.set(t,o),this.mats_[m]=o}moveRectToBlock_(t,o){const a=o.getHeightWidth();t.setAttribute("width",a.width.toString()),t.setAttribute("height",a.height.toString()),o=o.getRelativeToSurfaceXY(),t.setAttribute("y",o.y.toString()),t.setAttribute("x",(this.RTL?o.x-a.width:o.x).toString())}filterForCapacity_(){const t=this.workspace_.getTopBlocks(!1);for(let o=0,a;a=t[o];o++)if(this.permanentlyDisabled_.indexOf(a)===-1){const d=this.targetWorkspace.isCapacityAvailable(we(a));for(;a;)a.setEnabled(d),a=a.getNextBlock()}}reflow(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)}isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():!1}placeNewBlock_(t){var o=this.targetWorkspace;if(!t.getSvgRoot())throw Error("oldBlock is not rendered.");const a=Pn(t);return o.setResizesEnabled(!1),o=al(a,o),this.positionNewBlock_(t,o),o}positionNewBlock_(t,o){const a=this.targetWorkspace;var d=a.getOriginOffsetInPixels(),m=this.workspace_.getOriginOffsetInPixels();t=t.getRelativeToSurfaceXY(),t.scale(this.workspace_.scale),m=ve.sum(m,t),d=ve.difference(m,d),d.scale(1/a.scale),o.moveTo(new ve(d.x,d.y))}};xd.FlyoutItemType=Na;var Og=class extends xd{constructor(t){super(t)}setMetrics_(t){if(this.isVisible()){var o=this.workspace_.getMetricsManager(),a=o.getScrollMetrics(),d=o.getViewMetrics();o=o.getAbsoluteMetrics(),typeof t.y=="number"&&(this.workspace_.scrollY=-(a.top+(a.height-d.height)*t.y)),this.workspace_.translate(this.workspace_.scrollX+o.left,this.workspace_.scrollY+o.top)}}getX(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager();const o=t.getAbsoluteMetrics(),a=t.getViewMetrics();return t=t.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Je.LEFT?t.width:a.width-this.width_:this.toolboxPosition_===Je.LEFT?0:a.width:this.toolboxPosition_===Je.LEFT?0:a.width+o.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=t.height,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,t.height-2*this.CORNER_RADIUS),t=this.getX();var o=this.getY();this.positionAt_(this.width_,this.height_,t,o)}}setBackgroundPath_(t,o){const a=this.toolboxPosition_===Je.RIGHT;var d=t+this.CORNER_RADIUS;d=["M "+(a?d:0)+",0"],d.push("h",a?-t:t),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,a?0:1,a?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("v",Math.max(0,o)),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,a?0:1,a?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("h",a?t:-t),d.push("z"),this.svgBackground_.setAttribute("d",d.join(" "))}scrollToStart(){let t;(t=this.workspace_.scrollbar)==null||t.setY(0)}wheel_(t){var o=q(t);if(o.y){const a=this.workspace_.getMetricsManager(),d=a.getScrollMetrics();o=a.getViewMetrics().top-d.top+o.y;let m;(m=this.workspace_.scrollbar)==null||m.setY(o),tn(),en()}t.preventDefault(),t.stopPropagation()}layout_(t,o){this.workspace_.scale=this.targetWorkspace.scale;var a=this.MARGIN;const d=this.RTL?a:a+this.tabWidth_;for(let L=0,oe;oe=t[L];L++)if(oe.type==="block"){var m=oe.block,b=m.getDescendants(!1);for(let yt=0,Jt;Jt=b[yt];yt++)Jt.isInFlyout=!0;m.render(),b=m.getSvgRoot();const ye=m.getHeightWidth();var I=m.outputConnection?d-this.tabWidth_:d;m.moveBy(I,a),I=this.createRect_(m,this.RTL?I-ye.width:I,a,ye,L),this.addBlockListeners_(b,m,I),a+=ye.height+o[L]}else oe.type==="button"&&(m=oe.button,this.initFlyoutButton_(m,d,a),a+=m.height+o[L])}isDragTowardWorkspace(t){t=Math.atan2(t.y,t.x)/Math.PI*180;const o=this.dragAngleRange_;return t<o&&t>-o||t<-180+o||t>180-o}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const t=this.svgGroup_.getBoundingClientRect(),o=t.left;return this.toolboxPosition_===Je.LEFT?new li(-1e9,1e9,-1e9,o+t.width):new li(-1e9,1e9,o,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let t=0;var o=this.workspace_.getTopBlocks(!1);for(let d=0,m;m=o[d];d++){var a=m.getHeightWidth().width;m.outputConnection&&(a-=this.tabWidth_),t=Math.max(t,a)}for(let d=0,m;m=this.buttons_[d];d++)t=Math.max(t,m.width);if(t+=1.5*this.MARGIN+this.tabWidth_,t*=this.workspace_.scale,t+=ii.scrollbarThickness,this.width_!==t){for(let d=0,m;m=o[d];d++){if(this.RTL){a=m.getRelativeToSurfaceXY().x;let b=t/this.workspace_.scale-this.MARGIN;m.outputConnection||(b-=this.tabWidth_),m.moveBy(b-a,0)}this.rectMap_.has(m)&&this.moveRectToBlock_(this.rectMap_.get(m),m)}if(this.RTL)for(let d=0,m;m=this.buttons_[d];d++)o=m.getPosition().y,m.moveTo(t/this.workspace_.scale-m.width-this.MARGIN-this.tabWidth_,o);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==Je.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+t,this.targetWorkspace.scrollY),this.width_=t,this.position(),this.targetWorkspace.recordDragTargets()}}};Og.registryName="verticalFlyout",tt(fe.FLYOUTS_VERTICAL_TOOLBOX,Hn,Og);var b2=class extends xd{constructor(t){super(t),this.horizontalLayout=!0}setMetrics_(t){if(this.isVisible()){var o=this.workspace_.getMetricsManager(),a=o.getScrollMetrics(),d=o.getViewMetrics();o=o.getAbsoluteMetrics(),typeof t.x=="number"&&(this.workspace_.scrollX=-(a.left+(a.width-d.width)*t.x)),this.workspace_.translate(this.workspace_.scrollX+o.left,this.workspace_.scrollY+o.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager();const o=t.getAbsoluteMetrics(),a=t.getViewMetrics();t=t.getToolboxMetrics();const d=this.toolboxPosition_===Je.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?d?t.height:a.height-this.height_:d?0:a.height:d?0:a.height+o.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=t.width,this.setBackgroundPath_(t.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),t=this.getX();var o=this.getY();this.positionAt_(this.width_,this.height_,t,o)}}setBackgroundPath_(t,o){const a=this.toolboxPosition_===Je.TOP,d=["M 0,"+(a?0:this.CORNER_RADIUS)];a?(d.push("h",t+2*this.CORNER_RADIUS),d.push("v",o),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("h",-t),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),d.push("h",t),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("v",o),d.push("h",-t-2*this.CORNER_RADIUS)),d.push("z"),this.svgBackground_.setAttribute("d",d.join(" "))}scrollToStart(){let t;(t=this.workspace_.scrollbar)==null||t.setX(this.RTL?1/0:0)}wheel_(t){var o=q(t);if(o=o.x||o.y){const a=this.workspace_.getMetricsManager(),d=a.getScrollMetrics();o=a.getViewMetrics().left-d.left+o;let m;(m=this.workspace_.scrollbar)==null||m.setX(o),tn(),en()}t.preventDefault(),t.stopPropagation()}layout_(t,o){this.workspace_.scale=this.targetWorkspace.scale;const a=this.MARGIN;let d=a+this.tabWidth_;this.RTL&&(t=t.reverse());for(let L=0,oe;oe=t[L];L++)if(oe.type==="block"){var m=oe.block,b=m.getDescendants(!1);for(let yt=0,Jt;Jt=b[yt];yt++)Jt.isInFlyout=!0;m.render(),b=m.getSvgRoot();const ye=m.getHeightWidth();var I=m.outputConnection?this.tabWidth_:0;I=this.RTL?d+ye.width:d-I,m.moveBy(I,a),I=this.createRect_(m,I,a,ye,L),d+=ye.width+o[L],this.addBlockListeners_(b,m,I)}else oe.type==="button"&&(m=oe.button,this.initFlyoutButton_(m,d,a),d+=m.width+o[L])}isDragTowardWorkspace(t){t=Math.atan2(t.y,t.x)/Math.PI*180;const o=this.dragAngleRange_;return t<90+o&&t>90-o||t>-90-o&&t<-90+o}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const t=this.svgGroup_.getBoundingClientRect(),o=t.top;return this.toolboxPosition_===Je.TOP?new li(-1e9,o+t.height,-1e9,1e9):new li(o,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let t=0;const o=this.workspace_.getTopBlocks(!1);for(let d=0,m;m=o[d];d++)t=Math.max(t,m.getHeightWidth().height);const a=this.buttons_;for(let d=0,m;m=a[d];d++)t=Math.max(t,m.height);if(t+=1.5*this.MARGIN,t*=this.workspace_.scale,t+=ii.scrollbarThickness,this.height_!==t){for(let d=0,m;m=o[d];d++)this.rectMap_.has(m)&&this.moveRectToBlock_(this.rectMap_.get(m),m);this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==Je.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+t),this.height_=t,this.position(),this.targetWorkspace.recordDragTargets()}}};tt(fe.FLYOUTS_HORIZONTAL_TOOLBOX,Hn,b2);var pc=class extends Gs{constructor(t,o,a,d,m){super(pt.SKIP_SETUP),this.defaultType_="",this.variableTypes=[],this.variable_=null,this.SERIALIZABLE=!0,this.menuGenerator_=pc.dropdownCreate,this.defaultVariableName=typeof t=="string"?t:"",this.size_=new Xi(0,0),t!==pt.SKIP_SETUP&&(m?this.configure_(m):this.setTypes_(a,d),o&&this.setValidator(o))}configure_(t){super.configure_(t),this.setTypes_(t.variableTypes,t.defaultType)}initModel(){var t=this.getSourceBlock();if(!t)throw new Ei;this.variable_||(t=wh(t.workspace,null,this.defaultVariableName,this.defaultType_),this.doValueUpdate_(t.getId()))}shouldAddBorderRect_(){const t=this.getSourceBlock();if(!t)throw new Ei;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||t.type!=="variables_get")}fromXml(t){var o=this.getSourceBlock();if(!o)throw new Ei;const a=t.getAttribute("id"),d=t.textContent,m=t.getAttribute("variabletype")||t.getAttribute("variableType")||"";if(o=wh(o.workspace,a,d,m),m!==null&&m!==o.type)throw Error("Serialized variable type with id '"+o.getId()+"' had type "+o.type+", and does not match variable field that references it: "+hs(t)+".");this.setValue(o.getId())}toXml(t){return this.initModel(),t.id=this.variable_.getId(),t.textContent=this.variable_.name,this.variable_.type&&t.setAttribute("variabletype",this.variable_.type),t}saveState(t){var o=this.saveLegacyState(pc);return o!==null||(this.initModel(),o={id:this.variable_.getId()},t&&(o.name=this.variable_.name,o.type=this.variable_.type)),o}loadState(t){const o=this.getSourceBlock();if(!o)throw new Ei;this.loadLegacyState(pc,t)||(t=wh(o.workspace,t.id||null,t.name,t.type||""),this.setValue(t.getId()))}setSourceBlock(t){if(t.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(t)}getValue(){return this.variable_?this.variable_.getId():null}getText(){return this.variable_?this.variable_.name:""}getVariable(){return this.variable_}getValidator(){return this.variable_?this.validator_:null}doClassValidation_(t){if(t===null)return null;var o=this.getSourceBlock();if(!o)throw new Ei;return o=Rh(o.workspace,t),o?(o=o.type,this.typeIsAllowed_(o)?t:(console.warn("Variable type doesn't match this field!  Type was "+o),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+t),null)}doValueUpdate_(t){const o=this.getSourceBlock();if(!o)throw new Ei;this.variable_=Rh(o.workspace,t),super.doValueUpdate_(t)}typeIsAllowed_(t){const o=this.getVariableTypes_();if(!o)return!0;for(let a=0;a<o.length;a++)if(t===o[a])return!0;return!1}getVariableTypes_(){var t=this.variableTypes;if(t===null&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(t=t||[""],t.length===0)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t}setTypes_(t,o){if(o=o||"",t==null)t=null;else if(Array.isArray(t)){let a=!1;for(let d=0;d<t.length;d++)t[d]===o&&(a=!0);if(!a)throw Error("Invalid default type '"+o+"' in the definition of a FieldVariable")}else throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType_=o,this.variableTypes=t}refreshVariableName(){this.forceRerender()}onItemSelected_(t,o){if(t=o.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(t===Qm){KT(this.sourceBlock_.workspace,this.variable_);return}if(t===Zm){this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId());return}}this.setValue(t)}referencesVariables(){return!0}static fromJson(t){return new this(oi(t.variable),void 0,void 0,void 0,t)}static dropdownCreate(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const t=this.getText();let o=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var a=this.getVariableTypes_(),d=0;d<a.length;d++){const m=this.sourceBlock_.workspace.getVariablesOfType(a[d]);o=o.concat(m)}for(o.sort(Bu.compareByName),a=[],d=0;d<o.length;d++)a[d]=[o[d].name,o[d].getId()];return a.push([Ve.RENAME_VARIABLE,Qm]),Ve.DELETE_VARIABLE&&a.push([Ve.DELETE_VARIABLE.replace("%1",t),Zm]),a}};ds("field_variable",pc);var wg=class extends dc{constructor(t,o,a,d,m,b){super(pt.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,this.SERIALIZABLE=!0,this.spellcheck_=!1,t!==pt.SKIP_SETUP&&(b?this.configure_(b):this.setConstraints(o,a,d),this.setValue(t),m&&this.setValidator(m))}configure_(t){super.configure_(t),this.setMinInternal_(t.min),this.setMaxInternal_(t.max),this.setPrecisionInternal_(t.precision)}setConstraints(t,o,a){this.setMinInternal_(t),this.setMaxInternal_(o),this.setPrecisionInternal_(a),this.setValue(this.getValue())}setMin(t){this.setMinInternal_(t),this.setValue(this.getValue())}setMinInternal_(t){t==null?this.min_=-1/0:(t=Number(t),isNaN(t)||(this.min_=t))}getMin(){return this.min_}setMax(t){this.setMaxInternal_(t),this.setValue(this.getValue())}setMaxInternal_(t){t==null?this.max_=1/0:(t=Number(t),isNaN(t)||(this.max_=t))}getMax(){return this.max_}setPrecision(t){this.setPrecisionInternal_(t),this.setValue(this.getValue())}setPrecisionInternal_(t){this.precision_=Number(t)||0;let o=String(this.precision_);o.indexOf("e")!==-1&&(o=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const a=o.indexOf(".");this.decimalPlaces_=a===-1?t?0:null:o.length-a-1}getPrecision(){return this.precision_}doClassValidation_(t){return t===null||(t=String(t),t=t.replace(/O/ig,"0"),t=t.replace(/,/g,""),t=t.replace(/infinity/i,"Infinity"),t=Number(t||0),isNaN(t))?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),this.decimalPlaces_!==null&&(t=Number(t.toFixed(this.decimalPlaces_))),t)}widgetCreate_(){const t=super.widgetCreate_();return-1/0<this.min_&&ti(t,Yt.VALUEMIN,this.min_),1/0>this.max_&&ti(t,Yt.VALUEMAX,this.max_),t}static fromJson(t){return new this(t.value,void 0,void 0,void 0,void 0,t)}};ds("field_number",wg),wg.prototype.DEFAULT_VALUE=0;var Rg=class extends i.FieldTextInput$$module$build$src$core$field_textinput{constructor(t,o,a){super(pt.SKIP_SETUP),this.textGroup_=null,this.maxLines_=1/0,this.isOverflowedY_=!1,t!==pt.SKIP_SETUP&&(a&&this.configure_(a),this.setValue(t),o&&this.setValidator(o))}configure_(t){super.configure_(t),t.maxLines&&this.setMaxLines(t.maxLines)}toXml(t){return t.textContent=this.getValue().replace(/\n/g,"&#10;"),t}fromXml(t){this.setValue(t.textContent.replace(/&#10;/g,`
`))}saveState(){const t=this.saveLegacyState(Rg);return t!==null?t:this.getValue()}loadState(t){this.loadLegacyState(pt,t)||this.setValue(t)}initView(){this.createBorderRect_(),this.textGroup_=z(G.G,{class:"blocklyEditableText"},this.fieldGroup_)}getDisplayText_(){const t=this.getSourceBlock();if(!t)throw new Ei;let o=this.getText();if(!o)return pt.NBSP;const a=o.split(`
`);o="";const d=this.isOverflowedY_?this.maxLines_:a.length;for(let m=0;m<d;m++){let b=a[m];b.length>this.maxDisplayLength?b=b.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&m===d-1&&(b=b.substring(0,b.length-3)+"..."),b=b.replace(/\s/g,pt.NBSP),o+=b,m!==d-1&&(o+=`
`)}return t.RTL&&(o+="‏"),o}doValueUpdate_(t){super.doValueUpdate_(t),this.isOverflowedY_=this.value_.split(`
`).length>this.maxLines_}render_(){var t=this.getSourceBlock();if(!t)throw new Ei;for(var o;o=this.textGroup_.firstChild;)this.textGroup_.removeChild(o);o=this.getDisplayText_().split(`
`);let a=0;for(let d=0;d<o.length;d++){const m=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;z(G.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:a+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(o[d])),a+=m}this.isBeingEdited_&&(o=this.htmlInput_,this.isOverflowedY_?Ce(o,"blocklyHtmlTextAreaInputOverflowedY"):qe(o,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(t.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),t=this.htmlInput_,this.isTextValid_?(qe(t,"blocklyInvalidInput"),ti(t,Yt.INVALID,!1)):(Ce(t,"blocklyInvalidInput"),ti(t,Yt.INVALID,!0)))}updateSize_(){var t=this.textGroup_.childNodes;const o=this.getConstants().FIELD_TEXT_FONTSIZE,a=this.getConstants().FIELD_TEXT_FONTWEIGHT,d=this.getConstants().FIELD_TEXT_FONTFAMILY;let m=0,b=0;for(var I=0;I<t.length;I++){var L=as(t[I],o,a,d);L>m&&(m=L),b+=this.getConstants().FIELD_TEXT_HEIGHT+(0<I?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){for(t=this.value_.split(`
`),I=z(G.TEXT,{class:"blocklyText blocklyMultilineText"}),L=0;L<t.length;L++){t[L].length>this.maxDisplayLength&&(t[L]=t[L].substring(0,this.maxDisplayLength)),I.textContent=t[L];const oe=as(I,o,a,d);oe>m&&(m=oe)}m+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(b+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,m+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",m),this.borderRect_.setAttribute("height",b)),this.size_.width=m,this.size_.height=b,this.positionBorderRect_()}showEditor_(t,o){super.showEditor_(t,o),this.forceRerender()}widgetCreate_(){const t=ra(),o=this.workspace_.getScale(),a=document.createElement("textarea");a.className="blocklyHtmlInput blocklyHtmlTextAreaInput",a.setAttribute("spellcheck",this.spellcheck_);var d=this.getConstants().FIELD_TEXT_FONTSIZE*o+"pt";t.style.fontSize=d,a.style.fontSize=d,a.style.borderRadius=i.FieldTextInput$$module$build$src$core$field_textinput.BORDERRADIUS*o+"px",d=this.getConstants().FIELD_BORDER_RECT_X_PADDING*o;const m=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*o/2;return a.style.padding=m+"px "+d+"px "+m+"px "+d+"px",d=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,a.style.lineHeight=d*o+"px",t.appendChild(a),a.value=a.defaultValue=this.getEditorText_(this.value_),a.setAttribute("data-untyped-default-value",this.value_),a.setAttribute("data-old-value",""),cm?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(a),a}setMaxLines(t){typeof t=="number"&&0<t&&t!==this.maxLines_&&(this.maxLines_=t,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(t){t.keyCode!==Re.ENTER&&super.onHtmlInputKeyDown_(t)}static fromJson(t){return new this(oi(t.text),void 0,t)}};Ds(`
.blocklyHtmlTextAreaInput {
  font-family: monospace;
  resize: none;
  overflow: hidden;
  height: 100%;
  text-align: left;
}

.blocklyHtmlTextAreaInputOverflowedY {
  overflow-y: scroll;
}
`),ds("field_multilinetext",Rg);var T2=class extends i.FieldLabel$$module$build$src$core$field_label{constructor(t,o,a){super(String(t??""),o,a),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(t){return new this(oi(t.text),void 0,t)}};ds("field_label_serializable",T2);var Jr=class extends pt{constructor(t,o,a){super(pt.SKIP_SETUP),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null,this.SERIALIZABLE=!0,this.CURSOR="default",this.isDirty_=!1,this.titles_=this.colours_=null,this.columns_=0,t!==pt.SKIP_SETUP&&(a&&this.configure_(a),this.setValue(t),o&&this.setValidator(o))}configure_(t){super.configure_(t),t.colourOptions&&(this.colours_=t.colourOptions),t.colourTitles&&(this.titles_=t.colourTitles),t.columns&&(this.columns_=t.columns)}initView(){this.size_=new Xi(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.sourceBlock_ instanceof ps&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()):(this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1")}applyColour(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.sourceBlock_ instanceof ps&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())}doClassValidation_(t){return typeof t!="string"?null:ll(t)}doValueUpdate_(t){this.value_=t,this.borderRect_?this.borderRect_.style.fill=t:this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_ instanceof ps&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",t),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))}getText(){let t=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(t)&&(t="#"+t[1]+t[3]+t[5]),t}setColours(t,o){return this.colours_=t,o&&(this.titles_=o),this}setColumns(t){return this.columns_=t,this}showEditor_(){this.dropdownCreate_(),Jl().appendChild(this.picker_),H(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:!0})}onClick_(t){t=(t=t.target)&&t.getAttribute("data-colour"),t!==null&&(this.setValue(t),_u(this))}onKeyDown_(t){var o=!1;t.keyCode===Re.UP?(this.moveHighlightBy_(0,-1),o=!0):t.keyCode===Re.DOWN?(this.moveHighlightBy_(0,1),o=!0):t.keyCode===Re.LEFT?(this.moveHighlightBy_(-1,0),o=!0):t.keyCode===Re.RIGHT?(this.moveHighlightBy_(1,0),o=!0):t.keyCode===Re.ENTER&&((o=this.getHighlighted_())&&(o=o&&o.getAttribute("data-colour"),o!==null&&this.setValue(o)),en(),o=!0),o&&t.stopPropagation()}moveHighlightBy_(t,o){if(this.highlightedIndex_){var a=this.colours_||Jr.COLOURS,d=this.columns_||Jr.COLUMNS,m=this.highlightedIndex_%d,b=Math.floor(this.highlightedIndex_/d);m+=t,b+=o,0>t?0>m&&0<b?(m=d-1,b--):0>m&&(m=0):0<t?m>d-1&&b<Math.floor(a.length/d)-1?(m=0,b++):m>d-1&&m--:0>o?0>b&&(b=0):0<o&&b>Math.floor(a.length/d)-1&&(b=Math.floor(a.length/d)-1),this.setHighlightedCell_(this.picker_.childNodes[b].childNodes[m],b*d+m)}}onMouseMove_(t){const o=(t=t.target)&&Number(t.getAttribute("data-index"));o!==null&&o!==this.highlightedIndex_&&this.setHighlightedCell_(t,o)}onMouseEnter_(){this.picker_.focus({preventScroll:!0})}onMouseLeave_(){this.picker_.blur();const t=this.getHighlighted_();t&&qe(t,"blocklyColourHighlighted")}getHighlighted_(){if(!this.highlightedIndex_)return null;const t=this.columns_||Jr.COLUMNS,o=this.picker_.childNodes[Math.floor(this.highlightedIndex_/t)];return o?o.childNodes[this.highlightedIndex_%t]:null}setHighlightedCell_(t,o){const a=this.getHighlighted_();a&&qe(a,"blocklyColourHighlighted"),Ce(t,"blocklyColourHighlighted"),this.highlightedIndex_=o,ti(this.picker_,Yt.ACTIVEDESCENDANT,t.getAttribute("id"))}dropdownCreate_(){const t=this.columns_||Jr.COLUMNS,o=this.colours_||Jr.COLOURS,a=this.titles_||Jr.TITLES,d=this.getValue(),m=document.createElement("table");m.className="blocklyColourTable",m.tabIndex=0,m.dir="ltr",rn(m,Rr.GRID),ti(m,Yt.EXPANDED,!0),ti(m,Yt.ROWCOUNT,Math.floor(o.length/t)),ti(m,Yt.COLCOUNT,t);let b;for(let I=0;I<o.length;I++){I%t===0&&(b=document.createElement("tr"),rn(b,Rr.ROW),m.appendChild(b));const L=document.createElement("td");b.appendChild(L),L.setAttribute("data-colour",o[I]),L.title=a[I]||o[I],L.id=bu(),L.setAttribute("data-index",I),rn(L,Rr.GRIDCELL),ti(L,Yt.LABEL,o[I]),ti(L,Yt.SELECTED,o[I]===d),L.style.backgroundColor=o[I],o[I]===d&&(L.className="blocklyColourSelected",this.highlightedIndex_=I)}this.onClickWrapper_=y(m,"pointerdown",this,this.onClick_,!0),this.onMouseMoveWrapper_=y(m,"pointermove",this,this.onMouseMove_,!0),this.onMouseEnterWrapper_=y(m,"pointerenter",this,this.onMouseEnter_,!0),this.onMouseLeaveWrapper_=y(m,"pointerleave",this,this.onMouseLeave_,!0),this.onKeyDownWrapper_=y(m,"keydown",this,this.onKeyDown_),this.picker_=m}dropdownDispose_(){this.onClickWrapper_&&(C(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&(C(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&(C(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&(C(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&(C(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null}static fromJson(t){return new this(t.colour,void 0,t)}};Jr.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),Jr.TITLES=[],Jr.COLUMNS=7,Jr.prototype.DEFAULT_VALUE=Jr.COLOURS[0],Ds(`
.blocklyColourTable {
  border-collapse: collapse;
  display: block;
  outline: none;
  padding: 1px;
}

.blocklyColourTable>tr>td {
  border: .5px solid #888;
  box-sizing: border-box;
  cursor: pointer;
  display: inline-block;
  height: 20px;
  padding: 0;
  width: 20px;
}

.blocklyColourTable>tr>td.blocklyColourHighlighted {
  border-color: #eee;
  box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);
  position: relative;
}

.blocklyColourSelected, .blocklyColourSelected:hover {
  border-color: #eee !important;
  outline: 1px solid #333;
  position: relative;
}
`),ds("field_colour",Jr),i.FieldCheckbox$$module$build$src$core$field_checkbox=class extends pt{constructor(t,o,a){super(pt.SKIP_SETUP),this.SERIALIZABLE=!0,this.CURSOR="default",this.checkChar_=i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR,t!==pt.SKIP_SETUP&&(a&&this.configure_(a),this.setValue(t),o&&this.setValidator(o))}configure_(t){super.configure_(t),t.checkCharacter&&(this.checkChar_=t.checkCharacter)}saveState(){const t=this.saveLegacyState(i.FieldCheckbox$$module$build$src$core$field_checkbox);return t!==null?t:this.getValueBoolean()}initView(){super.initView();const t=this.getTextElement();Ce(t,"blocklyCheckbox"),t.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar_}setCheckCharacter(t){this.checkChar_=t||i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(t){return t===!0||t==="TRUE"?"TRUE":t===!1||t==="FALSE"?"FALSE":null}doValueUpdate_(t){this.value_=this.convertValueToBool_(t),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(t){return typeof t=="string"?t==="TRUE":!!t}static fromJson(t){return new this(t.checked,void 0,t)}},i.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR="✓",ds("field_checkbox",i.FieldCheckbox$$module$build$src$core$field_checkbox),i.FieldCheckbox$$module$build$src$core$field_checkbox.prototype.DEFAULT_VALUE=!1,i.FieldCheckbox$$module$build$src$core$field_checkbox;var at=class extends dc{constructor(t,o,a){super(pt.SKIP_SETUP),this.clockwise_=at.CLOCKWISE,this.offset_=at.OFFSET,this.wrap_=at.WRAP,this.round_=at.ROUND,this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.symbol_=this.line_=this.gauge_=this.editor_=null,this.SERIALIZABLE=!0,t!==pt.SKIP_SETUP&&(a&&this.configure_(a),this.setValue(t),o&&this.setValidator(o))}configure_(t){switch(super.configure_(t),t.mode){case Dd.COMPASS:this.clockwise_=!0,this.offset_=90;break;case Dd.PROTRACTOR:this.clockwise_=!1,this.offset_=0}t.clockwise&&(this.clockwise_=t.clockwise),t.offset&&(this.offset_=t.offset),t.wrap&&(this.wrap_=t.wrap),t.round&&(this.round_=t.round)}initView(){super.initView(),this.symbol_=z(G.TSPAN,{}),this.symbol_.appendChild(document.createTextNode("°")),this.getTextElement().appendChild(this.symbol_)}render_(){super.render_(),this.updateGraph_()}showEditor_(t){super.showEditor_(t,dm||ed||na),this.dropdownCreate_(),Jl().appendChild(this.editor_),this.sourceBlock_ instanceof ps&&S(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),H(this,this.dropdownDispose_.bind(this)),this.updateGraph_()}dropdownCreate_(){const t=z(G.SVG,{xmlns:la,"xmlns:html":Ms,"xmlns:xlink":Or,version:"1.1",height:2*at.HALF+"px",width:2*at.HALF+"px",style:"touch-action: none"}),o=z(G.CIRCLE,{cx:at.HALF,cy:at.HALF,r:at.RADIUS,class:"blocklyAngleCircle"},t);this.gauge_=z(G.PATH,{class:"blocklyAngleGauge"},t),this.line_=z(G.LINE,{x1:at.HALF,y1:at.HALF,class:"blocklyAngleLine"},t);for(let a=0;360>a;a+=15)z(G.LINE,{x1:at.HALF+at.RADIUS,y1:at.HALF,x2:at.HALF+at.RADIUS-(a%45===0?10:5),y2:at.HALF,class:"blocklyAngleMarks",transform:"rotate("+a+","+at.HALF+","+at.HALF+")"},t);this.clickWrapper_=y(t,"click",this,this.hide_),this.clickSurfaceWrapper_=y(o,"pointerdown",this,this.onMouseMove_,!0),this.moveSurfaceWrapper_=y(o,"pointermove",this,this.onMouseMove_,!0),this.editor_=t}dropdownDispose_(){this.clickWrapper_&&(C(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&(C(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&(C(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null}hide_(){_u(this),tn()}onMouseMove_(t){var o=this.gauge_.ownerSVGElement.getBoundingClientRect();const a=t.clientX-o.left-at.HALF;t=t.clientY-o.top-at.HALF,o=Math.atan(-t/a),isNaN(o)||(o=Ln(o),0>a?o+=180:0<t&&(o+=360),o=this.clockwise_?this.offset_+360-o:360-(this.offset_-o),this.displayMouseOrKeyboardValue_(o))}displayMouseOrKeyboardValue_(t){this.round_&&(t=Math.round(t/this.round_)*this.round_),t=this.wrapValue_(t),t!==this.value_&&this.setEditorValue_(t)}updateGraph_(){if(this.gauge_){var t=Number(this.getText())+this.offset_,o=Bi(t%360);t=["M ",at.HALF,",",at.HALF];var a=at.HALF,d=at.HALF;if(!isNaN(o)){const m=Number(this.clockwise_),b=Bi(this.offset_),I=Math.cos(b)*at.RADIUS,L=Math.sin(b)*-at.RADIUS;m&&(o=2*b-o),a+=Math.cos(o)*at.RADIUS,d-=Math.sin(o)*at.RADIUS,o=Math.abs(Math.floor((o-b)/Math.PI)%2),m&&(o=1-o),t.push(" l ",I,",",L," A ",at.RADIUS,",",at.RADIUS," 0 ",o," ",m," ",a,",",d," z")}this.gauge_.setAttribute("d",t.join("")),this.line_.setAttribute("x2",a),this.line_.setAttribute("y2",d)}}onHtmlInputKeyDown_(t){super.onHtmlInputKeyDown_(t);var o=this.getSourceBlock();if(!o)throw new Ei;let a;t.keyCode===Re.LEFT?a=o.RTL?1:-1:t.keyCode===Re.RIGHT?a=o.RTL?-1:1:t.keyCode===Re.DOWN?a=-1:t.keyCode===Re.UP&&(a=1),a&&(o=this.getValue(),this.displayMouseOrKeyboardValue_(o+a*this.round_),t.preventDefault(),t.stopPropagation())}doClassValidation_(t){return t=Number(t),isNaN(t)||!isFinite(t)?null:this.wrapValue_(t)}wrapValue_(t){return t%=360,0>t&&(t+=360),t>this.wrap_&&(t-=360),t}static fromJson(t){return new this(t.angle,void 0,t)}};at.ROUND=15,at.HALF=50,at.CLOCKWISE=!1,at.OFFSET=0,at.WRAP=360,at.RADIUS=at.HALF-1,Ds(`
.blocklyAngleCircle {
  stroke: #444;
  stroke-width: 1;
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyAngleMarks {
  stroke: #444;
  stroke-width: 1;
}

.blocklyAngleGauge {
  fill: #f88;
  fill-opacity: .8;
  pointer-events: none;
}

.blocklyAngleLine {
  stroke: #f00;
  stroke-width: 2;
  stroke-linecap: round;
  pointer-events: none;
}
`),ds("field_angle",at),at.prototype.DEFAULT_VALUE=0;var Dd;(function(t){t.COMPASS="compass",t.PROTRACTOR="protractor"})(Dd||(Dd={}));var Ng=class extends ga{constructor(t){super(t),this.type=gr,t&&(t.isShadow()&&(this.recordUndo=!1),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)}toJson(){const t=super.toJson();return t.oldParentId=this.oldParentId,t.oldInputName=this.oldInputName,this.oldCoordinate&&(t.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),t.newParentId=this.newParentId,t.newInputName=this.newInputName,this.newCoordinate&&(t.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.recordUndo||(t.recordUndo=this.recordUndo),t}fromJson(t){if(s("Blockly.Events.BlockMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.oldParentId=t.oldParentId,this.oldInputName=t.oldInputName,t.oldCoordinate){var o=t.oldCoordinate.split(",");this.oldCoordinate=new ve(Number(o[0]),Number(o[1]))}this.newParentId=t.newParentId,this.newInputName=t.newInputName,t.newCoordinate&&(o=t.newCoordinate.split(","),this.newCoordinate=new ve(Number(o[0]),Number(o[1]))),t.recordUndo!==void 0&&(this.recordUndo=t.recordUndo)}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new Ng),o.oldParentId=t.oldParentId,o.oldInputName=t.oldInputName,t.oldCoordinate&&(a=t.oldCoordinate.split(","),o.oldCoordinate=new ve(Number(a[0]),Number(a[1]))),o.newParentId=t.newParentId,o.newInputName=t.newInputName,t.newCoordinate&&(a=t.newCoordinate.split(","),o.newCoordinate=new ve(Number(a[0]),Number(a[1]))),t.recordUndo!==void 0&&(o.recordUndo=t.recordUndo),o}recordNew(){const t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate}currentLocation_(){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var o=t.getBlockById(this.blockId);if(!o)throw Error("The block associated with the block move event could not be found");t={};const a=o.getParent();return a?(t.parentId=a.id,(o=a.getInputWithBlock(o))&&(t.inputName=o.name)):t.coordinate=o.getRelativeToSurfaceXY(),t}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&ve.equals(this.oldCoordinate,this.newCoordinate)}run(t){var o=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var a=o.getBlockById(this.blockId);if(a){var d=t?this.newParentId:this.oldParentId,m=t?this.newInputName:this.oldInputName;if(t=t?this.newCoordinate:this.oldCoordinate,d){var b=o.getBlockById(d);if(!b){console.warn("Can't connect to non-existent block: "+d);return}}if(a.getParent()&&a.unplug(),t)m=a.getRelativeToSurfaceXY(),a.moveBy(t.x-m.x,t.y-m.y);else{o=a.outputConnection,(!o||a.previousConnection&&a.previousConnection.isConnected())&&(o=a.previousConnection);let I;a=o.type,m?(a=b.getInput(m))&&(I=a.connection):a===Ie.PREVIOUS_STATEMENT&&(I=b.nextConnection),I?o.connect(I):console.warn("Can't connect to non-existent input: "+m)}}else console.warn("Can't move non-existent block: "+this.blockId)}};tt(fe.EVENT,gr,Ng);var ko=class extends _l{constructor(t){super(),this.isBlank=!t,t&&(this.commentId=t.id,this.workspaceId=t.workspace.id,this.group=Kt(),this.recordUndo=xs())}toJson(){const t=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return t.commentId=this.commentId,t}fromJson(t){s("Blockly.Events.CommentBase.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.commentId=t.commentId}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new ko),o.commentId=t.commentId,o}static CommentCreateDeleteHelper(t,o){var a=t.getEventWorkspace_();if(o){if(o=Dt("xml"),!t.xml)throw Error("Ecountered a comment event without proper xml");o.appendChild(t.xml),Eu(o,a)}else{if(!t.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(a=a.getCommentById(t.commentId))?a.dispose():console.warn("Can't uncreate non-existent comment: "+t.commentId)}}},xg=class extends ko{constructor(t,o,a){super(t),this.type=Du,t&&(this.oldContents_=typeof o>"u"?"":o,this.newContents_=typeof a>"u"?"":a)}toJson(){const t=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return t.oldContents=this.oldContents_,t.newContents=this.newContents_,t}fromJson(t){s("Blockly.Events.CommentChange.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.oldContents_=t.oldContents,this.newContents_=t.newContents}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new xg),o.oldContents_=t.oldContents,o.newContents_=t.newContents,o}isNull(){return this.oldContents_===this.newContents_}run(t){var o=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(o=o.getCommentById(this.commentId)){var a=t?this.newContents_:this.oldContents_;if(!a)throw Error(t?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");o.setContent(a)}else console.warn("Can't change non-existent comment: "+this.commentId)}};tt(fe.EVENT,Du,xg);var Dg=class extends ko{constructor(t){super(t),this.type=ml,t&&(this.xml=t.toXmlWithXY())}toJson(){const t=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return t.xml=hs(this.xml),t}fromJson(t){s("Blockly.Events.CommentCreate.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.xml=mr(t.xml)}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new Dg),o.xml=mr(t.xml),o}run(t){ko.CommentCreateDeleteHelper(this,t)}};tt(fe.EVENT,ml,Dg);var Lg=class extends ko{constructor(t){super(t),this.type=fa,t&&(this.xml=t.toXmlWithXY())}run(t){ko.CommentCreateDeleteHelper(this,!t)}toJson(){const t=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return t.xml=hs(this.xml),t}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new Lg),o.xml=mr(t.xml),o}};tt(fe.EVENT,fa,Lg);var Mg=class extends ko{constructor(t){super(t),this.type=Vn,t&&(this.comment_=t,this.oldCoordinate_=t.getXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getXY()}setOldCoordinate(t){this.oldCoordinate_=t}toJson(){const t=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return t.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,t.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),t}fromJson(t){s("Blockly.Events.CommentMove.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t);let o=t.oldCoordinate.split(",");this.oldCoordinate_=new ve(Number(o[0]),Number(o[1])),o=t.newCoordinate.split(","),this.newCoordinate_=new ve(Number(o[0]),Number(o[1]))}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new Mg),a=t.oldCoordinate.split(","),o.oldCoordinate_=new ve(Number(a[0]),Number(a[1])),a=t.newCoordinate.split(","),o.newCoordinate_=new ve(Number(a[0]),Number(a[1])),o}isNull(){return ve.equals(this.oldCoordinate_,this.newCoordinate_)}run(t){var o=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(o=o.getCommentById(this.commentId)){if(t=t?this.newCoordinate_:this.oldCoordinate_,!t)throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");var a=o.getXY();o.moveBy(t.x-a.x,t.y-a.y)}else console.warn("Can't move non-existent comment: "+this.commentId)}};tt(fe.EVENT,Vn,Mg);var Il=class extends _l{constructor(t,o){super(),this.model=o,this.isBlank=!1,this.workspaceId=t.id}toJson(){const t=super.toJson();return t.procedureId=this.model.getId(),t}},Bg=class extends Il{constructor(t,o,a){super(t,o),this.oldTypes=a,this.type=ud,this.newTypes=o.getReturnTypes()}run(t){const o=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!o)throw Error("Cannot change the type of a procedure that does not exist in the procedure map");t?o.setReturnTypes(this.newTypes):o.setReturnTypes(this.oldTypes)}toJson(){const t=super.toJson();return t.oldTypes=this.oldTypes,t}static fromJson(t,o){const a=o.getProcedureMap().get(t.procedureId);if(!a)throw Error("Cannot deserialize procedure change return event because the target procedure does not exist");return new Bg(o,a,t.oldTypes)}};tt(fe.EVENT,ud,Bg);var Pg=class extends Il{constructor(t,o){super(t,o),this.type=od}run(t){const o=this.getEventWorkspace_(),a=o.getProcedureMap(),d=a.get(this.model.getId());t?d||a.add(new sc(o,this.model.getName(),this.model.getId())):d&&a.delete(this.model.getId())}toJson(){const t=super.toJson();return t.model=im(this.model),t}static fromJson(t,o){return new Pg(o,sm(sc,Oa,t.model,o))}};tt(fe.EVENT,od,Pg);var Fg=class extends Il{constructor(t,o){super(t,o),this.type=Lu}run(t){const o=this.getEventWorkspace_(),a=o.getProcedureMap(),d=a.get(this.model.getId());t?d&&a.delete(this.model.getId()):d||a.add(new sc(o,this.model.getName(),this.model.getId()))}toJson(){return super.toJson()}static fromJson(t,o){if(t=o.getProcedureMap().get(t.procedureId),!t)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");return new Fg(o,t)}};tt(fe.EVENT,Lu,Fg);var Ug=class extends Il{constructor(t,o){super(t,o),this.type=ad,this.oldState=!o.getEnabled(),this.newState=o.getEnabled()}run(t){const o=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!o)throw Error("Cannot change the enabled state of a procedure that does not exist in the procedure map");t?o.setEnabled(this.newState):o.setEnabled(this.oldState)}toJson(){return super.toJson()}static fromJson(t,o){if(t=o.getProcedureMap().get(t.procedureId),!t)throw Error("Cannot deserialize procedure enable event because the target procedure does not exist");return new Ug(o,t)}};tt(fe.EVENT,ad,Ug);var Hg=class extends Il{constructor(t,o,a){super(t,o),this.oldName=a,this.type=ld,this.newName=o.getName()}run(t){const o=this.getEventWorkspace_().getProcedureMap().get(this.model.getId());if(!o)throw Error("Cannot change the type of a procedure that does not exist in the procedure map");t?o.setName(this.newName):o.setName(this.oldName)}toJson(){const t=super.toJson();return t.oldName=this.oldName,t}static fromJson(t,o){const a=o.getProcedureMap().get(t.procedureId);if(!a)throw Error("Cannot deserialize procedure rename event because the target procedure does not exist");return new Hg(o,a,t.oldName)}};tt(fe.EVENT,ld,Hg);var Ld=class extends Il{constructor(t,o,a){super(t,o),this.parameter=a}toJson(){const t=super.toJson();return t.parameterId=this.model.getId(),t}},Gg=class extends Ld{constructor(t,o,a,d){super(t,o,a),this.index=d,this.type=cd}run(t){const o=this.getEventWorkspace_(),a=o.getProcedureMap().get(this.model.getId());if(!a)throw Error("Cannot add a parameter to a procedure that does not exist in the procedure map");const d=a.getParameter(this.index);t?this.parameterMatches(d)||a.insertParameter(new Oa(o,this.parameter.getName(),this.parameter.getId()),this.index):this.parameterMatches(d)&&a.deleteParameter(this.index)}parameterMatches(t){return t&&t.getId()===this.parameter.getId()}toJson(){const t=super.toJson();return t.parameter=rm(this.parameter),t.index=this.index,t}static fromJson(t,o){const a=o.getProcedureMap().get(t.procedureId);if(!a)throw Error("Cannot deserialize parameter create event because the target procedure does not exist");return new Gg(o,a,nm(Oa,t.parameter,o),t.index)}};tt(fe.EVENT,cd,Gg);var Vg=class extends Ld{constructor(t,o,a,d){super(t,o,a),this.index=d,this.type=hd}run(t){const o=this.getEventWorkspace_(),a=o.getProcedureMap().get(this.model.getId());if(!a)throw Error("Cannot add a parameter to a procedure that does not exist in the procedure map");const d=a.getParameter(this.index);t?this.parameterMatches(d)&&a.deleteParameter(this.index):this.parameterMatches(d)||a.insertParameter(new Oa(o,this.parameter.getName(),this.parameter.getId()),this.index)}parameterMatches(t){return t&&t.getId()===this.parameter.getId()}toJson(){const t=super.toJson();return t.index=this.index,t}static fromJson(t,o){const a=o.getProcedureMap().get(t.procedureId);if(!a)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");const d=a.getParameter(t.index);return new Vg(o,a,d,t.index)}};tt(fe.EVENT,hd,Vg);var Wg=class extends Ld{constructor(t,o,a,d){super(t,o,a),this.oldName=d,this.type=dd,this.newName=a.getName()}run(t){const o=a$(this.getEventWorkspace_(),this.model.getId(),this.parameter.getId());if(!o)throw Error("Cannot rename a parameter that does not exist in the procedure map");t?o.setName(this.newName):o.setName(this.oldName)}toJson(){const t=super.toJson();return t.oldName=this.oldName,t}static fromJson(t,o){const a=o.getProcedureMap().get(t.procedureId);if(!a)throw Error("Cannot deserialize procedure delete event because the target procedure does not exist");const d=a$(o,t.procedureId,t.parameterId);if(!d)throw Error("Cannot deserialize parameter rename event because the target parameter does not exist");return new Wg(o,a,d,t.oldName)}};tt(fe.EVENT,dd,Wg);var zg=class extends Fs{constructor(t,o,a){super(t?t.workspace.id:void 0),this.type=da,t&&(this.blockId=t.id,this.isStart=o,this.blocks=a)}toJson(){const t=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.blockId===void 0)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return t.isStart=this.isStart,t.blockId=this.blockId,t.blocks=this.blocks,t}fromJson(t){s("Blockly.Events.BlockDrag.prototype.fromJson","version 9","version 10","Blockly.Events.fromJson"),super.fromJson(t),this.isStart=t.isStart,this.blockId=t.blockId,this.blocks=t.blocks}static fromJson(t,o,a){return o=super.fromJson(t,o,a??new zg),o.isStart=t.isStart,o.blockId=t.blockId,o.blocks=t.blocks,o}};tt(fe.EVENT,da,zg);var E2=class extends Fs{constructor(t,o,a,d){super(t?t.workspace.id:void 0),this.type=Ou,this.blockId=t?t.id:null,this.element=typeof o>"u"?"":o,this.oldValue=typeof a>"u"?"":a,this.newValue=typeof d>"u"?"":d}toJson(){const t=super.toJson();return t.element=this.element,this.newValue!==void 0&&(t.newValue=this.newValue),this.blockId&&(t.blockId=this.blockId),t}fromJson(t){super.fromJson(t),this.element=t.element,this.newValue=t.newValue,this.blockId=t.blockId}};tt(fe.EVENT,Ou,E2);var $2=class extends _l{constructor(t){super(),this.isBlank=!0,this.recordUndo=!1,this.type=pa,this.isBlank=!!t,t&&(this.workspaceId=t.id)}toJson(){const t=super.toJson();if(!this.workspaceId)throw Error("The workspace ID is undefined. Either pass a workspace to the constructor, or call fromJson");return t.workspaceId=this.workspaceId,t}fromJson(t){super.fromJson(t),this.workspaceId=t.workspaceId}};tt(fe.EVENT,pa,$2),i.module$build$src$core$events$events={},i.module$build$src$core$events$events.Abstract=_l,i.module$build$src$core$events$events.BLOCK_CHANGE=Ui,i.module$build$src$core$events$events.BLOCK_CREATE=Ji,i.module$build$src$core$events$events.BLOCK_DELETE=on,i.module$build$src$core$events$events.BLOCK_DRAG=da,i.module$build$src$core$events$events.BLOCK_MOVE=gr,i.module$build$src$core$events$events.BUBBLE_OPEN=Gn,i.module$build$src$core$events$events.BUMP_EVENTS=vm,i.module$build$src$core$events$events.BlockBase=ga,i.module$build$src$core$events$events.BlockChange=bl,i.module$build$src$core$events$events.BlockCreate=Ym,i.module$build$src$core$events$events.BlockDelete=Xm,i.module$build$src$core$events$events.BlockDrag=zg,i.module$build$src$core$events$events.BlockMove=Ng,i.module$build$src$core$events$events.BubbleOpen=Um,i.module$build$src$core$events$events.BubbleType=Hm,i.module$build$src$core$events$events.CHANGE=Ui,i.module$build$src$core$events$events.CLICK=$o,i.module$build$src$core$events$events.COMMENT_CHANGE=Du,i.module$build$src$core$events$events.COMMENT_CREATE=ml,i.module$build$src$core$events$events.COMMENT_DELETE=fa,i.module$build$src$core$events$events.COMMENT_MOVE=Vn,i.module$build$src$core$events$events.CREATE=Ji,i.module$build$src$core$events$events.Click=lg,i.module$build$src$core$events$events.ClickTarget=ag,i.module$build$src$core$events$events.CommentBase=ko,i.module$build$src$core$events$events.CommentChange=xg,i.module$build$src$core$events$events.CommentCreate=Dg,i.module$build$src$core$events$events.CommentDelete=Lg,i.module$build$src$core$events$events.CommentMove=Mg,i.module$build$src$core$events$events.DELETE=on,i.module$build$src$core$events$events.FINISHED_LOADING=pa,i.module$build$src$core$events$events.FinishedLoading=$2,i.module$build$src$core$events$events.MARKER_MOVE=wu,i.module$build$src$core$events$events.MOVE=gr,i.module$build$src$core$events$events.MarkerMove=Tg,i.module$build$src$core$events$events.ProcedureBase=Il,i.module$build$src$core$events$events.ProcedureChangeReturn=Bg,i.module$build$src$core$events$events.ProcedureCreate=Pg,i.module$build$src$core$events$events.ProcedureDelete=Fg,i.module$build$src$core$events$events.ProcedureEnable=Ug,i.module$build$src$core$events$events.ProcedureParameterBase=Ld,i.module$build$src$core$events$events.ProcedureParameterCreate=Gg,i.module$build$src$core$events$events.ProcedureParameterDelete=Vg,i.module$build$src$core$events$events.ProcedureParameterRename=Wg,i.module$build$src$core$events$events.ProcedureRename=Hg,i.module$build$src$core$events$events.SELECTED=Eo,i.module$build$src$core$events$events.Selected=Cm,i.module$build$src$core$events$events.THEME_CHANGE=xu,i.module$build$src$core$events$events.TOOLBOX_ITEM_SELECT=Nu,i.module$build$src$core$events$events.TRASHCAN_OPEN=Ru,i.module$build$src$core$events$events.ThemeChange=ug,i.module$build$src$core$events$events.ToolboxItemSelect=sg,i.module$build$src$core$events$events.TrashcanOpen=Wm,i.module$build$src$core$events$events.UI=Ou,i.module$build$src$core$events$events.Ui=E2,i.module$build$src$core$events$events.UiBase=Fs,i.module$build$src$core$events$events.VAR_CREATE=fl,i.module$build$src$core$events$events.VAR_DELETE=ha,i.module$build$src$core$events$events.VAR_RENAME=Cu,i.module$build$src$core$events$events.VIEWPORT_CHANGE=pl,i.module$build$src$core$events$events.VarBase=Mu,i.module$build$src$core$events$events.VarCreate=km,i.module$build$src$core$events$events.VarDelete=vg,i.module$build$src$core$events$events.VarRename=yg,i.module$build$src$core$events$events.ViewportChange=cg,i.module$build$src$core$events$events.clearPendingUndo=Ep,i.module$build$src$core$events$events.disable=Ci,i.module$build$src$core$events$events.disableOrphans=$p,i.module$build$src$core$events$events.enable=Oi,i.module$build$src$core$events$events.filter=Ah,i.module$build$src$core$events$events.fire=De,i.module$build$src$core$events$events.fromJson=WT,i.module$build$src$core$events$events.get=Le,i.module$build$src$core$events$events.getDescendantIds=Ch,i.module$build$src$core$events$events.getGroup=Kt,i.module$build$src$core$events$events.getRecordUndo=xs,i.module$build$src$core$events$events.isEnabled=Pi,i.module$build$src$core$events$events.setGroup=He,i.module$build$src$core$events$events.setRecordUndo=zr,S$();var Tr={};Tr.registerCleanup=h$,Tr.registerCollapse=f$,Tr.registerCollapseExpandBlock=E$,Tr.registerComment=b$,Tr.registerDefaultOptions=S$,Tr.registerDelete=v$,Tr.registerDeleteAll=g$,Tr.registerDisable=$$,Tr.registerDuplicate=_$,Tr.registerExpand=p$,Tr.registerHelp=y$,Tr.registerInline=T$,Tr.registerRedo=c$,Tr.registerUndo=u$;var v2=class{constructor(t,o){this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.draggingBlock_=t,this.draggedConnectionManager_=new qr(this.draggingBlock_),this.workspace_=o,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=q6(t)}dispose(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()}startDrag(t,o){Kt()||He(!0),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),Cs(),this.workspace_.setResizesEnabled(!1),yu(),this.shouldDisconnect_(o)&&this.disconnectBlock_(o,t),this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface()}shouldDisconnect_(t){return!!(this.draggingBlock_.getParent()||t&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())}disconnectBlock_(t,o){this.draggingBlock_.unplug(t),t=this.pixelsToWorkspaceUnits_(o),t=ve.sum(this.startXY_,t),this.draggingBlock_.translate(t.x,t.y),DE(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()}fireDragStartEvent_(){const t=new(Le(da))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));De(t)}drag(t,o){o=this.pixelsToWorkspaceUnits_(o);var a=ve.sum(this.startXY_,o);this.draggingBlock_.moveDuringDrag(a),this.dragIcons_(o),a=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(t),this.draggedConnectionManager_.update(o,this.dragTarget_),t=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock,t!==this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==a&&(a&&a.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)}endDrag(t,o){this.drag(t,o),this.dragIconData_=[],this.fireDragEndEvent_(),Os(),yu(),t=null,this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_)?o=this.startXY_:(o=this.getNewLocationAfterDrag_(o),t=o.delta,o=o.newLocation),this.draggingBlock_.moveOffDragSurface(o),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(!1),t?this.updateBlockAfterMove_(t):jh(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)),this.workspace_.setResizesEnabled(!0),He(!1)}getNewLocationAfterDrag_(t){t=this.pixelsToWorkspaceUnits_(t);const o=ve.sum(this.startXY_,t);return{delta:t,newLocation:o}}maybeDeleteBlock_(){return this.wouldDeleteBlock_?(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),cl.length=0,!0):!1}updateBlockAfterMove_(t){this.draggingBlock_.moveConnections(t.x,t.y),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()}fireDragEndEvent_(){const t=new(Le(da))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));De(t)}updateToolboxStyle_(t){const o=this.workspace_.getToolbox();if(o){const a=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";t&&typeof o.removeStyle=="function"?o.removeStyle(a):t||typeof o.addStyle!="function"||o.addStyle(a)}}fireMoveEvent_(){const t=new(Le(gr))(this.draggingBlock_);t.oldCoordinate=this.startXY_,t.recordNew(),De(t)}updateCursorDuringBlockDrag_(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)}pixelsToWorkspaceUnits_(t){return t=new ve(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t}dragIcons_(t){for(let o=0;o<this.dragIconData_.length;o++){const a=this.dragIconData_[o];a.icon.setIconLocation(ve.sum(a.location,t))}}getInsertionMarkers(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]}};tt(fe.BLOCK_DRAGGER,Hn,v2);var FN="9.2.1",UN=i.Align$$module$build$src$core$input.LEFT,HN=i.Align$$module$build$src$core$input.CENTRE,GN=i.Align$$module$build$src$core$input.RIGHT,VN=Ie.INPUT_VALUE,WN=Ie.OUTPUT_VALUE,zN=Ie.NEXT_STATEMENT,YN=Ie.PREVIOUS_STATEMENT,XN=it.DUMMY,jN=Je.TOP,KN=Je.BOTTOM,qN=Je.LEFT,JN=Je.RIGHT;Kn.prototype.newBlock=function(t,o){return new ya(this,t,o)},zs.prototype.newBlock=function(t,o){return new ps(this,t,o)},zs.newTrashcan=function(t){return new $v(t)},ar.prototype.showContextMenu=function(t){if(!this.workspace.options.readOnly){var o=[];this.isDeletable()&&this.isMovable()&&(o.push(UE(this)),o.push(FE(this))),zh(t,o,this.RTL)}},i.Mutator$$module$build$src$core$mutator.prototype.newWorkspaceSvg=function(t){return new zs(t)},ms.prototype.populateProcedures=function(t){t=Zp(t),t=t[0].concat(t[1]);for(let o=0;o<t.length;o++)this.getName(t[o][0],ms.NameType.PROCEDURE)};var QN=Ie,J={};return J.ALIGN_CENTRE=HN,J.ALIGN_LEFT=UN,J.ALIGN_RIGHT=GN,J.ASTNode=le,J.BasicCursor=ic,J.Block=ya,J.BlockDragSurfaceSvg=m2,J.BlockDragger=v2,J.BlockSvg=ps,J.Blocks=Cr,J.Bubble=Qe,J.BubbleDragger=kv,J.COLLAPSED_FIELD_NAME=qu,J.COLLAPSED_INPUT_NAME=Ku,J.COLLAPSE_CHARS=mv,J.CodeGenerator=i.CodeGenerator$$module$build$src$core$generator,J.CollapsibleToolboxCategory=Aa,J.Comment=pv,J.ComponentManager=ji,J.Connection=Ot,J.ConnectionChecker=Bv,J.ConnectionDB=Ca,J.ConnectionType=Ie,J.ContextMenu=i.module$build$src$core$contextmenu,J.ContextMenuItems=Tr,J.ContextMenuRegistry=wt,J.Css=Rm,J.Cursor=eg,J.DELETE_VARIABLE_ID=Zm,J.DRAG_STACK=gv,J.DUMMY_INPUT=XN,J.DeleteArea=kd,J.DragTarget=Ev,J.DropDownDiv=mi,J.Events=i.module$build$src$core$events$events,J.Extensions=i.module$build$src$core$extensions,J.Field=pt,J.FieldAngle=at,J.FieldCheckbox=i.FieldCheckbox$$module$build$src$core$field_checkbox,J.FieldColour=Jr,J.FieldDropdown=Gs,J.FieldImage=i.FieldImage$$module$build$src$core$field_image,J.FieldLabel=i.FieldLabel$$module$build$src$core$field_label,J.FieldLabelSerializable=T2,J.FieldMultilineInput=Rg,J.FieldNumber=wg,J.FieldTextInput=i.FieldTextInput$$module$build$src$core$field_textinput,J.FieldVariable=pc,J.Flyout=xd,J.FlyoutButton=Ra,J.FlyoutMetricsManager=_2,J.Generator=i.CodeGenerator$$module$build$src$core$generator,J.Gesture=an,J.Grid=hg,J.HorizontalFlyout=b2,J.INPUT_VALUE=VN,J.Icon=vd,J.Input=va,J.InsertionMarkerManager=qr,J.Marker=_v,J.MarkerManager=Pu,J.Menu=Pm,J.MenuItem=Fm,J.MetricsManager=Cg,J.Msg=Ve,J.Mutator=i.Mutator$$module$build$src$core$mutator,J.NEXT_STATEMENT=zN,J.Names=ms,J.OPPOSITE_TYPE=El,J.OUTPUT_VALUE=WN,J.Options=Vs,J.PREVIOUS_STATEMENT=YN,J.PROCEDURE_CATEGORY_NAME=Od,J.Procedures=i.module$build$src$core$procedures,J.RENAME_VARIABLE_ID=Qm,J.RenderedConnection=_r,J.Scrollbar=ii,J.ScrollbarPair=Ag,J.ShortcutItems=cn,J.ShortcutRegistry=Lt,J.TOOLBOX_AT_BOTTOM=KN,J.TOOLBOX_AT_LEFT=qN,J.TOOLBOX_AT_RIGHT=JN,J.TOOLBOX_AT_TOP=jN,J.TabNavigateCursor=bv,J.Theme=Tl,J.ThemeManager=Mv,J.Themes=og,J.Toolbox=Iv,J.ToolboxCategory=Ws,J.ToolboxItem=ng,J.ToolboxSeparator=rc,J.Tooltip=gi,J.Touch=Xr,J.TouchGesture=an,J.Trashcan=$v,J.VARIABLE_CATEGORY_NAME=md,J.VARIABLE_DYNAMIC_CATEGORY_NAME=$g,J.VERSION=FN,J.VariableMap=Sg,J.VariableModel=Bu,J.Variables=i.module$build$src$core$variables,J.VariablesDynamic=Io,J.VerticalFlyout=Og,J.Warning=Tv,J.WidgetDiv=Hs,J.Workspace=Kn,J.WorkspaceAudio=Pv,J.WorkspaceComment=ln,J.WorkspaceCommentSvg=ar,J.WorkspaceDragSurfaceSvg=p2,J.WorkspaceDragger=Av,J.WorkspaceSvg=zs,J.Xml=i.module$build$src$core$xml,J.ZoomControls=Fv,J.bindEventWithChecks_=oN,J.bindEvent_=sN,J.blockAnimations=Qu,J.blockRendering=Rt,J.browserEvents=Un,J.bumpObjects=Nd,J.clipboard=Zu,J.common=i.module$build$src$core$common,J.config=i.config$$module$build$src$core$config,J.connectionTypes=QN,J.constants=jm,J.copy=Z6,J.defineBlocksWithJsonArray=St,J.dialog=wr,J.duplicate=tN,J.fieldRegistry=Vu,J.geras=dn,J.getMainWorkspace=re,J.getSelected=_e,J.hideChaff=J6,J.hueToHex=rN,J.inject=H6,J.inputTypes=it,J.isNumber=iN,J.minimalist=fc,J.paste=eN,J.procedures=i.module$build$src$core$procedures,J.registry=Ps,J.resizeSvgContents=Q6,J.serialization=PN,J.setLocale=Im,J.setParentContainer=vt,J.svgResize=je,J.thrasos=kg,J.uiPosition=$l,J.unbindEvent_=nN,J.utils=Tt,J.zelos=Ys,i.module$build$src$core$contextmenu,i.module$build$src$core$events$events,i.module$build$src$core$msg,i.module$build$src$core$common,Object.defineProperties(J,{alert:{set:function(t){Fi.warn("Blockly.alert","December 2021","December 2022"),wr.setAlert(t)},get:function(){return Fi.warn("Blockly.alert","December 2021","December 2022","Blockly.dialog.alert()"),wr.alert}},confirm:{set:function(t){Fi.warn("Blockly.confirm","December 2021","December 2022"),wr.setConfirm(t)},get:function(){return Fi.warn("Blockly.confirm","December 2021","December 2022","Blockly.dialog.confirm()"),wr.confirm}},mainWorkspace:{set:function(t){Fi.warn("Blockly.mainWorkspace","version 9","version 10","Blockly.getMainWorkspace"),i.module$build$src$core$common.setMainWorkspace(t)},get:function(){return Fi.warn("Blockly.mainWorkspace","version 9","version 10","Blockly.getMainWorkspace"),i.module$build$src$core$common.getMainWorkspace()}},prompt:{set:function(t){Fi.warn("Blockly.prompt","December 2021","December 2022"),wr.setPrompt(t)},get:function(){return Fi.warn("Blockly.prompt","December 2021","December 2022","Blockly.dialog.prompt()"),wr.prompt}},selected:{get:function(){return Fi.warn("Blockly.selected","version 9","version 10","Blockly.getSelected"),i.module$build$src$core$common.getSelected()},set:function(t){Fi.warn("Blockly.selected","version 9","version 10","Blockly.getSelected"),i.module$build$src$core$common.setSelected(t)}},HSV_SATURATION:{get:function(){return ur.getHsvSaturation()},set:function(t){ur.setHsvSaturation(t)}},HSV_VALUE:{get:function(){return ur.getHsvValue()},set:function(t){ur.setHsvValue(t)}}}),Object.defineProperties(i.module$build$src$core$contextmenu,{currentBlock:{get:function(){return Fi.warn("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.getCurrentBlock()"),i.module$build$src$core$contextmenu.getCurrentBlock()},set:function(t){Fi.warn("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.setCurrentBlock(block)"),i.module$build$src$core$contextmenu.setCurrentBlock(t)}}}),Object.defineProperties(i.module$build$src$core$events$events,{recordUndo:{get:function(){return Fi.warn("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.getRecordUndo()"),We.getRecordUndo()},set:function(t){Fi.warn("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.setRecordUndo()"),We.setRecordUndo(t)}}}),Object.defineProperties(gi,{visible:{get:function(){return Fi.warn("Blockly.Tooltip.visible","September 2021","September 2022","Blockly.Tooltip.isVisible()"),gi.isVisible()}},DIV:{get:function(){return Fi.warn("Blockly.Tooltip.DIV","September 2021","September 2022","Blockly.Tooltip.getDiv()"),gi.getDiv()}}}),Object.defineProperties(Hs,{DIV:{get:function(){return Fi.warn("Blockly.WidgetDiv.DIV","September 2021","September 2022","Blockly.WidgetDiv.getDiv()"),Hs.getDiv()}}}),"Blockly"in globalThis||(globalThis.Blockly={Msg:i.module$build$src$core$msg}),J.__namespace__=i,J})}(Iz)),Cf}var Xk;function kz(){return Xk||(Xk=1,function(r,e){(function(i,s){r.exports=s(MT())})(ys,function(i){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})}(Sz)),Af}var jk;function vR(){return jk||(jk=1,function(r,e){(function(i,s){r.exports=s(kz())})(ys,function(i){return i})}(yz)),kf}var Of={},Az={get exports(){return Of},set exports(r){Of=r}},Kk;function Cz(){return Kk||(Kk=1,function(r,e){(function(i,s){r.exports=s()})(ys,function(){var i=i||{Msg:Object.create(null)};return i.Msg.ADD_COMMENT="Add Comment",i.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",i.Msg.CHANGE_VALUE_TITLE="Change value:",i.Msg.CLEAN_UP="Clean up Blocks",i.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",i.Msg.COLLAPSE_ALL="Collapse Blocks",i.Msg.COLLAPSE_BLOCK="Collapse Block",i.Msg.COLOUR_BLEND_COLOUR1="colour 1",i.Msg.COLOUR_BLEND_COLOUR2="colour 2",i.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",i.Msg.COLOUR_BLEND_RATIO="ratio",i.Msg.COLOUR_BLEND_TITLE="blend",i.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",i.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",i.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",i.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",i.Msg.COLOUR_RANDOM_TITLE="random colour",i.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",i.Msg.COLOUR_RGB_BLUE="blue",i.Msg.COLOUR_RGB_GREEN="green",i.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",i.Msg.COLOUR_RGB_RED="red",i.Msg.COLOUR_RGB_TITLE="colour with",i.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",i.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",i.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",i.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",i.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",i.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",i.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",i.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",i.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",i.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",i.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",i.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",i.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",i.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",i.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",i.Msg.CONTROLS_IF_MSG_ELSE="else",i.Msg.CONTROLS_IF_MSG_ELSEIF="else if",i.Msg.CONTROLS_IF_MSG_IF="if",i.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",i.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",i.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",i.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",i.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",i.Msg.CONTROLS_REPEAT_INPUT_DO="do",i.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",i.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",i.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",i.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",i.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",i.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",i.Msg.DELETE_BLOCK="Delete Block",i.Msg.DELETE_VARIABLE="Delete the '%1' variable",i.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",i.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",i.Msg.DIALOG_CANCEL="Cancel",i.Msg.DIALOG_OK="OK",i.Msg.DISABLE_BLOCK="Disable Block",i.Msg.DUPLICATE_BLOCK="Duplicate",i.Msg.DUPLICATE_COMMENT="Duplicate Comment",i.Msg.ENABLE_BLOCK="Enable Block",i.Msg.EXPAND_ALL="Expand Blocks",i.Msg.EXPAND_BLOCK="Expand Block",i.Msg.EXTERNAL_INPUTS="External Inputs",i.Msg.HELP="Help",i.Msg.INLINE_INPUTS="Inline Inputs",i.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",i.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",i.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",i.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",i.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",i.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",i.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",i.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",i.Msg.LISTS_GET_INDEX_FIRST="first",i.Msg.LISTS_GET_INDEX_FROM_END="# from end",i.Msg.LISTS_GET_INDEX_FROM_START="#",i.Msg.LISTS_GET_INDEX_GET="get",i.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",i.Msg.LISTS_GET_INDEX_LAST="last",i.Msg.LISTS_GET_INDEX_RANDOM="random",i.Msg.LISTS_GET_INDEX_REMOVE="remove",i.Msg.LISTS_GET_INDEX_TAIL="",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",i.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",i.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",i.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",i.Msg.LISTS_GET_SUBLIST_END_LAST="to last",i.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",i.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",i.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",i.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",i.Msg.LISTS_GET_SUBLIST_TAIL="",i.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",i.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",i.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",i.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",i.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",i.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",i.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",i.Msg.LISTS_INLIST="in list",i.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",i.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",i.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",i.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",i.Msg.LISTS_LENGTH_TITLE="length of %1",i.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",i.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",i.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",i.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",i.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",i.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",i.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",i.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",i.Msg.LISTS_SET_INDEX_INPUT_TO="as",i.Msg.LISTS_SET_INDEX_INSERT="insert at",i.Msg.LISTS_SET_INDEX_SET="set",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",i.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",i.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",i.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",i.Msg.LISTS_SORT_ORDER_DESCENDING="descending",i.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",i.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",i.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",i.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",i.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",i.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",i.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",i.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",i.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",i.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",i.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",i.Msg.LOGIC_BOOLEAN_FALSE="false",i.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",i.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",i.Msg.LOGIC_BOOLEAN_TRUE="true",i.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",i.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",i.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",i.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",i.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",i.Msg.LOGIC_NEGATE_TITLE="not %1",i.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",i.Msg.LOGIC_NULL="null",i.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",i.Msg.LOGIC_NULL_TOOLTIP="Returns null.",i.Msg.LOGIC_OPERATION_AND="and",i.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",i.Msg.LOGIC_OPERATION_OR="or",i.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",i.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",i.Msg.LOGIC_TERNARY_CONDITION="test",i.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",i.Msg.LOGIC_TERNARY_IF_FALSE="if false",i.Msg.LOGIC_TERNARY_IF_TRUE="if true",i.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",i.Msg.MATH_ADDITION_SYMBOL="+",i.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",i.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",i.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",i.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",i.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",i.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",i.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",i.Msg.MATH_CHANGE_TITLE="change %1 by %2",i.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",i.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",i.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: π (3.141…), e (2.718…), φ (1.618…), sqrt(2) (1.414…), sqrt(½) (0.707…), or ∞ (infinity).",i.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",i.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",i.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",i.Msg.MATH_DIVISION_SYMBOL="÷",i.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",i.Msg.MATH_IS_EVEN="is even",i.Msg.MATH_IS_NEGATIVE="is negative",i.Msg.MATH_IS_ODD="is odd",i.Msg.MATH_IS_POSITIVE="is positive",i.Msg.MATH_IS_PRIME="is prime",i.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",i.Msg.MATH_IS_WHOLE="is whole",i.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",i.Msg.MATH_MODULO_TITLE="remainder of %1 ÷ %2",i.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",i.Msg.MATH_MULTIPLICATION_SYMBOL="×",i.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",i.Msg.MATH_NUMBER_TOOLTIP="A number.",i.Msg.MATH_ONLIST_HELPURL="",i.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",i.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",i.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",i.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",i.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",i.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",i.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",i.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",i.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",i.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",i.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",i.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",i.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",i.Msg.MATH_POWER_SYMBOL="^",i.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",i.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",i.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",i.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",i.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",i.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",i.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",i.Msg.MATH_ROUND_OPERATOR_ROUND="round",i.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",i.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",i.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",i.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",i.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",i.Msg.MATH_SINGLE_OP_ROOT="square root",i.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",i.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",i.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",i.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",i.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",i.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",i.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",i.Msg.MATH_SUBTRACTION_SYMBOL="-",i.Msg.MATH_TRIG_ACOS="acos",i.Msg.MATH_TRIG_ASIN="asin",i.Msg.MATH_TRIG_ATAN="atan",i.Msg.MATH_TRIG_COS="cos",i.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",i.Msg.MATH_TRIG_SIN="sin",i.Msg.MATH_TRIG_TAN="tan",i.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",i.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",i.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",i.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",i.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",i.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",i.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",i.Msg.NEW_NUMBER_VARIABLE="Create number variable...",i.Msg.NEW_STRING_VARIABLE="Create string variable...",i.Msg.NEW_VARIABLE="Create variable...",i.Msg.NEW_VARIABLE_TITLE="New variable name:",i.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",i.Msg.ORDINAL_NUMBER_SUFFIX="",i.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",i.Msg.PROCEDURES_BEFORE_PARAMS="with:",i.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",i.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",i.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",i.Msg.PROCEDURES_CREATE_DO="Create '%1'",i.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",i.Msg.PROCEDURES_DEFNORETURN_DO="",i.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",i.Msg.PROCEDURES_DEFNORETURN_TITLE="to",i.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",i.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",i.Msg.PROCEDURES_DEFRETURN_RETURN="return",i.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",i.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",i.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",i.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",i.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",i.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",i.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",i.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",i.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",i.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",i.Msg.REDO="Redo",i.Msg.REMOVE_COMMENT="Remove Comment",i.Msg.RENAME_VARIABLE="Rename variable...",i.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",i.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_APPEND_TITLE="to %1 append text %2",i.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",i.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",i.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",i.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",i.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",i.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",i.Msg.TEXT_CHARAT_FIRST="get first letter",i.Msg.TEXT_CHARAT_FROM_END="get letter # from end",i.Msg.TEXT_CHARAT_FROM_START="get letter #",i.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",i.Msg.TEXT_CHARAT_LAST="get last letter",i.Msg.TEXT_CHARAT_RANDOM="get random letter",i.Msg.TEXT_CHARAT_TAIL="",i.Msg.TEXT_CHARAT_TITLE="in text %1 %2",i.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",i.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",i.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",i.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",i.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",i.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",i.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",i.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",i.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",i.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",i.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",i.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",i.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",i.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",i.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",i.Msg.TEXT_GET_SUBSTRING_TAIL="",i.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",i.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",i.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",i.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",i.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",i.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",i.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",i.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",i.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",i.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",i.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",i.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",i.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",i.Msg.TEXT_LENGTH_TITLE="length of %1",i.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",i.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",i.Msg.TEXT_PRINT_TITLE="print %1",i.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",i.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",i.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",i.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",i.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",i.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",i.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",i.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",i.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",i.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",i.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",i.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",i.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",i.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",i.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",i.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",i.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",i.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",i.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",i.Msg.TODAY="Today",i.Msg.UNDO="Undo",i.Msg.UNNAMED_KEY="unnamed",i.Msg.VARIABLES_DEFAULT_NAME="item",i.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",i.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",i.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",i.Msg.VARIABLES_SET="set %1 to %2",i.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",i.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",i.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",i.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",i.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",i.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",i.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",i.Msg.CONTROLS_FOREACH_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_FOR_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=i.Msg.CONTROLS_IF_MSG_ELSEIF,i.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=i.Msg.CONTROLS_IF_MSG_ELSE,i.Msg.CONTROLS_IF_IF_TITLE_IF=i.Msg.CONTROLS_IF_MSG_IF,i.Msg.CONTROLS_IF_MSG_THEN=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=i.Msg.CONTROLS_REPEAT_INPUT_DO,i.Msg.LISTS_CREATE_WITH_ITEM_TITLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.LISTS_GET_INDEX_HELPURL=i.Msg.LISTS_INDEX_OF_HELPURL,i.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=i.Msg.LISTS_INLIST,i.Msg.MATH_CHANGE_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.PROCEDURES_DEFRETURN_COMMENT=i.Msg.PROCEDURES_DEFNORETURN_COMMENT,i.Msg.PROCEDURES_DEFRETURN_DO=i.Msg.PROCEDURES_DEFNORETURN_DO,i.Msg.PROCEDURES_DEFRETURN_PROCEDURE=i.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,i.Msg.PROCEDURES_DEFRETURN_TITLE=i.Msg.PROCEDURES_DEFNORETURN_TITLE,i.Msg.TEXT_APPEND_VARIABLE=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=i.Msg.VARIABLES_DEFAULT_NAME,i.Msg.MATH_HUE="230",i.Msg.LOOPS_HUE="120",i.Msg.LISTS_HUE="260",i.Msg.LOGIC_HUE="210",i.Msg.VARIABLES_HUE="330",i.Msg.TEXTS_HUE="160",i.Msg.PROCEDURES_HUE="290",i.Msg.COLOUR_HUE="20",i.Msg.VARIABLES_DYNAMIC_HUE="310",i.Msg})}(Az)),Of}var wf={},Oz={get exports(){return wf},set exports(r){wf=r}},Rf={},wz={get exports(){return Rf},set exports(r){Rf=r}},qk;function Rz(){return qk||(qk=1,function(r,e){(function(i,s){r.exports=s(MT())})(ys,function(i){var s=i.__namespace__,n={};s.module$build$src$core$contextmenu,s.module$build$src$core$extensions,s.module$build$src$core$variables,s.module$build$src$core$utils$xml;var l=s.module$build$src$core$msg.Msg,u=s.module$build$src$core$common.createBlockDefinitionsFromJsonArray,c=s.module$build$src$core$common.defineBlocks;n.blocks=u([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]);var h={customContextMenu:function(S){if(this.isInFlyout)(this.type==="variables_get_dynamic"||this.type==="variables_get_reporter_dynamic")&&(w={text:l.RENAME_VARIABLE,enabled:!0,callback:f(this)},ie=this.getField("VAR").getText(),ie={text:l.DELETE_VARIABLE.replace("%1",ie),enabled:!0,callback:p(this)},S.unshift(w),S.unshift(ie));else{var w=this.getFieldValue("VAR"),H=this.workspace.getVariableById(w).type;if(this.type==="variables_get_dynamic"){w="variables_set_dynamic";var Z=l.VARIABLES_GET_CREATE_SET}else w="variables_get_dynamic",Z=l.VARIABLES_SET_CREATE_GET;var ie={enabled:0<this.workspace.remainingCapacity()};const kt=this.getField("VAR").getText();ie.text=Z.replace("%1",kt),Z=s.module$build$src$core$utils$xml.createElement("field"),Z.setAttribute("name","VAR"),Z.setAttribute("variabletype",H),Z.appendChild(s.module$build$src$core$utils$xml.createTextNode(kt)),H=s.module$build$src$core$utils$xml.createElement("block"),H.setAttribute("type",w),H.appendChild(Z),ie.callback=s.module$build$src$core$contextmenu.callbackFactory(this,H),S.push(ie)}},onchange:function(S){S=this.getFieldValue("VAR"),S=s.module$build$src$core$variables.getVariable(this.workspace,S),this.type==="variables_get_dynamic"?this.outputConnection.setCheck(S.type):this.getInput("VALUE").connection.setCheck(S.type)}},f=function(S){return function(){const w=S.workspace,H=S.getField("VAR").getVariable();s.module$build$src$core$variables.renameVariable(w,H)}},p=function(S){return function(){const w=S.workspace,H=S.getField("VAR").getVariable();w.deleteVariableById(H.getId()),w.refreshToolboxSelection()}};s.module$build$src$core$extensions.registerMixin("contextMenu_variableDynamicSetterGetter",h),c(n.blocks);var g={};s.module$build$src$core$contextmenu,s.module$build$src$core$extensions,s.module$build$src$core$variables,s.module$build$src$core$utils$xml;var T=s.module$build$src$core$msg.Msg,$=s.module$build$src$core$common.createBlockDefinitionsFromJsonArray,y=s.module$build$src$core$common.defineBlocks;g.blocks=$([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]);var R={customContextMenu:function(S){if(this.isInFlyout)(this.type==="variables_get"||this.type==="variables_get_reporter")&&(w={text:T.RENAME_VARIABLE,enabled:!0,callback:C(this)},Z=this.getField("VAR").getText(),Z={text:T.DELETE_VARIABLE.replace("%1",Z),enabled:!0,callback:x(this)},S.unshift(w),S.unshift(Z));else{if(this.type==="variables_get")var w="variables_set",H=T.VARIABLES_GET_CREATE_SET;else w="variables_get",H=T.VARIABLES_SET_CREATE_GET;var Z={enabled:0<this.workspace.remainingCapacity()},ie=this.getField("VAR").getText();Z.text=H.replace("%1",ie),H=s.module$build$src$core$utils$xml.createElement("field"),H.setAttribute("name","VAR"),H.appendChild(s.module$build$src$core$utils$xml.createTextNode(ie)),ie=s.module$build$src$core$utils$xml.createElement("block"),ie.setAttribute("type",w),ie.appendChild(H),Z.callback=s.module$build$src$core$contextmenu.callbackFactory(this,ie),S.push(Z)}}},C=function(S){return function(){const w=S.workspace,H=S.getField("VAR").getVariable();s.module$build$src$core$variables.renameVariable(w,H)}},x=function(S){return function(){const w=S.workspace,H=S.getField("VAR").getVariable();w.deleteVariableById(H.getId()),w.refreshToolboxSelection()}};s.module$build$src$core$extensions.registerMixin("contextMenu_variableSetterGetter",R),y(g.blocks);var j={};s.module$build$src$core$extensions;var F=s.module$build$src$core$msg.Msg;s.module$build$src$core$utils$xml,s.Align$$module$build$src$core$input,s.module$build$src$core$connection_type.ConnectionType;var q=s.module$build$src$core$field_dropdown.FieldDropdown;s.FieldImage$$module$build$src$core$field_image,s.FieldTextInput$$module$build$src$core$field_textinput,s.Mutator$$module$build$src$core$mutator;var W=s.module$build$src$core$common.createBlockDefinitionsFromJsonArray,ne=s.module$build$src$core$common.defineBlocks;j.blocks=W([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"¶"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),j.blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[F.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[F.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[F.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[F.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[F.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[F.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(F.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(F.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),F.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(F.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(F.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation");var w=this.getInput("AT1").type===s.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return S.setAttribute("at1",w),w=this.getInput("AT2").type===s.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE,S.setAttribute("at2",w),S},domToMutation:function(S){const w=S.getAttribute("at1")==="true";S=S.getAttribute("at2")==="true",this.updateAt_(1,w),this.updateAt_(2,S)},updateAt_:function(S,w){this.removeInput("AT"+S),this.removeInput("ORDINAL"+S,!0),w?(this.appendValueInput("AT"+S).setCheck("Number"),F.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+S).appendField(F.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+S),S===2&&F.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(F.TEXT_GET_SUBSTRING_TAIL));const H=new q(this["WHERE_OPTIONS_"+S],function(Z){const ie=Z==="FROM_START"||Z==="FROM_END";if(ie!==w){const kt=this.getSourceBlock();return kt.updateAt_(S,ie),kt.setFieldValue(Z,"WHERE"+S),null}});this.getInput("AT"+S).appendField(H,"WHERE"+S),S===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},j.blocks.text_changeCase={init:function(){const S=[[F.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[F.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[F.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(F.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new q(S),"CASE"),this.setOutput(!0,"String"),this.setTooltip(F.TEXT_CHANGECASE_TOOLTIP)}},j.blocks.text_trim={init:function(){const S=[[F.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[F.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[F.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(F.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new q(S),"MODE"),this.setOutput(!0,"String"),this.setTooltip(F.TEXT_TRIM_TOOLTIP)}},j.blocks.text_print={init:function(){this.jsonInit({message0:F.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:F.TEXT_PRINT_TOOLTIP,helpUrl:F.TEXT_PRINT_HELPURL})}};var P={updateType_:function(S){this.outputConnection.setCheck(S==="NUMBER"?"Number":"String")},mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation");return S.setAttribute("type",this.getFieldValue("TYPE")),S},domToMutation:function(S){this.updateType_(S.getAttribute("type"))}};j.blocks.text_prompt_ext=Object.assign({},P,{init:function(){var S=[[F.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[F.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(F.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");const w=this;S=new q(S,function(H){w.updateType_(H)}),this.appendValueInput("TEXT").appendField(S,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(function(){return w.getFieldValue("TYPE")==="TEXT"?F.TEXT_PROMPT_TOOLTIP_TEXT:F.TEXT_PROMPT_TOOLTIP_NUMBER})}}),j.blocks.text_prompt=Object.assign({},P,{init:function(){this.mixin(Q);var S=[[F.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[F.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];const w=this;this.setHelpUrl(F.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),S=new q(S,function(H){w.updateType_(H)}),this.appendDummyInput().appendField(S,"TYPE").appendField(this.newQuote_(!0)).appendField(new s.FieldTextInput$$module$build$src$core$field_textinput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(function(){return w.getFieldValue("TYPE")==="TEXT"?F.TEXT_PROMPT_TOOLTIP_TEXT:F.TEXT_PROMPT_TOOLTIP_NUMBER})}}),j.blocks.text_count={init:function(){this.jsonInit({message0:F.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:F.TEXT_COUNT_TOOLTIP,helpUrl:F.TEXT_COUNT_HELPURL})}},j.blocks.text_replace={init:function(){this.jsonInit({message0:F.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:F.TEXT_REPLACE_TOOLTIP,helpUrl:F.TEXT_REPLACE_HELPURL})}},j.blocks.text_reverse={init:function(){this.jsonInit({message0:F.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:F.TEXT_REVERSE_TOOLTIP,helpUrl:F.TEXT_REVERSE_HELPURL})}};var Q={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(S){for(let w=0,H;H=this.inputList[w];w++)for(let Z=0,ie;ie=H.fieldRow[Z];Z++)if(S===ie.name){H.insertFieldAt(Z,this.newQuote_(!0)),H.insertFieldAt(Z+2,this.newQuote_(!1));return}console.warn('field named "'+S+'" not found in '+this.toDevString())},newQuote_:function(S){return S=this.RTL?!S:S,new s.FieldImage$$module$build$src$core$field_image(S?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,S?"“":"”")}},re=function(){this.mixin(Q),this.quoteField_("TEXT")},Y={mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation");return S.setAttribute("items",this.itemCount_),S},domToMutation:function(S){this.itemCount_=parseInt(S.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(S){this.itemCount_=S.itemCount,this.updateShape_()},decompose:function(S){const w=S.newBlock("text_create_join_container");w.initSvg();let H=w.getInput("STACK").connection;for(let Z=0;Z<this.itemCount_;Z++){const ie=S.newBlock("text_create_join_item");ie.initSvg(),H.connect(ie.previousConnection),H=ie.nextConnection}return w},compose:function(S){var w=S.getInputTargetBlock("STACK");for(S=[];w;)w.isInsertionMarker()||S.push(w.valueConnection_),w=w.getNextBlock();for(w=0;w<this.itemCount_;w++){const H=this.getInput("ADD"+w).connection.targetConnection;H&&S.indexOf(H)===-1&&H.disconnect()}for(this.itemCount_=S.length,this.updateShape_(),w=0;w<this.itemCount_;w++)s.Mutator$$module$build$src$core$mutator.reconnect(S[w],this,"ADD"+w)},saveConnections:function(S){S=S.getInputTargetBlock("STACK");let w=0;for(;S;){if(S.isInsertionMarker()){S=S.getNextBlock();continue}const H=this.getInput("ADD"+w);S.valueConnection_=H&&H.connection.targetConnection,S=S.getNextBlock(),w++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var S=0;S<this.itemCount_;S++)if(!this.getInput("ADD"+S)){const w=this.appendValueInput("ADD"+S).setAlign(s.Align$$module$build$src$core$input.RIGHT);S===0&&w.appendField(F.TEXT_JOIN_TITLE_CREATEWITH)}for(S=this.itemCount_;this.getInput("ADD"+S);S++)this.removeInput("ADD"+S)}},_e=function(){this.mixin(Q),this.itemCount_=2,this.updateShape_(),this.setMutator(new s.Mutator$$module$build$src$core$mutator(["text_create_join_item"],this))};s.module$build$src$core$extensions.register("text_append_tooltip",s.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var Xe=function(){const S=this;this.setTooltip(function(){return F.TEXT_INDEXOF_TOOLTIP.replace("%1",S.workspace.options.oneBasedIndex?"0":"-1")})},At={mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation");return S.setAttribute("at",!!this.isAt_),S},domToMutation:function(S){S=S.getAttribute("at")!=="false",this.updateAt_(S)},updateAt_:function(S){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),S&&(this.appendValueInput("AT").setCheck("Number"),F.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(F.ORDINAL_NUMBER_SUFFIX)),F.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(F.TEXT_CHARAT_TAIL)),this.isAt_=S}},vt=function(){this.getField("WHERE").setValidator(function(w){w=w==="FROM_START"||w==="FROM_END",w!==this.isAt_&&this.getSourceBlock().updateAt_(w)}),this.updateAt_(!0);const S=this;this.setTooltip(function(){var w=S.getFieldValue("WHERE");let H=F.TEXT_CHARAT_TOOLTIP;return(w==="FROM_START"||w==="FROM_END")&&(w=w==="FROM_START"?F.LISTS_INDEX_FROM_START_TOOLTIP:F.LISTS_INDEX_FROM_END_TOOLTIP)&&(H+="  "+w.replace("%1",S.workspace.options.oneBasedIndex?"#1":"#0")),H})};s.module$build$src$core$extensions.register("text_indexOf_tooltip",Xe),s.module$build$src$core$extensions.register("text_quotes",re),s.module$build$src$core$extensions.registerMutator("text_join_mutator",Y,_e),s.module$build$src$core$extensions.registerMutator("text_charAt_mutator",At,vt),ne(j.blocks);var je={};s.module$build$src$core$contextmenu,s.module$build$src$core$events$events,s.module$build$src$core$procedures,s.module$build$src$core$variables,s.module$build$src$core$xml,s.module$build$src$core$utils$xml,s.Align$$module$build$src$core$input,s.config$$module$build$src$core$config,s.FieldCheckbox$$module$build$src$core$field_checkbox,s.FieldLabel$$module$build$src$core$field_label,s.FieldTextInput$$module$build$src$core$field_textinput;var we=s.module$build$src$core$msg.Msg;s.Mutator$$module$build$src$core$mutator,s.module$build$src$core$names.Names;var xe=s.module$build$src$core$common.defineBlocks;je.blocks={};var St={setStatements_:function(S){this.hasStatements_!==S&&(S?(this.appendStatementInput("STACK").appendField(we.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=S)},updateParams_:function(){let S="";this.arguments_.length&&(S=we.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),s.module$build$src$core$events$events.disable();try{this.setFieldValue(S,"PARAMS")}finally{s.module$build$src$core$events$events.enable()}},mutationToDom:function(S){const w=s.module$build$src$core$utils$xml.createElement("mutation");S&&w.setAttribute("name",this.getFieldValue("NAME"));for(let H=0;H<this.argumentVarModels_.length;H++){const Z=s.module$build$src$core$utils$xml.createElement("arg"),ie=this.argumentVarModels_[H];Z.setAttribute("name",ie.name),Z.setAttribute("varid",ie.getId()),S&&this.paramIds_&&Z.setAttribute("paramId",this.paramIds_[H]),w.appendChild(Z)}return this.hasStatements_||w.setAttribute("statements","false"),w},domToMutation:function(S){this.arguments_=[],this.argumentVarModels_=[];for(let H=0,Z;Z=S.childNodes[H];H++)if(Z.nodeName.toLowerCase()==="arg"){const ie=Z.getAttribute("name");var w=Z.getAttribute("varid")||Z.getAttribute("varId");this.arguments_.push(ie),w=s.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,w,ie,""),w!==null?this.argumentVarModels_.push(w):console.log(`Failed to create a variable named "${ie}", ignoring.`)}this.updateParams_(),s.module$build$src$core$procedures.mutateCallers(this),this.setStatements_(S.getAttribute("statements")!=="false")},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const S=Object.create(null);if(this.argumentVarModels_.length){S.params=[];for(let w=0;w<this.argumentVarModels_.length;w++)S.params.push({name:this.argumentVarModels_[w].name,id:this.argumentVarModels_[w].getId()})}return this.hasStatements_||(S.hasStatements=!1),S},loadExtraState:function(S){if(this.arguments_=[],this.argumentVarModels_=[],S.params)for(let H=0;H<S.params.length;H++){var w=S.params[H];w=s.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,w.id,w.name,""),this.arguments_.push(w.name),this.argumentVarModels_.push(w)}this.updateParams_(),s.module$build$src$core$procedures.mutateCallers(this),this.setStatements_(S.hasStatements!==!1)},decompose:function(S){const w=s.module$build$src$core$utils$xml.createElement("block");w.setAttribute("type","procedures_mutatorcontainer");var H=s.module$build$src$core$utils$xml.createElement("statement");H.setAttribute("name","STACK"),w.appendChild(H);for(let ie=0;ie<this.arguments_.length;ie++){const kt=s.module$build$src$core$utils$xml.createElement("block");kt.setAttribute("type","procedures_mutatorarg");var Z=s.module$build$src$core$utils$xml.createElement("field");Z.setAttribute("name","NAME");const sl=s.module$build$src$core$utils$xml.createTextNode(this.arguments_[ie]);Z.appendChild(sl),kt.appendChild(Z),Z=s.module$build$src$core$utils$xml.createElement("next"),kt.appendChild(Z),H.appendChild(kt),H=Z}return S=s.module$build$src$core$xml.domToBlock(w,S),this.type==="procedures_defreturn"?S.setFieldValue(this.hasStatements_,"STATEMENTS"):S.removeInput("STATEMENT_INPUT"),s.module$build$src$core$procedures.mutateCallers(this),S},compose:function(S){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let w=S.getInputTargetBlock("STACK");for(;w&&!w.isInsertionMarker();){var H=w.getFieldValue("NAME");this.arguments_.push(H),H=this.workspace.getVariable(H,""),this.argumentVarModels_.push(H),this.paramIds_.push(w.id),w=w.nextConnection&&w.nextConnection.targetBlock()}this.updateParams_(),s.module$build$src$core$procedures.mutateCallers(this),S=S.getFieldValue("STATEMENTS"),S!==null&&(S=S==="TRUE",this.hasStatements_!==S)&&(S?(this.setStatements_(!0),s.Mutator$$module$build$src$core$mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(S=this.getInput("STACK").connection,(this.statementConnection_=S.targetConnection)&&(S=S.targetBlock(),S.unplug(),S.bumpNeighbours()),this.setStatements_(!1)))},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(S,w){var H=this.workspace.getVariableById(S);if(H.type===""){H=H.name,w=this.workspace.getVariableById(w);var Z=!1;for(let ie=0;ie<this.argumentVarModels_.length;ie++)this.argumentVarModels_[ie].getId()===S&&(this.arguments_[ie]=w.name,this.argumentVarModels_[ie]=w,Z=!0);Z&&(this.displayRenamedVar_(H,w.name),s.module$build$src$core$procedures.mutateCallers(this))}},updateVarName:function(S){const w=S.name;let H=!1,Z;for(let ie=0;ie<this.argumentVarModels_.length;ie++)this.argumentVarModels_[ie].getId()===S.getId()&&(Z=this.arguments_[ie],this.arguments_[ie]=w,H=!0);H&&(this.displayRenamedVar_(Z,w),s.module$build$src$core$procedures.mutateCallers(this))},displayRenamedVar_:function(S,w){if(this.updateParams_(),this.mutator&&this.mutator.isVisible()){const H=this.mutator.workspace_.getAllBlocks(!1);for(let Z=0,ie;ie=H[Z];Z++)ie.type==="procedures_mutatorarg"&&s.module$build$src$core$names.Names.equals(S,ie.getFieldValue("NAME"))&&ie.setFieldValue(w,"NAME")}},customContextMenu:function(S){if(!this.isInFlyout){var w={enabled:!0},H=this.getFieldValue("NAME");w.text=we.PROCEDURES_CREATE_DO.replace("%1",H);var Z=s.module$build$src$core$utils$xml.createElement("mutation");for(Z.setAttribute("name",H),H=0;H<this.arguments_.length;H++){var ie=s.module$build$src$core$utils$xml.createElement("arg");ie.setAttribute("name",this.arguments_[H]),Z.appendChild(ie)}if(H=s.module$build$src$core$utils$xml.createElement("block"),H.setAttribute("type",this.callType_),H.appendChild(Z),w.callback=s.module$build$src$core$contextmenu.callbackFactory(this,H),S.push(w),!this.isCollapsed())for(w=0;w<this.argumentVarModels_.length;w++)Z={enabled:!0},H=this.argumentVarModels_[w],Z.text=we.VARIABLES_SET_CREATE_GET.replace("%1",H.name),H=s.module$build$src$core$variables.generateVariableFieldDom(H),ie=s.module$build$src$core$utils$xml.createElement("block"),ie.setAttribute("type","variables_get"),ie.appendChild(H),Z.callback=s.module$build$src$core$contextmenu.callbackFactory(this,ie),S.push(Z)}}};je.blocks.procedures_defnoreturn=Object.assign({},St,{init:function(){var S=s.module$build$src$core$procedures.findLegalName("",this);S=new s.FieldTextInput$$module$build$src$core$field_textinput(S,s.module$build$src$core$procedures.rename),S.setSpellcheck(!1),this.appendDummyInput().appendField(we.PROCEDURES_DEFNORETURN_TITLE).appendField(S,"NAME").appendField("","PARAMS"),this.setMutator(new s.Mutator$$module$build$src$core$mutator(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&we.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(we.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(we.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(we.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),je.blocks.procedures_defreturn=Object.assign({},St,{init:function(){var S=s.module$build$src$core$procedures.findLegalName("",this);S=new s.FieldTextInput$$module$build$src$core$field_textinput(S,s.module$build$src$core$procedures.rename),S.setSpellcheck(!1),this.appendDummyInput().appendField(we.PROCEDURES_DEFRETURN_TITLE).appendField(S,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(s.Align$$module$build$src$core$input.RIGHT).appendField(we.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new s.Mutator$$module$build$src$core$mutator(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&we.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(we.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(we.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(we.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"}),je.blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(we.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(we.PROCEDURES_ALLOW_STATEMENTS).appendField(new s.FieldCheckbox$$module$build$src$core$field_checkbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(we.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}},je.blocks.procedures_mutatorarg={init:function(){const S=new s.FieldTextInput$$module$build$src$core$field_textinput(s.module$build$src$core$procedures.DEFAULT_ARG,this.validator_);S.oldShowEditorFn_=S.showEditor_,S.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(we.PROCEDURES_MUTATORARG_TITLE).appendField(S,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(we.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,S.onFinishEditing_=this.deleteIntermediateVars_,S.createdVariables_=[],S.onFinishEditing_("x")},validator_:function(S){var w=this.getSourceBlock();const H=s.Mutator$$module$build$src$core$mutator.findParentWs(w.workspace);if(S=S.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),!S)return null;const Z=(w.workspace.targetWorkspace||w.workspace).getAllBlocks(!1),ie=S.toLowerCase();for(let kt=0;kt<Z.length;kt++){if(Z[kt].id===this.getSourceBlock().id)continue;const sl=Z[kt].getFieldValue("NAME");if(sl&&sl.toLowerCase()===ie)return null}return w.isInFlyout||((w=H.getVariable(S,""))&&w.name!==S&&H.renameVariableById(w.getId(),S),w||(w=H.createVariable(S,""))&&this.createdVariables_&&this.createdVariables_.push(w)),S},deleteIntermediateVars_:function(S){const w=s.Mutator$$module$build$src$core$mutator.findParentWs(this.getSourceBlock().workspace);if(w)for(let H=0;H<this.createdVariables_.length;H++){const Z=this.createdVariables_[H];Z.name!==S&&w.deleteVariableById(Z.getId())}}};var It={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(S,w){s.module$build$src$core$names.Names.equals(S,this.getProcedureCall())&&(this.setFieldValue(w,"NAME"),this.setTooltip((this.outputConnection?we.PROCEDURES_CALLRETURN_TOOLTIP:we.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",w)))},setProcedureParameters_:function(S,w){var H=s.module$build$src$core$procedures.getDefinition(this.getProcedureCall(),this.workspace),Z=H&&H.mutator&&H.mutator.isVisible();if(Z?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),S.join(`
`)===this.arguments_.join(`
`))this.quarkIds_=w;else{if(w.length!==S.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),H=this.rendered,this.rendered=!1;for(let kt=0;kt<this.arguments_.length;kt++){var ie=this.getInput("ARG"+kt);ie&&(ie=ie.connection.targetConnection,this.quarkConnections_[this.quarkIds_[kt]]=ie,Z&&ie&&w.indexOf(this.quarkIds_[kt])===-1&&(ie.disconnect(),ie.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(S),this.argumentVarModels_=[],S=0;S<this.arguments_.length;S++)Z=s.module$build$src$core$variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[S],""),this.argumentVarModels_.push(Z);if(this.updateShape_(),this.quarkIds_=w)for(w=0;w<this.arguments_.length;w++)S=this.quarkIds_[w],S in this.quarkConnections_&&(s.Mutator$$module$build$src$core$mutator.reconnect(this.quarkConnections_[S],this,"ARG"+w)||delete this.quarkConnections_[S]);(this.rendered=H)&&this.render()}},updateShape_:function(){for(var S=0;S<this.arguments_.length;S++){var w=this.getField("ARGNAME"+S);if(w){s.module$build$src$core$events$events.disable();try{w.setValue(this.arguments_[S])}finally{s.module$build$src$core$events$events.enable()}}else w=new s.FieldLabel$$module$build$src$core$field_label(this.arguments_[S]),this.appendValueInput("ARG"+S).setAlign(s.Align$$module$build$src$core$input.RIGHT).appendField(w,"ARGNAME"+S).init()}for(S=this.arguments_.length;this.getInput("ARG"+S);S++)this.removeInput("ARG"+S);(S=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(S.appendField(we.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),S.init()):this.getField("WITH")&&S.removeField("WITH"))},mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation");S.setAttribute("name",this.getProcedureCall());for(let w=0;w<this.arguments_.length;w++){const H=s.module$build$src$core$utils$xml.createElement("arg");H.setAttribute("name",this.arguments_[w]),S.appendChild(H)}return S},domToMutation:function(S){var w=S.getAttribute("name");this.renameProcedure(this.getProcedureCall(),w),w=[];const H=[];for(let Z=0,ie;ie=S.childNodes[Z];Z++)ie.nodeName.toLowerCase()==="arg"&&(w.push(ie.getAttribute("name")),H.push(ie.getAttribute("paramId")));this.setProcedureParameters_(w,H)},saveExtraState:function(){const S=Object.create(null);return S.name=this.getProcedureCall(),this.arguments_.length&&(S.params=this.arguments_),S},loadExtraState:function(S){if(this.renameProcedure(this.getProcedureCall(),S.name),S=S.params){const w=[];w.length=S.length,w.fill(null),this.setProcedureParameters_(S,w)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(S){if(this.workspace&&!this.workspace.isFlyout&&S.recordUndo)if(S.type===s.module$build$src$core$events$events.BLOCK_CREATE&&S.ids.indexOf(this.id)!==-1){var w=this.getProcedureCall();if(w=s.module$build$src$core$procedures.getDefinition(w,this.workspace),!w||w.type===this.defType_&&JSON.stringify(w.getVars())===JSON.stringify(this.arguments_)||(w=null),!w){s.module$build$src$core$events$events.setGroup(S.group),S=s.module$build$src$core$utils$xml.createElement("xml"),w=s.module$build$src$core$utils$xml.createElement("block"),w.setAttribute("type",this.defType_);var H=this.getRelativeToSurfaceXY(),Z=H.y+2*s.config$$module$build$src$core$config.snapRadius;w.setAttribute("x",H.x+s.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)),w.setAttribute("y",Z),H=this.mutationToDom(),w.appendChild(H),H=s.module$build$src$core$utils$xml.createElement("field"),H.setAttribute("name","NAME"),Z=this.getProcedureCall();const ie=s.module$build$src$core$procedures.findLegalName(Z,this);Z!==ie&&this.renameProcedure(Z,ie),H.appendChild(s.module$build$src$core$utils$xml.createTextNode(Z)),w.appendChild(H),S.appendChild(w),s.module$build$src$core$xml.domToWorkspace(S,this.workspace),s.module$build$src$core$events$events.setGroup(!1)}}else S.type===s.module$build$src$core$events$events.BLOCK_DELETE?(w=this.getProcedureCall(),s.module$build$src$core$procedures.getDefinition(w,this.workspace)||(s.module$build$src$core$events$events.setGroup(S.group),this.dispose(!0),s.module$build$src$core$events$events.setGroup(!1))):S.type===s.module$build$src$core$events$events.CHANGE&&S.element==="disabled"&&(w=this.getProcedureCall(),(w=s.module$build$src$core$procedures.getDefinition(w,this.workspace))&&w.id===S.blockId&&((w=s.module$build$src$core$events$events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),s.module$build$src$core$events$events.setGroup(S.group),S.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),s.module$build$src$core$events$events.setGroup(w)))},customContextMenu:function(S){if(this.workspace.isMovable()){var w={enabled:!0};w.text=we.PROCEDURES_HIGHLIGHT_DEF;var H=this.getProcedureCall(),Z=this.workspace;w.callback=function(){const ie=s.module$build$src$core$procedures.getDefinition(H,Z);ie&&(Z.centerOnBlock(ie.id),ie.select())},S.push(w)}}};je.blocks.procedures_callnoreturn=Object.assign({},It,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(we.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defnoreturn"}),je.blocks.procedures_callreturn=Object.assign({},It,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(we.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defreturn"}),je.blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(we.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(we.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(we.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(we.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation");return S.setAttribute("value",Number(this.hasReturnValue_)),S},domToMutation:function(S){this.hasReturnValue_=S.getAttribute("value")==="1",this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(we.PROCEDURES_DEFRETURN_RETURN))},onchange:function(S){if(!(this.workspace.isDragging&&this.workspace.isDragging()||S.type!==s.module$build$src$core$events$events.BLOCK_MOVE)){var w=!1,H=this;do{if(this.FUNCTION_TYPES.indexOf(H.type)!==-1){w=!0;break}H=H.getSurroundParent()}while(H);w?(H.type==="procedures_defnoreturn"&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(we.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):H.type!=="procedures_defreturn"||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(we.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(we.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||(H=s.module$build$src$core$events$events.getGroup(),s.module$build$src$core$events$events.setGroup(S.group),this.setEnabled(w),s.module$build$src$core$events$events.setGroup(H))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},xe(je.blocks);var bt={};s.module$build$src$core$extensions,s.module$build$src$core$field_dropdown,s.module$build$src$core$utils$xml;var ei=s.module$build$src$core$common.createBlockDefinitionsFromJsonArray,z=s.module$build$src$core$common.defineBlocks;bt.blocks=ei([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["π","PI"],["e","E"],["φ","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(½)","SQRT1_2"],["∞","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);var Ce={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"};s.module$build$src$core$extensions.register("math_op_tooltip",s.module$build$src$core$extensions.buildTooltipForDropdown("OP",Ce));var pr={mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation"),w=this.getFieldValue("PROPERTY")==="DIVISIBLE_BY";return S.setAttribute("divisor_input",w),S},domToMutation:function(S){S=S.getAttribute("divisor_input")==="true",this.updateShape_(S)},updateShape_:function(S){const w=this.getInput("DIVISOR");S?w||this.appendValueInput("DIVISOR").setCheck("Number"):w&&this.removeInput("DIVISOR")}},qe=function(){this.getField("PROPERTY").setValidator(function(S){S=S==="DIVISIBLE_BY",this.getSourceBlock().updateShape_(S)})};s.module$build$src$core$extensions.registerMutator("math_is_divisibleby_mutator",pr,qe),s.module$build$src$core$extensions.register("math_change_tooltip",s.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var Kl={updateType_:function(S){S==="MODE"?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation");return S.setAttribute("op",this.getFieldValue("OP")),S},domToMutation:function(S){this.updateType_(S.getAttribute("op"))}},ft=function(){this.getField("OP").setValidator(function(S){this.updateType_(S)}.bind(this))};s.module$build$src$core$extensions.registerMutator("math_modes_of_list_mutator",Kl,ft),z(bt.blocks);var pi={};s.module$build$src$core$contextmenu,s.module$build$src$core$events$events,s.module$build$src$core$extensions,s.module$build$src$core$variables,s.module$build$src$core$utils$xml;var ls=s.module$build$src$core$msg.Msg,Wr=s.module$build$src$core$common.createBlockDefinitionsFromJsonArray,Cs=s.module$build$src$core$common.defineBlocks;pi.blocks=Wr([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);var Os={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"};s.module$build$src$core$extensions.register("controls_whileUntil_tooltip",s.module$build$src$core$extensions.buildTooltipForDropdown("MODE",Os));var gu={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"};s.module$build$src$core$extensions.register("controls_flow_tooltip",s.module$build$src$core$extensions.buildTooltipForDropdown("FLOW",gu));var as={customContextMenu:function(S){if(!this.isInFlyout){var w=this.getField("VAR").getVariable(),H=w.name;if(!this.isCollapsed()&&H!==null){const Z={enabled:!0};Z.text=ls.VARIABLES_SET_CREATE_GET.replace("%1",H),w=s.module$build$src$core$variables.generateVariableFieldDom(w),H=s.module$build$src$core$utils$xml.createElement("block"),H.setAttribute("type","variables_get"),H.appendChild(w),Z.callback=s.module$build$src$core$contextmenu.callbackFactory(this,H),S.push(Z)}}}};s.module$build$src$core$extensions.registerMixin("contextMenu_newGetVariableBlock",as),s.module$build$src$core$extensions.register("controls_for_tooltip",s.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),s.module$build$src$core$extensions.register("controls_forEach_tooltip",s.module$build$src$core$extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),pi.loopTypes=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]);var po={getSurroundLoop:function(){let S=this;do{if(pi.loopTypes.has(S.type))return S;S=S.getSurroundParent()}while(S);return null},onchange:function(S){if(this.workspace.isDragging&&!this.workspace.isDragging()&&S.type===s.module$build$src$core$events$events.BLOCK_MOVE){var w=this.getSurroundLoop(this);if(this.setWarningText(w?null:ls.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){const H=s.module$build$src$core$events$events.getGroup();s.module$build$src$core$events$events.setGroup(S.group),this.setEnabled(w),s.module$build$src$core$events$events.setGroup(H)}}}};s.module$build$src$core$extensions.registerMixin("controls_flow_in_loop_check",po),Cs(pi.blocks);var ws={};s.module$build$src$core$events$events,s.module$build$src$core$extensions,s.module$build$src$core$utils$xml;var Bi=s.module$build$src$core$msg.Msg;s.Mutator$$module$build$src$core$mutator;var Ln=s.module$build$src$core$common.createBlockDefinitionsFromJsonArray,us=s.module$build$src$core$common.defineBlocks;ws.blocks=Ln([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["≠","NEQ"],["‏<","LT"],["‏≤","LTE"],["‏>","GT"],["‏≥","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);var ql={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"};s.module$build$src$core$extensions.register("logic_op_tooltip",s.module$build$src$core$extensions.buildTooltipForDropdown("OP",ql));var gp={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const S=s.module$build$src$core$utils$xml.createElement("mutation");return this.elseifCount_&&S.setAttribute("elseif",this.elseifCount_),this.elseCount_&&S.setAttribute("else",1),S},domToMutation:function(S){this.elseifCount_=parseInt(S.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(S.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const S=Object.create(null);return this.elseifCount_&&(S.elseIfCount=this.elseifCount_),this.elseCount_&&(S.hasElse=!0),S},loadExtraState:function(S){this.elseifCount_=S.elseIfCount||0,this.elseCount_=S.hasElse?1:0,this.updateShape_()},decompose:function(S){const w=S.newBlock("controls_if_if");w.initSvg();let H=w.nextConnection;for(let Z=1;Z<=this.elseifCount_;Z++){const ie=S.newBlock("controls_if_elseif");ie.initSvg(),H.connect(ie.previousConnection),H=ie.nextConnection}return this.elseCount_&&(S=S.newBlock("controls_if_else"),S.initSvg(),H.connect(S.previousConnection)),w},compose:function(S){S=S.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const w=[null],H=[null];let Z=null;for(;S;){if(!S.isInsertionMarker())switch(S.type){case"controls_if_elseif":this.elseifCount_++,w.push(S.valueConnection_),H.push(S.statementConnection_);break;case"controls_if_else":this.elseCount_++,Z=S.statementConnection_;break;default:throw TypeError("Unknown block type: "+S.type)}S=S.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(w,H,Z)},saveConnections:function(S){S=S.nextConnection.targetBlock();let w=1;for(;S;){if(!S.isInsertionMarker())switch(S.type){case"controls_if_elseif":var H=this.getInput("IF"+w);const Z=this.getInput("DO"+w);S.valueConnection_=H&&H.connection.targetConnection,S.statementConnection_=Z&&Z.connection.targetConnection,w++;break;case"controls_if_else":H=this.getInput("ELSE"),S.statementConnection_=H&&H.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+S.type)}S=S.getNextBlock()}},rebuildShape_:function(){const S=[null],w=[null];let H=null;this.getInput("ELSE")&&(H=this.getInput("ELSE").connection.targetConnection);for(let Z=1;this.getInput("IF"+Z);Z++){const ie=this.getInput("IF"+Z),kt=this.getInput("DO"+Z);S.push(ie.connection.targetConnection),w.push(kt.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(S,w,H)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var S=1;this.getInput("IF"+S);S++)this.removeInput("IF"+S),this.removeInput("DO"+S);for(S=1;S<=this.elseifCount_;S++)this.appendValueInput("IF"+S).setCheck("Boolean").appendField(Bi.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+S).appendField(Bi.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(Bi.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(S,w,H){for(let Z=1;Z<=this.elseifCount_;Z++)s.Mutator$$module$build$src$core$mutator.reconnect(S[Z],this,"IF"+Z),s.Mutator$$module$build$src$core$mutator.reconnect(w[Z],this,"DO"+Z);s.Mutator$$module$build$src$core$mutator.reconnect(H,this,"ELSE")}};s.module$build$src$core$extensions.registerMutator("controls_if_mutator",gp,null,["controls_if_elseif","controls_if_else"]);var Eh=function(){this.setTooltip(function(){if(this.elseifCount_||this.elseCount_){if(!this.elseifCount_&&this.elseCount_)return Bi.CONTROLS_IF_TOOLTIP_2;if(this.elseifCount_&&!this.elseCount_)return Bi.CONTROLS_IF_TOOLTIP_3;if(this.elseifCount_&&this.elseCount_)return Bi.CONTROLS_IF_TOOLTIP_4}else return Bi.CONTROLS_IF_TOOLTIP_1;return""}.bind(this))};s.module$build$src$core$extensions.register("controls_if_tooltip",Eh);var Rs={onchange:function(S){this.prevBlocks_||(this.prevBlocks_=[null,null]);var w=this.getInputTargetBlock("A");const H=this.getInputTargetBlock("B");w&&H&&!this.workspace.connectionChecker.doTypeChecks(w.outputConnection,H.outputConnection)&&(s.module$build$src$core$events$events.setGroup(S.group),S=this.prevBlocks_[0],S!==w&&(w.unplug(),!S||S.isDisposed()||S.isShadow()||this.getInput("A").connection.connect(S.outputConnection)),w=this.prevBlocks_[1],w!==H&&(H.unplug(),!w||w.isDisposed()||w.isShadow()||this.getInput("B").connection.connect(w.outputConnection)),this.bumpNeighbours(),s.module$build$src$core$events$events.setGroup(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},_p=function(){this.mixin(Rs)};s.module$build$src$core$extensions.register("logic_compare",_p);var Mn={prevParentConnection_:null,onchange:function(S){const w=this.getInputTargetBlock("THEN"),H=this.getInputTargetBlock("ELSE"),Z=this.outputConnection.targetConnection;if((w||H)&&Z)for(let ie=0;2>ie;ie++){const kt=ie===1?w:H;kt&&!kt.workspace.connectionChecker.doTypeChecks(kt.outputConnection,Z)&&(s.module$build$src$core$events$events.setGroup(S.group),Z===this.prevParentConnection_?(this.unplug(),Z.getSourceBlock().bumpNeighbours()):(kt.unplug(),kt.bumpNeighbours()),s.module$build$src$core$events$events.setGroup(!1))}this.prevParentConnection_=Z}};s.module$build$src$core$extensions.registerMixin("logic_ternary",Mn),us(ws.blocks);var nr={};s.module$build$src$core$utils$xml,s.module$build$src$core$xml,s.Align$$module$build$src$core$input,s.module$build$src$core$connection_type.ConnectionType;var Zs=s.module$build$src$core$field_dropdown.FieldDropdown,be=s.module$build$src$core$msg.Msg;s.Mutator$$module$build$src$core$mutator;var $h=s.module$build$src$core$common.createBlockDefinitionsFromJsonArray,vh=s.module$build$src$core$common.defineBlocks;nr.blocks=$h([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),nr.blocks.lists_create_with={init:function(){this.setHelpUrl(be.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new s.Mutator$$module$build$src$core$mutator(["lists_create_with_item"],this)),this.setTooltip(be.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation");return S.setAttribute("items",this.itemCount_),S},domToMutation:function(S){this.itemCount_=parseInt(S.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(S){this.itemCount_=S.itemCount,this.updateShape_()},decompose:function(S){const w=S.newBlock("lists_create_with_container");w.initSvg();let H=w.getInput("STACK").connection;for(let Z=0;Z<this.itemCount_;Z++){const ie=S.newBlock("lists_create_with_item");ie.initSvg(),H.connect(ie.previousConnection),H=ie.nextConnection}return w},compose:function(S){var w=S.getInputTargetBlock("STACK");for(S=[];w;)w.isInsertionMarker()||S.push(w.valueConnection_),w=w.getNextBlock();for(w=0;w<this.itemCount_;w++){const H=this.getInput("ADD"+w).connection.targetConnection;H&&S.indexOf(H)===-1&&H.disconnect()}for(this.itemCount_=S.length,this.updateShape_(),w=0;w<this.itemCount_;w++)s.Mutator$$module$build$src$core$mutator.reconnect(S[w],this,"ADD"+w)},saveConnections:function(S){S=S.getInputTargetBlock("STACK");let w=0;for(;S;){if(S.isInsertionMarker()){S=S.getNextBlock();continue}const H=this.getInput("ADD"+w);S.valueConnection_=H&&H.connection.targetConnection,S=S.getNextBlock(),w++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(be.LISTS_CREATE_EMPTY_TITLE);for(var S=0;S<this.itemCount_;S++)if(!this.getInput("ADD"+S)){const w=this.appendValueInput("ADD"+S).setAlign(s.Align$$module$build$src$core$input.RIGHT);S===0&&w.appendField(be.LISTS_CREATE_WITH_INPUT_WITH)}for(S=this.itemCount_;this.getInput("ADD"+S);S++)this.removeInput("ADD"+S)}},nr.blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(be.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(be.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},nr.blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(be.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(be.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},nr.blocks.lists_indexOf={init:function(){const S=[[be.LISTS_INDEX_OF_FIRST,"FIRST"],[be.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(be.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(be.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new Zs(S),"END"),this.setInputsInline(!0);const w=this;this.setTooltip(function(){return be.LISTS_INDEX_OF_TOOLTIP.replace("%1",w.workspace.options.oneBasedIndex?"0":"-1")})}},nr.blocks.lists_getIndex={init:function(){var S=[[be.LISTS_GET_INDEX_GET,"GET"],[be.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[be.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[be.LISTS_GET_INDEX_FROM_START,"FROM_START"],[be.LISTS_GET_INDEX_FROM_END,"FROM_END"],[be.LISTS_GET_INDEX_FIRST,"FIRST"],[be.LISTS_GET_INDEX_LAST,"LAST"],[be.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(be.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),S=new Zs(S,function(H){H=H==="REMOVE",this.getSourceBlock().updateStatement_(H)}),this.appendValueInput("VALUE").setCheck("Array").appendField(be.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(S,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),be.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(be.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);const w=this;this.setTooltip(function(){const H=w.getFieldValue("MODE"),Z=w.getFieldValue("WHERE");let ie="";switch(H+" "+Z){case"GET FROM_START":case"GET FROM_END":ie=be.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":ie=be.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":ie=be.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":ie=be.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":ie=be.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":ie=be.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":ie=be.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":ie=be.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":ie=be.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":ie=be.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":ie=be.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":ie=be.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return(Z==="FROM_START"||Z==="FROM_END")&&(ie+="  "+(Z==="FROM_START"?be.LISTS_INDEX_FROM_START_TOOLTIP:be.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",w.workspace.options.oneBasedIndex?"#1":"#0")),ie})},mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation");S.setAttribute("statement",!this.outputConnection);const w=this.getInput("AT").type===s.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return S.setAttribute("at",w),S},domToMutation:function(S){const w=S.getAttribute("statement")==="true";this.updateStatement_(w),S=S.getAttribute("at")!=="false",this.updateAt_(S)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(S){S.isStatement?this.updateStatement_(!0):typeof S=="string"&&this.domToMutation(s.module$build$src$core$xml.textToDom(S))},updateStatement_:function(S){S!==!this.outputConnection&&(this.unplug(!0,!0),S?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(S){this.removeInput("AT"),this.removeInput("ORDINAL",!0),S?(this.appendValueInput("AT").setCheck("Number"),be.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(be.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const w=new Zs(this.WHERE_OPTIONS,function(H){const Z=H==="FROM_START"||H==="FROM_END";if(Z!==S){const ie=this.getSourceBlock();return ie.updateAt_(Z),ie.setFieldValue(H,"WHERE"),null}});this.getInput("AT").appendField(w,"WHERE"),be.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},nr.blocks.lists_setIndex={init:function(){const S=[[be.LISTS_SET_INDEX_SET,"SET"],[be.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[be.LISTS_GET_INDEX_FROM_START,"FROM_START"],[be.LISTS_GET_INDEX_FROM_END,"FROM_END"],[be.LISTS_GET_INDEX_FIRST,"FIRST"],[be.LISTS_GET_INDEX_LAST,"LAST"],[be.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(be.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(be.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new Zs(S),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(be.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(be.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);const w=this;this.setTooltip(function(){const H=w.getFieldValue("MODE"),Z=w.getFieldValue("WHERE");let ie="";switch(H+" "+Z){case"SET FROM_START":case"SET FROM_END":ie=be.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":ie=be.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":ie=be.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":ie=be.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":ie=be.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":ie=be.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":ie=be.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":ie=be.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return(Z==="FROM_START"||Z==="FROM_END")&&(ie+="  "+be.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",w.workspace.options.oneBasedIndex?"#1":"#0")),ie})},mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation"),w=this.getInput("AT").type===s.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return S.setAttribute("at",w),S},domToMutation:function(S){S=S.getAttribute("at")!=="false",this.updateAt_(S)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(S){this.removeInput("AT"),this.removeInput("ORDINAL",!0),S?(this.appendValueInput("AT").setCheck("Number"),be.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(be.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const w=new Zs(this.WHERE_OPTIONS,function(H){const Z=H==="FROM_START"||H==="FROM_END";if(Z!==S){const ie=this.getSourceBlock();return ie.updateAt_(Z),ie.setFieldValue(H,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(w,"WHERE")}},nr.blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[be.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[be.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[be.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[be.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[be.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[be.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(be.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(be.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),be.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(be.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(be.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation");var w=this.getInput("AT1").type===s.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE;return S.setAttribute("at1",w),w=this.getInput("AT2").type===s.module$build$src$core$connection_type.ConnectionType.INPUT_VALUE,S.setAttribute("at2",w),S},domToMutation:function(S){const w=S.getAttribute("at1")==="true";S=S.getAttribute("at2")==="true",this.updateAt_(1,w),this.updateAt_(2,S)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(S,w){this.removeInput("AT"+S),this.removeInput("ORDINAL"+S,!0),w?(this.appendValueInput("AT"+S).setCheck("Number"),be.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+S).appendField(be.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+S);const H=new Zs(this["WHERE_OPTIONS_"+S],function(Z){const ie=Z==="FROM_START"||Z==="FROM_END";if(ie!==w){const kt=this.getSourceBlock();return kt.updateAt_(S,ie),kt.setFieldValue(Z,"WHERE"+S),null}});this.getInput("AT"+S).appendField(H,"WHERE"+S),S===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),be.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},nr.blocks.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},nr.blocks.lists_split={init:function(){const S=this,w=new Zs([[be.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[be.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(H){S.updateType_(H)});this.setHelpUrl(be.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(w,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(be.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(function(){const H=S.getFieldValue("MODE");if(H==="SPLIT")return be.LISTS_SPLIT_TOOLTIP_SPLIT;if(H==="JOIN")return be.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+H)})},updateType_:function(S){if(this.getFieldValue("MODE")!==S){const w=this.getInput("INPUT").connection;w.setShadowDom(null);const H=w.targetBlock();H&&(w.disconnect(),H.isShadow()?H.dispose():this.bumpNeighbours())}S==="SPLIT"?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const S=s.module$build$src$core$utils$xml.createElement("mutation");return S.setAttribute("mode",this.getFieldValue("MODE")),S},domToMutation:function(S){this.updateType_(S.getAttribute("mode"))},saveExtraState:function(){return null},loadExtraState:function(){}},vh(nr.blocks);var rl={},yh=s.module$build$src$core$common.createBlockDefinitionsFromJsonArray,Jl=s.module$build$src$core$common.defineBlocks;rl.blocks=yh([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),Jl(rl.blocks);var or={};return or.colour=rl,or.lists=nr,or.logic=ws,or.loops=pi,or.math=bt,or.procedures=je,or.texts=j,or.variables=g,or.variablesDynamic=n,or.blocks=Object.assign({},rl.blocks,nr.blocks,ws.blocks,pi.blocks,bt.blocks,je.blocks,g.blocks,n.blocks),or.__namespace__=s,or})}(wz)),Rf}var Jk;function Nz(){return Jk||(Jk=1,function(r,e){(function(i,s){r.exports=s(Rz())})(ys,function(i){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})}(Oz)),wf}var Nf={},xz={get exports(){return Nf},set exports(r){Nf=r}},xf={},Dz={get exports(){return xf},set exports(r){xf=r}},Qk;function Lz(){return Qk||(Qk=1,function(r,e){(function(i,s){r.exports=s(MT())})(ys,function(i){var s=i.__namespace__,n={};s.module$build$src$core$variables,s.module$build$src$core$utils$string,s.CodeGenerator$$module$build$src$core$generator,s.module$build$src$core$input_types.inputTypes,s.module$build$src$core$names.Names,s.NameType$$module$build$src$core$names,n.javascriptGenerator=new s.CodeGenerator$$module$build$src$core$generator("JavaScript"),n.javascriptGenerator.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(",")),n.javascriptGenerator.ORDER_ATOMIC=0,n.javascriptGenerator.ORDER_NEW=1.1,n.javascriptGenerator.ORDER_MEMBER=1.2,n.javascriptGenerator.ORDER_FUNCTION_CALL=2,n.javascriptGenerator.ORDER_INCREMENT=3,n.javascriptGenerator.ORDER_DECREMENT=3,n.javascriptGenerator.ORDER_BITWISE_NOT=4.1,n.javascriptGenerator.ORDER_UNARY_PLUS=4.2,n.javascriptGenerator.ORDER_UNARY_NEGATION=4.3,n.javascriptGenerator.ORDER_LOGICAL_NOT=4.4,n.javascriptGenerator.ORDER_TYPEOF=4.5,n.javascriptGenerator.ORDER_VOID=4.6,n.javascriptGenerator.ORDER_DELETE=4.7,n.javascriptGenerator.ORDER_AWAIT=4.8,n.javascriptGenerator.ORDER_EXPONENTIATION=5,n.javascriptGenerator.ORDER_MULTIPLICATION=5.1,n.javascriptGenerator.ORDER_DIVISION=5.2,n.javascriptGenerator.ORDER_MODULUS=5.3,n.javascriptGenerator.ORDER_SUBTRACTION=6.1,n.javascriptGenerator.ORDER_ADDITION=6.2,n.javascriptGenerator.ORDER_BITWISE_SHIFT=7,n.javascriptGenerator.ORDER_RELATIONAL=8,n.javascriptGenerator.ORDER_IN=8,n.javascriptGenerator.ORDER_INSTANCEOF=8,n.javascriptGenerator.ORDER_EQUALITY=9,n.javascriptGenerator.ORDER_BITWISE_AND=10,n.javascriptGenerator.ORDER_BITWISE_XOR=11,n.javascriptGenerator.ORDER_BITWISE_OR=12,n.javascriptGenerator.ORDER_LOGICAL_AND=13,n.javascriptGenerator.ORDER_LOGICAL_OR=14,n.javascriptGenerator.ORDER_CONDITIONAL=15,n.javascriptGenerator.ORDER_ASSIGNMENT=16,n.javascriptGenerator.ORDER_YIELD=17,n.javascriptGenerator.ORDER_COMMA=18,n.javascriptGenerator.ORDER_NONE=99,n.javascriptGenerator.ORDER_OVERRIDES=[[n.javascriptGenerator.ORDER_FUNCTION_CALL,n.javascriptGenerator.ORDER_MEMBER],[n.javascriptGenerator.ORDER_FUNCTION_CALL,n.javascriptGenerator.ORDER_FUNCTION_CALL],[n.javascriptGenerator.ORDER_MEMBER,n.javascriptGenerator.ORDER_MEMBER],[n.javascriptGenerator.ORDER_MEMBER,n.javascriptGenerator.ORDER_FUNCTION_CALL],[n.javascriptGenerator.ORDER_LOGICAL_NOT,n.javascriptGenerator.ORDER_LOGICAL_NOT],[n.javascriptGenerator.ORDER_MULTIPLICATION,n.javascriptGenerator.ORDER_MULTIPLICATION],[n.javascriptGenerator.ORDER_ADDITION,n.javascriptGenerator.ORDER_ADDITION],[n.javascriptGenerator.ORDER_LOGICAL_AND,n.javascriptGenerator.ORDER_LOGICAL_AND],[n.javascriptGenerator.ORDER_LOGICAL_OR,n.javascriptGenerator.ORDER_LOGICAL_OR]],n.javascriptGenerator.isInitialized=!1,n.javascriptGenerator.init=function(f){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new s.module$build$src$core$names.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(f.getVariableMap()),this.nameDB_.populateVariables(f),this.nameDB_.populateProcedures(f);const p=[];var g=s.module$build$src$core$variables.allDeveloperVariables(f);for(let T=0;T<g.length;T++)p.push(this.nameDB_.getName(g[T],s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for(f=s.module$build$src$core$variables.allUsedVarModels(f),g=0;g<f.length;g++)p.push(this.nameDB_.getName(f[g].getId(),s.NameType$$module$build$src$core$names.VARIABLE));p.length&&(this.definitions_.variables="var "+p.join(", ")+";"),this.isInitialized=!0},n.javascriptGenerator.finish=function(f){const p=Object.values(this.definitions_);return f=Object.getPrototypeOf(this).finish.call(this,f),this.isInitialized=!1,this.nameDB_.reset(),p.join(`

`)+`


`+f},n.javascriptGenerator.scrubNakedValue=function(f){return f+`;
`},n.javascriptGenerator.quote_=function(f){return f=f.replace(/\\/g,"\\\\").replace(/\n/g,`\\
`).replace(/'/g,"\\'"),"'"+f+"'"},n.javascriptGenerator.multiline_quote_=function(f){return f.split(/\n/g).map(this.quote_).join(` + '\\n' +
`)},n.javascriptGenerator.scrub_=function(f,p,g){let T="";if(!f.outputConnection||!f.outputConnection.targetConnection){var $=f.getCommentText();$&&($=s.module$build$src$core$utils$string.wrap($,this.COMMENT_WRAP-3),T+=this.prefixLines($+`
`,"// "));for(let y=0;y<f.inputList.length;y++)f.inputList[y].type===s.module$build$src$core$input_types.inputTypes.VALUE&&($=f.inputList[y].connection.targetBlock())&&($=this.allNestedComments($))&&(T+=this.prefixLines($,"// "))}return f=f.nextConnection&&f.nextConnection.targetBlock(),g=g?"":this.blockToCode(f),T+p+g},n.javascriptGenerator.getAdjusted=function(f,p,g,T,$){g=g||0,$=$||this.ORDER_NONE,f.workspace.options.oneBasedIndex&&g--;const y=f.workspace.options.oneBasedIndex?"1":"0";let R,C=$;return 0<g?R=C=this.ORDER_ADDITION:0>g?R=C=this.ORDER_SUBTRACTION:T&&(R=C=this.ORDER_UNARY_NEGATION),f=this.valueToCode(f,p,C)||y,s.module$build$src$core$utils$string.isNumber(f)?(f=Number(f)+g,T&&(f=-f)):(0<g?f=f+" + "+g:0>g&&(f=f+" - "+-g),T&&(f=g?"-("+f+")":"-"+f),R=Math.floor(R),$=Math.floor($),R&&$>=R&&(f="("+f+")")),f},s.NameType$$module$build$src$core$names,n.javascriptGenerator.variables_get=function(f){return[n.javascriptGenerator.nameDB_.getName(f.getFieldValue("VAR"),s.NameType$$module$build$src$core$names.VARIABLE),n.javascriptGenerator.ORDER_ATOMIC]},n.javascriptGenerator.variables_set=function(f){const p=n.javascriptGenerator.valueToCode(f,"VALUE",n.javascriptGenerator.ORDER_ASSIGNMENT)||"0";return n.javascriptGenerator.nameDB_.getName(f.getFieldValue("VAR"),s.NameType$$module$build$src$core$names.VARIABLE)+" = "+p+`;
`},n.javascriptGenerator.variables_get_dynamic=n.javascriptGenerator.variables_get,n.javascriptGenerator.variables_set_dynamic=n.javascriptGenerator.variables_set,s.NameType$$module$build$src$core$names;var l=/^\s*'([^']|\\')*'\s*$/,u=function(f){return l.test(f)?[f,n.javascriptGenerator.ORDER_ATOMIC]:["String("+f+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},c=function(f,p,g){return p==="FIRST"?"0":p==="FROM_END"?f+".length - 1 - "+g:p==="LAST"?f+".length - 1":g};n.javascriptGenerator.text=function(f){return[n.javascriptGenerator.quote_(f.getFieldValue("TEXT")),n.javascriptGenerator.ORDER_ATOMIC]},n.javascriptGenerator.text_multiline=function(f){f=n.javascriptGenerator.multiline_quote_(f.getFieldValue("TEXT"));const p=f.indexOf("+")!==-1?n.javascriptGenerator.ORDER_ADDITION:n.javascriptGenerator.ORDER_ATOMIC;return[f,p]},n.javascriptGenerator.text_join=function(f){switch(f.itemCount_){case 0:return["''",n.javascriptGenerator.ORDER_ATOMIC];case 1:return f=n.javascriptGenerator.valueToCode(f,"ADD0",n.javascriptGenerator.ORDER_NONE)||"''",u(f);case 2:var p=n.javascriptGenerator.valueToCode(f,"ADD0",n.javascriptGenerator.ORDER_NONE)||"''";return f=n.javascriptGenerator.valueToCode(f,"ADD1",n.javascriptGenerator.ORDER_NONE)||"''",[u(p)[0]+" + "+u(f)[0],n.javascriptGenerator.ORDER_ADDITION];default:p=Array(f.itemCount_);for(let g=0;g<f.itemCount_;g++)p[g]=n.javascriptGenerator.valueToCode(f,"ADD"+g,n.javascriptGenerator.ORDER_NONE)||"''";return["["+p.join(",")+"].join('')",n.javascriptGenerator.ORDER_FUNCTION_CALL]}},n.javascriptGenerator.text_append=function(f){const p=n.javascriptGenerator.nameDB_.getName(f.getFieldValue("VAR"),s.NameType$$module$build$src$core$names.VARIABLE);return f=n.javascriptGenerator.valueToCode(f,"TEXT",n.javascriptGenerator.ORDER_NONE)||"''",p+" += "+u(f)[0]+`;
`},n.javascriptGenerator.text_length=function(f){return[(n.javascriptGenerator.valueToCode(f,"VALUE",n.javascriptGenerator.ORDER_MEMBER)||"''")+".length",n.javascriptGenerator.ORDER_MEMBER]},n.javascriptGenerator.text_isEmpty=function(f){return["!"+(n.javascriptGenerator.valueToCode(f,"VALUE",n.javascriptGenerator.ORDER_MEMBER)||"''")+".length",n.javascriptGenerator.ORDER_LOGICAL_NOT]},n.javascriptGenerator.text_indexOf=function(f){var p=f.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf";const g=n.javascriptGenerator.valueToCode(f,"FIND",n.javascriptGenerator.ORDER_NONE)||"''";return p=(n.javascriptGenerator.valueToCode(f,"VALUE",n.javascriptGenerator.ORDER_MEMBER)||"''")+"."+p+"("+g+")",f.workspace.options.oneBasedIndex?[p+" + 1",n.javascriptGenerator.ORDER_ADDITION]:[p,n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.text_charAt=function(f){const p=f.getFieldValue("WHERE")||"FROM_START",g=n.javascriptGenerator.valueToCode(f,"VALUE",p==="RANDOM"?n.javascriptGenerator.ORDER_NONE:n.javascriptGenerator.ORDER_MEMBER)||"''";switch(p){case"FIRST":return[g+".charAt(0)",n.javascriptGenerator.ORDER_FUNCTION_CALL];case"LAST":return[g+".slice(-1)",n.javascriptGenerator.ORDER_FUNCTION_CALL];case"FROM_START":return f=n.javascriptGenerator.getAdjusted(f,"AT"),[g+".charAt("+f+")",n.javascriptGenerator.ORDER_FUNCTION_CALL];case"FROM_END":return f=n.javascriptGenerator.getAdjusted(f,"AT",1,!0),[g+".slice("+f+").charAt(0)",n.javascriptGenerator.ORDER_FUNCTION_CALL];case"RANDOM":return[n.javascriptGenerator.provideFunction_("textRandomLetter",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(text) {
  var x = Math.floor(Math.random() * text.length);
  return text[x];
}
`)+"("+g+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},n.javascriptGenerator.text_getSubstring=function(f){var p=f.getFieldValue("WHERE1"),g=f.getFieldValue("WHERE2"),T=p!=="FROM_END"&&p!=="LAST"&&g!=="FROM_END"&&g!=="LAST",$=n.javascriptGenerator.valueToCode(f,"STRING",T?n.javascriptGenerator.ORDER_MEMBER:n.javascriptGenerator.ORDER_NONE)||"''";if(p==="FIRST"&&g==="LAST")return[$,n.javascriptGenerator.ORDER_NONE];if($.match(/^'?\w+'?$/)||T){switch(p){case"FROM_START":p=n.javascriptGenerator.getAdjusted(f,"AT1");break;case"FROM_END":p=n.javascriptGenerator.getAdjusted(f,"AT1",1,!1,n.javascriptGenerator.ORDER_SUBTRACTION),p=$+".length - "+p;break;case"FIRST":p="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(g){case"FROM_START":g=n.javascriptGenerator.getAdjusted(f,"AT2",1);break;case"FROM_END":g=n.javascriptGenerator.getAdjusted(f,"AT2",0,!1,n.javascriptGenerator.ORDER_SUBTRACTION),g=$+".length - "+g;break;case"LAST":g=$+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}$=$+".slice("+p+", "+g+")"}else{T=n.javascriptGenerator.getAdjusted(f,"AT1"),f=n.javascriptGenerator.getAdjusted(f,"AT2");const y={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};$=n.javascriptGenerator.provideFunction_("subsequence"+y[p]+y[g],`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(sequence${p==="FROM_END"||p==="FROM_START"?", at1":""}${g==="FROM_END"||g==="FROM_START"?", at2":""}) {
  var start = ${c("sequence",p,"at1")};
  var end = ${c("sequence",g,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+$+(p==="FROM_END"||p==="FROM_START"?", "+T:"")+(g==="FROM_END"||g==="FROM_START"?", "+f:"")+")"}return[$,n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.text_changeCase=function(f){const p={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[f.getFieldValue("CASE")];return f=n.javascriptGenerator.valueToCode(f,"TEXT",p?n.javascriptGenerator.ORDER_MEMBER:n.javascriptGenerator.ORDER_NONE)||"''",[p?f+p:n.javascriptGenerator.provideFunction_("textToTitleCase",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(str) {
  return str.replace(/\\S+/g,
      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});
}
`)+"("+f+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.text_trim=function(f){const p={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[f.getFieldValue("MODE")];return[(n.javascriptGenerator.valueToCode(f,"TEXT",n.javascriptGenerator.ORDER_MEMBER)||"''")+p,n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.text_print=function(f){return"window.alert("+(n.javascriptGenerator.valueToCode(f,"TEXT",n.javascriptGenerator.ORDER_NONE)||"''")+`);
`},n.javascriptGenerator.text_prompt_ext=function(f){let p="window.prompt("+(f.getField("TEXT")?n.javascriptGenerator.quote_(f.getFieldValue("TEXT")):n.javascriptGenerator.valueToCode(f,"TEXT",n.javascriptGenerator.ORDER_NONE)||"''")+")";return f.getFieldValue("TYPE")==="NUMBER"&&(p="Number("+p+")"),[p,n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.text_prompt=n.javascriptGenerator.text_prompt_ext,n.javascriptGenerator.text_count=function(f){const p=n.javascriptGenerator.valueToCode(f,"TEXT",n.javascriptGenerator.ORDER_NONE)||"''";return f=n.javascriptGenerator.valueToCode(f,"SUB",n.javascriptGenerator.ORDER_NONE)||"''",[n.javascriptGenerator.provideFunction_("textCount",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle) {
  if (needle.length === 0) {
    return haystack.length + 1;
  } else {
    return haystack.split(needle).length - 1;
  }
}
`)+"("+p+", "+f+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.text_replace=function(f){const p=n.javascriptGenerator.valueToCode(f,"TEXT",n.javascriptGenerator.ORDER_NONE)||"''",g=n.javascriptGenerator.valueToCode(f,"FROM",n.javascriptGenerator.ORDER_NONE)||"''";return f=n.javascriptGenerator.valueToCode(f,"TO",n.javascriptGenerator.ORDER_NONE)||"''",[n.javascriptGenerator.provideFunction_("textReplace",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle, replacement) {
  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')
                 .replace(/\\x08/g, '\\\\x08');
  return haystack.replace(new RegExp(needle, 'g'), replacement);
}
`)+"("+p+", "+g+", "+f+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.text_reverse=function(f){return[(n.javascriptGenerator.valueToCode(f,"TEXT",n.javascriptGenerator.ORDER_MEMBER)||"''")+".split('').reverse().join('')",n.javascriptGenerator.ORDER_FUNCTION_CALL]},s.NameType$$module$build$src$core$names,n.javascriptGenerator.procedures_defreturn=function(f){const p=n.javascriptGenerator.nameDB_.getName(f.getFieldValue("NAME"),s.NameType$$module$build$src$core$names.PROCEDURE);var g="";n.javascriptGenerator.STATEMENT_PREFIX&&(g+=n.javascriptGenerator.injectId(n.javascriptGenerator.STATEMENT_PREFIX,f)),n.javascriptGenerator.STATEMENT_SUFFIX&&(g+=n.javascriptGenerator.injectId(n.javascriptGenerator.STATEMENT_SUFFIX,f)),g&&(g=n.javascriptGenerator.prefixLines(g,n.javascriptGenerator.INDENT));let T="";n.javascriptGenerator.INFINITE_LOOP_TRAP&&(T=n.javascriptGenerator.prefixLines(n.javascriptGenerator.injectId(n.javascriptGenerator.INFINITE_LOOP_TRAP,f),n.javascriptGenerator.INDENT));const $=n.javascriptGenerator.statementToCode(f,"STACK");let y=n.javascriptGenerator.valueToCode(f,"RETURN",n.javascriptGenerator.ORDER_NONE)||"",R="";$&&y&&(R=g),y&&(y=n.javascriptGenerator.INDENT+"return "+y+`;
`);const C=[],x=f.getVars();for(let j=0;j<x.length;j++)C[j]=n.javascriptGenerator.nameDB_.getName(x[j],s.NameType$$module$build$src$core$names.VARIABLE);return g="function "+p+"("+C.join(", ")+`) {
`+g+T+$+R+y+"}",g=n.javascriptGenerator.scrub_(f,g),n.javascriptGenerator.definitions_["%"+p]=g,null},n.javascriptGenerator.procedures_defnoreturn=n.javascriptGenerator.procedures_defreturn,n.javascriptGenerator.procedures_callreturn=function(f){const p=n.javascriptGenerator.nameDB_.getName(f.getFieldValue("NAME"),s.NameType$$module$build$src$core$names.PROCEDURE),g=[],T=f.getVars();for(let $=0;$<T.length;$++)g[$]=n.javascriptGenerator.valueToCode(f,"ARG"+$,n.javascriptGenerator.ORDER_NONE)||"null";return[p+"("+g.join(", ")+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.procedures_callnoreturn=function(f){return n.javascriptGenerator.procedures_callreturn(f)[0]+`;
`},n.javascriptGenerator.procedures_ifreturn=function(f){let p="if ("+(n.javascriptGenerator.valueToCode(f,"CONDITION",n.javascriptGenerator.ORDER_NONE)||"false")+`) {
`;return n.javascriptGenerator.STATEMENT_SUFFIX&&(p+=n.javascriptGenerator.prefixLines(n.javascriptGenerator.injectId(n.javascriptGenerator.STATEMENT_SUFFIX,f),n.javascriptGenerator.INDENT)),f.hasReturnValue_?(f=n.javascriptGenerator.valueToCode(f,"VALUE",n.javascriptGenerator.ORDER_NONE)||"null",p+=n.javascriptGenerator.INDENT+"return "+f+`;
`):p+=n.javascriptGenerator.INDENT+`return;
`,p+`}
`},s.NameType$$module$build$src$core$names,n.javascriptGenerator.math_number=function(f){return f=Number(f.getFieldValue("NUM")),[f,0<=f?n.javascriptGenerator.ORDER_ATOMIC:n.javascriptGenerator.ORDER_UNARY_NEGATION]},n.javascriptGenerator.math_arithmetic=function(f){var p={ADD:[" + ",n.javascriptGenerator.ORDER_ADDITION],MINUS:[" - ",n.javascriptGenerator.ORDER_SUBTRACTION],MULTIPLY:[" * ",n.javascriptGenerator.ORDER_MULTIPLICATION],DIVIDE:[" / ",n.javascriptGenerator.ORDER_DIVISION],POWER:[null,n.javascriptGenerator.ORDER_NONE]}[f.getFieldValue("OP")];const g=p[0];p=p[1];const T=n.javascriptGenerator.valueToCode(f,"A",p)||"0";return f=n.javascriptGenerator.valueToCode(f,"B",p)||"0",g?[T+g+f,p]:["Math.pow("+T+", "+f+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.math_single=function(f){const p=f.getFieldValue("OP");let g;if(p==="NEG")return f=n.javascriptGenerator.valueToCode(f,"NUM",n.javascriptGenerator.ORDER_UNARY_NEGATION)||"0",f[0]==="-"&&(f=" "+f),["-"+f,n.javascriptGenerator.ORDER_UNARY_NEGATION];switch(f=p==="SIN"||p==="COS"||p==="TAN"?n.javascriptGenerator.valueToCode(f,"NUM",n.javascriptGenerator.ORDER_DIVISION)||"0":n.javascriptGenerator.valueToCode(f,"NUM",n.javascriptGenerator.ORDER_NONE)||"0",p){case"ABS":g="Math.abs("+f+")";break;case"ROOT":g="Math.sqrt("+f+")";break;case"LN":g="Math.log("+f+")";break;case"EXP":g="Math.exp("+f+")";break;case"POW10":g="Math.pow(10,"+f+")";break;case"ROUND":g="Math.round("+f+")";break;case"ROUNDUP":g="Math.ceil("+f+")";break;case"ROUNDDOWN":g="Math.floor("+f+")";break;case"SIN":g="Math.sin("+f+" / 180 * Math.PI)";break;case"COS":g="Math.cos("+f+" / 180 * Math.PI)";break;case"TAN":g="Math.tan("+f+" / 180 * Math.PI)"}if(g)return[g,n.javascriptGenerator.ORDER_FUNCTION_CALL];switch(p){case"LOG10":g="Math.log("+f+") / Math.log(10)";break;case"ASIN":g="Math.asin("+f+") / Math.PI * 180";break;case"ACOS":g="Math.acos("+f+") / Math.PI * 180";break;case"ATAN":g="Math.atan("+f+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+p)}return[g,n.javascriptGenerator.ORDER_DIVISION]},n.javascriptGenerator.math_constant=function(f){return{PI:["Math.PI",n.javascriptGenerator.ORDER_MEMBER],E:["Math.E",n.javascriptGenerator.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",n.javascriptGenerator.ORDER_DIVISION],SQRT2:["Math.SQRT2",n.javascriptGenerator.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",n.javascriptGenerator.ORDER_MEMBER],INFINITY:["Infinity",n.javascriptGenerator.ORDER_ATOMIC]}[f.getFieldValue("CONSTANT")]},n.javascriptGenerator.math_number_property=function(f){var p={EVEN:[" % 2 === 0",n.javascriptGenerator.ORDER_MODULUS,n.javascriptGenerator.ORDER_EQUALITY],ODD:[" % 2 === 1",n.javascriptGenerator.ORDER_MODULUS,n.javascriptGenerator.ORDER_EQUALITY],WHOLE:[" % 1 === 0",n.javascriptGenerator.ORDER_MODULUS,n.javascriptGenerator.ORDER_EQUALITY],POSITIVE:[" > 0",n.javascriptGenerator.ORDER_RELATIONAL,n.javascriptGenerator.ORDER_RELATIONAL],NEGATIVE:[" < 0",n.javascriptGenerator.ORDER_RELATIONAL,n.javascriptGenerator.ORDER_RELATIONAL],DIVISIBLE_BY:[null,n.javascriptGenerator.ORDER_MODULUS,n.javascriptGenerator.ORDER_EQUALITY],PRIME:[null,n.javascriptGenerator.ORDER_NONE,n.javascriptGenerator.ORDER_FUNCTION_CALL]};const g=f.getFieldValue("PROPERTY"),[T,$,y]=p[g];return p=n.javascriptGenerator.valueToCode(f,"NUMBER_TO_CHECK",$)||"0",g==="PRIME"?f=n.javascriptGenerator.provideFunction_("mathIsPrime",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(n) {
  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods
  if (n == 2 || n == 3) {
    return true;
  }
  // False if n is NaN, negative, is 1, or not whole.
  // And false if n is divisible by 2 or 3.
  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {
    return false;
  }
  // Check all the numbers of form 6k +/- 1, up to sqrt(n).
  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {
    if (n % (x - 1) === 0 || n % (x + 1) === 0) {
      return false;
    }
  }
  return true;
}
`)+"("+p+")":g==="DIVISIBLE_BY"?(f=n.javascriptGenerator.valueToCode(f,"DIVISOR",n.javascriptGenerator.ORDER_MODULUS)||"0",f=p+" % "+f+" === 0"):f=p+T,[f,y]},n.javascriptGenerator.math_change=function(f){const p=n.javascriptGenerator.valueToCode(f,"DELTA",n.javascriptGenerator.ORDER_ADDITION)||"0";return f=n.javascriptGenerator.nameDB_.getName(f.getFieldValue("VAR"),s.NameType$$module$build$src$core$names.VARIABLE),f+" = (typeof "+f+" === 'number' ? "+f+" : 0) + "+p+`;
`},n.javascriptGenerator.math_round=n.javascriptGenerator.math_single,n.javascriptGenerator.math_trig=n.javascriptGenerator.math_single,n.javascriptGenerator.math_on_list=function(f){var p=f.getFieldValue("OP");switch(p){case"SUM":f=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_MEMBER)||"[]",f+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":f=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_NONE)||"[]",f="Math.min.apply(null, "+f+")";break;case"MAX":f=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_NONE)||"[]",f="Math.max.apply(null, "+f+")";break;case"AVERAGE":p=n.javascriptGenerator.provideFunction_("mathMean",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;
}
`),f=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_NONE)||"[]",f=p+"("+f+")";break;case"MEDIAN":p=n.javascriptGenerator.provideFunction_("mathMedian",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  var localList = myList.filter(function (x) {return typeof x === 'number';});
  if (!localList.length) return null;
  localList.sort(function(a, b) {return b - a;});
  if (localList.length % 2 === 0) {
    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;
  } else {
    return localList[(localList.length - 1) / 2];
  }
}
`),f=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_NONE)||"[]",f=p+"("+f+")";break;case"MODE":p=n.javascriptGenerator.provideFunction_("mathModes",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(values) {
  var modes = [];
  var counts = [];
  var maxCount = 0;
  for (var i = 0; i < values.length; i++) {
    var value = values[i];
    var found = false;
    var thisCount;
    for (var j = 0; j < counts.length; j++) {
      if (counts[j][0] === value) {
        thisCount = ++counts[j][1];
        found = true;
        break;
      }
    }
    if (!found) {
      counts.push([value, 1]);
      thisCount = 1;
    }
    maxCount = Math.max(thisCount, maxCount);
  }
  for (var j = 0; j < counts.length; j++) {
    if (counts[j][1] === maxCount) {
        modes.push(counts[j][0]);
    }
  }
  return modes;
}
`),f=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_NONE)||"[]",f=p+"("+f+")";break;case"STD_DEV":p=n.javascriptGenerator.provideFunction_("mathStandardDeviation",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(numbers) {
  var n = numbers.length;
  if (!n) return null;
  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;
  var variance = 0;
  for (var j = 0; j < n; j++) {
    variance += Math.pow(numbers[j] - mean, 2);
  }
  variance = variance / n;
  return Math.sqrt(variance);
}
`),f=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_NONE)||"[]",f=p+"("+f+")";break;case"RANDOM":p=n.javascriptGenerator.provideFunction_("mathRandomList",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(list) {
  var x = Math.floor(Math.random() * list.length);
  return list[x];
}
`),f=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_NONE)||"[]",f=p+"("+f+")";break;default:throw Error("Unknown operator: "+p)}return[f,n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.math_modulo=function(f){const p=n.javascriptGenerator.valueToCode(f,"DIVIDEND",n.javascriptGenerator.ORDER_MODULUS)||"0";return f=n.javascriptGenerator.valueToCode(f,"DIVISOR",n.javascriptGenerator.ORDER_MODULUS)||"0",[p+" % "+f,n.javascriptGenerator.ORDER_MODULUS]},n.javascriptGenerator.math_constrain=function(f){const p=n.javascriptGenerator.valueToCode(f,"VALUE",n.javascriptGenerator.ORDER_NONE)||"0",g=n.javascriptGenerator.valueToCode(f,"LOW",n.javascriptGenerator.ORDER_NONE)||"0";return f=n.javascriptGenerator.valueToCode(f,"HIGH",n.javascriptGenerator.ORDER_NONE)||"Infinity",["Math.min(Math.max("+p+", "+g+"), "+f+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.math_random_int=function(f){const p=n.javascriptGenerator.valueToCode(f,"FROM",n.javascriptGenerator.ORDER_NONE)||"0";return f=n.javascriptGenerator.valueToCode(f,"TO",n.javascriptGenerator.ORDER_NONE)||"0",[n.javascriptGenerator.provideFunction_("mathRandomInt",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(a, b) {
  if (a > b) {
    // Swap a and b to ensure a is smaller.
    var c = a;
    a = b;
    b = c;
  }
  return Math.floor(Math.random() * (b - a + 1) + a);
}
`)+"("+p+", "+f+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.math_random_float=function(f){return["Math.random()",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.math_atan2=function(f){const p=n.javascriptGenerator.valueToCode(f,"X",n.javascriptGenerator.ORDER_NONE)||"0";return["Math.atan2("+(n.javascriptGenerator.valueToCode(f,"Y",n.javascriptGenerator.ORDER_NONE)||"0")+", "+p+") / Math.PI * 180",n.javascriptGenerator.ORDER_DIVISION]},s.module$build$src$core$utils$string,s.NameType$$module$build$src$core$names,n.javascriptGenerator.controls_repeat_ext=function(f){let p;p=f.getField("TIMES")?String(Number(f.getFieldValue("TIMES"))):n.javascriptGenerator.valueToCode(f,"TIMES",n.javascriptGenerator.ORDER_ASSIGNMENT)||"0";let g=n.javascriptGenerator.statementToCode(f,"DO");g=n.javascriptGenerator.addLoopTrap(g,f),f="";const T=n.javascriptGenerator.nameDB_.getDistinctName("count",s.NameType$$module$build$src$core$names.VARIABLE);let $=p;return p.match(/^\w+$/)||s.module$build$src$core$utils$string.isNumber(p)||($=n.javascriptGenerator.nameDB_.getDistinctName("repeat_end",s.NameType$$module$build$src$core$names.VARIABLE),f+="var "+$+" = "+p+`;
`),f+("for (var "+T+" = 0; "+T+" < "+$+"; "+T+`++) {
`+g+`}
`)},n.javascriptGenerator.controls_repeat=n.javascriptGenerator.controls_repeat_ext,n.javascriptGenerator.controls_whileUntil=function(f){const p=f.getFieldValue("MODE")==="UNTIL";let g=n.javascriptGenerator.valueToCode(f,"BOOL",p?n.javascriptGenerator.ORDER_LOGICAL_NOT:n.javascriptGenerator.ORDER_NONE)||"false",T=n.javascriptGenerator.statementToCode(f,"DO");return T=n.javascriptGenerator.addLoopTrap(T,f),p&&(g="!"+g),"while ("+g+`) {
`+T+`}
`},n.javascriptGenerator.controls_for=function(f){var p=n.javascriptGenerator.nameDB_.getName(f.getFieldValue("VAR"),s.NameType$$module$build$src$core$names.VARIABLE),g=n.javascriptGenerator.valueToCode(f,"FROM",n.javascriptGenerator.ORDER_ASSIGNMENT)||"0",T=n.javascriptGenerator.valueToCode(f,"TO",n.javascriptGenerator.ORDER_ASSIGNMENT)||"0";const $=n.javascriptGenerator.valueToCode(f,"BY",n.javascriptGenerator.ORDER_ASSIGNMENT)||"1";let y=n.javascriptGenerator.statementToCode(f,"DO");if(y=n.javascriptGenerator.addLoopTrap(y,f),s.module$build$src$core$utils$string.isNumber(g)&&s.module$build$src$core$utils$string.isNumber(T)&&s.module$build$src$core$utils$string.isNumber($)){var R=Number(g)<=Number(T);f="for ("+p+" = "+g+"; "+p+(R?" <= ":" >= ")+T+"; "+p,p=Math.abs(Number($)),f=p===1?f+(R?"++":"--"):f+((R?" += ":" -= ")+p),f+=`) {
`+y+`}
`}else f="",R=g,g.match(/^\w+$/)||s.module$build$src$core$utils$string.isNumber(g)||(R=n.javascriptGenerator.nameDB_.getDistinctName(p+"_start",s.NameType$$module$build$src$core$names.VARIABLE),f+="var "+R+" = "+g+`;
`),g=T,T.match(/^\w+$/)||s.module$build$src$core$utils$string.isNumber(T)||(g=n.javascriptGenerator.nameDB_.getDistinctName(p+"_end",s.NameType$$module$build$src$core$names.VARIABLE),f+="var "+g+" = "+T+`;
`),T=n.javascriptGenerator.nameDB_.getDistinctName(p+"_inc",s.NameType$$module$build$src$core$names.VARIABLE),f+="var "+T+" = ",f=s.module$build$src$core$utils$string.isNumber($)?f+(Math.abs($)+`;
`):f+("Math.abs("+$+`);
`),f+="if ("+R+" > "+g+`) {
`,f+=n.javascriptGenerator.INDENT+T+" = -"+T+`;
`,f=f+`}
for (`+(p+" = "+R+"; "+T+" >= 0 ? "+p+" <= "+g+" : "+p+" >= "+g+"; "+p+" += "+T+`) {
`+y+`}
`);return f},n.javascriptGenerator.controls_forEach=function(f){const p=n.javascriptGenerator.nameDB_.getName(f.getFieldValue("VAR"),s.NameType$$module$build$src$core$names.VARIABLE);var g=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_ASSIGNMENT)||"[]";let T=n.javascriptGenerator.statementToCode(f,"DO");T=n.javascriptGenerator.addLoopTrap(T,f),f="";let $=g;return g.match(/^\w+$/)||($=n.javascriptGenerator.nameDB_.getDistinctName(p+"_list",s.NameType$$module$build$src$core$names.VARIABLE),f+="var "+$+" = "+g+`;
`),g=n.javascriptGenerator.nameDB_.getDistinctName(p+"_index",s.NameType$$module$build$src$core$names.VARIABLE),T=n.javascriptGenerator.INDENT+p+" = "+$+"["+g+`];
`+T,f+("for (var "+g+" in "+$+`) {
`+T+`}
`)},n.javascriptGenerator.controls_flow_statements=function(f){let p="";if(n.javascriptGenerator.STATEMENT_PREFIX&&(p+=n.javascriptGenerator.injectId(n.javascriptGenerator.STATEMENT_PREFIX,f)),n.javascriptGenerator.STATEMENT_SUFFIX&&(p+=n.javascriptGenerator.injectId(n.javascriptGenerator.STATEMENT_SUFFIX,f)),n.javascriptGenerator.STATEMENT_PREFIX){const g=f.getSurroundLoop();g&&!g.suppressPrefixSuffix&&(p+=n.javascriptGenerator.injectId(n.javascriptGenerator.STATEMENT_PREFIX,g))}switch(f.getFieldValue("FLOW")){case"BREAK":return p+`break;
`;case"CONTINUE":return p+`continue;
`}throw Error("Unknown flow statement.")},n.javascriptGenerator.controls_if=function(f){var p=0;let g="";n.javascriptGenerator.STATEMENT_PREFIX&&(g+=n.javascriptGenerator.injectId(n.javascriptGenerator.STATEMENT_PREFIX,f));do{const T=n.javascriptGenerator.valueToCode(f,"IF"+p,n.javascriptGenerator.ORDER_NONE)||"false";let $=n.javascriptGenerator.statementToCode(f,"DO"+p);n.javascriptGenerator.STATEMENT_SUFFIX&&($=n.javascriptGenerator.prefixLines(n.javascriptGenerator.injectId(n.javascriptGenerator.STATEMENT_SUFFIX,f),n.javascriptGenerator.INDENT)+$),g+=(0<p?" else ":"")+"if ("+T+`) {
`+$+"}",p++}while(f.getInput("IF"+p));return(f.getInput("ELSE")||n.javascriptGenerator.STATEMENT_SUFFIX)&&(p=n.javascriptGenerator.statementToCode(f,"ELSE"),n.javascriptGenerator.STATEMENT_SUFFIX&&(p=n.javascriptGenerator.prefixLines(n.javascriptGenerator.injectId(n.javascriptGenerator.STATEMENT_SUFFIX,f),n.javascriptGenerator.INDENT)+p),g+=` else {
`+p+"}"),g+`
`},n.javascriptGenerator.controls_ifelse=n.javascriptGenerator.controls_if,n.javascriptGenerator.logic_compare=function(f){const p={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[f.getFieldValue("OP")],g=p==="=="||p==="!="?n.javascriptGenerator.ORDER_EQUALITY:n.javascriptGenerator.ORDER_RELATIONAL,T=n.javascriptGenerator.valueToCode(f,"A",g)||"0";return f=n.javascriptGenerator.valueToCode(f,"B",g)||"0",[T+" "+p+" "+f,g]},n.javascriptGenerator.logic_operation=function(f){const p=f.getFieldValue("OP")==="AND"?"&&":"||",g=p==="&&"?n.javascriptGenerator.ORDER_LOGICAL_AND:n.javascriptGenerator.ORDER_LOGICAL_OR;let T=n.javascriptGenerator.valueToCode(f,"A",g);if(f=n.javascriptGenerator.valueToCode(f,"B",g),T||f){const $=p==="&&"?"true":"false";T||(T=$),f||(f=$)}else f=T="false";return[T+" "+p+" "+f,g]},n.javascriptGenerator.logic_negate=function(f){const p=n.javascriptGenerator.ORDER_LOGICAL_NOT;return["!"+(n.javascriptGenerator.valueToCode(f,"BOOL",p)||"true"),p]},n.javascriptGenerator.logic_boolean=function(f){return[f.getFieldValue("BOOL")==="TRUE"?"true":"false",n.javascriptGenerator.ORDER_ATOMIC]},n.javascriptGenerator.logic_null=function(f){return["null",n.javascriptGenerator.ORDER_ATOMIC]},n.javascriptGenerator.logic_ternary=function(f){const p=n.javascriptGenerator.valueToCode(f,"IF",n.javascriptGenerator.ORDER_CONDITIONAL)||"false",g=n.javascriptGenerator.valueToCode(f,"THEN",n.javascriptGenerator.ORDER_CONDITIONAL)||"null";return f=n.javascriptGenerator.valueToCode(f,"ELSE",n.javascriptGenerator.ORDER_CONDITIONAL)||"null",[p+" ? "+g+" : "+f,n.javascriptGenerator.ORDER_CONDITIONAL]},s.NameType$$module$build$src$core$names,n.javascriptGenerator.lists_create_empty=function(f){return["[]",n.javascriptGenerator.ORDER_ATOMIC]},n.javascriptGenerator.lists_create_with=function(f){const p=Array(f.itemCount_);for(let g=0;g<f.itemCount_;g++)p[g]=n.javascriptGenerator.valueToCode(f,"ADD"+g,n.javascriptGenerator.ORDER_NONE)||"null";return["["+p.join(", ")+"]",n.javascriptGenerator.ORDER_ATOMIC]},n.javascriptGenerator.lists_repeat=function(f){const p=n.javascriptGenerator.provideFunction_("listsRepeat",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(value, n) {
  var array = [];
  for (var i = 0; i < n; i++) {
    array[i] = value;
  }
  return array;
}
`),g=n.javascriptGenerator.valueToCode(f,"ITEM",n.javascriptGenerator.ORDER_NONE)||"null";return f=n.javascriptGenerator.valueToCode(f,"NUM",n.javascriptGenerator.ORDER_NONE)||"0",[p+"("+g+", "+f+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.lists_length=function(f){return[(n.javascriptGenerator.valueToCode(f,"VALUE",n.javascriptGenerator.ORDER_MEMBER)||"[]")+".length",n.javascriptGenerator.ORDER_MEMBER]},n.javascriptGenerator.lists_isEmpty=function(f){return["!"+(n.javascriptGenerator.valueToCode(f,"VALUE",n.javascriptGenerator.ORDER_MEMBER)||"[]")+".length",n.javascriptGenerator.ORDER_LOGICAL_NOT]},n.javascriptGenerator.lists_indexOf=function(f){var p=f.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf";const g=n.javascriptGenerator.valueToCode(f,"FIND",n.javascriptGenerator.ORDER_NONE)||"''";return p=(n.javascriptGenerator.valueToCode(f,"VALUE",n.javascriptGenerator.ORDER_MEMBER)||"[]")+"."+p+"("+g+")",f.workspace.options.oneBasedIndex?[p+" + 1",n.javascriptGenerator.ORDER_ADDITION]:[p,n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.lists_getIndex=function(f){const p=f.getFieldValue("MODE")||"GET",g=f.getFieldValue("WHERE")||"FROM_START";var T=n.javascriptGenerator.valueToCode(f,"VALUE",g==="RANDOM"?n.javascriptGenerator.ORDER_NONE:n.javascriptGenerator.ORDER_MEMBER)||"[]";switch(g){case"FIRST":if(p==="GET")return[T+"[0]",n.javascriptGenerator.ORDER_MEMBER];if(p==="GET_REMOVE")return[T+".shift()",n.javascriptGenerator.ORDER_MEMBER];if(p==="REMOVE")return T+`.shift();
`;break;case"LAST":if(p==="GET")return[T+".slice(-1)[0]",n.javascriptGenerator.ORDER_MEMBER];if(p==="GET_REMOVE")return[T+".pop()",n.javascriptGenerator.ORDER_MEMBER];if(p==="REMOVE")return T+`.pop();
`;break;case"FROM_START":if(f=n.javascriptGenerator.getAdjusted(f,"AT"),p==="GET")return[T+"["+f+"]",n.javascriptGenerator.ORDER_MEMBER];if(p==="GET_REMOVE")return[T+".splice("+f+", 1)[0]",n.javascriptGenerator.ORDER_FUNCTION_CALL];if(p==="REMOVE")return T+".splice("+f+`, 1);
`;break;case"FROM_END":if(f=n.javascriptGenerator.getAdjusted(f,"AT",1,!0),p==="GET")return[T+".slice("+f+")[0]",n.javascriptGenerator.ORDER_FUNCTION_CALL];if(p==="GET_REMOVE")return[T+".splice("+f+", 1)[0]",n.javascriptGenerator.ORDER_FUNCTION_CALL];if(p==="REMOVE")return T+".splice("+f+", 1);";break;case"RANDOM":if(T=n.javascriptGenerator.provideFunction_("listsGetRandomItem",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {
  var x = Math.floor(Math.random() * list.length);
  if (remove) {
    return list.splice(x, 1)[0];
  } else {
    return list[x];
  }
}
`)+"("+T+", "+(p!=="GET")+")",p==="GET"||p==="GET_REMOVE")return[T,n.javascriptGenerator.ORDER_FUNCTION_CALL];if(p==="REMOVE")return T+`;
`}throw Error("Unhandled combination (lists_getIndex).")},n.javascriptGenerator.lists_setIndex=function(f){function p(){if(g.match(/^\w+$/))return"";const R=n.javascriptGenerator.nameDB_.getDistinctName("tmpList",s.NameType$$module$build$src$core$names.VARIABLE),C="var "+R+" = "+g+`;
`;return g=R,C}let g=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_MEMBER)||"[]";const T=f.getFieldValue("MODE")||"GET";var $=f.getFieldValue("WHERE")||"FROM_START";const y=n.javascriptGenerator.valueToCode(f,"TO",n.javascriptGenerator.ORDER_ASSIGNMENT)||"null";switch($){case"FIRST":if(T==="SET")return g+"[0] = "+y+`;
`;if(T==="INSERT")return g+".unshift("+y+`);
`;break;case"LAST":if(T==="SET")return p()+(g+"["+g+".length - 1] = "+y+`;
`);if(T==="INSERT")return g+".push("+y+`);
`;break;case"FROM_START":if(f=n.javascriptGenerator.getAdjusted(f,"AT"),T==="SET")return g+"["+f+"] = "+y+`;
`;if(T==="INSERT")return g+".splice("+f+", 0, "+y+`);
`;break;case"FROM_END":if(f=n.javascriptGenerator.getAdjusted(f,"AT",1,!1,n.javascriptGenerator.ORDER_SUBTRACTION),$=p(),T==="SET")return $+(g+"["+g+".length - "+f+"] = "+y+`;
`);if(T==="INSERT")return $+(g+".splice("+g+".length - "+f+", 0, "+y+`);
`);break;case"RANDOM":if(f=p(),$=n.javascriptGenerator.nameDB_.getDistinctName("tmpX",s.NameType$$module$build$src$core$names.VARIABLE),f+="var "+$+" = Math.floor(Math.random() * "+g+`.length);
`,T==="SET")return f+(g+"["+$+"] = "+y+`;
`);if(T==="INSERT")return f+(g+".splice("+$+", 0, "+y+`);
`)}throw Error("Unhandled combination (lists_setIndex).")};var h=function(f,p,g){return p==="FIRST"?"0":p==="FROM_END"?f+".length - 1 - "+g:p==="LAST"?f+".length - 1":g};return n.javascriptGenerator.lists_getSublist=function(f){var p=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_MEMBER)||"[]",g=f.getFieldValue("WHERE1"),T=f.getFieldValue("WHERE2");if(g==="FIRST"&&T==="LAST")p+=".slice(0)";else if(p.match(/^\w+$/)||g!=="FROM_END"&&T==="FROM_START"){switch(g){case"FROM_START":g=n.javascriptGenerator.getAdjusted(f,"AT1");break;case"FROM_END":g=n.javascriptGenerator.getAdjusted(f,"AT1",1,!1,n.javascriptGenerator.ORDER_SUBTRACTION),g=p+".length - "+g;break;case"FIRST":g="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(T){case"FROM_START":T=n.javascriptGenerator.getAdjusted(f,"AT2",1);break;case"FROM_END":T=n.javascriptGenerator.getAdjusted(f,"AT2",0,!1,n.javascriptGenerator.ORDER_SUBTRACTION),T=p+".length - "+T;break;case"LAST":T=p+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}p=p+".slice("+g+", "+T+")"}else{const $=n.javascriptGenerator.getAdjusted(f,"AT1");f=n.javascriptGenerator.getAdjusted(f,"AT2");const y={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};p=n.javascriptGenerator.provideFunction_("subsequence"+y[g]+y[T],`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(sequence${g==="FROM_END"||g==="FROM_START"?", at1":""}${T==="FROM_END"||T==="FROM_START"?", at2":""}) {
  var start = ${h("sequence",g,"at1")};
  var end = ${h("sequence",T,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+p+(g==="FROM_END"||g==="FROM_START"?", "+$:"")+(T==="FROM_END"||T==="FROM_START"?", "+f:"")+")"}return[p,n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.lists_sort=function(f){const p=n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_FUNCTION_CALL)||"[]",g=f.getFieldValue("DIRECTION")==="1"?1:-1;f=f.getFieldValue("TYPE");const T=n.javascriptGenerator.provideFunction_("listsGetSortCompare",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {
  var compareFuncs = {
    'NUMERIC': function(a, b) {
        return Number(a) - Number(b); },
    'TEXT': function(a, b) {
        return a.toString() > b.toString() ? 1 : -1; },
    'IGNORE_CASE': function(a, b) {
        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },
  };
  var compare = compareFuncs[type];
  return function(a, b) { return compare(a, b) * direction; };
}
      `);return[p+".slice().sort("+T+'("'+f+'", '+g+"))",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.lists_split=function(f){let p=n.javascriptGenerator.valueToCode(f,"INPUT",n.javascriptGenerator.ORDER_MEMBER);const g=n.javascriptGenerator.valueToCode(f,"DELIM",n.javascriptGenerator.ORDER_NONE)||"''";if(f=f.getFieldValue("MODE"),f==="SPLIT")p||(p="''"),f="split";else if(f==="JOIN")p||(p="[]"),f="join";else throw Error("Unknown mode: "+f);return[p+"."+f+"("+g+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.lists_reverse=function(f){return[(n.javascriptGenerator.valueToCode(f,"LIST",n.javascriptGenerator.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.colour_picker=function(f){return[n.javascriptGenerator.quote_(f.getFieldValue("COLOUR")),n.javascriptGenerator.ORDER_ATOMIC]},n.javascriptGenerator.colour_random=function(f){return[n.javascriptGenerator.provideFunction_("colourRandom",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}() {
  var num = Math.floor(Math.random() * Math.pow(2, 24));
  return '#' + ('00000' + num.toString(16)).substr(-6);
}
`)+"()",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.colour_rgb=function(f){const p=n.javascriptGenerator.valueToCode(f,"RED",n.javascriptGenerator.ORDER_NONE)||0,g=n.javascriptGenerator.valueToCode(f,"GREEN",n.javascriptGenerator.ORDER_NONE)||0;return f=n.javascriptGenerator.valueToCode(f,"BLUE",n.javascriptGenerator.ORDER_NONE)||0,[n.javascriptGenerator.provideFunction_("colourRgb",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {
  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;
  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;
  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;
  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);
  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);
  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+p+", "+g+", "+f+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.javascriptGenerator.colour_blend=function(f){const p=n.javascriptGenerator.valueToCode(f,"COLOUR1",n.javascriptGenerator.ORDER_NONE)||"'#000000'",g=n.javascriptGenerator.valueToCode(f,"COLOUR2",n.javascriptGenerator.ORDER_NONE)||"'#000000'";return f=n.javascriptGenerator.valueToCode(f,"RATIO",n.javascriptGenerator.ORDER_NONE)||.5,[n.javascriptGenerator.provideFunction_("colourBlend",`
function ${n.javascriptGenerator.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {
  ratio = Math.max(Math.min(Number(ratio), 1), 0);
  var r1 = parseInt(c1.substring(1, 3), 16);
  var g1 = parseInt(c1.substring(3, 5), 16);
  var b1 = parseInt(c1.substring(5, 7), 16);
  var r2 = parseInt(c2.substring(1, 3), 16);
  var g2 = parseInt(c2.substring(3, 5), 16);
  var b2 = parseInt(c2.substring(5, 7), 16);
  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);
  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);
  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);
  r = ('0' + (r || 0).toString(16)).slice(-2);
  g = ('0' + (g || 0).toString(16)).slice(-2);
  b = ('0' + (b || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+p+", "+g+", "+f+")",n.javascriptGenerator.ORDER_FUNCTION_CALL]},n.__namespace__=s,n})}(Dz)),xf}var Zk;function Mz(){return Zk||(Zk=1,function(r,e){(function(i,s){r.exports=s(vR(),Lz())})(ys,function(i,s){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return s})}(xz)),Nf}var eA;function Bz(){return eA||(eA=1,function(r,e){(function(i,s){r.exports=s(vR(),Cz(),Nz(),Mz())})(ys,function(i,s,n,l){return i.setLocale(s),i})}(vz)),If}(function(r,e){(function(i,s){r.exports=s(Bz())})(ys,function(i){/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return i})})($z);const ab=au,Zo=["Variable","Formula"],Pz={type:"combination",message0:"%1 %2 %3",args0:[{type:"input_value",name:"PROPOSITION1",check:Zo},{type:"field_dropdown",name:"TYPE",options:[["∧","and"],["∨","or"],["→","implies"],["↔","iff"]]},{type:"input_value",name:"PROPOSITION2",check:Zo}],inputsInline:!0,output:"Formula",colour:165},Fz={type:"conj",message0:"From both %1 and %2 we have %3",args0:[{type:"field_input",name:"HYPOTHESIS1",text:"HP"},{type:"field_input",name:"HYPOTHESIS2",text:"HQ"},{type:"input_value",name:"CONJUNCTION"}],colour:0,previousStatement:null,nextStatement:null},Uz={type:"destruct",message0:"From %1 %2 we have both %3 %4 and %5 %6",args0:[{type:"field_input",name:"ASSUMPTION",text:"H"},{type:"input_value",name:"ASSUMPTIONPROP"},{type:"field_input",name:"HYPOTHESIS1",text:"HP"},{type:"input_value",name:"PROPOSITION1",check:Zo},{type:"field_input",name:"HYPOTHESIS2",text:"HQ"},{type:"input_value",name:"PROPOSITION2",check:Zo}],inputsInline:!0,colour:195,previousStatement:null,nextStatement:null},Hz={type:"intro",message0:"Let %1 be the %2 %3",args0:[{type:"field_input",name:"NAME",text:"P"},{type:"field_dropdown",name:"TYPE",options:[["proposition","forall"],["assumption that","implies"]]},{type:"input_value",name:"PROPOSITION",check:Zo}],colour:270,previousStatement:null,nextStatement:null},Gz={type:"negation",message0:"¬ %1",args0:[{type:"input_value",name:"PROPOSITION",check:Zo}],output:"Formula",colour:300,helpUrl:""},Vz={type:"quantifier",message0:"%1 %2 %3",args0:[{type:"field_dropdown",name:"TYPE",options:[["∀","forall"],["∃","exists"]]},{type:"input_value",name:"VARIABLE",check:"Variable"},{type:"input_value",name:"PREDICATE",check:Zo}],inputsInline:!1,output:"Formula",colour:345},Wz={type:"theorem",message0:"Theorem %1 %2",args0:[{type:"field_input",name:"NAME",text:"My Theorem"},{type:"input_value",name:"PROPOSITION",check:Zo}],message1:"Proof %1",args1:[{type:"input_statement",name:"ARGUMENT"}],message2:"Q.E.D. %1",args2:[{type:"input_dummy",align:"RIGHT"}],colour:240},zz={type:"variable",message0:"%1",args0:[{type:"field_input",name:"NAME",text:"P"}],output:"Variable",colour:210},Yz={type:"exact",message0:"exactly %1",args0:[{type:"field_input",name:"NAME",text:"P"}],previousStatement:null,nextStatement:null,colour:240,helpUrl:""};ab.common.defineBlocksWithJsonArray([Pz,Fz,Uz,Hz,Gz,Vz,Wz,zz,Yz]);function Xz(r,e){const i=ab.inject(r,e),s=i.newBlock("theorem");return s.setDeletable(!1),s.setMovable(!1),s.initSvg(),i.render(),i.addChangeListener(ab.Events.disableOrphans),i}function jz(r){let e;return{c(){e=Ft("div"),this.h()},l(i){e=Ut(i,"DIV",{class:!0}),Vt(e).forEach(ue),this.h()},h(){Ki(e,"class","blocklyContainer svelte-1w40d01")},m(i,s){Ee(i,e,s),r[6](e)},p:Wi,i:Wi,o:Wi,d(i){i&&ue(e),r[6](null)}}}function Kz(r,e,i){let{toolbox:s}=e,{width:n="800px"}=e,{height:l="600px"}=e,{workspace:u}=e,c,h=!1;ub(async()=>{i(0,c.style.height=l,c),i(0,c.style.width=n,c),i(1,u=Xz(c,{toolbox:s})),i(5,h=!0)});function f(p){cb[p?"unshift":"push"](()=>{c=p,i(0,c),i(5,h),i(4,l),i(3,n),i(1,u)})}return r.$$set=p=>{"toolbox"in p&&i(2,s=p.toolbox),"width"in p&&i(3,n=p.width),"height"in p&&i(4,l=p.height),"workspace"in p&&i(1,u=p.workspace)},r.$$.update=()=>{r.$$.dirty&58&&h&&(i(0,c.style.height=l,c),i(0,c.style.width=n,c),au.svgResize(u))},[c,u,s,n,l,h,f]}class qz extends Ii{constructor(e){super(),ki(this,e,Kz,jz,Ai,{toolbox:2,width:3,height:4,workspace:1})}}const Jz={kind:"flyoutToolbox",contents:[{kind:"block",type:"variable"},{kind:"block",type:"quantifier"},{kind:"block",type:"combination"},{kind:"block",type:"negation"},{kind:"block",type:"intro"},{kind:"block",type:"destruct"},{kind:"block",type:"conj"},{kind:"block",type:"exact"}]};class Qz extends au.CodeGenerator{constructor(){super(...arguments);_i(this,"_outputType",i=>i===null?null:i.type==="quantifier"?"language":i.type==="negation"?this._outputType(i.getInputTargetBlock("PROPOSITION")):"math");_i(this,"variable",i=>[i.getFieldValue("NAME"),0]);_i(this,"quantifier",i=>{let s=i.getFieldValue("TYPE"),n="for all propositions ";return s!=="forall"&&(n="there exists a proposition "),n=n+"<m>"+this.valueToCode(i,"VARIABLE",0)+"</m>",s==="forall"?n=n+", ":n=n+" such that ",this._outputType(i.getInputTargetBlock("PREDICATE"))==="math"?n=n+"<m>"+this.valueToCode(i,"PREDICATE",0)+"</m>":n=n+this.valueToCode(i,"PREDICATE",0),[n,0]});_i(this,"combination",i=>{let s=this.valueToCode(i,"PROPOSITION1",0),n=i.getFieldValue("TYPE");return n=="and"?s=s+" \\wedge ":n=="implies"?s=s+" \\rightarrow ":n=="iff"?s=s+" \\leftrightarrow ":s=s+" \\vee ",s=s+this.valueToCode(i,"PROPOSITION2",0),[s,0]});_i(this,"negation",i=>{let s;return this._outputType(i.getInputTargetBlock("PROPOSITION"))==="math"?s="\\neg "+this.valueToCode(i,"PROPOSITION",0):s="it is false that "+this.valueToCode(i,"PROPOSITION",0),[s,0]});_i(this,"theorem",i=>{let s=this.valueToCode(i,"PROPOSITION",0);s=s.trim();let n=`<knowl mode="theorem">
`;return n=n+"    <title>"+i.getFieldValue("NAME")+`</title>
`,n=n+`    <content>
`,n=n+"        <p>"+s.charAt(0).toUpperCase()+s.slice(1)+`.</p>
`,n=n+`    </content>
`,n=n+`    <outtro>
`,n=n+this.statementToCode(i,"ARGUMENT")+`
`,n=n+`    </outtro>
`,n=n+"</knowl>",n});_i(this,"intro",i=>"<p>Let <m>"+i.getFieldValue("NAME")+"</m> be a proposition.</p>");_i(this,"exact",i=>"Exactly TODO lol");_i(this,"destruct",i=>{let s=`<p>From <m>${this.valueToCode(i,"ASSUMPTIONPROP",0)}</m> `;return s=s+`we have both <m>${this.valueToCode(i,"PROPOSITION1",0)}</m> and <m>${this.valueToCode(i,"PROPOSITION2",0)}</m>.</p>`,s});_i(this,"scrub_",(i,s,n)=>{const l=i.nextConnection&&i.nextConnection.targetBlock();return l&&!n?s+`
`+this.blockToCode(l):s});_i(this,"INDENT"," ".repeat(4))}}const Zz=new Qz("SpaTeXt"),eY=(r="")=>r.split(" ").reduce((s,n)=>s.concat(n.toLowerCase()),[]).join("_");class tY extends au.CodeGenerator{constructor(){super(...arguments);_i(this,"variable",i=>[i.getFieldValue("NAME"),0]);_i(this,"quantifier",i=>{var s=this.valueToCode(i,"PREDICATE",0);return[i.getFieldValue("TYPE")+" "+this.valueToCode(i,"VARIABLE",0)+" : Prop, "+s,0]});_i(this,"combination",i=>{let s="";var n=i.getFieldValue("TYPE");n=="and"?s="/\\":n=="or"?s="\\/":n=="implies"?s="->":n=="iff"&&(s="<->");var l=this.valueToCode(i,"PROPOSITION1",0)+" "+s+" "+this.valueToCode(i,"PROPOSITION2",0);return[l,0]});_i(this,"negation",i=>{var s="~ "+this.valueToCode(i,"PROPOSITION",0);return[s,0]});_i(this,"theorem",i=>"Theorem "+eY(i.getFieldValue("NAME"))+" : "+this.valueToCode(i,"PROPOSITION",0).trim()+`.
Proof.
`+this.statementToCode(i,"ARGUMENT")+`
Qed.
`);_i(this,"intro",i=>"intro "+i.getFieldValue("NAME")+".");_i(this,"exact",i=>"exact "+i.getFieldValue("NAME")+".");_i(this,"destruct",i=>`destruct ${i.getFieldValue("ASSUMPTION")}  as [${i.getFieldValue("HYPOTHESIS1")} ${i.getFieldValue("HYPOTHESIS2")}].`);_i(this,"scrub_",(i,s,n)=>{const l=i.nextConnection&&i.nextConnection.targetBlock();return l&&!n?s+`
`+this.blockToCode(l):s});_i(this,"INDENT"," ".repeat(0))}}const tA=new tY("Coq");function iA(r){let e,i,s,n,l,u,c,h,f;return s=new Ck({props:{value:r[1],lang:zk(),readonly:!0,styles:{"&":{border:"1px solid #aaa"}}}}),u=new gP({props:{stx:r[1]}}),h=new Ck({props:{value:tA.workspaceToCode(r[0]),lang:zk(),readonly:!0,styles:{"&":{border:"1px solid #aaa"}}}}),{c(){e=Ft("div"),i=Ft("div"),st(s.$$.fragment),n=xi(),l=Ft("div"),st(u.$$.fragment),c=xi(),st(h.$$.fragment),this.h()},l(p){e=Ut(p,"DIV",{class:!0});var g=Vt(e);i=Ut(g,"DIV",{class:!0});var T=Vt(i);nt(s.$$.fragment,T),T.forEach(ue),n=Di(g),l=Ut(g,"DIV",{class:!0});var $=Vt(l);nt(u.$$.fragment,$),$.forEach(ue),g.forEach(ue),c=Di(p),nt(h.$$.fragment,p),this.h()},h(){Ki(i,"class","column svelte-1elbvs0"),Ki(l,"class","column svelte-1elbvs0"),Ki(e,"class","flex-container svelte-1elbvs0")},m(p,g){Ee(p,e,g),vi(e,i),ot(s,i,null),vi(e,n),vi(e,l),ot(u,l,null),Ee(p,c,g),ot(h,p,g),f=!0},p(p,g){const T={};g&2&&(T.value=p[1]),s.$set(T);const $={};g&2&&($.stx=p[1]),u.$set($);const y={};g&1&&(y.value=tA.workspaceToCode(p[0])),h.$set(y)},i(p){f||(ee(s.$$.fragment,p),ee(u.$$.fragment,p),ee(h.$$.fragment,p),f=!0)},o(p){ae(s.$$.fragment,p),ae(u.$$.fragment,p),ae(h.$$.fragment,p),f=!1},d(p){p&&ue(e),lt(s),lt(u),p&&ue(c),lt(h,p)}}}function iY(r){let e,i,s,n,l;function u(f){r[2](f)}let c={height:"30em",width:"100%",toolbox:Jz};r[0]!==void 0&&(c.workspace=r[0]),e=new qz({props:c}),cb.push(()=>lx(e,"workspace",u));let h=r[0]&&iA(r);return{c(){st(e.$$.fragment),s=xi(),h&&h.c(),n=dt()},l(f){nt(e.$$.fragment,f),s=Di(f),h&&h.l(f),n=dt()},m(f,p){ot(e,f,p),Ee(f,s,p),h&&h.m(f,p),Ee(f,n,p),l=!0},p(f,[p]){const g={};!i&&p&1&&(i=!0,g.workspace=f[0],ax(()=>i=!1)),e.$set(g),f[0]?h?(h.p(f,p),p&1&&ee(h,1)):(h=iA(f),h.c(),ee(h,1),h.m(n.parentNode,n)):h&&(mt(),ae(h,1,1,()=>{h=null}),gt())},i(f){l||(ee(e.$$.fragment,f),ee(h),l=!0)},o(f){ae(e.$$.fragment,f),ae(h),l=!1},d(f){lt(e,f),f&&ue(s),h&&h.d(f),f&&ue(n)}}}function rY(r,e,i){let s;ub(async()=>{s.addChangeListener(()=>i(0,s))});let n="<spatext/>";function l(u){s=u,i(0,s)}return r.$$.update=()=>{r.$$.dirty&1&&s&&i(1,n=`<spatext>
${Zz.workspaceToCode(s)}
</spatext>`)},[s,n,l]}class TY extends Ii{constructor(e){super(),ki(this,e,rY,iY,Ai,{})}}export{TY as default};
